import{eL as gt,P as l,r as c,e as u,u as ht,g as It,d as yt,f as xt,o as E,c as R,_ as V,t as St,h as bt,i as wt,s as vt,k as _t,ej as _e,w as Ee,q as Et,a9 as $e,E as Ae,l as Ce}from"./iframe-6Ea7Lnhj.js";import{u as Te,L as z,a as $t,b as At}from"./index-DegWqaip.js";import{m as Ct}from"./mergeRefs-91-mP8KM.js";import{F as Ft}from"./FormContext-D8Mn8o3U.js";import{C as Ot}from"./Checkbox-Bhl7pOTE.js";import{A as Tt}from"./index-DRv8Cx3Q.js";import{i as Pt}from"./utils-DSvpuMUF.js";import{W as Bt,a as Dt}from"./bucket-19-B56Rjjwc.js";var se,Fe;function Mt(){if(Fe)return se;Fe=1;var o=typeof Element<"u",p=typeof Map=="function",f=typeof Set=="function",v=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function h(t,s){if(t===s)return!0;if(t&&s&&typeof t=="object"&&typeof s=="object"){if(t.constructor!==s.constructor)return!1;var a,r,m;if(Array.isArray(t)){if(a=t.length,a!=s.length)return!1;for(r=a;r--!==0;)if(!h(t[r],s[r]))return!1;return!0}var g;if(p&&t instanceof Map&&s instanceof Map){if(t.size!==s.size)return!1;for(g=t.entries();!(r=g.next()).done;)if(!s.has(r.value[0]))return!1;for(g=t.entries();!(r=g.next()).done;)if(!h(r.value[1],s.get(r.value[0])))return!1;return!0}if(f&&t instanceof Set&&s instanceof Set){if(t.size!==s.size)return!1;for(g=t.entries();!(r=g.next()).done;)if(!s.has(r.value[0]))return!1;return!0}if(v&&ArrayBuffer.isView(t)&&ArrayBuffer.isView(s)){if(a=t.length,a!=s.length)return!1;for(r=a;r--!==0;)if(t[r]!==s[r])return!1;return!0}if(t.constructor===RegExp)return t.source===s.source&&t.flags===s.flags;if(t.valueOf!==Object.prototype.valueOf&&typeof t.valueOf=="function"&&typeof s.valueOf=="function")return t.valueOf()===s.valueOf();if(t.toString!==Object.prototype.toString&&typeof t.toString=="function"&&typeof s.toString=="function")return t.toString()===s.toString();if(m=Object.keys(t),a=m.length,a!==Object.keys(s).length)return!1;for(r=a;r--!==0;)if(!Object.prototype.hasOwnProperty.call(s,m[r]))return!1;if(o&&t instanceof Element)return!1;for(r=a;r--!==0;)if(!((m[r]==="_owner"||m[r]==="__v"||m[r]==="__o")&&t.$$typeof)&&!h(t[m[r]],s[m[r]]))return!1;return!0}return t!==t&&s!==s}return se=function(s,a){try{return h(s,a)}catch(r){if((r.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw r}},se}var kt=Mt();const Pe=gt(kt),Lt={compareItems:l.func,sortItems:l.func},jt=(o,p,{locale:f})=>o.localeCompare(p,f,{numeric:!0}),Nt=(o,{selectedItems:p=[],itemToString:f,compareItems:v,locale:h="en"})=>o.sort((t,s)=>{if(t.isSelectAll)return-1;if(s.isSelectAll)return 1;const a=p.includes(t),r=p.includes(s);return a&&!r?-1:r&&!a?1:v(f(t),f(s),{locale:h})}),Oe=({isControlled:o,isMounted:p,onChangeHandlerControlled:f,onChangeHandlerUncontrolled:v,selectedItems:h})=>{o?p&&f&&setTimeout(()=>{f({selectedItems:h})},0):v(h)},Rt=({disabled:o,onChange:p,initialSelectedItems:f=[],selectedItems:v,selectAll:h=!1,filteredItems:t=[]})=>{const s=c.useRef(!1),a=c.useRef(p),[r,m]=c.useState(f),g=!!v,x=g?v:r,G=c.useCallback(O=>{if(o)return;const K=t.filter($=>!$?.disabled),J=t.filter($=>$?.disabled).length;let b;if(O?.isSelectAll&&x.length>0)b=[];else if(O?.isSelectAll&&x.length===0)b=K;else{const $=x.findLastIndex(B=>Pe(B,O));$===-1?(b=x.concat(O),h&&t.length-1===b.length+J&&(b=K)):(b=zt(x,$),b=b.filter(B=>!B?.isSelectAll))}Oe({isControlled:g,isMounted:s.current,onChangeHandlerControlled:a.current,onChangeHandlerUncontrolled:m,selectedItems:b})},[o,x,t,h,g]),S=c.useCallback(()=>{o||Oe({isControlled:g,isMounted:s.current,onChangeHandlerControlled:a.current,onChangeHandlerUncontrolled:m,selectedItems:[]})},[o,g]);return c.useEffect(()=>{a.current=p},[p]),c.useEffect(()=>{s.current&&a.current&&!g&&a.current({selectedItems:x})},[g,x]),c.useEffect(()=>(s.current=!0,()=>{s.current=!1}),[]),{clearSelection:S,onItemChange:G,selectedItems:x}},zt=(o,p)=>{const f=o.slice();return f.splice(p,1),f},{ItemClick:Kt,ToggleButtonBlur:qt,ToggleButtonKeyDownArrowDown:Ht,ToggleButtonKeyDownArrowUp:Ut,ToggleButtonKeyDownEnter:Wt,ToggleButtonKeyDownEscape:Vt,ToggleButtonKeyDownSpaceButton:Gt,ItemMouseMove:Jt,MenuMouseLeave:Qt,ToggleButtonClick:Xt,ToggleButtonKeyDownPageDown:Yt,ToggleButtonKeyDownPageUp:Zt,FunctionSetHighlightedIndex:es}=Te.stateChangeTypes,ts=o=>typeof o=="string"?o:typeof o=="number"?`${o}`:o!==null&&typeof o=="object"&&"label"in o&&typeof o.label=="string"?o.label:"",Be=u.forwardRef(({autoAlign:o=!1,className:p,decorator:f,id:v,items:h,itemToElement:t,itemToString:s=ts,titleText:a=!1,hideLabel:r,helperText:m,label:g,type:x="default",size:G,disabled:S=!1,initialSelectedItems:O=[],sortItems:K=Nt,compareItems:J=jt,clearSelectionText:b="To clear selection, press Delete or Backspace",clearAnnouncement:$="all items have been cleared",clearSelectionDescription:B="Total items selected: ",light:De,invalid:_,invalidText:Me,warn:q,warnText:ke,useTitleInItem:Le,translateWithId:ne,downshiftProps:je,open:T=!1,selectionFeedback:le="top-after-reopen",onChange:Ne,onMenuChange:re,direction:oe="bottom",selectedItems:ae,readOnly:D,locale:Re="en",slug:Q},ze)=>{const A=c.useMemo(()=>h.filter(e=>{if(typeof e=="object"&&e!==null){for(const d in e)if(Object.hasOwn(e,d)&&e[d]===void 0)return!1}return!0}),[h]);let M=A.some(e=>e.isSelectAll);(ae??[]).length>0&&M&&(console.warn("Warning: `selectAll` should not be used when `selectedItems` is provided. Please pass either `selectAll` or `selectedItems`, not both."),M=!1);const n=ht(),{isFluid:X}=c.useContext(Ft),ie=It(),[ss,Y]=c.useState(!1),[ce,k]=c.useState(!1),[w,Ke]=c.useState(T||!1),[qe,He]=c.useState(T),[Ue,We]=c.useState([]),[Ve,ue]=c.useState(!1),C=yt("enable-v12-dynamic-floating-styles")||o,{refs:P,floatingStyles:fe,middlewareData:de}=xt(C?{placement:oe,strategy:"fixed",middleware:[o&&wt({crossAxis:!1}),vt({apply({rects:e,elements:d}){Object.assign(d.floating.style,{width:`${e.reference.width}px`})}}),o&&_t()],whileElementsMounted:bt}:{});c.useLayoutEffect(()=>{if(C){const e={...fe,visibility:de.hide?.referenceHidden?"hidden":"visible"};Object.keys(e).forEach(d=>{P.floating.current&&(P.floating.current.style[d]=e[d])})}},[C,fe,P.floating,de,T]);const{selectedItems:H,onItemChange:pe,clearSelection:me}=Rt({disabled:S,initialSelectedItems:O,onChange:Ne,selectedItems:ae,selectAll:M,filteredItems:A}),Z={selectedItems:H,itemToString:s,compareItems:J,locale:Re},Ge={stateReducer:ot,isOpen:w,itemToString:e=>Array.isArray(e)&&e.map(function(d){return s(d)}).join(", ")||"",selectedItem:H,items:A,isItemDisabled(e,d){return e?.disabled},...je},{getToggleButtonProps:Je,getLabelProps:Qe,getMenuProps:ge,getItemProps:Xe,selectedItem:Ye,highlightedIndex:Ze,setHighlightedIndex:he}=Te(Ge),Ie=Je({onFocus:()=>{k(!0)},onBlur:()=>{k(!1)},onKeyDown:e=>{S||((E(e,_e)||E(e,Ee))&&!w&&(me(),e.stopPropagation()),!w&&E(e,_e)&&I.length>0&&ue(!0),(E(e,Et)||E(e,$e)||E(e,Ae))&&!w&&(he(0),ue(!1),U(!0)),E(e,$e)&&I.length===0&&(k(!1),Y(!1)),E(e,Ee)&&w&&k(!0),E(e,Ae)&&w&&k(!0))}}),ee=Ct(Ie.ref,ze),I=Ye,U=e=>{Ke(e),re&&re(e)};qe!==T&&(U(T),He(T));const F=x==="inline",ye=!_&&q,et=R(`${n}--multi-select__wrapper`,`${n}--list-box__wrapper`,p,{[`${n}--multi-select__wrapper--inline`]:F,[`${n}--list-box__wrapper--inline`]:F,[`${n}--multi-select__wrapper--inline--invalid`]:F&&_,[`${n}--list-box__wrapper--inline--invalid`]:F&&_,[`${n}--list-box__wrapper--fluid--invalid`]:X&&_,[`${n}--list-box__wrapper--slug`]:Q,[`${n}--list-box__wrapper--decorator`]:f}),tt=R(`${n}--label`,{[`${n}--label--disabled`]:S,[`${n}--visually-hidden`]:r}),xe=m?`multiselect-helper-text-${ie}`:void 0,st=`multiselect-field-label-${ie}`,nt=R(`${n}--form__helper-text`,{[`${n}--form__helper-text--disabled`]:S}),lt=R(`${n}--multi-select`,{[`${n}--multi-select--invalid`]:_,[`${n}--multi-select--invalid--focused`]:_&&ce,[`${n}--multi-select--warning`]:ye,[`${n}--multi-select--inline`]:F,[`${n}--multi-select--selected`]:I&&I.length>0,[`${n}--list-box--up`]:oe==="top",[`${n}--multi-select--readonly`]:D,[`${n}--autoalign`]:C,[`${n}--multi-select--selectall`]:M}),rt=t;le==="fixed"?Z.selectedItems=[]:le==="top-after-reopen"&&(Z.selectedItems=Ue);function ot(e,d){const{changes:i,props:L,type:j}=d,{highlightedIndex:y}=i;switch(i.isOpen&&!w&&We(H),j){case Gt:case Wt:if(i.selectedItem===void 0||Array.isArray(i.selectedItem))break;return pe(i.selectedItem),{...i,highlightedIndex:e.highlightedIndex};case qt:case Vt:U(!1);break;case Xt:return U(i.isOpen||!1),{...i,highlightedIndex:H.length>0?0:void 0};case Kt:return he(i.selectedItem),pe(i.selectedItem),{...i,highlightedIndex:e.highlightedIndex};case Qt:return{...i,highlightedIndex:e.highlightedIndex};case es:return w?{...i,highlightedIndex:A.indexOf(y)}:{...i,highlightedIndex:0};case Ht:case Ut:case Yt:case Zt:if(y>-1){const te=document.querySelectorAll(`li.${n}--list-box__menu-item[role="option"]`);L.scrollIntoView(te[y])}return y===-1?{...i,highlightedIndex:0}:i;case Jt:return{...i,highlightedIndex:e.highlightedIndex}}return i}const at=R(`${n}--list-box__field--wrapper`,{[`${n}--list-box__field--wrapper--input-focused`]:ce}),Se=e=>{e.target.classList.contains(`${n}--tag__close-icon`)?Y(!1):Y(e.type==="focus")},it=D?{onClick:e=>{e.preventDefault(),ee.current!==void 0&&ee.current.focus()},onKeyDown:e=>{["ArrowDown","ArrowUp"," ","Enter"].includes(e.key)&&e.preventDefault()}}:{},be=Q??f,we=Pt(be,Tt)?c.cloneElement(be,{size:"mini"}):null,ct=I.length>0&&I.map(e=>e?.text),ut=M?I.filter(e=>!e.isSelectAll).length:I.length,ft=c.useMemo(()=>ge({ref:C?P.setFloating:null}),[C,ge,P.setFloating]),ve=Qe(),dt=c.isValidElement(a)?{id:ve.id}:ve,pt=c.useCallback((e,d)=>{const i=e.some(y=>!y.isSelectAll),L=e.filter(y=>!y.isSelectAll).length,j=d.filter(y=>!y.isSelectAll&&!y.disabled).length;return{hasIndividualSelections:i,nonSelectAllSelectedCount:L,totalSelectableCount:j}},[I,A]);return u.createElement("div",{className:et},u.createElement("label",V({className:tt},dt),a&&a,I.length>0&&u.createElement("span",{className:`${n}--visually-hidden`},B," ",I.length," ",ct,",",b)),u.createElement(z,{onFocus:X?Se:void 0,onBlur:X?Se:void 0,type:x,size:G,className:lt,disabled:S,light:De,invalid:_,invalidText:Me,warn:q,warnText:ke,isOpen:w,id:v},_&&u.createElement(Bt,{className:`${n}--list-box__invalid-icon`}),ye&&u.createElement(Dt,{className:`${n}--list-box__invalid-icon ${n}--list-box__invalid-icon--warning`}),u.createElement("div",{className:at,ref:C?P.setReference:null},I.length>0&&u.createElement(z.Selection,{readOnly:D,clearSelection:!S&&!D?me:St,selectionCount:ut,translateWithId:ne,disabled:S}),u.createElement("button",V({type:"button",className:`${n}--list-box__field`,disabled:S,"aria-disabled":S||D,"aria-describedby":!F&&!_&&!q&&m?xe:void 0},Ie,{ref:ee},it),u.createElement("span",{id:st,className:`${n}--list-box__label`},g),u.createElement(z.MenuIcon,{isOpen:w,translateWithId:ne})),Q?we:f?u.createElement("div",{className:`${n}--list-box__inner-wrapper--decorator`},we):""),u.createElement(z.Menu,ft,w&&K(A,Z).map((e,d)=>{const i=I.filter(mt=>Pe(mt,e)).length>0,{hasIndividualSelections:L,nonSelectAllSelectedCount:j,totalSelectableCount:y}=pt(I,A),te=e.isSelectAll&&L&&j<y,N=Xe({item:e,"aria-selected":i}),W=s(e);return u.createElement(z.MenuItem,V({key:N.id,isActive:i&&!e.isSelectAll,"aria-label":W,isHighlighted:Ze===d,title:W,disabled:N["aria-disabled"]},N),u.createElement("div",{className:`${n}--checkbox-wrapper`},u.createElement(Ot,{id:`${N.id}__checkbox`,labelText:t?u.createElement(rt,V({key:N.id},e)):W,checked:i,title:Le?W:void 0,indeterminate:te,disabled:S})))})),Ve&&u.createElement("span",{"aria-live":"assertive","aria-label":$})),!F&&!_&&!q&&m&&u.createElement("div",{id:xe,className:nt},m))});Be.displayName="MultiSelect";Be.propTypes={...Lt,autoAlign:l.bool,className:l.string,clearSelectionDescription:l.string,clearSelectionText:l.string,compareItems:l.func,decorator:l.node,direction:l.oneOf(["top","bottom"]),disabled:l.bool,downshiftProps:l.object,helperText:l.node,hideLabel:l.bool,id:l.string.isRequired,initialSelectedItems:l.array,invalid:l.bool,invalidText:l.node,itemToElement:l.func,itemToString:l.func,items:l.array.isRequired,label:l.node.isRequired,light:Ce(l.bool),locale:l.string,onChange:l.func,onMenuChange:l.func,open:l.bool,readOnly:l.bool,selectedItems:l.array,selectionFeedback:l.oneOf(["top","fixed","top-after-reopen"]),size:At,slug:Ce(l.node),sortItems:l.func,titleText:l.node,translateWithId:l.func,type:$t,useTitleInItem:l.bool,warn:l.bool,warnText:l.node};export{Be as M,jt as a,Nt as d,Pe as i,Lt as s,Rt as u};
