import{eG as gt,P as l,r as i,e as u,u as ht,d as It,a as yt,b as xt,n as C,c as N,_ as W,q as St,f as bt,g as wt,s as vt,h as _t,eg as Ee,t as Ce,o as Et,a3 as Ae,E as $e,i as Fe}from"./iframe-DCfjJu_F.js";import{u as Te,L as R,a as Ct,b as At}from"./index-BgLL8Ey7.js";import{m as $t}from"./mergeRefs-D4pwfk3t.js";import{F as Ft}from"./FormContext-zJNsbdVC.js";import{C as Ot}from"./Checkbox-D9UbsuV-.js";import{A as Tt}from"./index-DggURKcq.js";import{i as Pt}from"./utils-CHds83dj.js";import{W as Bt,a as Dt}from"./bucket-19-DaUFX3rW.js";var ne,Oe;function Mt(){if(Oe)return ne;Oe=1;var o=typeof Element<"u",g=typeof Map=="function",f=typeof Set=="function",v=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function h(t,s){if(t===s)return!0;if(t&&s&&typeof t=="object"&&typeof s=="object"){if(t.constructor!==s.constructor)return!1;var a,r,p;if(Array.isArray(t)){if(a=t.length,a!=s.length)return!1;for(r=a;r--!==0;)if(!h(t[r],s[r]))return!1;return!0}var d;if(g&&t instanceof Map&&s instanceof Map){if(t.size!==s.size)return!1;for(d=t.entries();!(r=d.next()).done;)if(!s.has(r.value[0]))return!1;for(d=t.entries();!(r=d.next()).done;)if(!h(r.value[1],s.get(r.value[0])))return!1;return!0}if(f&&t instanceof Set&&s instanceof Set){if(t.size!==s.size)return!1;for(d=t.entries();!(r=d.next()).done;)if(!s.has(r.value[0]))return!1;return!0}if(v&&ArrayBuffer.isView(t)&&ArrayBuffer.isView(s)){if(a=t.length,a!=s.length)return!1;for(r=a;r--!==0;)if(t[r]!==s[r])return!1;return!0}if(t.constructor===RegExp)return t.source===s.source&&t.flags===s.flags;if(t.valueOf!==Object.prototype.valueOf&&typeof t.valueOf=="function"&&typeof s.valueOf=="function")return t.valueOf()===s.valueOf();if(t.toString!==Object.prototype.toString&&typeof t.toString=="function"&&typeof s.toString=="function")return t.toString()===s.toString();if(p=Object.keys(t),a=p.length,a!==Object.keys(s).length)return!1;for(r=a;r--!==0;)if(!Object.prototype.hasOwnProperty.call(s,p[r]))return!1;if(o&&t instanceof Element)return!1;for(r=a;r--!==0;)if(!((p[r]==="_owner"||p[r]==="__v"||p[r]==="__o")&&t.$$typeof)&&!h(t[p[r]],s[p[r]]))return!1;return!0}return t!==t&&s!==s}return ne=function(s,a){try{return h(s,a)}catch(r){if((r.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw r}},ne}var kt=Mt();const Pe=gt(kt),Lt={compareItems:l.func,sortItems:l.func},jt=(o,g,{locale:f})=>o.localeCompare(g,f,{numeric:!0}),Nt=(o,{selectedItems:g=[],itemToString:f,compareItems:v,locale:h="en"})=>o.sort((t,s)=>{if(t.isSelectAll)return-1;if(s.isSelectAll)return 1;const a=g.includes(t),r=g.includes(s);return a&&!r?-1:r&&!a?1:v(f(t),f(s),{locale:h})}),le=({isControlled:o,isMounted:g,onChangeHandlerControlled:f,onChangeHandlerUncontrolled:v,selectedItems:h})=>{o?g&&f&&setTimeout(()=>{f({selectedItems:h})},0):v(h)},Rt=({disabled:o,onChange:g,initialSelectedItems:f=[],selectedItems:v,selectAll:h=!1,filteredItems:t=[]})=>{const s=i.useRef(!1),a=i.useRef(g),[r,p]=i.useState(f),d=!!v,x=d?v:r,V=i.useCallback(A=>{if(o)return;const z=t.filter(E=>!E?.disabled&&!E?.isSelectAll),J=t.filter(E=>E?.disabled).length;let b;if(A?.isSelectAll&&x.length>0)b=[];else if(A?.isSelectAll&&x.length===0)b=z;else{const E=x.findLastIndex(M=>Pe(M,A));E===-1?(b=x.concat(A),h&&t.length-1===b.length+J&&(b=z)):(b=zt(x,E),b=b.filter(M=>!M?.isSelectAll))}le({isControlled:d,isMounted:s.current,onChangeHandlerControlled:a.current,onChangeHandlerUncontrolled:p,selectedItems:b})},[o,x,t,h,d]),S=i.useCallback(()=>{o||le({isControlled:d,isMounted:s.current,onChangeHandlerControlled:a.current,onChangeHandlerUncontrolled:p,selectedItems:[]})},[o,d]),G=i.useCallback(A=>{le({isControlled:d,isMounted:s.current,onChangeHandlerControlled:a.current,onChangeHandlerUncontrolled:p,selectedItems:A})},[d]);return i.useEffect(()=>{a.current=g},[g]),i.useEffect(()=>{s.current&&a.current&&!d&&a.current({selectedItems:x})},[d,x]),i.useEffect(()=>(s.current=!0,()=>{s.current=!1}),[]),{clearSelection:S,onItemChange:V,toggleAll:G,selectedItems:x}},zt=(o,g)=>{const f=o.slice();return f.splice(g,1),f},{ItemClick:Ht,ToggleButtonBlur:Kt,ToggleButtonKeyDownArrowDown:qt,ToggleButtonKeyDownArrowUp:Ut,ToggleButtonKeyDownEnter:Wt,ToggleButtonKeyDownEscape:Vt,ToggleButtonKeyDownSpaceButton:Gt,ItemMouseMove:Jt,MenuMouseLeave:Qt,ToggleButtonClick:Xt,ToggleButtonKeyDownPageDown:Yt,ToggleButtonKeyDownPageUp:Zt,FunctionSetHighlightedIndex:es}=Te.stateChangeTypes,ts=o=>typeof o=="string"?o:typeof o=="number"?`${o}`:o!==null&&typeof o=="object"&&"label"in o&&typeof o.label=="string"?o.label:"",Be=u.forwardRef(({autoAlign:o=!1,className:g,decorator:f,id:v,items:h,itemToElement:t,itemToString:s=ts,titleText:a=!1,hideLabel:r,helperText:p,label:d,type:x="default",size:V,disabled:S=!1,initialSelectedItems:G=[],sortItems:A=Nt,compareItems:z=jt,clearSelectionText:J="To clear selection, press Delete or Backspace",clearAnnouncement:b="all items have been cleared",clearSelectionDescription:E="Total items selected: ",light:M,invalid:_,invalidText:De,warn:H,warnText:Me,useTitleInItem:ke,translateWithId:re,downshiftProps:Le,open:P=!1,selectionFeedback:oe="top-after-reopen",onChange:je,onMenuChange:ae,direction:ce="bottom",selectedItems:Ne,readOnly:k,locale:Re="en",slug:Q},ze)=>{const $=i.useMemo(()=>h.filter(e=>{if(typeof e=="object"&&e!==null){for(const m in e)if(Object.hasOwn(e,m)&&e[m]===void 0)return!1}return!0}),[h]),X=$.some(e=>e.isSelectAll),n=ht(),{isFluid:Y}=i.useContext(Ft),ie=It(),[ss,Z]=i.useState(!1),[ue,L]=i.useState(!1),[w,He]=i.useState(P||!1),[Ke,qe]=i.useState(P),[Ue,We]=i.useState([]),[Ve,fe]=i.useState(!1),F=yt("enable-v12-dynamic-floating-styles")||o,{refs:B,floatingStyles:de,middlewareData:pe}=xt(F?{placement:ce,strategy:"fixed",middleware:[o&&wt({crossAxis:!1}),vt({apply({rects:e,elements:m}){Object.assign(m.floating.style,{width:`${e.reference.width}px`})}}),o&&_t()],whileElementsMounted:bt}:{});i.useLayoutEffect(()=>{if(F){const e={...de,visibility:pe.hide?.referenceHidden?"hidden":"visible"};Object.keys(e).forEach(m=>{B.floating.current&&(B.floating.current.style[m]=e[m])})}},[F,de,B.floating,pe,P]);const{selectedItems:K,onItemChange:me,clearSelection:ge}=Rt({disabled:S,initialSelectedItems:G,onChange:je,selectedItems:Ne,selectAll:X,filteredItems:$}),ee={selectedItems:K,itemToString:s,compareItems:z,locale:Re},Ge={stateReducer:ot,isOpen:w,itemToString:e=>Array.isArray(e)&&e.map(m=>s(m)).join(", ")||"",selectedItem:K,items:$,isItemDisabled(e,m){return e?.disabled},...Le},{getToggleButtonProps:Je,getLabelProps:Qe,getMenuProps:he,getItemProps:Xe,selectedItem:Ye,highlightedIndex:Ze,setHighlightedIndex:Ie}=Te(Ge),ye=Je({onFocus:()=>{L(!0)},onBlur:()=>{L(!1)},onKeyDown:e=>{S||((C(e,Ee)||C(e,Ce))&&!w&&(ge(),e.stopPropagation()),!w&&C(e,Ee)&&y.length>0&&fe(!0),(C(e,Et)||C(e,Ae)||C(e,$e))&&!w&&(Ie(0),fe(!1),q(!0)),C(e,Ae)&&y.length===0&&(L(!1),Z(!1)),C(e,Ce)&&w&&L(!0),C(e,$e)&&w&&L(!0))}}),te=$t(ye.ref,ze),y=Ye,q=e=>{He(e),ae&&ae(e)};Ke!==P&&(q(P),qe(P));const O=x==="inline",xe=!_&&H,et=N(`${n}--multi-select__wrapper`,`${n}--list-box__wrapper`,g,{[`${n}--multi-select__wrapper--inline`]:O,[`${n}--list-box__wrapper--inline`]:O,[`${n}--multi-select__wrapper--inline--invalid`]:O&&_,[`${n}--list-box__wrapper--inline--invalid`]:O&&_,[`${n}--list-box__wrapper--fluid--invalid`]:Y&&_,[`${n}--list-box__wrapper--slug`]:Q,[`${n}--list-box__wrapper--decorator`]:f}),tt=N(`${n}--label`,{[`${n}--label--disabled`]:S,[`${n}--visually-hidden`]:r}),Se=p?`multiselect-helper-text-${ie}`:void 0,st=`multiselect-field-label-${ie}`,nt=N(`${n}--form__helper-text`,{[`${n}--form__helper-text--disabled`]:S}),lt=N(`${n}--multi-select`,{[`${n}--multi-select--invalid`]:_,[`${n}--multi-select--invalid--focused`]:_&&ue,[`${n}--multi-select--warning`]:xe,[`${n}--multi-select--inline`]:O,[`${n}--multi-select--selected`]:y&&y.length>0,[`${n}--list-box--up`]:ce==="top",[`${n}--multi-select--readonly`]:k,[`${n}--autoalign`]:F,[`${n}--multi-select--selectall`]:X}),rt=t;oe==="fixed"?ee.selectedItems=[]:oe==="top-after-reopen"&&(ee.selectedItems=Ue);function ot(e,m){const{changes:c,props:D,type:T}=m,{highlightedIndex:I}=c;switch(c.isOpen&&!w&&We(K),T){case Gt:case Wt:if(c.selectedItem===void 0||Array.isArray(c.selectedItem))break;return me(c.selectedItem),{...c,highlightedIndex:e.highlightedIndex};case Kt:case Vt:q(!1);break;case Xt:return q(c.isOpen||!1),{...c,highlightedIndex:K.length>0?0:void 0};case Ht:return Ie(c.selectedItem),me(c.selectedItem),{...c,highlightedIndex:e.highlightedIndex};case Qt:return{...c,highlightedIndex:e.highlightedIndex};case es:return w?{...c,highlightedIndex:$.indexOf(I)}:{...c,highlightedIndex:0};case qt:case Ut:case Yt:case Zt:if(I>-1){const se=document.querySelectorAll(`li.${n}--list-box__menu-item[role="option"]`);D.scrollIntoView(se[I])}return I===-1?{...c,highlightedIndex:0}:c;case Jt:return{...c,highlightedIndex:e.highlightedIndex}}return c}const at=N(`${n}--list-box__field--wrapper`,{[`${n}--list-box__field--wrapper--input-focused`]:ue}),be=e=>{e.target.classList.contains(`${n}--tag__close-icon`)?Z(!1):Z(e.type==="focus")},ct=k?{onClick:e=>{e.preventDefault(),te.current!==void 0&&te.current.focus()},onKeyDown:e=>{["ArrowDown","ArrowUp"," ","Enter"].includes(e.key)&&e.preventDefault()}}:{},we=Q??f,ve=Pt(we,Tt)?i.cloneElement(we,{size:"mini"}):null,it=y.length>0&&y.map(e=>e?.text),ut=X?y.filter(e=>!e.isSelectAll).length:y.length,ft=i.useMemo(()=>he({ref:F?B.setFloating:null}),[F,he,B.setFloating]),_e=Qe(),dt=i.isValidElement(a)?{id:_e.id}:_e,pt=i.useCallback((e,m)=>{const c=e.some(I=>!I.isSelectAll),D=e.filter(I=>!I.isSelectAll).length,T=m.filter(I=>!I.isSelectAll&&!I.disabled).length;return{hasIndividualSelections:c,nonSelectAllSelectedCount:D,totalSelectableCount:T}},[y,$]);return u.createElement("div",{className:et},u.createElement("label",W({className:tt},dt),a&&a,y.length>0&&u.createElement("span",{className:`${n}--visually-hidden`},E," ",y.length," ",it,",",J)),u.createElement(R,{onFocus:Y?be:void 0,onBlur:Y?be:void 0,type:x,size:V,className:lt,disabled:S,light:M,invalid:_,invalidText:De,warn:H,warnText:Me,isOpen:w,id:v},_&&u.createElement(Bt,{className:`${n}--list-box__invalid-icon`}),xe&&u.createElement(Dt,{className:`${n}--list-box__invalid-icon ${n}--list-box__invalid-icon--warning`}),u.createElement("div",{className:at,ref:F?B.setReference:null},y.length>0&&u.createElement(R.Selection,{readOnly:k,clearSelection:!S&&!k?ge:St,selectionCount:ut,translateWithId:re,disabled:S}),u.createElement("button",W({type:"button",className:`${n}--list-box__field`,disabled:S,"aria-disabled":S||k,"aria-describedby":!O&&!_&&!H&&p?Se:void 0},ye,{ref:te},ct),u.createElement("span",{id:st,className:`${n}--list-box__label`},d),u.createElement(R.MenuIcon,{isOpen:w,translateWithId:re})),Q?ve:f?u.createElement("div",{className:`${n}--list-box__inner-wrapper--decorator`},ve):""),u.createElement(R.Menu,ft,w&&A($,ee).map((e,m)=>{const{hasIndividualSelections:c,nonSelectAllSelectedCount:D,totalSelectableCount:T}=pt(y,$),I=e.isSelectAll?D===T&&T>0:y.some(mt=>Pe(mt,e)),se=e.isSelectAll&&c&&D<T,j=Xe({item:e,"aria-selected":I}),U=s(e);return u.createElement(R.MenuItem,W({key:j.id,isActive:I&&!e.isSelectAll,"aria-label":U,isHighlighted:Ze===m,title:U,disabled:j["aria-disabled"]},j),u.createElement("div",{className:`${n}--checkbox-wrapper`},u.createElement(Ot,{id:`${j.id}__checkbox`,labelText:t?u.createElement(rt,W({key:j.id},e)):U,checked:I,title:ke?U:void 0,indeterminate:se,disabled:S})))})),Ve&&u.createElement("span",{"aria-live":"assertive","aria-label":b})),!O&&!_&&!H&&p&&u.createElement("div",{id:Se,className:nt},p))});Be.displayName="MultiSelect";Be.propTypes={...Lt,autoAlign:l.bool,className:l.string,clearSelectionDescription:l.string,clearSelectionText:l.string,compareItems:l.func,decorator:l.node,direction:l.oneOf(["top","bottom"]),disabled:l.bool,downshiftProps:l.object,helperText:l.node,hideLabel:l.bool,id:l.string.isRequired,initialSelectedItems:l.array,invalid:l.bool,invalidText:l.node,itemToElement:l.func,itemToString:l.func,items:l.array.isRequired,label:l.node.isRequired,light:Fe(l.bool),locale:l.string,onChange:l.func,onMenuChange:l.func,open:l.bool,readOnly:l.bool,selectedItems:l.array,selectionFeedback:l.oneOf(["top","fixed","top-after-reopen"]),size:At,slug:Fe(l.node),sortItems:l.func,titleText:l.node,translateWithId:l.func,type:Ct,useTitleInItem:l.bool,warn:l.bool,warnText:l.node};export{Be as M,jt as a,Nt as d,Pe as i,Lt as s,Rt as u};
