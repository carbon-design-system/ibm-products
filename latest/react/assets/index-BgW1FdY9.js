import{e as g,a as be,b as qe,f as Be,g as He,d as We,u as Ve,r as t,c as W,_ as Z,O as he,P as e,a5 as we,eF as ve,eG as J,eD as je,aN as Ee,v as fe,eH as Xe,n as ze,a4 as Ke,eI as Ye,q as oe,$ as ue,a2 as Ge,X as Ue,a1 as Je,am as Qe,t as Ze,i as de}from"./iframe-BpnXlfCj.js";import{b as et,a as tt}from"./useAttachedMenu-CjUBRJxP.js";import{m as ne}from"./mergeRefs-BZpmU3mx.js";import{t as ye}from"./bucket-13-BW8mKYI8.js";import{s as ot,b as nt,w as st,a as rt}from"./wrapFocus-B-05VqgP.js";import{u as lt}from"./useOutsideClick-D6ARJrF8.js";const pe="md",Ce=g.forwardRef(({autoAlign:r=!1,children:l,className:O,label:d="Options",renderIcon:w=ye,size:c=pe,menuAlignment:s="bottom-start",tooltipAlignment:T,menuTarget:P,...b},M)=>{const f=be("enable-v12-dynamic-floating-styles")||r,{refs:E,floatingStyles:a,placement:F,middlewareData:p}=qe(f?{placement:s,strategy:"fixed",middleware:[r&&He({fallbackPlacements:s.includes("bottom")?["bottom-start","bottom-end","top-start","top-end"]:["top-start","top-end","bottom-start","bottom-end"]})],whileElementsMounted:Be}:{}),y=We("overflowmenu"),u=Ve(),m=t.useRef(null),{open:v,x:D,y:k,handleClick:q,handleMousedown:V,handleClose:B}=et(m);t.useEffect(()=>{f&&Object.keys(a).forEach(R=>{E.floating.current&&(E.floating.current.style[R]=a[R])})},[a,f,E.floating,v,F,p]);function h(){m.current&&q()}const i=W(O,`${u}--overflow-menu__container`,{[`${u}--autoalign`]:f}),I=W(`${u}--overflow-menu__${s}`),n=W(`${u}--overflow-menu`,{[`${u}--overflow-menu--open`]:v},c!==pe&&`${u}--overflow-menu--${c}`),C=ne(m,E.setReference);return g.createElement("div",Z({},b,{className:i,"aria-owns":v?y:void 0,ref:M}),g.createElement(he,{"aria-controls":v?y:void 0,"aria-haspopup":!0,"aria-expanded":v,className:n,onClick:h,onMouseDown:V,ref:C,label:d,align:T,kind:"ghost"},g.createElement(w,{className:`${u}--overflow-menu__icon`})),g.createElement(tt,{containerRef:m,ref:E.setFloating,menuAlignment:s,className:I,id:y,size:c,legacyAutoalign:!f,open:v,onClose:B,x:D,y:k,label:d,target:P},l))});Ce.propTypes={autoAlign:e.bool,children:e.node,className:e.string,label:e.string,menuAlignment:e.oneOf(["top-start","top-end","bottom-start","bottom-end"]),renderIcon:e.oneOfType([e.func,e.object]),size:e.oneOf(["xs","sm","md","lg"]),tooltipAlignment:we(e.oneOf(["top","top-left","top-right","bottom","bottom-left","bottom-right","left","left-bottom","left-top","right","right-bottom","right-top","top-start","top-end","bottom-start","bottom-end","left-end","left-start","right-end","right-start"]),["top","top-start","top-end","bottom","bottom-start","bottom-end","left","left-start","left-end","right","right-start","right-end"],ve),menuTarget:e.instanceOf(typeof Element<"u"?Element:Object)};var Q,me;function at(){return me||(me=1,Q=typeof self=="object"&&self.self===self&&self||typeof J=="object"&&J.global===J&&J||Q),Q}var ct=at();const H=je(ct),it=(()=>{const r=[];let l=!1;const O=()=>{r.forEach(c=>{c()}),l=!1},d=()=>{l||(l=!0,H.requestAnimationFrame(O))},w=c=>{r.indexOf(c)<0&&r.push(c)};return{add:c=>(r.length||H.addEventListener("resize",d),w(c),{remove:()=>{const s=r.indexOf(c);s>=0&&r.splice(s,1)}})}})(),ft="left",se="top",ut="right",Y="bottom",dt=({menuSize:r,refPosition:l,offset:O,direction:d,scrollX:w,scrollY:c,container:s})=>{const{left:T=0,top:P=0,right:b=0,bottom:M=0}=l,f=s.position!=="static"?0:w,E=s.position!=="static"?0:c,a={top:s.position!=="static"?s.rect.top:0,left:s.position!=="static"?s.rect.left:0},{width:F,height:p}=r,{top:y=0,left:u=0}=O,m=(T+b)/2,v=(P+M)/2;return{[ft]:()=>({left:T-F+f-u-a.left,top:v-p/2+E+y-9-a.top}),[se]:()=>({left:m-F/2+f+u-a.left,top:P-p+E-y-a.top}),[ut]:()=>({left:b+f+u-a.left,top:v-p/2+E+y+3-a.top}),[Y]:()=>({left:m-F/2+f+u-a.left,top:M+E+y-a.top})}[d]()},pt=({children:r,flipped:l,focusTrap:O,menuDirection:d=Y,menuOffset:w={top:0,left:0},menuRef:c,onPlace:s,selectorPrimaryFocus:T,styles:P,target:b=()=>document.body,triggerRef:M,updateOrientation:f})=>{const E=t.useContext(Ee),[a,F]=t.useState(void 0),p=t.useRef(null),y=t.useRef(null),u=t.useRef(null),m=t.useRef(!1),v=t.useCallback(n=>{const C=p.current;if(!C)return;const R=M.current,$=C.getBoundingClientRect(),_=R?R.getBoundingClientRect():void 0,j=typeof w=="function"?w(C,d,R,l):w;if(f&&f({menuSize:$,refPosition:_,direction:d,offset:j,scrollX:H.pageXOffset,scrollY:H.pageYOffset,container:{rect:b().getBoundingClientRect(),position:getComputedStyle(b()).position}}),$.width>0&&$.height>0||!j){const N=dt({menuSize:$,refPosition:_??{left:0,top:0,right:0,bottom:0},offset:j,direction:d,scrollX:H.pageXOffset,scrollY:H.pageYOffset,container:{rect:b().getBoundingClientRect(),position:getComputedStyle(b()).position}});if((!a||a.left!==N.left||a.top!==N.top)&&F(N),!n){const X=C.getBoundingClientRect();(X.width!==$.width||X.height!==$.height)&&v(!0)}}},[M,w,d,l,b,f,a]),D=n=>{const C=T?n.querySelector(T):null,R=n.querySelector(ot),$=n.querySelector(nt);(C||R||$||n).focus()},k=n=>{p.current=n,m.current=!!n,c&&c(n),n&&v()};t.useEffect(()=>{m.current&&a&&p.current&&(p.current.contains(document.activeElement)||D(p.current),typeof s=="function"&&s(p.current),m.current=!1)},[a,s]),t.useEffect(()=>{const n=it.add(()=>{v()});return()=>{n.remove()}},[M,w,d,l,b,f]),t.useEffect(()=>{v()},[w,d,l,M,b,f]);const q=()=>{const n=a,C=n?{left:`${n.left}px`,top:`${n.top}px`,right:"auto"}:{visibility:"hidden",top:"0px"},R=r;return t.cloneElement(R,{ref:k,style:{...P,...C,position:"absolute",opacity:1}})},V=n=>{const{target:C,relatedTarget:R}=n;p.current&&y.current&&u.current&&C instanceof HTMLElement&&R instanceof HTMLElement&&rt({bodyNode:p.current,startTrapNode:y.current,endTrapNode:u.current,currentActiveNode:R,oldActiveNode:C})},B=n=>{ze(n,Ke)&&p.current&&n.target instanceof HTMLElement&&st({containerNode:p.current,currentActiveNode:n.target,event:n})},h=fe("enable-experimental-focus-wrap-without-sentinels"),i=fe("enable-focus-wrap-without-sentinels"),I=h||i;if(typeof document<"u"){const n=b?b():document.body;return Xe.createPortal(g.createElement("div",{onBlur:O&&!I?V:void 0,onKeyDown:I?B:void 0},!I&&g.createElement("span",{ref:y,tabIndex:0,role:"link",className:`${E}--visually-hidden`},"Focus sentinel"),q(),!I&&g.createElement("span",{ref:u,tabIndex:0,role:"link",className:`${E}--visually-hidden`},"Focus sentinel")),n)}return null},mt=Ye(),gt=(r,...l)=>(r.addEventListener(...l),{release(){return r.removeEventListener(...l),null}}),bt={[se]:"bottom",[Y]:"top"},ge=(r,l,O,d)=>{const w=bt[l],{offsetWidth:c,offsetHeight:s}=r;switch(w){case"top":case"bottom":{const T=O?O.offsetWidth:0;return{left:(d?-1:1)*(c/2-T/2),top:0}}default:return{left:0,top:0}}},re=t.forwardRef(({align:r,["aria-label"]:l=null,ariaLabel:O,children:d,className:w,direction:c=Y,flipped:s=!1,focusTrap:T=!0,iconClass:P,iconDescription:b="Options",id:M,light:f,menuOffset:E=ge,menuOffsetFlip:a=ge,menuOptionsClass:F,onClick:p=oe,onClose:y=oe,onOpen:u=oe,open:m,renderIcon:v=ye,selectorPrimaryFocus:D="[data-floating-menu-primary-focus]",size:k="md",innerRef:q,...V},B)=>{const h=t.useContext(Ee),[i,I]=t.useState(m??!1),[n,C]=t.useState(!1),[R,$]=t.useState(!1),_=t.useRef(null),j=t.useRef(mt()),N=t.useRef(null),X=t.useRef({}),le=t.useRef(m),ee=t.useRef(i),A=t.useRef(null),ae=t.useRef(null);t.useEffect(()=>{le.current!==m&&(I(!!m),le.current=m)},[m]),t.useEffect(()=>{A.current&&$(!0)},[]),t.useEffect(()=>{i&&!ee.current?u():!i&&ee.current&&y(),ee.current=i},[i,y,u]),lt(ae,({target:o})=>{i&&(!N.current||o instanceof Node&&!N.current.contains(o))&&z()});const G=t.useCallback(()=>{A.current&&A.current.focus()},[]),z=t.useCallback(o=>{I(!1),o&&o()},[]),ce=t.useCallback(()=>{const o=n,x=i;z(()=>{x&&!o&&G()})},[n,i,z,G]),Oe=t.useCallback(()=>{const o=i;z(()=>{o&&G()})},[i,z,G]),Te=o=>{C(!0),(!N.current||!N.current.contains(o.target))&&(I(x=>!x),p(o))},Me=o=>{i&&ue(o,[Ge,Ue,Je,Qe])&&o.preventDefault(),ue(o,[Ze])&&(Oe(),o.stopPropagation())},xe=({currentIndex:o=0,direction:x})=>{const S=t.Children.toArray(d).reduce((L,ie,De)=>(g.isValidElement(ie)&&!ie.props.disabled&&L.push(De),L),[]),K=(()=>{const L=S.indexOf(o)+x;switch(L){case-1:return S.length-1;case S.length:return 0;default:return L}})();X.current[S[K]]?.focus()},Ie=o=>{o||(N.current=o),!o&&_.current&&(_.current=_.current.release())},$e=o=>{if(!o)return;N.current=o;const x="onfocusin"in window,S=x?"focusin":"focus";_.current=gt(o.ownerDocument,S,K=>{const U=K.target,L=A.current;typeof U.matches=="function"&&!o.contains(U)&&L&&!U.matches(`.${h}--overflow-menu:first-child, .${h}--overflow-menu-options:first-child`)&&ce()},!x)},Ne=()=>{const o=A.current;return o instanceof Element&&o.closest("[data-floating-menu-container]")||document.body},te=`overflow-menu-${j.current}__menu-body`,Fe=W(w,`${h}--overflow-menu`,{[`${h}--overflow-menu--open`]:i,[`${h}--overflow-menu--light`]:f,[`${h}--overflow-menu--${k}`]:k}),ke=W(F,`${h}--overflow-menu-options`,{[`${h}--overflow-menu--flip`]:s,[`${h}--overflow-menu-options--open`]:i,[`${h}--overflow-menu-options--light`]:f,[`${h}--overflow-menu-options--${k}`]:k}),Se=W(`${h}--overflow-menu__icon`,P),Pe=t.Children.toArray(d).map((o,x)=>{if(t.isValidElement(o)){const S=o;return t.cloneElement(S,{closeMenu:S.props.closeMenu||ce,handleOverflowMenuItemFocus:xe,ref:K=>{X.current[x]=K},index:x})}return null}),_e=g.createElement("ul",{className:ke,tabIndex:-1,role:"menu","aria-label":l||O,onKeyDown:Me,id:te},Pe),Ae=g.createElement(pt,{focusTrap:T,triggerRef:A,menuDirection:c,menuOffset:s?a:E,menuRef:Ie,flipped:s,target:Ne,onPlace:$e,selectorPrimaryFocus:D},t.cloneElement(_e,{"data-floating-menu-direction":c})),Le=q?ne(A,q,B):ne(A,B);return g.createElement(g.Fragment,null,g.createElement("span",{className:`${h}--overflow-menu__wrapper`,"aria-owns":i?te:void 0,ref:ae},g.createElement(he,Z({},V,{align:r,type:"button","aria-haspopup":!0,"aria-expanded":i,"aria-controls":i?te:void 0,className:Fe,onClick:Te,id:M,ref:Le,size:k,label:b,kind:"ghost"}),g.createElement(v,{className:Se,"aria-label":b})),i&&R&&Ae))});re.propTypes={align:we(e.oneOf(["top","top-left","top-right","bottom","bottom-left","bottom-right","left","left-bottom","left-top","right","right-bottom","right-top","top-start","top-end","bottom-start","bottom-end","left-end","left-start","right-end","right-start"]),["top","top-start","top-end","bottom","bottom-start","bottom-end","left","left-start","left-end","right","right-start","right-end"],ve),"aria-label":e.string,ariaLabel:de(e.string),children:e.node,className:e.string,direction:e.oneOf([se,Y]),flipped:e.bool,focusTrap:e.bool,iconClass:e.string,iconDescription:e.string,id:e.string,light:de(e.bool),menuOffset:e.oneOfType([e.shape({top:e.number.isRequired,left:e.number.isRequired}),e.func]),menuOffsetFlip:e.oneOfType([e.shape({top:e.number.isRequired,left:e.number.isRequired}),e.func]),menuOptionsClass:e.string,onClick:e.func,onClose:e.func,onFocus:e.func,onKeyDown:e.func,onOpen:e.func,open:e.bool,renderIcon:e.oneOfType([e.func,e.object]),selectorPrimaryFocus:e.string,size:e.oneOf(["xs","sm","md","lg"])};const Re=t.forwardRef((r,l)=>be("enable-v12-overflowmenu")?g.createElement(Ce,Z({},r,{ref:l})):g.createElement(re,Z({},r,{ref:l})));Re.displayName="OverflowMenu";Re.propTypes=re.propTypes;export{Re as O};
//# sourceMappingURL=index-BgW1FdY9.js.map
