import{e as g,d as be,f as Ve,h as He,i as We,g as je,u as ze,r as o,c as H,_ as Q,I as we,P as t,y as ve,z as Ee,eL as ye,eQ as U,eG as Re,K as Ke,eR as Xe,o as Ye,ac as Ge,eS as Ue,t as te,J as ue,aa as Je,a6 as Qe,a9 as Ze,ar as et,w as tt,l as de}from"./iframe-YKw9nL_F.js";import{b as ot,a as nt}from"./useAttachedMenu-Di7wXaNY.js";import{m as ne}from"./mergeRefs-91-mP8KM.js";import{aM as Ce}from"./bucket-12-DXgkfsZm.js";import{s as st,b as rt,w as at,a as it}from"./wrapFocus-DNecG-Dg.js";import{u as lt}from"./useOutsideClick-BuwC9cvu.js";const pe="md",Oe=g.forwardRef(function({autoAlign:s=!1,children:w,className:d,label:p="Options",renderIcon:c=Ce,size:r=pe,menuAlignment:v="bottom-start",tooltipAlignment:N,menuTarget:l,...M},h){const E=be("enable-v12-dynamic-floating-styles")||s,{refs:a,floatingStyles:I,placement:m,middlewareData:y}=Ve(E?{placement:v,strategy:"fixed",middleware:[s&&We({fallbackPlacements:v.includes("bottom")?["bottom-start","bottom-end","top-start","top-end"]:["top-start","top-end","bottom-start","bottom-end"]})],whileElementsMounted:He}:{}),R=je("overflowmenu"),f=ze(),O=o.useRef(null),{open:x,x:F,y:B,handleClick:W,handleMousedown:q,handleClose:u}=ot(O);o.useEffect(()=>{E&&Object.keys(I).forEach(S=>{a.floating.current&&(a.floating.current.style[S]=I[S])})},[I,E,a.floating,x,m,y]);function e(){O.current&&W()}const b=H(d,`${f}--overflow-menu__container`,{[`${f}--autoalign`]:E}),C=H(`${f}--overflow-menu__${v}`),T=H(`${f}--overflow-menu`,{[`${f}--overflow-menu--open`]:x},r!==pe&&`${f}--overflow-menu--${r}`),L=ne(O,a.setReference);return g.createElement("div",Q({},M,{className:b,"aria-owns":x?R:void 0,ref:h}),g.createElement(we,{"aria-controls":x?R:void 0,"aria-haspopup":!0,"aria-expanded":x,className:T,onClick:e,onMouseDown:q,ref:L,label:p,align:N,kind:"ghost"},g.createElement(c,{className:`${f}--overflow-menu__icon`})),g.createElement(nt,{containerRef:O,ref:a.setFloating,menuAlignment:v,className:C,id:R,size:r,legacyAutoalign:!E,open:x,onClose:u,x:F,y:B,label:p,target:l},w))});Oe.propTypes={autoAlign:t.bool,children:t.node,className:t.string,label:t.string,menuAlignment:t.oneOf(["top-start","top-end","bottom-start","bottom-end"]),renderIcon:t.oneOfType([t.func,t.object]),size:t.oneOf(["sm","md","lg"]),tooltipAlignment:ve(t.oneOf(["top","top-left","top-right","bottom","bottom-left","bottom-right","left","left-bottom","left-top","right","right-bottom","right-top","top-start","top-end","bottom-start","bottom-end","left-end","left-start","right-end","right-start"]),["top","top-start","top-end","bottom","bottom-start","bottom-end","left","left-start","left-end","right","right-start","right-end"],Ee),menuTarget:t.instanceOf(typeof Element<"u"?Element:Object)};var oe,me;function ct(){if(me)return oe;me=1;var i=function(s,w,d,p,c,r,v,N){if(!s){var l;if(w===void 0)l=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var M=[d,p,c,r,v,N],h=0;l=new Error(w.replace(/%s/g,function(){return M[h++]})),l.name="Invariant Violation"}throw l.framesToPop=1,l}};return oe=i,oe}var ft=ct();const It=ye(ft);var J,ge;function ut(){return ge||(ge=1,J=typeof self=="object"&&self.self===self&&self||typeof U=="object"&&U.global===U&&U||J),J}var dt=ut();const V=ye(dt),pt=(()=>{const i=[];let s=!1;const w=()=>{i.forEach(c=>{c()}),s=!1},d=()=>{s||(s=!0,V.requestAnimationFrame(w))},p=c=>{i.indexOf(c)<0&&i.push(c)};return{add:c=>(i.length||V.addEventListener("resize",d),p(c),{remove:()=>{const r=i.indexOf(c);r>=0&&i.splice(r,1)}})}})(),mt="left",se="top",gt="right",K="bottom",ht=({menuSize:i,refPosition:s,offset:w,direction:d,scrollX:p,scrollY:c,container:r})=>{const{left:v=0,top:N=0,right:l=0,bottom:M=0}=s,h=r.position!=="static"?0:p,E=r.position!=="static"?0:c,a={top:r.position!=="static"?r.rect.top:0,left:r.position!=="static"?r.rect.left:0},{width:I,height:m}=i,{top:y=0,left:R=0}=w,f=(v+l)/2,O=(N+M)/2;return{[mt]:()=>({left:v-I+h-R-a.left,top:O-m/2+E+y-9-a.top}),[se]:()=>({left:f-I/2+h+R-a.left,top:N-m+E-y-a.top}),[gt]:()=>({left:l+h+R-a.left,top:O-m/2+E+y+3-a.top}),[K]:()=>({left:f-I/2+h+R-a.left,top:M+E+y-a.top})}[d]()},bt=({children:i,flipped:s,focusTrap:w,menuDirection:d=K,menuOffset:p={top:0,left:0},menuRef:c,onPlace:r,selectorPrimaryFocus:v,styles:N,target:l=()=>document.body,triggerRef:M,updateOrientation:h})=>{const E=o.useContext(Re),[a,I]=o.useState(void 0),m=o.useRef(null),y=o.useRef(null),R=o.useRef(null),f=o.useRef(!1),O=o.useCallback(e=>{const b=m.current;if(!b)return;const C=M.current,T=b.getBoundingClientRect(),L=C?C.getBoundingClientRect():void 0,S=typeof p=="function"?p(b,d,C,s):p;if(h&&h({menuSize:T,refPosition:L,direction:d,offset:S,scrollX:V.pageXOffset,scrollY:V.pageYOffset,container:{rect:l().getBoundingClientRect(),position:getComputedStyle(l()).position}}),T.width>0&&T.height>0||!S){const P=ht({menuSize:T,refPosition:L??{left:0,top:0,right:0,bottom:0},offset:S,direction:d,scrollX:V.pageXOffset,scrollY:V.pageYOffset,container:{rect:l().getBoundingClientRect(),position:getComputedStyle(l()).position}});if((!a||a.left!==P.left||a.top!==P.top)&&I(P),!e){const X=b.getBoundingClientRect();(X.width!==T.width||X.height!==T.height)&&O(!0)}}},[M,p,d,s,l,h,a]),x=e=>{const b=v?e.querySelector(v):null,C=e.querySelector(st),T=e.querySelector(rt);(b||C||T||e).focus()},F=e=>{m.current=e,f.current=!!e,c&&c(e),e&&O()};o.useEffect(()=>{f.current&&a&&m.current&&(m.current.contains(document.activeElement)||x(m.current),typeof r=="function"&&r(m.current),f.current=!1)},[a,r]),o.useEffect(()=>{const e=pt.add(()=>{O()});return()=>{e.remove()}},[M,p,d,s,l,h]),o.useEffect(()=>{O()},[p,d,s,M,l,h]);const B=()=>{const e=a,b=e?{left:`${e.left}px`,top:`${e.top}px`,right:"auto"}:{visibility:"hidden",top:"0px"},C=i;return o.cloneElement(C,{ref:F,style:{...N,...b,position:"absolute",opacity:1}})},W=e=>{const{target:b,relatedTarget:C}=e;m.current&&y.current&&R.current&&b instanceof HTMLElement&&C instanceof HTMLElement&&it({bodyNode:m.current,startTrapNode:y.current,endTrapNode:R.current,currentActiveNode:C,oldActiveNode:b})},q=e=>{Ye(e,Ge)&&m.current&&e.target instanceof HTMLElement&&at({containerNode:m.current,currentActiveNode:e.target,event:e})},u=Ke("enable-experimental-focus-wrap-without-sentinels");if(typeof document<"u"){const e=l?l():document.body;return Xe.createPortal(g.createElement("div",{onBlur:w&&!u?W:void 0,onKeyDown:u?q:void 0},!u&&g.createElement("span",{ref:y,tabIndex:0,role:"link",className:`${E}--visually-hidden`},"Focus sentinel"),B(),!u&&g.createElement("span",{ref:R,tabIndex:0,role:"link",className:`${E}--visually-hidden`},"Focus sentinel")),e)}return null},wt=Ue(),vt=(i,...s)=>(i.addEventListener(...s),{release(){return i.removeEventListener(...s),null}}),Et={[se]:"bottom",[K]:"top"},he=(i,s,w,d)=>{const p=Et[s],{offsetWidth:c,offsetHeight:r}=i;switch(p){case"top":case"bottom":{const v=w?w.offsetWidth:0;return{left:(d?-1:1)*(c/2-v/2),top:0}}default:return{left:0,top:0}}},re=o.forwardRef(({align:i,["aria-label"]:s=null,ariaLabel:w,children:d,className:p,direction:c=K,flipped:r=!1,focusTrap:v=!0,iconClass:N,iconDescription:l="Options",id:M,light:h,menuOffset:E=he,menuOffsetFlip:a=he,menuOptionsClass:I,onClick:m=te,onClose:y=te,onOpen:R=te,open:f,renderIcon:O=Ce,selectorPrimaryFocus:x="[data-floating-menu-primary-focus]",size:F="md",innerRef:B,...W},q)=>{const u=o.useContext(Re),[e,b]=o.useState(f??!1),[C,T]=o.useState(!1),[L,S]=o.useState(!1),P=o.useRef(null),X=o.useRef(wt()),D=o.useRef(null),ae=o.useRef({}),ie=o.useRef(f),Z=o.useRef(e),_=o.useRef(null),le=o.useRef(null);o.useEffect(()=>{ie.current!==f&&(b(!!f),ie.current=f)},[f]),o.useEffect(()=>{_.current&&S(!0)},[]),o.useEffect(()=>{e&&!Z.current?R():!e&&Z.current&&y(),Z.current=e},[e,y,R]),lt(le,({target:n})=>{e&&(!D.current||n instanceof Node&&!D.current.contains(n))&&j()});const Y=o.useCallback(()=>{_.current&&_.current.focus()},[]),j=o.useCallback(n=>{b(!1),n&&n(),y()},[y]),ce=o.useCallback(()=>{const n=C,$=e;j(()=>{$&&!n&&Y()})},[C,e,j,Y]),Te=o.useCallback(()=>{const n=e;j(()=>{n&&Y()})},[e,j,Y]),Ie=n=>{T(!0),(!D.current||!D.current.contains(n.target))&&(b($=>!$),m(n))},xe=n=>{e&&ue(n,[Je,Qe,Ze,et])&&n.preventDefault(),ue(n,[tt])&&(Te(),n.stopPropagation())},$e=({currentIndex:n=0,direction:$})=>{const k=o.Children.toArray(d).reduce((A,fe,De)=>(g.isValidElement(fe)&&!fe.props.disabled&&A.push(De),A),[]),z=(()=>{const A=k.indexOf(n)+$;switch(A){case-1:return k.length-1;case k.length:return 0;default:return A}})();ae.current[k[z]]?.focus()},Ne=n=>{n||(D.current=n),!n&&P.current&&(P.current=P.current.release())},Fe=n=>{if(!n)return;D.current=n;const $="onfocusin"in window,k=$?"focusin":"focus";P.current=vt(n.ownerDocument,k,z=>{const G=z.target,A=_.current;typeof G.matches=="function"&&!n.contains(G)&&A&&!G.matches(`.${u}--overflow-menu:first-child, .${u}--overflow-menu-options:first-child`)&&ce()},!$)},ke=()=>{const n=_.current;return n instanceof Element&&n.closest("[data-floating-menu-container]")||document.body},ee=`overflow-menu-${X.current}__menu-body`,Se=H(p,`${u}--overflow-menu`,{[`${u}--overflow-menu--open`]:e,[`${u}--overflow-menu--light`]:h,[`${u}--overflow-menu--${F}`]:F}),Pe=H(I,`${u}--overflow-menu-options`,{[`${u}--overflow-menu--flip`]:r,[`${u}--overflow-menu-options--open`]:e,[`${u}--overflow-menu-options--light`]:h,[`${u}--overflow-menu-options--${F}`]:F}),_e=H(`${u}--overflow-menu__icon`,N),Le=o.Children.toArray(d).map((n,$)=>{if(o.isValidElement(n)){const k=n;return o.cloneElement(k,{closeMenu:k.props.closeMenu||ce,handleOverflowMenuItemFocus:$e,ref:z=>{ae.current[$]=z},index:$})}return null}),Ae=g.createElement("ul",{className:Pe,tabIndex:-1,role:"menu","aria-label":s||w,onKeyDown:xe,id:ee},Le),Be=g.createElement(bt,{focusTrap:v,triggerRef:_,menuDirection:c,menuOffset:r?a:E,menuRef:Ne,flipped:r,target:ke,onPlace:Fe,selectorPrimaryFocus:x},o.cloneElement(Ae,{"data-floating-menu-direction":c})),qe=B?ne(_,B,q):ne(_,q);return g.createElement(g.Fragment,null,g.createElement("span",{className:`${u}--overflow-menu__wrapper`,"aria-owns":e?ee:void 0,ref:le},g.createElement(we,Q({},W,{align:i,type:"button","aria-haspopup":!0,"aria-expanded":e,"aria-controls":e?ee:void 0,className:Se,onClick:Ie,id:M,ref:qe,size:F,label:l,kind:"ghost"}),g.createElement(O,{className:_e,"aria-label":l})),e&&L&&Be))});re.propTypes={align:ve(t.oneOf(["top","top-left","top-right","bottom","bottom-left","bottom-right","left","left-bottom","left-top","right","right-bottom","right-top","top-start","top-end","bottom-start","bottom-end","left-end","left-start","right-end","right-start"]),["top","top-start","top-end","bottom","bottom-start","bottom-end","left","left-start","left-end","right","right-start","right-end"],Ee),"aria-label":t.string,ariaLabel:de(t.string),children:t.node,className:t.string,direction:t.oneOf([se,K]),flipped:t.bool,focusTrap:t.bool,iconClass:t.string,iconDescription:t.string,id:t.string,light:de(t.bool),menuOffset:t.oneOfType([t.shape({top:t.number.isRequired,left:t.number.isRequired}),t.func]),menuOffsetFlip:t.oneOfType([t.shape({top:t.number.isRequired,left:t.number.isRequired}),t.func]),menuOptionsClass:t.string,onClick:t.func,onClose:t.func,onFocus:t.func,onKeyDown:t.func,onOpen:t.func,open:t.bool,renderIcon:t.oneOfType([t.func,t.object]),selectorPrimaryFocus:t.string,size:t.oneOf(["sm","md","lg"])};const Me=o.forwardRef((i,s)=>be("enable-v12-overflowmenu")?g.createElement(Oe,Q({},i,{ref:s})):g.createElement(re,Q({},i,{ref:s})));Me.displayName="OverflowMenu";Me.propTypes=re.propTypes;export{Me as O,It as i};
