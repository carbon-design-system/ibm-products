import{e as r,r as g}from"./index-DtHxqM--.js";import"./feature-flags-CgeLICHA.js";import{d as F,P as e,Q as P,bb as re}from"./index-CMVdkQrl.js";import{C as ee}from"./Checkbox-CVg4b6-b.js";import{p as w,B as ne}from"./settings-C3kz8lqM.js";import{u as ie}from"./useId-DyRoBmqU.js";import{u as ae,C as oe,a as Y,P as le,K as ce,b as de,D as ue,r as me,e as pe,c as ge,S as fe,v as be}from"./modifiers.esm-DDFNLOS6.js";import{aZ as ye}from"./bucket-5-BJPJ9WD6.js";import{aB as Ce}from"./bucket-10-BzYiIxX7.js";import{g as O}from"./getNodeTextContent-C8IeKkUQ.js";import{u as he}from"./uuidv4-BN2rGLQG.js";import{S as Te}from"./Search-QqBUyI3s.js";import{T as qe}from"./TearsheetNarrow-Ci2_CCyA.js";import{k as _e}from"./useDatagrid-BDEhjUIV.js";import{r as xe}from"./index.esm-DzetqPWz.js";const K=s=>typeof s.isVisible=="boolean"?s.isVisible:!0,I=`${w.prefix}--datagrid`,U=({id:s,elementId:n,children:o,classList:d,disabled:u,ariaLabel:m,isSticky:h,selected:y})=>{const{attributes:T,isDragging:S,listeners:a,setNodeRef:E,transform:R,transition:k}=ae({disabled:u,id:s}),z=r.createElement(r.Fragment,null,r.createElement("div",{className:F({disabled:u},`${I}__draggable-handleStyle`)},h?r.createElement(Ce,{size:16}):r.createElement(ye,{size:16})),o),_={transform:u?void 0:oe.Transform.toString(R),transition:k};return r.createElement("li",{className:F(d,`${I}__draggable-handleHolder`,{[`${I}__draggable-handleHolder--selected`]:y,[`${I}__draggable-handleHolder--sticky`]:h,[`${I}__draggable-handleHolder--dragging`]:S}),id:n||s,ref:E,style:_,...T,...a,"aria-disabled":void 0,"aria-selected":y,role:"option"},r.createElement("span",{className:`${I}__shared-ui--assistive-text`},m),r.createElement("div",{className:F({[`${I}__draggable-handleStyle`]:!u},[`${I}__draggable-handleHolder-droppable`])},z))};U.propTypes={ariaLabel:e.string.isRequired,children:e.element.isRequired,classList:e.string,disabled:e.bool,elementId:e.string,id:e.string.isRequired,isSticky:e.bool,selected:e.bool};U.__docgenInfo={description:"",methods:[],displayName:"DraggableElement",props:{ariaLabel:{required:!0,tsType:{name:"string"},description:"",type:{name:"string"}},children:{required:!0,tsType:{name:"ReactNode"},description:"",type:{name:"element"}},classList:{required:!1,tsType:{name:"string"},description:"",type:{name:"string"}},disabled:{required:!1,tsType:{name:"boolean"},description:"",type:{name:"bool"}},id:{required:!0,tsType:{name:"string"},description:"",type:{name:"string"}},elementId:{required:!1,tsType:{name:"string"},description:"",type:{name:"string"}},isSticky:{required:!1,tsType:{name:"boolean"},description:"",type:{name:"bool"}},selected:{required:!1,tsType:{name:"boolean"},description:"",type:{name:"bool"}}},composes:["PropsWithChildren"]};const V=`${w.prefix}--datagrid`,N=(s,n)=>s&&n&&s.id===n.id,M=({columns:s,filterString:n,id:o,moveElement:d,onSelectColumn:u,setAriaRegionText:m})=>{const h=`${V}__draggable-item`,y=ie(),T=s.filter(t=>O(t.Header).trim().length!==0).filter(Boolean).filter(t=>!t.isAction).filter(t=>t.id!=="spacer").filter(t=>n.length===0||O(t.Header).toLowerCase().includes(n)),a=(()=>{const t=[...T];return t.forEach(l=>{l.sticky&&(l.disabled=!0)}),t})(),E=t=>{var j;const{active:l,over:i}=t,c=a.filter(f=>f.id===i.id);if(c!=null&&c.length&&((j=c[0])!=null&&j.disabled))return;const C=a.findIndex(f=>N(f,l)),$=a.findIndex(f=>N(f,i)),x=O(a[C].Header);m(`${x} dropped. New position ${$+1} of ${a.length}.`);const v=s.findIndex(f=>N(f,l)),B=s.findIndex(f=>N(f,i));d(v,B)},R=t=>{const{active:l}=t,i=a.findIndex(C=>N(C,l)),c=O(a[i].Header);m(`${c} grabbed. Current position ${i+1} of ${a.length}.`)},k=t=>{const{active:l,over:i}=t,c=a.findIndex(x=>N(x,l)),C=a.findIndex(x=>N(x,i)),$=O(a[c].Header);m(`${$} grabbed. Original position ${c+1}, new position ${C+1} of ${a.length}.`)},z=Y(le,{activationConstraint:{distance:4}}),_=Y(ce,{coordinateGetter:(t,l)=>{const{currentCoordinates:i}=l;let c=t.target;for(;c&&!c.classList.contains(h);)c=c.parentNode;const C=c.offsetHeight;switch(t.code){case"ArrowRight":case"ArrowLeft":return i;case"ArrowUp":return{...i,y:i.y-C};case"ArrowDown":return{...i,y:i.y+C}}}}),H=de(z,_),A=(t,l)=>{if(t.code==="Space")return u(l,!K(l)),t.preventDefault(),t.stopPropagation(),!1};return r.createElement(ue,{collisionDetection:ge,onDragEnd:E,onDragStart:R,onDragMove:k,sensors:H,modifiers:[me,pe]},r.createElement(r.Fragment,null,r.createElement("div",{className:`${V}__draggable-underlay`,"aria-hidden":"true",key:`draggable-underlay-${o}`},T.map(t=>r.createElement("div",{className:`${V}__draggable-underlay-item`,key:t.id}))),r.createElement(fe,{items:a,strategy:be},T.map(t=>{const l=O(t.Header),c=l.split(new RegExp(`(${n})`,"gi")).map(v=>v.toLowerCase()===n.toLowerCase()?`<strong>${v}</strong>`:v).join(""),C=!!t.sticky,$=t.disabled,x=r.createElement(r.Fragment,null,r.createElement(ee,{checked:K(t),disabled:$||C,onChange:(v,{checked:B})=>u(t,B),id:`${V}__customization-column-${t.id}`,labelText:l,title:l,className:`${V}__customize-columns-checkbox`,hideLabel:!0,onKeyDown:v=>A(v,t)}),r.createElement("div",{dangerouslySetInnerHTML:{__html:c},className:`${V}__customize-columns-checkbox-visible-label`}));return r.createElement(U,{classList:h,key:t.id,id:t.id,elementId:`${t.id}-${y}`,disabled:n.length>0||C,ariaLabel:l,isSticky:C,selected:K(t)},x)}))))};M.propTypes={columns:P.PropTypes.array.isRequired,filterString:P.PropTypes.string.isRequired,id:P.PropTypes.string.isRequired,moveElement:P.PropTypes.func.isRequired,onSelectColumn:P.PropTypes.func.isRequired,setAriaRegionText:P.PropTypes.func.isRequired};M.__docgenInfo={description:"",methods:[],displayName:"DraggableItemsList",props:{columns:{description:"",type:{name:"array"},required:!0},filterString:{description:"",type:{name:"string"},required:!0},id:{description:"",type:{name:"string"},required:!0},moveElement:{description:"",type:{name:"func"},required:!0},onSelectColumn:{description:"",type:{name:"func"},required:!0},setAriaRegionText:{description:"",type:{name:"func"},required:!0}}};const q=`${w.prefix}--datagrid`,G=({getVisibleColumnsCount:s,filterString:n,columns:o,setColumnsObject:d,onSelectColumn:u,assistiveTextInstructionsLabel:m,assistiveTextDisabledInstructionsLabel:h,selectAllLabel:y,customizeTearsheetHeadingLabel:T})=>{const S=g.useRef(he()),a=g.useRef(null),[E,R]=r.useState(""),k=r.useCallback((_,H)=>{d(A=>{const t=[...A],l=t[_];return t.splice(_,1),t.splice(H,0,l),t})},[d]),z=o==null?void 0:o.filter(_=>!_.sticky);return r.createElement("div",{className:`${q}__customize-columns-column-list`,ref:a},r.createElement("ol",{className:`${q}__customize-columns-column-list--focus`,role:"listbox","aria-label":T,"aria-describedby":`${q}__customize-columns--instructions`,tabIndex:0},r.createElement("span",{"aria-live":"assertive",className:`${q}__shared-ui--assistive-text`},E),r.createElement("span",{id:`${q}__customize-columns--instructions`,className:`${q}__shared-ui--assistive-text`},n.length===0?m:h),r.createElement("div",{id:`${q}__customize-columns-select-all`,className:F(`${q}__customize-columns-select-all`,{[`${q}__customize-columns-select-all--selected`]:s()>0}),selected:s()>0},r.createElement(ee,{className:`${q}__customize-columns-checkbox-wrapper`,checked:s()===o.length,indeterminate:s()<o.length&&s()>0,onChange:()=>{u(z,s()!==o.length)},id:`${q}__customization-column-select-all`,labelText:y})),r.createElement(M,{id:S.current,columns:o,filterString:n,moveElement:k,setAriaRegionText:R,onSelectColumn:u})))};G.propTypes={assistiveTextDisabledInstructionsLabel:e.string,assistiveTextInstructionsLabel:e.string,columns:e.array.isRequired,customizeTearsheetHeadingLabel:e.string,disabledInstructionsLabel:e.string,filterString:e.string.isRequired,getVisibleColumnsCount:e.func.isRequired,instructionsLabel:e.string,onSelectColumn:e.func.isRequired,selectAllLabel:e.string,setColumnStatus:e.func,setColumnsObject:e.func.isRequired};G.__docgenInfo={description:"",methods:[],displayName:"Columns",props:{assistiveTextDisabledInstructionsLabel:{description:"",type:{name:"string"},required:!1},assistiveTextInstructionsLabel:{description:"",type:{name:"string"},required:!1},columns:{description:"",type:{name:"array"},required:!0},customizeTearsheetHeadingLabel:{description:"",type:{name:"string"},required:!1},disabledInstructionsLabel:{description:"",type:{name:"string"},required:!1},filterString:{description:"",type:{name:"string"},required:!0},getVisibleColumnsCount:{description:"",type:{name:"func"},required:!0},instructionsLabel:{description:"",type:{name:"string"},required:!1},onSelectColumn:{description:"",type:{name:"func"},required:!0},selectAllLabel:{description:"",type:{name:"string"},required:!1},setColumnStatus:{description:"",type:{name:"func"},required:!1},setColumnsObject:{description:"",type:{name:"func"},required:!0}}};const ve=`${w.prefix}--datagrid`,Q=({searchText:s,setSearchText:n,findColumnPlaceholderLabel:o})=>g.createElement("div",{className:`${ve}__customize-columns-tearsheet--actions`},g.createElement(Te,{placeholder:o,value:s,size:"lg",labelText:o,onChange:d=>{n(d.target.value)}}));Q.propTypes={columns:e.array.isRequired,findColumnPlaceholderLabel:e.string,originalColumnDefinitions:e.array.isRequired,resetToDefaultLabel:e.string,searchText:e.string.isRequired,setColumnsObject:e.func.isRequired,setSearchText:e.func.isRequired};Q.__docgenInfo={description:"",methods:[],displayName:"Actions",props:{columns:{description:"",type:{name:"array"},required:!0},findColumnPlaceholderLabel:{description:"",type:{name:"string"},required:!1},originalColumnDefinitions:{description:"",type:{name:"array"},required:!0},resetToDefaultLabel:{description:"",type:{name:"string"},required:!1},searchText:{description:"",type:{name:"string"},required:!0},setColumnsObject:{description:"",type:{name:"func"},required:!0},setSearchText:{description:"",type:{name:"func"},required:!0}}};const $e=`${w.prefix}--datagrid`,Z=({isOpen:s,setIsTearsheetOpen:n,onSaveColumnPrefs:o,columnDefinitions:d,originalColumnDefinitions:u,customizeTearsheetHeadingLabel:m="Customize columns",primaryButtonTextLabel:h="Save",secondaryButtonTextLabel:y="Cancel",instructionsLabel:T="Select columns to display them. Click and drag the box to reorder the columns. These specifications will be saved and persist if you leave and return to the data table.",findColumnPlaceholderLabel:S="Find column",resetToDefaultLabel:a="Reset to default",assistiveTextInstructionsLabel:E="Press space bar to toggle drag drop mode, use arrow keys to move selected elements.",assistiveTextDisabledInstructionsLabel:R="Reordering columns are disabled because they are filtered currently.",selectAllLabel:k="Column name"})=>{const[z,_]=g.useState(""),[H,A]=g.useState(""),[t,l]=g.useState(""),[i,c]=g.useState(d),[C,$]=g.useState(!1),x=g.useRef(void 0),v=()=>{c(d),n(!1)},B=()=>{n(!1);const b=i.map(L=>({id:L.id,isVisible:L.isVisible}));o(b)},j=(b,L)=>{const D=i.map(p=>Array.isArray(b)?b.includes(p)&&p.canFilter&&!p.disabled?{...p,isVisible:L}:p:b.id===p.id?{...p,isVisible:L}:p),X=D.filter(p=>p.isVisible&&!["datagridSelection","actions"].includes(p.id)).length,se=D.map(p=>X>0?["datagridSelection","actions"].includes(p.id)?{...p,isVisible:!0}:p:["datagridSelection","actions"].includes(p.id)?{...p,isVisible:!1}:p);c(se),$(X!==0)},f=g.useCallback(()=>i.filter(b=>b.isVisible).length,[i]),te=t.trim().toLowerCase();return g.useEffect(()=>{x.current!==d&&c(d);const b=i.filter(D=>D.id==="actions").length,L=i.filter(D=>D.id==="datagridSelection").length;_(f()-b-L<0?0:f()-b-L),A(i.length-b-L),x.current=d},[f,i,d]),r.createElement(qe,{className:`${$e}__customize-columns-tearsheet`,open:s,title:`${m} (${z}/${H})`,description:T,actions:[{kind:"secondary",label:y,onClick:v},{kind:"primary",label:h,onClick:B,disabled:!C}]},r.createElement(Q,{columns:i,originalColumnDefinitions:u,searchText:t,setColumnsObject:b=>{c(b),$(!0)},setSearchText:l,findColumnPlaceholderLabel:S,resetToDefaultLabel:a}),s&&r.createElement(G,{assistiveTextInstructionsLabel:E,assistiveTextDisabledInstructionsLabel:R,getVisibleColumnsCount:f,columns:i,filterString:te,onSelectColumn:j,setColumnsObject:b=>{c(b),$(f()!==0)},selectAllLabel:k,customizeTearsheetHeadingLabel:m}))};Z.propTypes={assistiveTextDisabledInstructionsLabel:e.string,assistiveTextInstructionsLabel:e.string,columnDefinitions:e.array.isRequired,customizeTearsheetHeadingLabel:e.string,findColumnPlaceholderLabel:e.string,instructionsLabel:e.string,isOpen:e.bool.isRequired,onSaveColumnPrefs:e.func.isRequired,originalColumnDefinitions:e.array.isRequired,primaryButtonTextLabel:e.string,resetToDefaultLabel:e.string,secondaryButtonTextLabel:e.string,selectAllLabel:e.string,setIsTearsheetOpen:e.func.isRequired};Z.__docgenInfo={description:"",methods:[],displayName:"CustomizeColumnsTearsheet",props:{customizeTearsheetHeadingLabel:{defaultValue:{value:"'Customize columns'",computed:!1},description:"",type:{name:"string"},required:!1},primaryButtonTextLabel:{defaultValue:{value:"'Save'",computed:!1},description:"",type:{name:"string"},required:!1},secondaryButtonTextLabel:{defaultValue:{value:"'Cancel'",computed:!1},description:"",type:{name:"string"},required:!1},instructionsLabel:{defaultValue:{value:"'Select columns to display them. Click and drag the box to reorder the columns. These specifications will be saved and persist if you leave and return to the data table.'",computed:!1},description:"",type:{name:"string"},required:!1},findColumnPlaceholderLabel:{defaultValue:{value:"'Find column'",computed:!1},description:"",type:{name:"string"},required:!1},resetToDefaultLabel:{defaultValue:{value:"'Reset to default'",computed:!1},description:"",type:{name:"string"},required:!1},assistiveTextInstructionsLabel:{defaultValue:{value:"'Press space bar to toggle drag drop mode, use arrow keys to move selected elements.'",computed:!1},description:"",type:{name:"string"},required:!1},assistiveTextDisabledInstructionsLabel:{defaultValue:{value:"'Reordering columns are disabled because they are filtered currently.'",computed:!1},description:"",type:{name:"string"},required:!1},selectAllLabel:{defaultValue:{value:"'Column name'",computed:!1},description:"",type:{name:"string"},required:!1},columnDefinitions:{description:"",type:{name:"array"},required:!0},isOpen:{description:"",type:{name:"bool"},required:!0},onSaveColumnPrefs:{description:"",type:{name:"func"},required:!0},originalColumnDefinitions:{description:"",type:{name:"array"},required:!0},setIsTearsheetOpen:{description:"",type:{name:"func"},required:!0}}};const J=({instance:s})=>{const{onSaveColumnPrefs:n,isTearsheetOpen:o,setIsTearsheetOpen:d,labels:u,...m}=s.customizeColumnsProps,{state:h}=g.useContext(_e),{featureFlags:y}=h||{};return g.useEffect(()=>{y&&!(y!=null&&y["enable-datagrid-useCustomizeColumns"])&&console.error("Datagrid useCustomizeColumns extension has not been enabled via feature flag.")},[y]),r.createElement(Z,{...m,...u,isOpen:o,setIsTearsheetOpen:d,columnDefinitions:s.allColumns,originalColumnDefinitions:s.columns,onSaveColumnPrefs:T=>{setTimeout(()=>{const S=T.filter(a=>!a.isVisible).map(a=>a.id);s.setHiddenColumns(S),typeof s.setColumnOrder=="function"?s.setColumnOrder(T.map(a=>a.id)):console.warn("Column order can not be updated. Did you forget to add 'useColumnOrder' in 'useDatagrid'")},0),typeof n=="function"&&n(T)}})};J.propTypes={instance:e.object.isRequired};J.__docgenInfo={description:"",methods:[],displayName:"TearsheetWrapper",props:{instance:{description:"",type:{name:"object"},required:!0}}};const Le=`${w.prefix}--datagrid`,W=({onClick:s,setIsTearsheetOpen:n,isTearsheetOpen:o,iconTooltipLabel:d="Customize columns",...u})=>g.createElement(ne,{...u,renderIcon:m=>g.createElement(re,{size:16,...m}),iconDescription:d,tooltipPosition:"bottom",kind:"ghost",hasIconOnly:!0,"test-id":`${Le}__customize-columns-trigger`,onClick:()=>{n(!o),typeof s=="function"&&s()}});W.defaultProps={onClick:()=>{}};W.propTypes={iconTooltipLabel:e.string,isTearsheetOpen:e.bool.isRequired,onClick:e.func.isRequired,setIsTearsheetOpen:e.func.isRequired};W.__docgenInfo={description:"",methods:[],displayName:"ButtonWrapper",props:{iconTooltipLabel:{defaultValue:{value:"'Customize columns'",computed:!1},description:"",type:{name:"string"},required:!1},onClick:{defaultValue:{value:"() => {}",computed:!1},description:"",type:{name:"func"},required:!1},isTearsheetOpen:{description:"",type:{name:"bool"},required:!0},setIsTearsheetOpen:{description:"",type:{name:"func"},required:!0}}};const je=s=>{const[n,o]=g.useState(!1);s.useInstance.push(d=>{const{customizeColumnsProps:u}=d,{labels:m}=u||{};Object.assign(d,{customizeColumnsProps:{...u,isTearsheetOpen:n,setIsTearsheetOpen:o},CustomizeColumnsButton:h=>g.createElement(W,{iconTooltipLabel:m==null?void 0:m.iconTooltipLabel,isTearsheetOpen:n,setIsTearsheetOpen:o,...h}),CustomizeColumnsTearsheet:J})})},Fe=xe.useColumnOrder;export{je as a,Fe as u};
