import{y as Z,p as le,j as D,q as Nt,D as tt,E as Vt,F as Bt,G as Wt}from"./settings-DrdbGLhD.js";import{r as d,R as zt}from"./index-BwDkhjyp.js";import{useMDXComponents as bt}from"./index-DlpNa54Y.js";import"./chunk-HLWAVYOI-E9TBytJS.js";import{e as Et,i as Ut,C as Kt}from"./index-CVv_11D1.js";import{d as ue,a as pe,i as nt,h as Ft,b as Xt,F as Gt,s as xt,u as Rt,r as Ee}from"./useMultipleKeyTracking-CPufQLjc.js";import{P as c}from"./index-Dk74W0Oi.js";import{c as he}from"./deprecate-D9ms-jbM.js";import{u as qe}from"./uuidv4-BQrI85uz.js";import{p as Pe}from"./props-helper-D-fMQKH_.js";import{u as Ve}from"./usePreviousValue-DDnp_zt4.js";import{g as Jt}from"./devtools-B_UYo462.js";import"./_commonjsHelpers-BosuxZz1.js";import"./index-CJvxHwuA.js";import"./events-Bq7WR1mU.js";import"./index-BONylQH5.js";import"./iframe-hL1s_big.js";import"../sb-preview/runtime.js";import"./react-18-Dd3bHtks.js";import"./extends-CCbyfPlC.js";import"./index-C2eUe6cH.js";import"./index-BjQFKvNH.js";import"./isSymbol-BZYRlrjc.js";import"./index-DrFu-skq.js";const Qt=()=>{const[t,e]=d.useState(document.activeElement),r=()=>{e(document.activeElement)};return d.useEffect(()=>(document.addEventListener("focusin",r),()=>{document.removeEventListener("focusin",r)}),[]),t},Se=t=>{const e=Math.max(t.point1.row,t.point2.row),r=Math.max(t.point1.column,t.point2.column),a=Math.min(t.point1.row,t.point2.row),s=Math.min(t.point1.column,t.point2.column);return{greatestRowIndex:e,greatestColumnIndex:r,lowestColumnIndex:s,lowestRowIndex:a}},rt=({ref:t,area:e,blockClass:r,defaultColumn:a,selectionAreas:s,setSelectionAreas:h,setActiveCellInsideSelectionArea:o,visibleColumns:i})=>{const{lowestColumnIndex:u,lowestRowIndex:m,greatestColumnIndex:p,greatestRowIndex:w}=Se(e);(w-m>0||p-u>0)&&(o(!0),t.current.querySelector(`.${r}__active-cell--highlight`).setAttribute("data-selection-id",e.matcher));let l=0;i.forEach((O,M)=>{M>=u&&M<=p&&(l+=(O==null?void 0:O.width)||(a==null?void 0:a.width))});const f=(document.querySelector(`[data-row-index="${e.point1.row}"][data-column-index="${e.point1.column}"]`)||document.querySelector(`.${r}__body--td`)).offsetHeight,T=f*(w-m+1),S=document.querySelector(`.${r}__list--container`).firstElementChild,A=S.querySelector(`[data-row-index="${m}"][data-column-index="${u}"]`),_={top:A?A.getBoundingClientRect().top-S.getBoundingClientRect().top:m===0?0:f*m,left:A?A.getBoundingClientRect().left-S.getBoundingClientRect().left:u===0?0+(a.rowHeaderWidth-4):a.width*u+(a.rowHeaderWidth-4)},P=document.querySelector(`[data-matcher-id="${e.matcher}"]`)||document.createElement("div");P.classList.add(`${r}__selection-area--element`),P.setAttribute("data-matcher-id",e.matcher),P.style.width=Z(l),P.style.height=Z(T),P.style.left=Z(_.left),P.style.top=Z(_.top),S.appendChild(P);const W=ue(s),n=W.findIndex(O=>O.matcher===e.matcher);W[n].areaCreated=!0,h(W)},Ue=(t,e,r)=>{const a=ue(e),s=[];a.forEach(o=>{var m,p,w,l;const i=Math.max((m=o.point1)==null?void 0:m[r],(p=o.point2)==null?void 0:p[r]),u=Math.min((w=o.point1)==null?void 0:w[r],(l=o.point2)==null?void 0:l[r]);for(let y=u;y<=i;y++)s.push(y)});const h=[...new Set(s)];return!!(a!=null&&a.length&&h.includes(t))},St=(t,e,r,a)=>ue(e).some(o=>{var y,f,T,S,A,_,P,W;const i=r==="column"?"row":"column",u=Math.min((y=o==null?void 0:o.point1)==null?void 0:y[i],(f=o==null?void 0:o.point2)==null?void 0:f[i]),m=Math.max((T=o==null?void 0:o.point1)==null?void 0:T[i],(S=o==null?void 0:o.point2)==null?void 0:S[i]),p=Math.min((A=o==null?void 0:o.point1)==null?void 0:A[r],(_=o==null?void 0:o.point2)==null?void 0:_[r]),w=Math.max((P=o==null?void 0:o.point1)==null?void 0:P[r],(W=o==null?void 0:o.point2)==null?void 0:W[r]),l=(a==null?void 0:a.length)-1===m&&u===0;for(let n=p;n<=w;n++)if(t===n&&l)return!0;return!1}),At=({type:t,headerGroup:e,scrollBarSizeValue:r,totalVisibleColumns:a,defaultColumn:s,totalColumnsWidth:h,visibleColumns:o})=>{const i=r+s.rowHeaderWidth;if(!a){if(t==="header")return Z(parseInt(e.getHeaderGroupProps().style.width)+i);if(t!=="header")return h+i}if(a)return o.map((m,p)=>p<=a-1&&((m==null?void 0:m.width)||(s==null?void 0:s.width))).reduce((m,p)=>m+p,0)+i},Yt=({spreadsheetRef:t,activeCellCoordinates:e,containerHasFocus:r,createActiveCell:a,activeCellContent:s,isActiveHeaderCellChanged:h})=>{let o;d.useEffect(()=>{o()},[s,o,h]),o=d.useCallback(()=>{const i=t==null?void 0:t.current.querySelector(`[data-row-index="${e==null?void 0:e.row}"][data-column-index="${e==null?void 0:e.column}"]`),u=(e==null?void 0:e.row)==="header"&&!0,m=t==null?void 0:t.current.querySelector('[data-row-index="header"][data-column-index="header"]');r&&a({placementElement:e?i:m,coords:e,addToHeader:u})},[t,e,r,a])},Zt=({blockClass:t=`${le.prefix}--data-spreadsheet`,focusedElement:e,removeActiveCell:r,setContainerHasFocus:a})=>{d.useEffect(()=>{e.classList.contains(`${t}--interactive-cell-element`)||(a(!1),r()),(e.classList.contains(t)||e.classList.contains(`${t}--interactive-cell-element`))&&a(!0)},[e,r,t,a])},vt=({isBlurSpreadsheet:t,spreadsheetRef:e,blockClass:r=`${le.prefix}--data-spreadsheet`,setActiveCellCoordinates:a,setSelectionAreas:s,removeActiveCell:h,setContainerHasFocus:o,removeCellEditor:i})=>{d.useEffect(()=>{const u=m=>{!e.current||e.current.contains(m.target)||m.target.classList.contains(`${r}__active-cell--highlight`)||m.target.classList.contains(`${r}--interactive-cell-element`)||(t.current=!0,a(null),s([]),h(),pe({spreadsheetRef:e}),o(!1))};return document.addEventListener("click",u),()=>{document.removeEventListener("click",u)}},[t,e,h,r,a,o,s,i])},Ct=({isEditing:t,rows:e,activeCellCoordinates:r,activeCellRef:a,cellEditorRef:s,cellEditorRulerRef:h,visibleColumns:o,defaultColumn:i,cellEditorValue:u,blockClass:m=`${le.prefix}--data-spreadsheet`})=>{const[p,w]=d.useState(null),l=Ve({nextIndex:p});d.useEffect(()=>{l!=null&&l.nextIndex||w(r==null?void 0:r.column)},[l==null?void 0:l.nextIndex,r]),d.useEffect(()=>{var T,S,A,_,P;const y=h.current.offsetWidth,f=parseInt(s.current.style.width);if(t){const W=(T=e[r==null?void 0:r.row])==null?void 0:T.cells[r==null?void 0:r.column],n=a==null?void 0:a.current.style.left,O=a==null?void 0:a.current.style.top;if(s.current.style.left=n,s.current.style.top=O,s.current.style.display="block",s.current.style.height=a==null?void 0:a.current.style.height,s.current.style.paddingTop=`${(parseInt(a==null?void 0:a.current.style.height)-16)/2-1}px`,s.current.style.textAlign=((S=W==null?void 0:W.column)==null?void 0:S.placement)==="right"?"right":"left",(A=s.current)==null||A.focus(),y<f){const M=((_=o[p])==null?void 0:_.width)||(i==null?void 0:i.width);y<f-M&&(s.current.style.width=Z(parseInt(s.current.style.width)-M),w(j=>j===0?j:j-1))}if(y>=f){w(N=>N===o.length-1?N:N+1);const j=p+1===o.length?0:((P=o[p+1])==null?void 0:P.width)||(i==null?void 0:i.width),k=r==null?void 0:r.row,Q=(e.length-k)*i.rowHeight;s.current.style.maxHeight=Z(Q),s.current.style.width=Z(j+f),s.current.style.height=Z(s.current.scrollHeight),s.current.clientHeight===Q-1?s.current.style.overflow="auto":s.current.style.overflow="hidden"}}t||(s.current.style.overflow="hidden",s.current.style.display="none",s.current.blur(),a.current.focus(),w(r==null?void 0:r.column))},[t,r,e,u,i,a,s,h,o,m,l==null?void 0:l.cellEditorValue,p])},en=({currentMatcher:t,setSelectionAreas:e,selectedHeaderReorderActive:r,setSelectedHeaderReorderActive:a,setClickAndHoldActive:s,setValidStartingPoint:h,validStartingPoint:o,blockClass:i=`${le.prefix}--data-spreadsheet`,ref:u,setHeaderCellHoldActive:m,setColumnOrder:p,visibleColumns:w,setActiveCellCoordinates:l,activeCellCoordinates:y,rows:f,defaultColumn:T,selectionAreas:S})=>{d.useEffect(()=>{const A=_=>{var W,n;let P=!1;if((W=S==null?void 0:S[0])!=null&&W.header&&S[0].header.type==="column"&&(P=!0),!o&&P){m(!1);const O=u.current.querySelector(`.${i}__selection-area--element`),M=u.current.querySelector(`.${i}__selection-area--element-cloned`);if(!M)return;if(M){const j=_.target.closest(`.${i}--interactive-cell-element`),k=parseInt==null?void 0:parseInt(j==null?void 0:j.getAttribute("data-column-index")),z=parseInt==null?void 0:parseInt(M==null?void 0:M.getAttribute("data-column-index-original")),N=S.filter(se=>(se==null?void 0:se.matcher)===t)[0].header.selectedIndexList;if(!u.current.querySelector(`[data-row-index="header"][data-column-index="${k}"]`))return;const V=u.current.querySelector(`[data-matcher-id="${t}"]`),g=u.current.getBoundingClientRect(),re=u.current.querySelector(`.${i}__list--container`).scrollLeft,K=k<z,F=k>z,me=F?k-z:z-k;if(e(se=>{const J=ue(se);if(z===k)return se;const ae=J.findIndex(C=>C.matcher===t);if(ae===-1)return se;if(!N.includes(k)){const C=F?N.map(ce=>ce+me):N.map(ce=>ce-me);J[ae].header.selectedIndexList=C,J[ae].point1.column=Math.min(...C),J[ae].point2.column=Math.max(...C)}return J[ae].areaCreated=!1,J}),!N.includes(k)){const se=N.length,J=Math.min(...N),ae=w.map(q=>q.id),C=[...ae],ce=()=>{const q=[];return N.map(ee=>q.push(ae[ee])),q};C.splice(J,se);const de=N.findIndex(q=>q===z),E=k-de;C.splice(E,0,...ce()),p(C);const I={...y,column:F?y.column+me:y.column-me};l(I);const U=Array.from(u.current.querySelectorAll(`.${i}__th--selected-header`))[0].getBoundingClientRect().left-g.left+re,L=K?U:k===z?V.style.left:U;V.style.left=Z(L)}const ie=u.current.querySelector(`.${i}__reorder-indicator-line`);ie==null||ie.remove(),M==null||M.remove(),(n=O==null?void 0:O.classList)==null||n.remove(`${i}__selection-area--element`),a(!1)}}if(o||_.type==="mouseup"){s(!1),h(!1);const O=_.target.closest(`.${i}__body--td`);if(O){const M={row:Number(O.getAttribute("data-row-index")),column:Number(O.getAttribute("data-column-index"))};e(j=>{const k=ue(j),z=k.findIndex(Q=>Q.matcher===t);return z===-1?j:(k[z].point2=M,k[z].areaCreated=!1,k)})}}};return document.addEventListener("mouseup",A),()=>{document.removeEventListener("mouseup",A)}},[i,t,e,s,h,o,r,a,u,m,p,w,l,y,f,T,S])},tn=({blockClass:t=`${le.prefix}--data-spreadsheet`,clonedSelectionElement:e,ref:r,spreadsheetCoords:a,leftScrollAmount:s})=>{const h=event.target.closest(`.${t}--interactive-cell-element`),o=h==null?void 0:h.getAttribute("data-column-index"),i=e==null?void 0:e.getAttribute("data-column-index-original"),u=h.getBoundingClientRect(),m=r.current.querySelector(`.${t}__reorder-indicator-line`),p=e==null?void 0:e.getAttribute("data-matcher-id"),w=r.current.querySelector(`[data-matcher-id="${p}"]`),l=r.current.querySelector(`.${t}__list--container`),y=10,f=120,T=100,{clientX:S}=event,{left:A,right:_}=l.getBoundingClientRect();if(S<f&&window.scrollBy(-y,0),S>window.innerWidth-T&&window.scrollBy(y,0),S>A&&S<A+f&&l.scrollBy(-y,0),S<_&&S>_-T&&l.scrollBy(y,0),Number(o)>Number(i)){const P=u.left-a.left+h.offsetWidth-2+s;m.style.left=Z(P)}if(Number(o)<Number(i)){const P=u.left-a.left+s;m.style.left=Z(P)}Number(o)===Number(i)&&(m.style.left=w.style.left)},nn=({ref:t,blockClass:e=`${le.prefix}--data-spreadsheet`,headerCellHoldActive:r,defaultColumn:a})=>{d.useEffect(()=>{const s=o=>{const i=t.current.querySelector(`.${e}__selection-area--element-cloned`);i&&t.current.addEventListener("mousemove",s);const u=t.current.getBoundingClientRect(),m=t.current.querySelector(`.${e}__list--container`),p=m.scrollLeft;tn({clonedSelectionElement:i,ref:t,spreadsheetCoords:u,leftScrollAmount:p}),t.current.getBoundingClientRect();const l=o.clientX-u.left,y=i==null?void 0:i.getAttribute("data-clone-offset-x"),f=m.scrollWidth,T=i.offsetWidth,S=Math.max(l-y,a==null?void 0:a.rowHeaderWidth),A=f-T>=S?S+p:f-T;A<u.right-40&&(i.style.left=Z(A))};r&&t.current.addEventListener("mousemove",s);const h=t.current;return r||h==null||h.removeEventListener("mousemove",s),()=>{h==null||h.removeEventListener("mousemove",s)}})},De=(t,e)=>e=="cmd"?t.metaKey||t.ctrlKey:t[e],rn=({indexList:t,newIndex:e,activeCellIndex:r})=>{const a=e>r?r:Math.min(...t,e),s=e<r?r:Math.max(...t,e),h=[];for(let o=a;o<=s;o++)h.push(o);return[...h]},Ne=({type:t,activeCellCoordinates:e,rows:r,columns:a,currentMatcher:s,setActiveCellCoordinates:h,setCurrentMatcher:o,setSelectionAreas:i,spreadsheetRef:u,index:m,isKeyboard:p,setSelectionAreaData:w,isHoldingCommandKey:l,isHoldingShiftKey:y})=>{l||(w([]),pe({spreadsheetRef:u}));const f=p?e==null?void 0:e.row:m,T=p?e==null?void 0:e.column:m,S={row:t==="column"?0:f,column:t==="column"?T:0},A={row:t==="column"?r.length-1:f,column:t==="column"?T:a.length-1},_=qe();y||(h({row:t==="column"?0:f,column:t==="column"?T:0}),o(_));const P={point1:S,point2:A,areaCreated:!1,matcher:_,header:{type:t,selectedIndexList:[t==="column"?T:f]}};i(W=>{var O,M;const n=ue(W);if(l){const k=n.filter(Q=>{var N;return(N=Q.header)==null?void 0:N.type}).filter(Q=>{var N;return((N=Q.header)==null?void 0:N.type)===t}),z=Ue(m,k,t);return k.length&&z?W:[...W,P]}if(y){const k=n.filter(K=>{var F;return(F=K.header)==null?void 0:F.type}).filter(K=>K.matcher===s)[0],z=Math.max(k==null?void 0:k.point1[t],k==null?void 0:k.point2[t],e==null?void 0:e[t]),Q=t==="column"?T:f,N={row:z<Q?r.length-1:0,column:T},$=ue(W),V=$.findIndex(K=>K.matcher===s),g=rn({indexList:((M=(O=$[V])==null?void 0:O.header)==null?void 0:M.selectedIndexList)||[t==="column"?T:f],newIndex:Q,activeCellIndex:e==null?void 0:e[t]}),v=K=>K<Q?{row:t==="column"?0:Math.min(...g),column:t==="column"?Math.min(...g):0}:N,re=K=>K<Q?N:{row:t==="column"?r.length-1:Math.max(...g),column:t==="column"?Math.max(...g):a.length-1};if(!e||typeof e>"u"){o(_);const K={point1:v(t==="column"?T:f),point2:re(t==="column"?T:f),areaCreated:!1,matcher:_,header:{type:t,selectedIndexList:[t==="column"?T:f]}};return h({row:t==="column"?0:f,column:t==="column"?T:0}),[K]}return $[V].point1=v(e==null?void 0:e[t]),$[V].point2=re(e==null?void 0:e[t]),$[V].areaCreated=!1,$[V].header.selectedIndexList=g,$}return[P]})},an=({activeCellInsideSelectionArea:t,activeCellCoordinates:e,activeCellRef:r,selectionAreas:a,updateActiveCellCoordinates:s})=>{if(!t)return;const h=r.current.getAttribute("data-selection-id"),o=a.findIndex(y=>y.matcher===h),i=a[o],{lowestColumnIndex:u,lowestRowIndex:m,greatestColumnIndex:p,greatestRowIndex:w}=Se(i),l={...e};if((e==null?void 0:e.row)<w&&s({coords:l,updatedValue:{row:(l==null?void 0:l.row)+1},optOutOfSelectionAreaUpdate:!0}),(e==null?void 0:e.row)===w&&((e==null?void 0:e.column)<p&&s({coords:l,updatedValue:{column:(l==null?void 0:l.column)+1,row:m},optOutOfSelectionAreaUpdate:!0}),(e==null?void 0:e.column)===p)){if(a.length>1)if(a[o+1]){r.current.setAttribute("data-selection-id",a[o+1].matcher);const y=a[o+1],{lowestColumnIndex:f,lowestRowIndex:T}=Se(y);s({coords:l,updatedValue:{column:f,row:T},optOutOfSelectionAreaUpdate:!0});return}else{r.current.setAttribute("data-selection-id",a[0].matcher);const y=a[0],{lowestColumnIndex:f,lowestRowIndex:T}=Se(y);s({coords:l,updatedValue:{column:f,row:T},optOutOfSelectionAreaUpdate:!0})}if(a.length===1)return s({coords:l,updatedValue:{column:u,row:m},optOutOfSelectionAreaUpdate:!0})}},sn=({activeCellInsideSelectionArea:t,activeCellCoordinates:e,activeCellRef:r,selectionAreas:a,updateActiveCellCoordinates:s})=>{if(!t)return;const h=r.current.getAttribute("data-selection-id"),o=a.findIndex(l=>l.matcher===h),i=a[o],{lowestColumnIndex:u,lowestRowIndex:m,greatestColumnIndex:p,greatestRowIndex:w}=Se(i);if((e==null?void 0:e.column)<p&&s({updatedValue:{column:(e==null?void 0:e.column)+1},optOutOfSelectionAreaUpdate:!0}),(e==null?void 0:e.column)===p&&((e==null?void 0:e.row)<w&&s({updatedValue:{column:u,row:(e==null?void 0:e.row)+1},optOutOfSelectionAreaUpdate:!0}),(e==null?void 0:e.row)===w)){if(a.length>1)if(a[o+1]){r.current.setAttribute("data-selection-id",a[o+1].matcher);const l=a[o+1],{lowestColumnIndex:y,lowestRowIndex:f}=Se(l);s({updatedValue:{column:y,row:f},optOutOfSelectionAreaUpdate:!0});return}else{r.current.setAttribute("data-selection-id",a[0].matcher);const l=a[0],{lowestColumnIndex:y,lowestRowIndex:f}=Se(l);s({updatedValue:{column:y,row:f},optOutOfSelectionAreaUpdate:!0})}if(a.length===1)return s({updatedValue:{column:u,row:m},optOutOfSelectionAreaUpdate:!0})}},at=(t,e,r)=>{for(let a=t;a<=e;a++)r(a)},on=({activeCellCoordinates:t,selectionAreas:e,currentMatcher:r,rows:a,setActiveCellContent:s,updateData:h})=>{var y,f,T,S,A,_,P,W;if((t==null?void 0:t.column)==="header"||(t==null?void 0:t.row)==="header")return;const o=ue(e),i=o.findIndex(n=>n.matcher===r),u=o[i],m=Math.min((y=u==null?void 0:u.point1)==null?void 0:y.column,(f=u==null?void 0:u.point2)==null?void 0:f.column),p=Math.max((T=u==null?void 0:u.point1)==null?void 0:T.column,(S=u==null?void 0:u.point2)==null?void 0:S.column),w=Math.min((A=u==null?void 0:u.point1)==null?void 0:A.row,(_=u==null?void 0:u.point2)==null?void 0:_.row),l=Math.max((P=u==null?void 0:u.point1)==null?void 0:P.row,(W=u==null?void 0:u.point2)==null?void 0:W.row);at(m,p,n=>{at(w,l,O=>{const M=a[O].cells[n];h(O,M==null?void 0:M.column.id,"")})}),s(null)},Le=`${le.prefix}--data-spreadsheet`,cn=(t,e,r,...a)=>{const[s,h,o,i,u,m,p,w,l,y,f,T,S]=a;r.preventDefault();const _=r.target.closest(`.${Le}__body--td`).classList.contains(`${Le}__body--td`);S(_);const P=De(r,"cmd"),W=De(r,"shiftKey");m(!0);const n={row:t.row.index,column:e},O=qe();if(p(!0),P)l.current.querySelector(`.${Le}__active-cell--highlight`).setAttribute("data-selection-id",O),f(!0),i(n),w(O),u(j=>[...j,{point1:n,matcher:O}]);else if(W){m(!0);const M=ue(o),j=M.findIndex(k=>k.matcher===s);if(j===-1)return;M[j].point1=h,M[j].point2=n,M[j].areaCreated=!1,M[j].matcher=s,u(M)}else T.current.style.display="none",f(!1),i(n),pe({spreadsheetRef:l}),u([{point1:n,matcher:O}]),w(O),y([])},un=(t,e,...r)=>{const[a,s,h]=r;if(a){const o={row:t.row.index,column:e};h(i=>{var p,w;const u=ue(i),m=u.findIndex(l=>l.matcher===s);return m===-1||((p=u[m].point2)==null?void 0:p.row)===o.row&&((w=u[m].point2)==null?void 0:w.column)===o.column?i:(u[m].point2=o,u[m].areaCreated=!1,u)})}},ln=(t,e,...r)=>{const[a,s,h,o,i,u,m,p]=r,w=De(e,"cmd");Ne({type:"row",activeCellCoordinates:u,rows:m,columns:a,setActiveCellCoordinates:i,setCurrentMatcher:o,setSelectionAreas:h,spreadsheetRef:s,index:t,setSelectionAreaData:p,isHoldingCommandKey:w})},mn=(t,...e)=>{const[r,a,s,h,o,i,u,m,p,w,l,y,f,T,S,A,_,P,W,n,O,M,j]=e,{key:k}=t;if(!S(k)&&(["ArrowLeft","ArrowUp","ArrowRight","ArrowDown"].indexOf(k)>-1&&w!=null&&w.length&&y.length<2&&!nt(y)&&(_([]),P([]),pe({spreadsheetRef:u})),(y==null?void 0:y.length)>1&&Ft({activeCellCoordinates:s,event:t,keysPressedList:y,selectionAreas:w,currentMatcher:m,rows:i,setSelectionAreas:_,columns:o,updateActiveCellCoordinates:a,spreadsheetRef:u,removeCellSelections:pe,blockClass:Le,setCurrentMatcher:W,usingMac:f}),y.length<2&&!nt(y)||s.row==="header"||s.column==="header"))switch(k){case"Backspace":case"Delete":{on({selectionAreas:w,currentMatcher:m,rows:i,setActiveCellContent:j,updateData:T,activeCellCoordinates:s});break}case"Enter":{an({activeCellInsideSelectionArea:r,activeCellCoordinates:s,activeCellRef:n,selectionAreas:w,updateActiveCellCoordinates:a});break}case"Home":case"End":{if(t.preventDefault(),Xt(y,f))return;l({type:k});break}case"Tab":{if(r)return t.preventDefault(),sn({activeCellInsideSelectionArea:r,activeCellCoordinates:s,activeCellRef:n,selectionAreas:w,updateActiveCellCoordinates:a});_([]),h(),p(),M(!1),O(null);break}case"ArrowLeft":case"ArrowUp":case"ArrowRight":case"ArrowDown":A(k)}},G=`${le.prefix}--data-spreadsheet`,Ke=d.forwardRef(({activeCellRef:t,columns:e,activeCellCoordinates:r,defaultColumn:a,defaultEmptyRowCount:s,getTableBodyProps:h,headerGroups:o,id:i,onDataUpdate:u,prepareRow:m,rows:p,selectionAreaData:w,setSelectionAreaData:l,setActiveCellCoordinates:y,selectedHeaderReorderActive:f,setSelectedHeaderReorderActive:T,selectionAreas:S,setContainerHasFocus:A,setSelectionAreas:_,scrollBarSize:P,totalColumnsWidth:W,clickAndHoldActive:n,setClickAndHoldActive:O,currentMatcher:M,setCurrentMatcher:j,onSelectionAreaChange:k,setActiveCellInsideSelectionArea:z,totalVisibleColumns:Q,setHeaderCellHoldActive:N,setColumnOrder:$,visibleColumns:V},g)=>{const[v,re]=d.useState(!1),K=d.useRef(),F=Ve({selectionAreaData:w,clickAndHoldActive:n,rowHeight:a==null?void 0:a.rowHeight})||{};d.useEffect(()=>{g==null||g.current.style.setProperty(`--${G}--total-width`,Z((W||0)+(P||0)))},[g,P,W]),d.useEffect(()=>{var I,H,B,U;if(w!=null&&w.length){let L=!1;(((I=F==null?void 0:F.selectionAreaData)==null?void 0:I.length)!==(w==null?void 0:w.length)||((H=w==null?void 0:w[0])==null?void 0:H.cells.length)!==((U=(B=F==null?void 0:F.selectionAreaData)==null?void 0:B[0])==null?void 0:U.cells.length))&&(L=!0),(!n&&(F!=null&&F.clickAndHoldActive)||L)&&(k==null||k(w))}},[F==null?void 0:F.selectionAreaData,w,k,n,F==null?void 0:F.clickAndHoldActive]),d.useEffect(()=>{S&&S.length&&S.map(I=>{if(I.areaCreated){const H=Math.min(I.point1.row,I.point2.row),B=Math.max(I.point1.row,I.point2.row),U=Math.min(I.point1.column,I.point2.column),L=Math.max(I.point1.column,I.point2.column),q={rows:{start:H,end:B},columns:{start:U,end:L},cells:me({rowStart:H,rowEnd:B,columnStart:U,columnEnd:L}),selectionId:I.matcher};l==null||l(ee=>[...ue(ee).filter(Me=>Me.selectionId!==I.matcher),q])}!I.areaCreated&&I.point1&&I.point2&&I.matcher&&rt({ref:g,area:I,blockClass:G,defaultColumn:a,selectionAreas:S,setSelectionAreas:_,setActiveCellInsideSelectionArea:z,visibleColumns:V})})},[S,_,a,k,l,g,r,z,V]);const me=({rowStart:I,rowEnd:H,columnStart:B,columnEnd:U})=>{const L=[];for(let q=I;q<=H;q++)for(let ee=B;ee<=U;ee++)L.push([q,ee,`${G}__cell--${q}--${ee}`]);return L};en({currentMatcher:M,setClickAndHoldActive:O,setSelectionAreas:_,setValidStartingPoint:re,selectedHeaderReorderActive:f,setSelectedHeaderReorderActive:T,validStartingPoint:v,ref:g,setHeaderCellHoldActive:N,setColumnOrder:$,visibleColumns:V,setActiveCellCoordinates:y,rows:p,activeCellCoordinates:r,defaultColumn:a,selectionAreas:S}),d.useEffect(()=>{let I,H;if(E!=null&&E.current&&(I=E==null?void 0:E.current,H=I==null?void 0:I.querySelector(`.${G}__active-cell--highlight`)),H&&(a==null?void 0:a.rowHeight)!==F.rowHeight&&(H.style.height=`${a==null?void 0:a.rowHeight}px`,r)){const B=g==null?void 0:g.current.querySelector(`[data-row-index="${r.row}"][data-column-index="${r.column}"]`),U=g==null?void 0:g.current.querySelector(`.${G}__list--container`);let L;B&&U&&(L=(B==null?void 0:B.getBoundingClientRect().top)-U.getBoundingClientRect().top),H.style.top=Z(L),pe({matcher:void 0,spreadsheetRef:g}),S==null||S.map(q=>{if(!q.areaCreated&&q.point1&&q.point2&&q.matcher)return rt({ref:g,area:q,blockClass:G,defaultColumn:a,selectionAreas:S,setSelectionAreas:_,setActiveCellInsideSelectionArea:z,visibleColumns:V})})}},[a,g,r,F==null?void 0:F.rowHeight,S,z,_,V]);const ie=d.useCallback(()=>{const I=[],H=[];g==null||g.current.querySelectorAll(`.${G}__selection-area--element`).forEach(B=>{const{top:U,left:L,height:q,width:ee}=B.style,we=`${U}${L}${q}${ee}`;I.indexOf(we)==-1?I.push(we):(B.remove(),H.push(B.getAttribute("data-matcher-id")))}),H.length&&(_==null||_(B=>ue(B).filter(L=>!H.includes(L.matcher))),l==null||l(B=>ue(B).filter(L=>!H.includes(L.selectionId))))},[g,_,l]);d.useEffect(()=>{ie()},[S,ie]);const se=d.useCallback((I,H)=>B=>{cn(I,H,B,M,r,S,y,_,A,O,j,g,l,z,t,re)},[M,r,S,y,_,A,O,j,g,l,z,t]),J=()=>{const I=g.current.querySelector(`
        .${G}__header--container .${G}__tr`)||new HTMLDivElement;I.scrollLeft=K==null?void 0:K.current.scrollLeft};d.useEffect(()=>{K.current.addEventListener("scroll",()=>J());const I=K.current||new HTMLElement;return()=>{I.removeEventListener("scroll",J)}});const ae=d.useCallback((I,H)=>()=>{un(I,H,n,M,_)},[n,M,_]),C=d.useCallback(I=>H=>{ln(I,H,e,g,_,j,y,r,p,l)},[e,g,_,j,y,r,p,l]);d.useEffect(()=>{p!=null&&p.length||(()=>{const H=[];[...Array(s)].map(()=>{var U;const B={};(U=o==null?void 0:o[0])==null||U.headers.map(L=>{B[L.id]=null}),H.push(B)}),u==null||u(H)})()},[p,o,s,u]);const ce=()=>D.jsx("div",{}),de=d.useCallback(({index:I,style:H})=>{const B=p==null?void 0:p[I];if(p&&p.length){m==null||m(B);const U=Pe(B.getRowProps({style:H}),"key");return D.jsxs("div",{...U,className:he(`${G}__tr`),"data-row-index":I,"aria-rowindex":I+1,"aria-owns":`${G}__cell-editor-text-area`,children:[D.jsx("div",{role:"rowheader",className:`${G}__td-th--cell-container`,children:D.jsx("button",{id:`${G}__cell--${I}--header`,tabIndex:-1,"data-row-index":I,"data-column-index":"header",type:"button",onClick:C(I),className:he(`${G}__td`,`${G}__td-th`,`${G}--interactive-cell-element`,{[`${G}__td-th--active-header`]:(r==null?void 0:r.row)===I||Ue(I,S,"row"),[`${G}__td-th--selected-header`]:St(I,S,"row",e)}),style:{width:a==null?void 0:a.rowHeaderWidth},children:I+1})}),B.cells.map((L,q)=>{var we;const ee=Pe(L.getCellProps(),"key");return D.jsx("div",{"aria-colindex":q+1,...ee,role:"gridcell",style:{...L.getCellProps().style,display:"grid",minWidth:((we=L==null?void 0:L.column)==null?void 0:we.width)||(a==null?void 0:a.width)},children:D.jsx("button",{id:`${G}__cell--${L.row.index}--${q}`,tabIndex:-1,"data-row-index":L.row.index,"data-column-index":q,className:he(`${G}__td`,`${G}__body--td`,`${G}--interactive-cell-element`),onMouseDown:se(L,q),onMouseOver:ae(L,q),onFocus:()=>{},type:"button",children:L.render("Cell")})},`cell_${q}`)})]},{...B.getRowProps().key})}},[m,p,r==null?void 0:r.row,S,C,se,ae,a,e]),E=d.useRef();return D.jsx("div",{ref:E,className:he(`${G}__body--container`),...h==null?void 0:h(),children:D.jsx(Gt,{className:he(`${G}__list--container`,`${G}__list--container--${i}`),height:400,itemCount:(p==null?void 0:p.length)||s,itemSize:a==null?void 0:a.rowHeight,width:At({headerGroup:void 0,type:void 0,scrollBarSizeValue:P,totalVisibleColumns:Q,defaultColumn:a,totalColumnsWidth:W,visibleColumns:V}),outerRef:K,children:p!=null&&p.length?de:ce})})});Ke.propTypes={activeCellCoordinates:c.shape({row:c.oneOfType([c.string,c.number]),column:c.oneOfType([c.string,c.number])}),activeCellRef:c.object,clickAndHoldActive:c.bool,columns:c.array,currentMatcher:c.string,defaultColumn:c.shape({rowHeight:c.number,rowHeaderWidth:c.number,width:c.number}),defaultEmptyRowCount:c.number,getTableBodyProps:c.func,headerGroups:c.arrayOf(c.object),id:c.oneOfType([c.number,c.string]),onActiveCellChange:c.func,onDataUpdate:c.func,onSelectionAreaChange:c.func,prepareRow:c.func,rows:c.arrayOf(c.object),scrollBarSize:c.number,selectedHeaderReorderActive:c.bool,selectionAreaData:c.array,selectionAreas:c.array,setActiveCellCoordinates:c.func,setActiveCellInsideSelectionArea:c.func,setClickAndHoldActive:c.func,setColumnOrder:c.func,setContainerHasFocus:c.func,setCurrentMatcher:c.func,setHeaderCellHoldActive:c.func,setSelectedHeaderReorderActive:c.func,setSelectionAreaData:c.func,setSelectionAreas:c.func,totalColumnsWidth:c.number,totalVisibleColumns:c.number,visibleColumns:c.array};Ke.__docgenInfo={description:"",methods:[],displayName:"DataSpreadsheetBody",props:{activeCellCoordinates:{required:!1,tsType:{name:"union",raw:"ActiveCellCoordinates | null",elements:[{name:"ActiveCellCoordinates"},{name:"null"}]},description:"Object containing the active cell coordinates",type:{name:"shape",value:{row:{name:"union",value:[{name:"string"},{name:"number"}],required:!1},column:{name:"union",value:[{name:"string"},{name:"number"}],required:!1}}}},activeCellRef:{required:!1,tsType:{name:"MutableRefObject",elements:[{name:"union",raw:"HTMLElement | undefined",elements:[{name:"HTMLElement"},{name:"undefined"}]}],raw:"MutableRefObject<HTMLElement | undefined>"},description:"This is the ref of the button input, which is the active cell element",type:{name:"object"}},clickAndHoldActive:{required:!1,tsType:{name:"boolean"},description:"Is the user clicking and holding in the data spreadsheet body",type:{name:"bool"}},columns:{required:!1,tsType:{name:"unknown"},description:"All of the spreadsheet columns",type:{name:"array"}},currentMatcher:{required:!1,tsType:{name:"string"},description:"This represents the id of the current cell selection area",type:{name:"string"}},defaultColumn:{required:!1,tsType:{name:"SpreadsheetColumn"},description:"Default spreadsheet sizing values",type:{name:"shape",value:{rowHeight:{name:"number",required:!1},rowHeaderWidth:{name:"number",required:!1},width:{name:"number",required:!1}}}},defaultEmptyRowCount:{required:!1,tsType:{name:"number"},description:"Sets the number of empty rows to be created when there is no data provided",type:{name:"number"}},getTableBodyProps:{required:!1,tsType:{name:"signature",type:"function",raw:"(propGetter?: TableBodyPropGetter<any>) => TableBodyProps",signature:{arguments:[{type:{name:"TableBodyPropGetter",elements:[{name:"any"}],raw:"TableBodyPropGetter<any>"},name:"propGetter"}],return:{name:"TableBodyProps"}}},description:"Function to set table body prop values",type:{name:"func"}},headerGroups:{required:!1,tsType:{name:"Array",elements:[{name:"any"}],raw:"any[]"},description:"Headers provided from useTable hook",type:{name:"arrayOf",value:{name:"object"}}},id:{required:!1,tsType:{name:"union",raw:"number | string",elements:[{name:"number"},{name:"string"}]},description:"The spreadsheet id",type:{name:"union",value:[{name:"number"},{name:"string"}]}},onActiveCellChange:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"The event handler that is called when the active cell changes",type:{name:"func"}},onDataUpdate:{required:!1,tsType:{name:"signature",type:"function",raw:"({ ...args }) => void",signature:{arguments:[{name:""}],return:{name:"void"}}},description:"The event handler that is called to set the rows for the empty spreadsheet",type:{name:"func"}},onSelectionAreaChange:{required:!1,tsType:{name:"signature",type:"function",raw:"({ ...args }) => void",signature:{arguments:[{name:""}],return:{name:"void"}}},description:"The event handler that is called when the selection areas change",type:{name:"func"}},prepareRow:{required:!1,tsType:{name:"signature",type:"function",raw:"(...args) => void",signature:{arguments:[{name:"args",rest:!0}],return:{name:"void"}}},description:"Prepare row function from react-table",type:{name:"func"}},rows:{required:!1,tsType:{name:"Array",elements:[{name:"any"}],raw:"any[]"},description:"All of the spreadsheet row data",type:{name:"arrayOf",value:{name:"object"}}},scrollBarSize:{required:!1,tsType:{name:"number"},description:"The scrollbar width",type:{name:"number"}},selectionAreaData:{required:!1,tsType:{name:"Array",elements:[{name:"any"}],raw:"any[]"},description:"Array of selection area data",type:{name:"array"}},selectedHeaderReorderActive:{required:!1,tsType:{name:"boolean"},description:"Header reordering is active",type:{name:"bool"}},setSelectedHeaderReorderActive:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"boolean"}],raw:"SetStateAction<boolean>"}],raw:"Dispatch<SetStateAction<boolean>>"},description:"Set header reordering active or not",type:{name:"func"}},selectionAreas:{required:!1,tsType:{name:"Array",elements:[{name:"any"}],raw:"any[]"},description:"Array of selection areas",type:{name:"array"}},setActiveCellCoordinates:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"union",raw:"ActiveCellCoordinates | null",elements:[{name:"ActiveCellCoordinates"},{name:"null"}]}],raw:"SetStateAction<ActiveCellCoordinates | null>"}],raw:`Dispatch<
  SetStateAction<ActiveCellCoordinates | null>
>`},description:"Setter fn for activeCellCoordinates state value",type:{name:"func"}},setActiveCellInsideSelectionArea:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"boolean"}],raw:"SetStateAction<boolean>"}],raw:"Dispatch<SetStateAction<boolean>>"},description:"Setter fn for active cell inside of selection area",type:{name:"func"}},setClickAndHoldActive:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"boolean"}],raw:"SetStateAction<boolean>"}],raw:"Dispatch<SetStateAction<boolean>>"},description:"Setter fn for clickAndHold state value",type:{name:"func"}},setColumnOrder:{required:!1,tsType:{name:"signature",type:"function",raw:`(
  updater:
    | ((columnOrder: Array<IdType<any>>) => Array<IdType<any>>)
    | Array<IdType<any>>
) => void`,signature:{arguments:[{type:{name:"union",raw:`| ((columnOrder: Array<IdType<any>>) => Array<IdType<any>>)
| Array<IdType<any>>`,elements:[{name:"unknown"},{name:"Array",elements:[{name:"IdType",elements:[{name:"any"}],raw:"IdType<any>"}],raw:"Array<IdType<any>>"}]},name:"updater"}],return:{name:"void"}}},description:"Setter fn for column ordering, provided from react-table",type:{name:"func"}},setContainerHasFocus:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"boolean"}],raw:"SetStateAction<boolean>"}],raw:"Dispatch<SetStateAction<boolean>>"},description:"Setter fn for containerHasFocus state value",type:{name:"func"}},setCurrentMatcher:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"string"}],raw:"SetStateAction<string>"}],raw:"Dispatch<SetStateAction<string>>"},description:"Setter fn for currentMatcher state value",type:{name:"func"}},setHeaderCellHoldActive:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"boolean"}],raw:"SetStateAction<boolean>"}],raw:"Dispatch<SetStateAction<boolean>>"},description:"Setter fn for header cell hold active value",type:{name:"func"}},setSelectionAreaData:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"Array",elements:[{name:"object"}],raw:"object[]"}],raw:"SetStateAction<object[]>"}],raw:"Dispatch<SetStateAction<object[]>>"},description:"Setter fn for selectionAreaData state value",type:{name:"func"}},setSelectionAreas:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"Array",elements:[{name:"object"}],raw:"object[]"}],raw:"SetStateAction<object[]>"}],raw:"Dispatch<SetStateAction<object[]>>"},description:"Setter fn for selectionAreas state value",type:{name:"func"}},totalColumnsWidth:{required:!1,tsType:{name:"number"},description:"The total columns width",type:{name:"number"}},totalVisibleColumns:{required:!1,tsType:{name:"number"},description:`The total number of columns to be initially visible, additional columns will be rendered and
visible via horizontal scrollbar`,type:{name:"number"}},visibleColumns:{required:!1,tsType:{name:"Array",elements:[{name:"Column",elements:[{name:"object"}],raw:"Column<object>"}],raw:"Column<object>[]"},description:"Prop from react-table used to reorder columns",type:{name:"array"}}}};const Y=`${le.prefix}--data-spreadsheet`,Fe=d.forwardRef(({activeCellCoordinates:t,cellSize:e,columns:r,currentMatcher:a,defaultColumn:s,headerGroups:h,scrollBarSize:o,selectionAreas:i,selectedHeaderReorderActive:u,setSelectedHeaderReorderActive:m,setActiveCellCoordinates:p,setCurrentMatcher:w,setSelectionAreas:l,setSelectionAreaData:y,rows:f,totalVisibleColumns:T,updateActiveCellCoordinates:S,setHeaderCellHoldActive:A,headerCellHoldActive:_,selectAllAriaLabel:P,visibleColumns:W},n)=>{const[O,M]=d.useState(0),j=Ve({cellSize:e})||{};d.useEffect(()=>{var N;if((j==null?void 0:j.cellSize)!==e){const $=(N=n==null?void 0:n.current)==null?void 0:N.querySelector(`.${Y}__list--container`),g=($==null?void 0:$.scrollHeight)&&($==null?void 0:$.clientHeight)&&($==null?void 0:$.scrollHeight)>($==null?void 0:$.clientHeight)?0:o;$!=null&&$.getAttribute("tabIndex")||$==null||$.setAttribute("tabIndex","0"),M(g)}},[e,n,o,j==null?void 0:j.cellSize]);const k=N=>$=>{const V=De($,"cmd"),g=De($,"shiftKey");Ne({type:"column",activeCellCoordinates:t,rows:f,columns:r,currentMatcher:a,setActiveCellCoordinates:p,setCurrentMatcher:w,setSelectionAreas:l,spreadsheetRef:n,index:N,isKeyboard:void 0,setSelectionAreaData:y,isHoldingCommandKey:V,isHoldingShiftKey:g})},z=()=>{xt({ref:n,setCurrentMatcher:w,setSelectionAreas:l,rows:f,columns:r,activeCellCoordinates:t,updateActiveCellCoordinates:S})},Q=N=>$=>{var ce,de,E,I,H,B;if($.shiftKey)return;const V=i==null?void 0:i.filter(U=>(U==null?void 0:U.matcher)===a),g=n.current.querySelector(`[data-matcher-id="${(ce=V==null?void 0:V[0])==null?void 0:ce.matcher}"]`);g&&g.classList.add(`${Y}__selection-area--element`),typeof m=="function"&&m(!0);const v=$.clientX,re=$.target.getBoundingClientRect(),K=$.target.getAttribute("data-column-index"),F=v-re.left,me=Math.min(((E=(de=V==null?void 0:V[0])==null?void 0:de.point1)==null?void 0:E.column)||0,((H=(I=V==null?void 0:V[0])==null?void 0:I.point2)==null?void 0:H.column)||0),ie=(g==null?void 0:g.getBoundingClientRect())||new DOMRect,se=me<parseInt(K)?F+(re.left-(ie==null?void 0:ie.left)):F,J=(B=document==null?void 0:document.querySelector(`.${Y}__list--container`))==null?void 0:B.firstElementChild,ae=g==null?void 0:g.cloneNode(),C=g==null?void 0:g.cloneNode();C&&(C.className=`${Y}__reorder-indicator-line`,C.style.width=Z(2)),ae.classList.add(`${Y}__selection-area--element-cloned`),ae.setAttribute("data-clone-offset-x",`${se}`),ae.setAttribute("data-column-index-original",N),J==null||J.appendChild(ae),J==null||J.appendChild(C),A==null||A(!0)};return nn({ref:n,headerCellHoldActive:_,defaultColumn:s}),D.jsx("div",{className:he(`${Y}__header--container`),role:"rowgroup",children:h==null?void 0:h.map((N,$)=>{const V=Pe(N.getHeaderGroupProps(),"key");return D.jsxs("div",{...V,style:{...N.getHeaderGroupProps().style,width:At({type:"header",headerGroup:N,scrollBarSizeValue:O,totalVisibleColumns:T,defaultColumn:s,totalColumnsWidth:void 0,visibleColumns:W}),overflow:"hidden"},className:`${Y}__tr`,children:[D.jsx("div",{role:"columnheader",className:`${Y}__select-all-cell-container`,style:{width:s==null?void 0:s.rowHeaderWidth,height:s==null?void 0:s.rowHeight},children:D.jsx("button",{id:`${Y}__cell--header--header`,"data-row-index":"header","data-column-index":"header",type:"button",tabIndex:-1,"aria-label":P,onClick:z,className:he(`${Y}__th`,`${Y}--interactive-cell-element`,`${Y}__th--select-all`,{[`${Y}__th--active-header`]:(t==null?void 0:t.column)==="header"&&(t==null?void 0:t.row)==="header"}),children:"Â "})}),N.headers.map((g,v)=>{const re=Pe(g.getHeaderProps(),"key"),K=St(v,i,"column",f);return D.jsx("div",{role:"columnheader",className:`${Y}__columnheader`,...re,children:D.jsx("button",{id:`${Y}__cell--header--${v}`,"data-row-index":"header","data-column-index":v,tabIndex:-1,onMouseDown:K?Q(v):void 0,onMouseUp:K&&typeof m=="function"?()=>m(!1):void 0,onClick:K?void 0:k(v),style:{height:s==null?void 0:s.rowHeight,width:(g==null?void 0:g.width)||(s==null?void 0:s.width)},className:he(`${Y}__th`,`${Y}--interactive-cell-element`,{[`${Y}__th--active-header`]:(t==null?void 0:t.column)===v||Ue(v,i,"column"),[`${Y}__th--selected-header`]:K,[`${Y}__th--selected-header-reorder-active`]:u}),type:"button",children:g.render("Header")})},`column_${v}`)})]},`header_${$}`)})})});Fe.propTypes={activeCellCoordinates:c.shape({row:c.oneOfType([c.number,c.string]),column:c.oneOfType([c.number,c.string])}),cellSize:c.oneOf(["xs","sm","md","lg"]),columns:c.array,currentMatcher:c.string,defaultColumn:c.shape({rowHeight:c.number,rowHeaderWidth:c.number,width:c.number}),headerCellHoldActive:c.bool,headerGroups:c.arrayOf(c.object),rows:c.arrayOf(c.object),scrollBarSize:c.number,selectAllAriaLabel:c.string.isRequired,selectedHeaderReorderActive:c.bool,selectionAreas:c.arrayOf(c.object),setActiveCellCoordinates:c.func,setCurrentMatcher:c.func,setHeaderCellHoldActive:c.func,setSelectedHeaderReorderActive:c.func,setSelectionAreaData:c.func,setSelectionAreas:c.func,totalVisibleColumns:c.number,updateActiveCellCoordinates:c.func,visibleColumns:c.array};Fe.__docgenInfo={description:"",methods:[],displayName:"DataSpreadsheetHeader",props:{activeCellCoordinates:{required:!1,tsType:{name:"union",raw:"ActiveCellCoordinates | null",elements:[{name:"ActiveCellCoordinates"},{name:"null"}]},description:"Object containing the active cell coordinates",type:{name:"shape",value:{row:{name:"union",value:[{name:"number"},{name:"string"}],required:!1},column:{name:"union",value:[{name:"number"},{name:"string"}],required:!1}}}},cellSize:{required:!1,tsType:{name:"union",raw:"'xs' | 'sm' | 'md' | 'lg'",elements:[{name:"literal",value:"'xs'"},{name:"literal",value:"'sm'"},{name:"literal",value:"'md'"},{name:"literal",value:"'lg'"}]},description:"Specifies the cell height",type:{name:"enum",value:[{value:"'xs'",computed:!1},{value:"'sm'",computed:!1},{value:"'md'",computed:!1},{value:"'lg'",computed:!1}]}},columns:{required:!1,tsType:{name:"unknown"},description:"All of the spreadsheet columns",type:{name:"array"}},currentMatcher:{required:!1,tsType:{name:"string"},description:"uuid that corresponds to the current selection area",type:{name:"string"}},defaultColumn:{required:!1,tsType:{name:"SpreadsheetColumn"},description:"Default spreadsheet sizing values",type:{name:"shape",value:{rowHeight:{name:"number",required:!1},rowHeaderWidth:{name:"number",required:!1},width:{name:"number",required:!1}}}},headerCellHoldActive:{required:!1,tsType:{name:"boolean"},description:"Whether or not a click/hold is active on a header cell",type:{name:"bool"}},headerGroups:{required:!1,tsType:{name:"Array",elements:[{name:"any"}],raw:"any[]"},description:"Headers provided from useTable hook",type:{name:"arrayOf",value:{name:"object"}}},rows:{required:!1,tsType:{name:"Array",elements:[{name:"object"}],raw:"object[]"},description:"All of the spreadsheet row data",type:{name:"arrayOf",value:{name:"object"}}},scrollBarSize:{required:!1,tsType:{name:"number"},description:"The scrollbar width",type:{name:"number"}},selectAllAriaLabel:{required:!0,tsType:{name:"string"},description:"The aria label applied to the Select all button",type:{name:"string"}},selectionAreas:{required:!1,tsType:{name:"Array",elements:[{name:"ItemType"}],raw:"ItemType[]"},description:"All of the cell selection area items",type:{name:"arrayOf",value:{name:"object"}}},setActiveCellCoordinates:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"union",raw:"ActiveCellCoordinates | null",elements:[{name:"ActiveCellCoordinates"},{name:"null"}]}],raw:"SetStateAction<ActiveCellCoordinates | null>"}],raw:`Dispatch<
  SetStateAction<ActiveCellCoordinates | null>
>`},description:"Setter fn for activeCellCoordinates value",type:{name:"func"}},selectedHeaderReorderActive:{required:!1,tsType:{name:"boolean"},description:"Header reordering is active",type:{name:"bool"}},setSelectedHeaderReorderActive:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"boolean"}],raw:"SetStateAction<boolean>"}],raw:"Dispatch<SetStateAction<boolean>>"},description:"Set header reordering active or not",type:{name:"func"}},setCurrentMatcher:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"string"}],raw:"SetStateAction<string>"}],raw:"Dispatch<SetStateAction<string>>"},description:"Setter fn for currentMatcher value",type:{name:"func"}},setHeaderCellHoldActive:{required:!1,tsType:{name:"signature",type:"function",raw:"(arg: boolean) => void",signature:{arguments:[{type:{name:"boolean"},name:"arg"}],return:{name:"void"}}},description:"Setter fn for header cell hold active value",type:{name:"func"}},setSelectionAreaData:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"Array",elements:[{name:"object"}],raw:"object[]"}],raw:"SetStateAction<object[]>"}],raw:"Dispatch<SetStateAction<object[]>>"},description:"Setter fn for selectionAreaData state value",type:{name:"func"}},setSelectionAreas:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"Array",elements:[{name:"object"}],raw:"object[]"}],raw:"SetStateAction<object[]>"}],raw:"Dispatch<SetStateAction<object[]>>"},description:"Setter fn for selectionAreas value",type:{name:"func"}},totalVisibleColumns:{required:!1,tsType:{name:"number"},description:`The total number of columns to be initially visible, additional columns will be rendered and
visible via horizontal scrollbar`,type:{name:"number"}},updateActiveCellCoordinates:{required:!1,tsType:{name:"signature",type:"function",raw:"(arg) => void",signature:{arguments:[{name:"arg"}],return:{name:"void"}}},description:"Function used to update the active cell coordinates",type:{name:"func"}},visibleColumns:{required:!1,tsType:{name:"Array",elements:[{name:"Column",elements:[{name:"object"}],raw:"Column<object>"}],raw:"Column<object>[]"},description:"Array of visible columns provided by react-table useTable hook",type:{name:"array"}}}};const dn=()=>{const t=document.createElement("div");t.setAttribute("style","width: 100px; height: 100px; overflow: scroll; position:absolute; top:-9999px;"),document.body.appendChild(t);const e=t.offsetWidth-t.clientWidth;return document.body.removeChild(t),e},hn=({placementElement:t,coords:e,addToHeader:r=!1,contextRef:a,blockClass:s=`${le.prefix}--data-spreadsheet`,onActiveCellChange:h,activeCellValue:o,activeCellRef:i,cellEditorRef:u,defaultColumn:m})=>{if(!e)return;const p=document.querySelector(`[data-row-index="${e.row}"][data-column-index="${e.column}"]`)||document.querySelector(`.${s}__body--td`),w=p.offsetWidth,l=p.offsetHeight,y=r?a==null?void 0:a.current.querySelector(`.${s}__header--container`):a==null?void 0:a.current.querySelector(`.${s}__list--container`).firstElementChild,f={top:t?t.getBoundingClientRect().top-y.getBoundingClientRect().top:e.row===0?0:l*e.row,left:t?t.getBoundingClientRect().left-y.getBoundingClientRect().left:e.column===0?0+(m.rowHeaderWidth-4):w*e.column+(m.rowHeaderWidth-4)},T=i==null?void 0:i.current;T.style.width=Z(t?t==null?void 0:t.offsetWidth:w),T.style.height=Z(t?t==null?void 0:t.offsetHeight:l),T.style.left=Z(f.left),T.style.top=Z(f.top),T.style.display="block",T.setAttribute("data-active-row-index",typeof(e==null?void 0:e.row)=="number"?e.row:"header"),T.setAttribute("data-active-column-index",typeof(e==null?void 0:e.column)=="number"?e.column:"header"),y.appendChild(T),T.focus(),r||y.appendChild(u.current),typeof(e==null?void 0:e.column)=="number"&&typeof(e==null?void 0:e.row)=="number"&&(h==null||h(o))},He=t=>Number(t.replace("rem","")*Nt),pn=t=>{switch(t){case"xs":return He(Wt);case"sm":return He(tt);case"md":return He(Bt);case"lg":return He(Vt);default:return He(tt)}},fn=({activeCellCoordinates:t,cellEditorRulerRef:e,columns:r,previousState:a,removeCellEditor:s,rows:h,setActiveCellCoordinates:o,setCurrentMatcher:i,setSelectionAreas:u,spreadsheetRef:m,updateData:p})=>w=>{const{key:l}=w,y=({type:f})=>{const T=()=>{const _=a==null?void 0:a.activeCellCoordinates,P=h[_==null?void 0:_.row].cells[_==null?void 0:_.column];s(),p(_==null?void 0:_.row,P.column.id)};pe({spreadsheetRef:m}),T();const S=qe(),A={row:f==="Enter"?t.row===h.length-1?t.row:t.row+1:t.row,column:f==="Tab"?t.column===r.length-1?t.column:t.column+1:t.column};u([{point1:A,point2:A,matcher:S,areaCreated:!1}]),i(S),e.current.textContent=""};l==="Enter"&&(y({type:"Enter"}),o(f=>({...f,row:f.row===h.length-1?f.row:f.row+1}))),l==="Tab"&&(w.preventDefault(),y({type:"Tab"}),o(f=>({...f,column:f.column===r.length-1?f.column:f.column+1})))},oe=`${le.prefix}--data-spreadsheet`,Xe="DataSpreadsheet",Ae={columns:Object.freeze([]),data:Object.freeze([]),defaultEmptyRowCount:16,onDataUpdate:Object.freeze(()=>{}),onActiveCellChange:Object.freeze(()=>{}),onSelectionAreaChange:Object.freeze(()=>{}),theme:"light"};let fe=zt.forwardRef(({cellSize:t="sm",className:e,columns:r=Ae.columns,data:a=Ae.data,defaultEmptyRowCount:s=Ae.defaultEmptyRowCount,onDataUpdate:h=Ae.onDataUpdate,id:o,onActiveCellChange:i=Ae.onActiveCellChange,onSelectionAreaChange:u=Ae.onSelectionAreaChange,selectAllAriaLabel:m,spreadsheetAriaLabel:p,theme:w,totalVisibleColumns:l,...y},f)=>{const T=d.useRef(null),S=d.useRef(),A=f||S,_=Qt(),[P,W]=d.useState(!1),[n,O]=d.useState(null),[M,j]=d.useState([]),[k,z]=d.useState([]),[Q,N]=d.useState(!1),[$,V]=d.useState(""),[g,v]=d.useState(!1),[re,K]=d.useState(""),[F,me]=d.useState(!1),[ie,se]=d.useState(!1),J=d.useRef(!1),[ae,C]=d.useState(!1),[ce,de]=d.useState(!1),E=Ve({activeCellCoordinates:n,isEditing:g,cellEditorValue:re})||{},I=pn(t),H=d.useRef(),[B,U]=d.useState(),L=d.useRef(),q=d.useRef(),ee=d.useMemo(()=>({width:150,rowHeaderWidth:64,rowHeight:I}),[I]),{keysPressedList:we,usingMac:We}=Rt({ref:T,containerHasFocus:P,isEditing:g}),Me=d.useMemo(()=>dn(),[]),{getTableProps:_t,getTableBodyProps:It,headerGroups:Re,rows:te,totalColumnsWidth:Tt,prepareRow:$t,setColumnOrder:Ht,visibleColumns:ze}=Ee.useTable({columns:r,data:a,defaultColumn:ee},Ee.useBlockLayout,Ee.useColumnOrder),$e=d.useCallback((x,b,X)=>{h(R=>R.map((ne,ye)=>ye===x?{...R[x],[b]:re||X}:ne))},[re,h]),je=d.useCallback(()=>{var b;const x=(b=A==null?void 0:A.current)==null?void 0:b.querySelector(`.${oe}__active-cell--highlight`);x&&(x.style.display="none")},[A]),be=d.useCallback(()=>{K(""),v(!1),H!=null&&H.current&&(H.current.style.display="none")},[]);d.useEffect(()=>{const x=E==null?void 0:E.activeCellCoordinates;if(((x==null?void 0:x.row)!==(n==null?void 0:n.row)||(x==null?void 0:x.column)!==(n==null?void 0:n.column))&&g){const b=te[Number(x==null?void 0:x.row)].cells[Number(x==null?void 0:x.column)];be(),$e(x==null?void 0:x.row,b.column.id,void 0),q!=null&&q.current&&(q.current.textContent="")}if((x==null?void 0:x.row)!==(n==null?void 0:n.row)||(x==null?void 0:x.column)!==(n==null?void 0:n.column)){if(n&&(n==null?void 0:n.row)!=="header"&&(n==null?void 0:n.column)!=="header"){const b=typeof(n==null?void 0:n.column)=="number"&&typeof(n==null?void 0:n.row)=="number"?te[n==null?void 0:n.row].cells[n==null?void 0:n.column]:null;U(b?b.render("Cell"):null)}(n&&(n==null?void 0:n.row)==="header"||(n==null?void 0:n.column)==="header")&&(U(null),C(b=>!b))}g&&E.activeCellCoordinates&&J.current&&(U(E.cellEditorValue),J.current=!1,be())},[J,n,E==null?void 0:E.activeCellCoordinates,E==null?void 0:E.cellEditorValue,$e,te,g,be,B]);const qt=d.useCallback(({placementElement:x,coords:b,addToHeader:X=!1})=>{const R=typeof(b==null?void 0:b.column)=="number"&&typeof(b==null?void 0:b.row)=="number"?te[b==null?void 0:b.row].cells[b==null?void 0:b.column]:null,ne=R?Object.values(R.row.values)[b==null?void 0:b.column]:null;hn({placementElement:x,coords:b,addToHeader:X,contextRef:A,blockClass:oe,onActiveCellChange:i,activeCellValue:ne,activeCellRef:L,cellEditorRef:H,defaultColumn:ee})},[A,te,i,ee]);Zt({focusedElement:_,removeActiveCell:je,setContainerHasFocus:W}),vt({isBlurSpreadsheet:J,spreadsheetRef:A,setActiveCellCoordinates:O,setSelectionAreas:j,removeActiveCell:je,setContainerHasFocus:W,removeCellEditor:be}),Yt({spreadsheetRef:A,activeCellCoordinates:n,containerHasFocus:P,createActiveCell:qt,activeCellContent:B,isActiveHeaderCellChanged:ae});const Je=d.useCallback(()=>{de(!1),n||O({column:"header",row:"header"})},[n]),ge=d.useCallback(({coords:x={...n},updatedValue:b,optOutOfSelectionAreaUpdate:X=!1})=>{const R={...x,...b};if(O(R),R.row!=="header"&&R.column!=="header"&&!X){const ne=qe();j([{point1:R,matcher:ne}]),V(ne)}},[n]),Qe=d.useCallback(({type:x})=>{const b={...n};ge({coords:b,updatedValue:{column:x==="Home"?0:r.length-1}}),pe({matcher:void 0,spreadsheetRef:A})},[n,ge,A,r.length]),Ye=d.useCallback(x=>g||x==="Meta"||x==="Control",[g]),Ze=d.useCallback(x=>{event==null||event.preventDefault(),Je();const b={...n};let X;switch(x){case"ArrowLeft":{if(b.column==="header")return;typeof b.column=="number"&&(b.column===0?X={column:"header"}:X={column:b.column-1});break}case"ArrowUp":{if(b.row==="header")return;typeof b.row=="number"&&(b.row===0?X={row:"header"}:X={row:b.row-1});break}case"ArrowRight":{if(b.column==="header"&&(X={column:0}),typeof b.column=="number"){if(r.length-1===b.column)return;X={column:b.column+1}}break}case"ArrowDown":{if(b.row==="header"&&(X={row:0}),typeof b.row=="number"){if(te.length-1===b.row)return;X={row:b.row+1}}break}}X&&ge({coords:b,updatedValue:X})},[Je,ge,n,r,te]),Dt=d.useCallback(x=>{mn(x,ce,ge,n,je,r,te,A,$,be,M,Qe,we,We,$e,Ye,Ze,j,z,V,L,O,W,U)},[ce,ge,n,je,r,te,A,$,be,M,Qe,we,We,$e,Ye,Ze]),ve=()=>{var X,R,ne,ye;v(!0),N(!1);const x=typeof(n==null?void 0:n.column)=="number"&&typeof(n==null?void 0:n.row)=="number"?te[n==null?void 0:n.row].cells[n==null?void 0:n.column]:null;let b;x&&(n!=null&&n.column)&&(b=x?(R=(X=x.row.cells)==null?void 0:X[n==null?void 0:n.column])==null?void 0:R.value:null),K(b||""),q!=null&&q.current&&(q.current.textContent=b),H!=null&&H.current&&(L!=null&&L.current)&&(H.current.style.width=(ye=(ne=L==null?void 0:L.current)==null?void 0:ne.style)==null?void 0:ye.width)};d.useEffect(()=>{var x,b,X,R,ne,ye;g&&!(E!=null&&E.isEditing)&&((ne=H==null?void 0:H.current)==null||ne.setSelectionRange(Number((b=(x=q==null?void 0:q.current)==null?void 0:x.textContent)==null?void 0:b.length),Number((R=(X=q==null?void 0:q.current)==null?void 0:X.textContent)==null?void 0:R.length)),(ye=H==null?void 0:H.current)==null||ye.focus())},[g,E==null?void 0:E.isEditing]);const Mt=()=>{if((n==null?void 0:n.row)==="header"||(n==null?void 0:n.column)==="header"){const x=(n==null?void 0:n.row)==="header"?n==null?void 0:n.column:n==null?void 0:n.row;if((n==null?void 0:n.row)==="header"&&(n==null?void 0:n.column)==="header")return;Ce({isKeyboard:!1,index:Number(x)})}},jt=()=>{N(!1)},Ot=()=>{if((n==null?void 0:n.row)!=="header"||(n==null?void 0:n.column)!=="header"){const x=qe();N(!0),pe({matcher:null,spreadsheetRef:A}),j([{point1:n,matcher:x}]),V(x),z([]),de(!1)}},kt=x=>{const{key:b}=x;b==="Enter"&&!ce&&((n==null?void 0:n.column)!=="header"&&(n==null?void 0:n.row)!=="header"&&ve(),((n==null?void 0:n.row)==="header"||(n==null?void 0:n.column)==="header")&&Ce({isKeyboard:!0}))},Ce=({isKeyboard:x,index:b=-1})=>{const X={activeCellCoordinates:n,rows:te,columns:r,currentMatcher:$,setActiveCellCoordinates:O,setCurrentMatcher:V,setSelectionAreas:j,spreadsheetRef:A,index:b,isKeyboard:x,setSelectionAreaData:z,isHoldingCommandKey:null,isHoldingShiftKey:null};(n==null?void 0:n.row)==="header"&&(n==null?void 0:n.column)!=="header"&&Ne({type:"column",...X}),(n==null?void 0:n.column)==="header"&&(n==null?void 0:n.row)!=="header"&&Ne({type:"row",...X}),(n==null?void 0:n.column)==="header"&&(n==null?void 0:n.row)==="header"&&xt({ref:A,setCurrentMatcher:V,setSelectionAreas:j,rows:te,columns:r,activeCellCoordinates:n,updateActiveCellCoordinates:ge})},Lt=()=>{ve()};Ct({isEditing:g,rows:te,activeCellCoordinates:n,activeCellRef:L,cellEditorRef:H,cellEditorRulerRef:q,visibleColumns:ze,defaultColumn:ee,cellEditorValue:re});const et=d.useCallback((x,b)=>{$&&x&&x.length&&b&&$&&j(X=>{const R=ue(X),ne=R.findIndex(ye=>ye.matcher===$);return ne===-1?X:typeof R[ne].point2=="object"&&R[ne].areaCreated?(R[ne].point2=R[ne].point1,R[ne].areaCreated=!1,de(!1),pe({matcher:$,spreadsheetRef:A}),R):X})},[A,$]),Pt=d.useCallback(()=>{et(M,Q)},[Q,M,et]);return D.jsx("div",{...y,..._t(),...Jt(Xe),className:he(oe,e,`${oe}--interactive-cell-element`,{[`${oe}__container-has-focus`]:P,[`${oe}__${w}`]:w==="dark"}),ref:A,role:"grid",tabIndex:0,"aria-rowcount":(te==null?void 0:te.length)||0,"aria-colcount":(r==null?void 0:r.length)||0,"aria-label":p,onKeyDown:Dt,onFocus:()=>W(!0),children:D.jsxs("div",{ref:T,children:[D.jsx(Fe,{ref:A,activeCellCoordinates:n,cellSize:t,columns:r,currentMatcher:$,defaultColumn:ee,selectedHeaderReorderActive:ie,setSelectedHeaderReorderActive:se,headerGroups:Re,rows:te,scrollBarSize:Me,selectionAreas:M,setActiveCellCoordinates:O,setSelectionAreas:j,setCurrentMatcher:V,setSelectionAreaData:z,totalVisibleColumns:l,updateActiveCellCoordinates:ge,setHeaderCellHoldActive:me,headerCellHoldActive:F,visibleColumns:ze,selectAllAriaLabel:m}),D.jsx(Ke,{activeCellRef:L,activeCellCoordinates:n,ref:A,clickAndHoldActive:Q,setClickAndHoldActive:N,currentMatcher:$,setCurrentMatcher:V,setContainerHasFocus:W,selectedHeaderReorderActive:ie,setSelectedHeaderReorderActive:se,selectionAreas:M,setSelectionAreas:j,headerGroups:Re,defaultColumn:ee,getTableBodyProps:It,onDataUpdate:h,onActiveCellChange:i,onSelectionAreaChange:u,prepareRow:$t,rows:te,selectionAreaData:k,setSelectionAreaData:z,setActiveCellCoordinates:O,scrollBarSize:Me,totalColumnsWidth:Tt,id:o,columns:r,defaultEmptyRowCount:s,setActiveCellInsideSelectionArea:de,totalVisibleColumns:l,setHeaderCellHoldActive:me,setColumnOrder:Ht,visibleColumns:ze}),D.jsx("button",{onMouseDown:Ot,onMouseUp:jt,onClick:Mt,onKeyDown:kt,onDoubleClick:Lt,onMouseEnter:Pt,ref:L,className:he(`${oe}--interactive-cell-element`,`${oe}__active-cell--highlight`,{[`${oe}__active-cell--with-selection`]:ce}),type:"button",children:B}),D.jsx("textarea",{id:`${oe}__cell-editor-text-area`,value:re,onKeyDown:fn({activeCellCoordinates:n,cellEditorRulerRef:q,columns:r,previousState:E,removeCellEditor:be,rows:te,setActiveCellCoordinates:O,setCurrentMatcher:V,setSelectionAreas:j,spreadsheetRef:A,updateData:$e}),onChange:x=>{E.isEditing&&(K(x.target.value),q!=null&&q.current&&(q.current.textContent=x.target.value))},ref:H,"aria-labelledby":n?`${oe}__cell--${n==null?void 0:n.row}--${n==null?void 0:n.column}`:"",className:he(`${oe}__cell-editor`,`${oe}--interactive-cell-element`,`${oe}__cell-editor--${t}`,{[`${oe}__cell-editor--active`]:g})}),D.jsx("pre",{"aria-hidden":!0,ref:q,className:`${oe}__cell-editor-ruler`})]})})});fe=le.checkComponentEnabled(fe,Xe);fe.displayName=Xe;fe.propTypes={cellSize:c.oneOf(["xs","sm","md","lg"]),className:c.string,columns:c.arrayOf(c.shape({Header:c.string,accessor:c.oneOfType([c.string,c.func]),Cell:c.func})),data:c.arrayOf(c.shape),defaultEmptyRowCount:c.number,id:c.oneOfType([c.number,c.string]),onActiveCellChange:c.func,onDataUpdate:c.func,onSelectionAreaChange:c.func,selectAllAriaLabel:c.string.isRequired,spreadsheetAriaLabel:c.string.isRequired,theme:c.oneOf(["light","dark"]),totalVisibleColumns:c.number};fe.__docgenInfo={description:"DataSpreadsheet: used to organize and display large amounts of structured data, separated by columns and rows in a grid-like format.",methods:[],displayName:"DataSpreadsheet",props:{cellSize:{required:!1,tsType:{name:"union",raw:"'xs' | 'sm' | 'md' | 'lg'",elements:[{name:"literal",value:"'xs'"},{name:"literal",value:"'sm'"},{name:"literal",value:"'md'"},{name:"literal",value:"'lg'"}]},description:"Specifies the cell height",defaultValue:{value:"'sm'",computed:!1},type:{name:"enum",value:[{value:"'xs'",computed:!1},{value:"'sm'",computed:!1},{value:"'md'",computed:!1},{value:"'lg'",computed:!1}]}},className:{required:!1,tsType:{name:"string"},description:"Provide an optional class to be applied to the containing node.",type:{name:"string"}},columns:{required:!1,tsType:{name:"unknown"},description:"The data that will build the column headers",defaultValue:{value:"Object.freeze([])",computed:!0},type:{name:"arrayOf",value:{name:"shape",value:{Header:{name:"string",required:!1},accessor:{name:"union",value:[{name:"string"},{name:"func"}],required:!1},Cell:{name:"func",required:!1}}}}},data:{required:!1,tsType:{name:"unknown"},description:"The spreadsheet data that will be rendered in the body of the spreadsheet component",defaultValue:{value:"Object.freeze([])",computed:!0},type:{name:"arrayOf",value:{name:"shape",value:"",computed:!0}}},defaultEmptyRowCount:{required:!1,tsType:{name:"number"},description:"Sets the number of empty rows to be created when there is no data provided",defaultValue:{value:"16",computed:!1},type:{name:"number"}},id:{required:!1,tsType:{name:"union",raw:"number | string",elements:[{name:"number"},{name:"string"}]},description:"The spreadsheet id",type:{name:"union",value:[{name:"number"},{name:"string"}]}},onActiveCellChange:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"The event handler that is called when the active cell changes",defaultValue:{value:"Object.freeze(() => {})",computed:!0},type:{name:"func"}},onDataUpdate:{required:!1,tsType:{name:"signature",type:"function",raw:"({ ...args }) => void",signature:{arguments:[{name:""}],return:{name:"void"}}},description:"The setter fn for the data prop",defaultValue:{value:"Object.freeze(() => {})",computed:!0},type:{name:"func"}},onSelectionAreaChange:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"The event handler that is called when the selection area values change",defaultValue:{value:"Object.freeze(() => {})",computed:!0},type:{name:"func"}},selectAllAriaLabel:{required:!0,tsType:{name:"string"},description:"The aria label applied to the Select all button",type:{name:"string"}},spreadsheetAriaLabel:{required:!0,tsType:{name:"string"},description:"The aria label applied to the Data spreadsheet component",type:{name:"string"}},theme:{required:!1,tsType:{name:"union",raw:"'light' | 'dark'",elements:[{name:"literal",value:"'light'"},{name:"literal",value:"'dark'"}]},description:"The theme the DataSpreadsheet should use (only used to render active cell/selection area colors on dark theme)",type:{name:"enum",value:[{value:"'light'",computed:!1},{value:"'dark'",computed:!1}]}},totalVisibleColumns:{required:!1,tsType:{name:"number"},description:`The total number of columns to be initially visible, additional columns will be rendered and
visible via horizontal scrollbar`,type:{name:"number"}}}};const st=["dog","cat","bird","lizard","frog","hamster","fish","rabbit","snake"],Oe=["Bruno","Willow","Kona","Heidi","Rusty","Bonnie","Cash","Gucci","Brody","Emma","Loki","Angel","Astro","Sherman","Layla","Peanut","Grace","Mickey","Sasha","Finn","Tucker","Bear","Mocha","Roscoe"],wn=t=>{const e=[];for(let r=0;r<t;r++)e.push(r);return e},yn=t=>{const e=t&&{ownerName:Oe[Math.floor(Math.random()*Oe.length)],weight:Math.floor(Math.random()*40)},r={petType:st[Math.floor(Math.random()*st.length)],firstName:Oe[Math.floor(Math.random()*Oe.length)],age:Math.floor(Math.random()*30),visits:Math.floor(Math.random()*40),health:Math.floor(Math.random()*100)};return t?{...r,...e}:r},Ge=({rows:t,extraColumns:e})=>((a=0)=>{const h=[t][a];return wn(h).map(()=>({...yn(e)}))})();function ot(t){const e={a:"a",h1:"h1",h2:"h2",li:"li",ul:"ul",...bt(),...t.components};return D.jsxs(D.Fragment,{children:[D.jsx(e.h1,{id:"dataspreadsheet",children:"DataSpreadsheet"}),`
`,D.jsx(e.h2,{id:"table-of-contents",children:"Table of Contents"}),`
`,D.jsxs(e.ul,{children:[`
`,D.jsx(e.li,{children:D.jsx(e.a,{href:"#overview",children:"Overview"})}),`
`,D.jsx(e.li,{children:D.jsx(e.a,{href:"#example-usage",children:"Example usage"})}),`
`,D.jsx(e.li,{children:D.jsx(e.a,{href:"#component-api",children:"Component API"})}),`
`]}),`
`,D.jsx(e.h2,{id:"overview",children:"Overview"}),`
`,`
`,D.jsx(e.h2,{id:"example-usage",children:"Example usage"}),`
`,`
`,D.jsx(Et,{children:D.jsx(Ut,{of:xe})}),`
`,D.jsx(e.h2,{id:"code-sample",children:"Code sample"}),`
`,`
`,D.jsx(e.h2,{id:"component-api",children:"Component API"}),`
`,D.jsx(Kt,{})]})}function gn(t={}){const{wrapper:e}={...bt(),...t.components};return e?D.jsx(e,{...t,children:D.jsx(ot,{...t})}):ot(t)}const bn="div[data-story-title*=DataSpreadsheet] .docs-story>div:first-child>div:first-child{overflow:auto;width:100%}",Jn={title:"IBM Products/Components/Data spreadsheet/DataSpreadsheet",component:fe,tags:["autodocs"],argTypes:{onActiveCellChange:{action:"active cell change"},onSelectionAreaChange:{action:"selection area change"}},parameters:{styles:bn,docs:{page:gn}}},ke=({value:t})=>D.jsx("span",{style:{display:"flex",justifyContent:"flex-end"},children:t}),Be=[{Header:"Row Index",accessor:(t,e)=>e,Cell:({cell:{value:t}})=>D.jsx(ke,{value:t}),placement:"right",width:275},{Header:"Pet type",accessor:"petType"},{Header:"First Name",accessor:"firstName"},{Header:"Age",accessor:"age",Cell:({cell:{value:t}})=>D.jsx(ke,{value:t}),placement:"right"},{Header:"Vet visits",accessor:"visits",Cell:({cell:{value:t}})=>D.jsx(ke,{value:t}),placement:"right"},{Header:"Health",accessor:"health",Cell:({cell:{value:t}})=>D.jsx(ke,{value:t}),placement:"right"}],xn=({...t})=>{const[e,r]=d.useState(()=>Ge({rows:16})),a=d.useMemo(()=>Be,[]);return D.jsx(fe,{columns:a,data:e,onDataUpdate:r,id:"spreadsheet--id",...t})},Sn=({...t})=>{const[e,r]=d.useState(()=>Ge({rows:1e3})),a=d.useMemo(()=>Be,[]);return D.jsx(fe,{columns:a,data:e,onDataUpdate:r,id:"spreadsheet--id",...t})},An=({...t})=>{const[e,r]=d.useState([]),a=d.useMemo(()=>[...Be.filter(h=>h.Header!=="Row Index")],[]),s=d.useMemo(()=>a,[a]);return D.jsx(fe,{columns:s,data:e,onDataUpdate:r,id:"spreadsheet--id",...t})},_n=({...t})=>{const[e,r]=d.useState(()=>Ge({rows:24,extraColumns:!0})),a=d.useMemo(()=>[...Be,{Header:"Owner name",accessor:"ownerName"},{Header:"Weight",accessor:"weight"}],[]),s=d.useMemo(()=>a,[a]);return D.jsx(fe,{columns:s,data:e,onDataUpdate:r,id:"spreadsheet--id",...t})},xe=xn.bind({});xe.storyName="Basic spreadsheet";xe.args={selectAllAriaLabel:"Select all",spreadsheetAriaLabel:"Example data spreadsheet"};const _e=Sn.bind({});_e.storyName="Large dataset";_e.args={cellSize:"lg",selectAllAriaLabel:"Select all",spreadsheetAriaLabel:"Example data spreadsheet"};const Ie=An.bind({});Ie.storyName="Empty with cells";Ie.args={defaultEmptyRowCount:24,selectAllAriaLabel:"Select all",spreadsheetAriaLabel:"Example data spreadsheet"};const Te=_n.bind({});Te.storyName="With many columns";Te.args={selectAllAriaLabel:"Select all",spreadsheetAriaLabel:"Example data spreadsheet",totalVisibleColumns:5};var ct,ut,it;xe.parameters={...xe.parameters,docs:{...(ct=xe.parameters)==null?void 0:ct.docs,source:{originalSource:`({
  ...args
}) => {
  const [data, setData] = useState(() => generateData({
    rows: 16
  }));
  const columns = useMemo(() => columnData, []);
  return <DataSpreadsheet columns={columns} data={data} onDataUpdate={setData} id="spreadsheet--id" {...args} />;
}`,...(it=(ut=xe.parameters)==null?void 0:ut.docs)==null?void 0:it.source}}};var lt,mt,dt;_e.parameters={..._e.parameters,docs:{...(lt=_e.parameters)==null?void 0:lt.docs,source:{originalSource:`({
  ...args
}) => {
  const [data, setData] = useState(() => generateData({
    rows: 1000
  }));
  const columns = useMemo(() => columnData, []);
  return <DataSpreadsheet columns={columns} data={data} onDataUpdate={setData} id="spreadsheet--id" {...args} />;
}`,...(dt=(mt=_e.parameters)==null?void 0:mt.docs)==null?void 0:dt.source}}};var ht,pt,ft;Ie.parameters={...Ie.parameters,docs:{...(ht=Ie.parameters)==null?void 0:ht.docs,source:{originalSource:`({
  ...args
}) => {
  const [data, setData] = useState([]);
  const columnDataClone = useMemo(() => [...columnData.filter(item => item.Header !== 'Row Index')], []);
  const columns = useMemo(() => columnDataClone, [columnDataClone]);
  return <DataSpreadsheet columns={columns} data={data} onDataUpdate={setData} id="spreadsheet--id" {...args} />;
}`,...(ft=(pt=Ie.parameters)==null?void 0:pt.docs)==null?void 0:ft.source}}};var wt,yt,gt;Te.parameters={...Te.parameters,docs:{...(wt=Te.parameters)==null?void 0:wt.docs,source:{originalSource:`({
  ...args
}) => {
  const [data, setData] = useState(() => generateData({
    rows: 24,
    extraColumns: true
  }));
  const columnDataClone = useMemo(() => [...columnData, {
    Header: 'Owner name',
    accessor: 'ownerName'
  }, {
    Header: 'Weight',
    accessor: 'weight'
  }], []);
  const columns = useMemo(() => columnDataClone, [columnDataClone]);
  return <DataSpreadsheet columns={columns} data={data} onDataUpdate={setData} id="spreadsheet--id" {...args} />;
}`,...(gt=(yt=Te.parameters)==null?void 0:yt.docs)==null?void 0:gt.source}}};const Qn=["dataSpreadsheet","largeDatasetSpreadsheet","emptyWithCells","withManyColumns"];export{Qn as __namedExportsOrder,xe as dataSpreadsheet,Jn as default,Ie as emptyWithCells,_e as largeDatasetSpreadsheet,Te as withManyColumns};
