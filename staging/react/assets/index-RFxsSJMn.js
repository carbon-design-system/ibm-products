import{at as u,r as k,e as E}from"./iframe-YKw9nL_F.js";const{STORY_CHANGED:O,SELECT_STORY:L}=__STORYBOOK_MODULE_CORE_EVENTS__,{global:T}=__STORYBOOK_MODULE_GLOBAL__,{makeDecorator:y,addons:h}=__STORYBOOK_MODULE_PREVIEW_API__;var C="links",{document:c,HTMLElement:R}=T;function v(e){let t={},a=(e[0]==="?"?e.substring(1):e).split("&").filter(Boolean);for(let n=0;n<a.length;n++){let i=a[n].split("=");t[decodeURIComponent(i[0])]=decodeURIComponent(i[1]||"")}return t}var p=e=>h.getChannel().emit(L,e),D=(e,t)=>new Promise(a=>{let{location:n}=c,i=v(n.search).id,s=e||i.split("--",2)[0],l=`/story/${u(s,t)}`,o=n.pathname.replace(/iframe\.html$/,""),f=`${n.origin+o}?${Object.entries({path:l}).map(d=>`${d[0]}=${d[1]}`).join("&")}`;a(f)}),m=e=>{let{target:t}=e;if(!(t instanceof R))return;let a=t,{sbKind:n,sbStory:i}=a.dataset;(n||i)&&(e.preventDefault(),p({kind:n,story:i}))},r=!1,K=()=>{r||(r=!0,c.addEventListener("click",m))},g=()=>{r&&(r=!1,c.removeEventListener("click",m))};y({name:"withLinks",parameterName:C,wrapper:(e,t)=>(K(),h.getChannel().once(O,g),e(t))});var b=0,S=e=>e.button===b&&!e.altKey&&!e.ctrlKey&&!e.metaKey&&!e.shiftKey,U=(e,t=a=>{})=>{S(e)&&(e.preventDefault(),t(e))},_=class extends k.PureComponent{constructor(){super(...arguments),this.state={href:"/"},this.updateHref=async()=>{let{kind:e,title:t=e,story:a,name:n=a}=this.props;if(t&&n){let i=await D(t,n);this.setState({href:i})}},this.handleClick=()=>{let{kind:e,title:t=e,story:a,name:n=a}=this.props;t&&n&&p({title:t,name:n})}}componentDidMount(){this.updateHref()}componentDidUpdate(e){let{kind:t,title:a,story:n,name:i}=this.props;(e.kind!==t||e.story!==n||e.title!==a||e.name!==i)&&this.updateHref()}render(){let{kind:e,title:t=e,story:a,name:n=a,children:i,...s}=this.props,{href:l}=this.state;return E.createElement("a",{href:l,onClick:o=>U(o,this.handleClick),...s},i)}};_.defaultProps={children:void 0};var M=_;export{M as r};
