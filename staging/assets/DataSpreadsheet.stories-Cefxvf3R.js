import{p as ge,o as re,j as x,l as on,q as gt,r as cn,t as ln,v as un}from"./settings-RejM0MIl.js";import{r as u,R as mn}from"./index-BwDkhjyp.js";import{useMDXComponents as Kt}from"./index-DlpNa54Y.js";import"./chunk-HLWAVYOI-Z7f8NcXw.js";import{e as dn,i as hn,C as pn}from"./index-Dh254eKQ.js";import{c as ye}from"./floating-ui.react-DMp4y4mM.js";import{O as fn,a as gn}from"./index-CDqmW12E.js";import{a as xe,d as me,i as wt,h as wn,b as yn,F as bn,s as Ft,u as xn,r as Ge}from"./index.esm-BLQX69od.js";import{P as o}from"./index-Dk74W0Oi.js";import{u as Ue}from"./uuidv4-BQrI85uz.js";import{p as ve}from"./props-helper-MxF4Ec7y.js";import{u as Qe}from"./usePreviousValue-DDnp_zt4.js";import{g as Sn}from"./devtools-DM-SaWXd.js";import{g as Dn}from"./getNodeTextContent-C8IeKkUQ.js";import"./_commonjsHelpers-BosuxZz1.js";import"./index-CJvxHwuA.js";import"./events-C3mJejkM.js";import"./index-CzgULgXp.js";import"./iframe-D7LytXOE.js";import"../sb-preview/runtime.js";import"./react-18-Dd3bHtks.js";import"./index-BONylQH5.js";import"./extends-CCbyfPlC.js";import"./index-C2eUe6cH.js";import"./index-C0xX6qoh.js";import"./index-DrFu-skq.js";import"./Text-DgK8TUAU.js";import"./index-C8dDhlyb.js";import"./useAttachedMenu-JDAsPBX5.js";import"./mergeRefs-CTUecegF.js";import"./bucket-12-jEhP6zSm.js";import"./wrapFocus-CuszVIVc.js";const An=()=>{const[e,t]=u.useState(document.activeElement),r=()=>{t(document.activeElement)};return u.useEffect(()=>(document.addEventListener("focusin",r),()=>{document.removeEventListener("focusin",r)}),[]),e},_n=({spreadsheetRef:e,activeCellCoordinates:t,containerHasFocus:r,createActiveCell:a,activeCellContent:s,isActiveHeaderCellChanged:d})=>{let c;u.useEffect(()=>{c()},[s,c,d]),c=u.useCallback(()=>{const m=e==null?void 0:e.current.querySelector(`[data-row-index="${t==null?void 0:t.row}"][data-column-index="${t==null?void 0:t.column}"]`),i=(t==null?void 0:t.row)==="header"&&!0,h=e==null?void 0:e.current.querySelector('[data-row-index="header"][data-column-index="header"]');r&&a({placementElement:t?m:h,coords:t,addToHeader:i})},[e,t,r,a])},Hn=({blockClass:e=`${ge.prefix}--data-spreadsheet`,focusedElement:t,removeActiveCell:r,setContainerHasFocus:a})=>{u.useEffect(()=>{t.classList.contains(`${e}--interactive-cell-element`)||(a(!1),r()),(t.classList.contains(e)||t.classList.contains(`${e}--interactive-cell-element`))&&a(!0)},[t,r,e,a])},Tn=({isBlurSpreadsheet:e,spreadsheetRef:t,blockClass:r=`${ge.prefix}--data-spreadsheet`,setActiveCellCoordinates:a,setSelectionAreas:s,removeActiveCell:d,setContainerHasFocus:c,removeCellEditor:m})=>{u.useEffect(()=>{const i=h=>{!t.current||t.current.contains(h.target)||h.target.classList.contains(`${r}__active-cell--highlight`)||h.target.classList.contains(`${r}--interactive-cell-element`)||(e.current=!0,a(null),s([]),d(),xe({spreadsheetRef:t}),c(!1))};return document.addEventListener("click",i),()=>{document.removeEventListener("click",i)}},[e,t,d,r,a,c,s,m])},In=({isEditing:e,rows:t,activeCellCoordinates:r,activeCellRef:a,cellEditorRef:s,cellEditorRulerRef:d,visibleColumns:c,defaultColumn:m,cellEditorValue:i,blockClass:h=`${ge.prefix}--data-spreadsheet`})=>{const[D,_]=u.useState(null),p=Qe({nextIndex:D});u.useEffect(()=>{p!=null&&p.nextIndex||_(r==null?void 0:r.column)},[p==null?void 0:p.nextIndex,r]),u.useEffect(()=>{var b,A,O,q,N;const f=d.current.offsetWidth,l=parseInt(s.current.style.width);if(e){const I=(b=t[r==null?void 0:r.row])==null?void 0:b.cells[r==null?void 0:r.column],B=a==null?void 0:a.current.style.left,w=a==null?void 0:a.current.style.top;if(s.current.style.left=B,s.current.style.top=w,s.current.style.display="block",s.current.style.height=a==null?void 0:a.current.style.height,s.current.style.paddingTop=`${(parseInt(a==null?void 0:a.current.style.height)-16)/2-1}px`,s.current.style.textAlign=((A=I==null?void 0:I.column)==null?void 0:A.placement)==="right"?"right":"left",(O=s.current)==null||O.focus(),f<l){const T=((q=c[D])==null?void 0:q.width)||(m==null?void 0:m.width);f<l-T&&(s.current.style.width=re(parseInt(s.current.style.width)-T),_(P=>P===0?P:P-1))}if(f>=l){_(U=>U===c.length-1?U:U+1);const P=D+1===c.length?0:((N=c[D+1])==null?void 0:N.width)||(m==null?void 0:m.width),M=r==null?void 0:r.row,J=(t.length-M)*m.rowHeight;s.current.style.maxHeight=re(J),s.current.style.width=re(P+l),s.current.style.height=re(s.current.scrollHeight),s.current.clientHeight===J-1?s.current.style.overflow="auto":s.current.style.overflow="hidden"}}e||(s.current.style.overflow="hidden",s.current.style.display="none",s.current.blur(),a.current.focus(),_(r==null?void 0:r.column))},[e,r,t,i,m,a,s,d,c,h,p==null?void 0:p.cellEditorValue,D])},$n=({currentMatcher:e,setSelectionAreas:t,selectedHeaderReorderActive:r,setSelectedHeaderReorderActive:a,setClickAndHoldActive:s,setValidStartingPoint:d,validStartingPoint:c,blockClass:m=`${ge.prefix}--data-spreadsheet`,ref:i,setHeaderCellHoldActive:h,setColumnOrder:D,visibleColumns:_,setActiveCellCoordinates:p,activeCellCoordinates:f,rows:l,defaultColumn:b,selectionAreas:A})=>{u.useEffect(()=>{const O=q=>{var I,B;let N=!1;if((I=A==null?void 0:A[0])!=null&&I.header&&A[0].header.type==="column"&&(N=!0),!c&&N){h(!1);const w=i.current.querySelector(`.${m}__selection-area--element`),T=i.current.querySelector(`.${m}__selection-area--element-cloned`);if(!T)return;if(T){const P=q.target.closest(`.${m}--interactive-cell-element`),M=parseInt==null?void 0:parseInt(P==null?void 0:P.getAttribute("data-column-index")),z=parseInt==null?void 0:parseInt(T==null?void 0:T.getAttribute("data-column-index-original")),U=A.filter(K=>(K==null?void 0:K.matcher)===e)[0].header.selectedIndexList;if(!i.current.querySelector(`[data-row-index="header"][data-column-index="${M}"]`))return;const n=i.current.querySelector(`[data-matcher-id="${e}"]`),$=i.current.getBoundingClientRect(),W=i.current.querySelector(`.${m}__list--container`).scrollLeft,E=M<z,j=M>z,ie=j?M-z:z-M;if(t(K=>{const k=me(K);if(z===M)return K;const Q=k.findIndex(ee=>ee.matcher===e);if(Q===-1)return K;if(!U.includes(M)){const ee=j?U.map(ae=>ae+ie):U.map(ae=>ae-ie);k[Q].header.selectedIndexList=ee,k[Q].point1.column=Math.min(...ee),k[Q].point2.column=Math.max(...ee)}return k[Q].areaCreated=!1,k}),!U.includes(M)){const K=U.length,k=Math.min(...U),Q=_.map(L=>L.id),ee=[...Q],ae=()=>{const L=[];return U.map(V=>L.push(Q[V])),L};ee.splice(k,K);const de=U.findIndex(L=>L===z),we=M-de;ee.splice(we,0,...ae()),D(ee);const be={...f,column:j?f.column+ie:f.column-ie};p(be);const ce=Array.from(i.current.querySelectorAll(`.${m}__th--selected-header`))[0].getBoundingClientRect().left-$.left+W,S=E?ce:M===z?n.style.left:ce;n.style.left=re(S)}const ue=i.current.querySelector(`.${m}__reorder-indicator-line`);ue==null||ue.remove(),T==null||T.remove(),(B=w==null?void 0:w.classList)==null||B.remove(`${m}__selection-area--element`),a(!1)}}if(c||q.type==="mouseup"){s(!1),d(!1);const w=q.target.closest(`.${m}__body--td`);if(w){const T={row:Number(w.getAttribute("data-row-index")),column:Number(w.getAttribute("data-column-index"))};t(P=>{const M=me(P),z=M.findIndex(J=>J.matcher===e);return z===-1?P:(M[z].point2=T,M[z].areaCreated=!1,M)})}}};return document.addEventListener("mouseup",O),()=>{document.removeEventListener("mouseup",O)}},[m,e,t,s,d,c,r,a,i,h,D,_,p,f,l,b,A])},qn=({blockClass:e=`${ge.prefix}--data-spreadsheet`,clonedSelectionElement:t,ref:r,spreadsheetCoords:a,leftScrollAmount:s})=>{const d=event.target.closest(`.${e}--interactive-cell-element`),c=d==null?void 0:d.getAttribute("data-column-index"),m=t==null?void 0:t.getAttribute("data-column-index-original"),i=d.getBoundingClientRect(),h=r.current.querySelector(`.${e}__reorder-indicator-line`),D=t==null?void 0:t.getAttribute("data-matcher-id"),_=r.current.querySelector(`[data-matcher-id="${D}"]`),p=r.current.querySelector(`.${e}__list--container`),f=10,l=120,b=100,{clientX:A}=event,{left:O,right:q}=p.getBoundingClientRect();if(A<l&&window.scrollBy(-f,0),A>window.innerWidth-b&&window.scrollBy(f,0),A>O&&A<O+l&&p.scrollBy(-f,0),A<q&&A>q-b&&p.scrollBy(f,0),Number(c)>Number(m)){const N=i.left-a.left+d.offsetWidth-2+s;h.style.left=re(N)}if(Number(c)<Number(m)){const N=i.left-a.left+s;h.style.left=re(N)}Number(c)===Number(m)&&(h.style.left=_.style.left)},Mn=({ref:e,blockClass:t=`${ge.prefix}--data-spreadsheet`,headerCellHoldActive:r,defaultColumn:a})=>{u.useEffect(()=>{const s=c=>{const m=e.current.querySelector(`.${t}__selection-area--element-cloned`);m&&e.current.addEventListener("mousemove",s);const i=e.current.getBoundingClientRect(),h=e.current.querySelector(`.${t}__list--container`),D=h.scrollLeft;qn({clonedSelectionElement:m,ref:e,spreadsheetCoords:i,leftScrollAmount:D}),e.current.getBoundingClientRect();const p=c.clientX-i.left,f=m==null?void 0:m.getAttribute("data-clone-offset-x"),l=h.scrollWidth,b=m.offsetWidth,A=Math.max(p-f,a==null?void 0:a.rowHeaderWidth),O=l-b>=A?A+D:l-b;O<i.right-40&&(m.style.left=re(O))};r&&e.current.addEventListener("mousemove",s);const d=e.current;return r||d==null||d.removeEventListener("mousemove",s),()=>{d==null||d.removeEventListener("mousemove",s)}})},qe=e=>{const t=Math.max(e.point1.row,e.point2.row),r=Math.max(e.point1.column,e.point2.column),a=Math.min(e.point1.row,e.point2.row),s=Math.min(e.point1.column,e.point2.column);return{greatestRowIndex:t,greatestColumnIndex:r,lowestColumnIndex:s,lowestRowIndex:a}},yt=({ref:e,area:t,blockClass:r,defaultColumn:a,selectionAreas:s,setSelectionAreas:d,setActiveCellInsideSelectionArea:c,visibleColumns:m})=>{const{lowestColumnIndex:i,lowestRowIndex:h,greatestColumnIndex:D,greatestRowIndex:_}=qe(t);(_-h>0||D-i>0)&&(c(!0),e.current.querySelector(`.${r}__active-cell--highlight`).setAttribute("data-selection-id",t.matcher));let p=0;m.forEach((w,T)=>{T>=i&&T<=D&&(p+=(w==null?void 0:w.width)||(a==null?void 0:a.width))});const l=(document.querySelector(`[data-row-index="${t.point1.row}"][data-column-index="${t.point1.column}"]`)||document.querySelector(`.${r}__body--td`)).offsetHeight,b=l*(_-h+1),A=document.querySelector(`.${r}__list--container`).firstElementChild,O=A.querySelector(`[data-row-index="${h}"][data-column-index="${i}"]`),q={top:O?O.getBoundingClientRect().top-A.getBoundingClientRect().top:h===0?0:l*h,left:O?O.getBoundingClientRect().left-A.getBoundingClientRect().left:i===0?0+(a.rowHeaderWidth-4):a.width*i+(a.rowHeaderWidth-4)},N=document.querySelector(`[data-matcher-id="${t.matcher}"]`)||document.createElement("div");N.classList.add(`${r}__selection-area--element`),N.setAttribute("data-matcher-id",t.matcher),N.style.width=re(p),N.style.height=re(b),N.style.left=re(q.left),N.style.top=re(q.top),A.appendChild(N);const I=me(s),B=I.findIndex(w=>w.matcher===t.matcher);I[B].areaCreated=!0,d(I)},Ce=(e,t,r)=>{const a=me(t),s=[];a.forEach(c=>{var h,D,_,p;const m=Math.max((h=c.point1)==null?void 0:h[r],(D=c.point2)==null?void 0:D[r]),i=Math.min((_=c.point1)==null?void 0:_[r],(p=c.point2)==null?void 0:p[r]);for(let f=i;f<=m;f++)s.push(f)});const d=[...new Set(s)];return!!(a!=null&&a.length&&d.includes(e))},Rt=(e,t,r,a)=>me(t).some(c=>{var f,l,b,A,O,q,N,I;const m=r==="column"?"row":"column",i=Math.min((f=c==null?void 0:c.point1)==null?void 0:f[m],(l=c==null?void 0:c.point2)==null?void 0:l[m]),h=Math.max((b=c==null?void 0:c.point1)==null?void 0:b[m],(A=c==null?void 0:c.point2)==null?void 0:A[m]),D=Math.min((O=c==null?void 0:c.point1)==null?void 0:O[r],(q=c==null?void 0:c.point2)==null?void 0:q[r]),_=Math.max((N=c==null?void 0:c.point1)==null?void 0:N[r],(I=c==null?void 0:c.point2)==null?void 0:I[r]),p=(a==null?void 0:a.length)-1===h&&i===0;for(let B=D;B<=_;B++)if(e===B&&p)return!0;return!1}),Xt=({type:e,headerGroup:t,scrollBarSizeValue:r,totalVisibleColumns:a,defaultColumn:s,totalColumnsWidth:d,visibleColumns:c})=>{const m=r+s.rowHeaderWidth;if(!a){if(e==="header")return re(parseInt(t.getHeaderGroupProps().style.width)+m);if(e!=="header")return d+m}if(a)return c.map((h,D)=>D<=a-1&&((h==null?void 0:h.width)||(s==null?void 0:s.width))).reduce((h,D)=>h+D,0)+m},Ke=(e,t)=>t=="cmd"?e.metaKey||e.ctrlKey:e[t],jn=({indexList:e,newIndex:t,activeCellIndex:r})=>{const a=t>r?r:Math.min(...e,t),s=t<r?r:Math.max(...e,t),d=[];for(let c=a;c<=s;c++)d.push(c);return[...d]},Je=({type:e,activeCellCoordinates:t,rows:r,columns:a,currentMatcher:s,setActiveCellCoordinates:d,setCurrentMatcher:c,setSelectionAreas:m,spreadsheetRef:i,index:h,isKeyboard:D,setSelectionAreaData:_,isHoldingCommandKey:p,isHoldingShiftKey:f})=>{p||(_([]),xe({spreadsheetRef:i}));const l=D?t==null?void 0:t.row:h,b=D?t==null?void 0:t.column:h,A={row:e==="column"?0:l,column:e==="column"?b:0},O={row:e==="column"?r.length-1:l,column:e==="column"?b:a.length-1},q=Ue();f||(d({row:e==="column"?0:l,column:e==="column"?b:0}),c(q));const N={point1:A,point2:O,areaCreated:!1,matcher:q,header:{type:e,selectedIndexList:[e==="column"?b:l]}};m(I=>{var w,T;const B=me(I);if(p){const M=B.filter(J=>{var U;return(U=J.header)==null?void 0:U.type}).filter(J=>{var U;return((U=J.header)==null?void 0:U.type)===e}),z=Ce(h,M,e);return M.length&&z?I:[...I,N]}if(f){const M=B.filter(E=>{var j;return(j=E.header)==null?void 0:j.type}).filter(E=>E.matcher===s)[0],z=Math.max(M==null?void 0:M.point1[e],M==null?void 0:M.point2[e],t==null?void 0:t[e]),J=e==="column"?b:l,U={row:z<J?r.length-1:0,column:b},C=me(I),n=C.findIndex(E=>E.matcher===s),$=jn({indexList:((T=(w=C[n])==null?void 0:w.header)==null?void 0:T.selectedIndexList)||[e==="column"?b:l],newIndex:J,activeCellIndex:t==null?void 0:t[e]}),X=E=>E<J?{row:e==="column"?0:Math.min(...$),column:e==="column"?Math.min(...$):0}:U,W=E=>E<J?U:{row:e==="column"?r.length-1:Math.max(...$),column:e==="column"?Math.max(...$):a.length-1};if(!t||typeof t>"u"){c(q);const E={point1:X(e==="column"?b:l),point2:W(e==="column"?b:l),areaCreated:!1,matcher:q,header:{type:e,selectedIndexList:[e==="column"?b:l]}};return d({row:e==="column"?0:l,column:e==="column"?b:0}),[E]}return C[n].point1=X(t==null?void 0:t[e]),C[n].point2=W(t==null?void 0:t[e]),C[n].areaCreated=!1,C[n].header.selectedIndexList=$,C}return[N]})},On=({activeCellInsideSelectionArea:e,activeCellCoordinates:t,activeCellRef:r,selectionAreas:a,updateActiveCellCoordinates:s})=>{if(!e)return;const d=r.current.getAttribute("data-selection-id"),c=a.findIndex(f=>f.matcher===d),m=a[c],{lowestColumnIndex:i,lowestRowIndex:h,greatestColumnIndex:D,greatestRowIndex:_}=qe(m),p={...t};if((t==null?void 0:t.row)<_&&s({coords:p,updatedValue:{row:(p==null?void 0:p.row)+1},optOutOfSelectionAreaUpdate:!0}),(t==null?void 0:t.row)===_&&((t==null?void 0:t.column)<D&&s({coords:p,updatedValue:{column:(p==null?void 0:p.column)+1,row:h},optOutOfSelectionAreaUpdate:!0}),(t==null?void 0:t.column)===D)){if(a.length>1)if(a[c+1]){r.current.setAttribute("data-selection-id",a[c+1].matcher);const f=a[c+1],{lowestColumnIndex:l,lowestRowIndex:b}=qe(f);s({coords:p,updatedValue:{column:l,row:b},optOutOfSelectionAreaUpdate:!0});return}else{r.current.setAttribute("data-selection-id",a[0].matcher);const f=a[0],{lowestColumnIndex:l,lowestRowIndex:b}=qe(f);s({coords:p,updatedValue:{column:l,row:b},optOutOfSelectionAreaUpdate:!0})}if(a.length===1)return s({coords:p,updatedValue:{column:i,row:h},optOutOfSelectionAreaUpdate:!0})}},kn=({activeCellInsideSelectionArea:e,activeCellCoordinates:t,activeCellRef:r,selectionAreas:a,updateActiveCellCoordinates:s})=>{if(!e)return;const d=r.current.getAttribute("data-selection-id"),c=a.findIndex(p=>p.matcher===d),m=a[c],{lowestColumnIndex:i,lowestRowIndex:h,greatestColumnIndex:D,greatestRowIndex:_}=qe(m);if((t==null?void 0:t.column)<D&&s({updatedValue:{column:(t==null?void 0:t.column)+1},optOutOfSelectionAreaUpdate:!0}),(t==null?void 0:t.column)===D&&((t==null?void 0:t.row)<_&&s({updatedValue:{column:i,row:(t==null?void 0:t.row)+1},optOutOfSelectionAreaUpdate:!0}),(t==null?void 0:t.row)===_)){if(a.length>1)if(a[c+1]){r.current.setAttribute("data-selection-id",a[c+1].matcher);const p=a[c+1],{lowestColumnIndex:f,lowestRowIndex:l}=qe(p);s({updatedValue:{column:f,row:l},optOutOfSelectionAreaUpdate:!0});return}else{r.current.setAttribute("data-selection-id",a[0].matcher);const p=a[0],{lowestColumnIndex:f,lowestRowIndex:l}=qe(p);s({updatedValue:{column:f,row:l},optOutOfSelectionAreaUpdate:!0})}if(a.length===1)return s({updatedValue:{column:i,row:h},optOutOfSelectionAreaUpdate:!0})}},bt=(e,t,r)=>{for(let a=e;a<=t;a++)r(a)},Ln=({activeCellCoordinates:e,selectionAreas:t,currentMatcher:r,rows:a,setActiveCellContent:s,updateData:d})=>{var f,l,b,A,O,q,N,I;if((e==null?void 0:e.column)==="header"||(e==null?void 0:e.row)==="header")return;const c=me(t),m=c.findIndex(B=>B.matcher===r),i=c[m],h=Math.min((f=i==null?void 0:i.point1)==null?void 0:f.column,(l=i==null?void 0:i.point2)==null?void 0:l.column),D=Math.max((b=i==null?void 0:i.point1)==null?void 0:b.column,(A=i==null?void 0:i.point2)==null?void 0:A.column),_=Math.min((O=i==null?void 0:i.point1)==null?void 0:O.row,(q=i==null?void 0:i.point2)==null?void 0:q.row),p=Math.max((N=i==null?void 0:i.point1)==null?void 0:N.row,(I=i==null?void 0:i.point2)==null?void 0:I.row);bt(h,D,B=>{bt(_,p,w=>{const T=a[w].cells[B];d(w,T==null?void 0:T.column.id,"")})}),s(null)},Xe=`${ge.prefix}--data-spreadsheet`,Nn=(e,t,r,...a)=>{const[s,d,c,m,i,h,D,_,p,f,l,b,A]=a;r.preventDefault();const q=r.target.closest(`.${Xe}__body--td`).classList.contains(`${Xe}__body--td`);A(q);const N=Ke(r,"cmd"),I=Ke(r,"shiftKey");h(!0);const B={row:e.row.index,column:t},w=Ue();if(D(!0),N)p.current.querySelector(`.${Xe}__active-cell--highlight`).setAttribute("data-selection-id",w),l(!0),m(B),_(w),i(P=>[...P,{point1:B,matcher:w}]);else if(I){h(!0);const T=me(c),P=T.findIndex(M=>M.matcher===s);if(P===-1)return;T[P].point1=d,T[P].point2=B,T[P].areaCreated=!1,T[P].matcher=s,i(T)}else b.current.style.display="none",l(!1),m(B),xe({spreadsheetRef:p}),i([{point1:B,matcher:w}]),_(w),f([])},Pn=(e,t,...r)=>{const[a,s,d]=r;if(a){const c={row:e.row.index,column:t};d(m=>{var D,_;const i=me(m),h=i.findIndex(p=>p.matcher===s);return h===-1||((D=i[h].point2)==null?void 0:D.row)===c.row&&((_=i[h].point2)==null?void 0:_.column)===c.column?m:(i[h].point2=c,i[h].areaCreated=!1,i)})}},Wn=(e,t,...r)=>{const[a,s,d,c,m,i,h,D]=r,_=Ke(t,"cmd");Je({type:"row",activeCellCoordinates:i,rows:h,columns:a,setActiveCellCoordinates:m,setCurrentMatcher:c,setSelectionAreas:d,spreadsheetRef:s,index:e,setSelectionAreaData:D,isHoldingCommandKey:_})},Vn=(e,...t)=>{const[r,a,s,d,c,m,i,h,D,_,p,f,l,b,A,O,q,N,I,B,w,T,P]=t,{key:M}=e;if(!A(M)&&(["ArrowLeft","ArrowUp","ArrowRight","ArrowDown"].indexOf(M)>-1&&_!=null&&_.length&&f.length<2&&!wt(f)&&(q([]),N([]),xe({spreadsheetRef:i})),(f==null?void 0:f.length)>1&&wn({activeCellCoordinates:s,event:e,keysPressedList:f,selectionAreas:_,currentMatcher:h,rows:m,setSelectionAreas:q,columns:c,updateActiveCellCoordinates:a,spreadsheetRef:i,removeCellSelections:xe,blockClass:Xe,setCurrentMatcher:I,usingMac:l}),f.length<2&&!wt(f)||s.row==="header"||s.column==="header"))switch(M){case"Backspace":case"Delete":{Ln({selectionAreas:_,currentMatcher:h,rows:m,setActiveCellContent:P,updateData:b,activeCellCoordinates:s});break}case"Enter":{On({activeCellInsideSelectionArea:r,activeCellCoordinates:s,activeCellRef:B,selectionAreas:_,updateActiveCellCoordinates:a});break}case"Home":case"End":{if(e.preventDefault(),yn(f,l))return;p({type:M});break}case"Tab":{if(r)return e.preventDefault(),kn({activeCellInsideSelectionArea:r,activeCellCoordinates:s,activeCellRef:B,selectionAreas:_,updateActiveCellCoordinates:a});q([]),d(),D(),T(!1),w(null);break}case"ArrowLeft":case"ArrowUp":case"ArrowRight":case"ArrowDown":O(M)}},v=`${ge.prefix}--data-spreadsheet`,et=u.forwardRef(({activeCellRef:e,columns:t,activeCellCoordinates:r,defaultColumn:a,defaultEmptyRowCount:s,getTableBodyProps:d,headerGroups:c,setCurrentColumns:m,id:i,onDataUpdate:h,renderRowHeader:D,renderRowHeaderDirection:_,hasCustomRowHeader:p,prepareRow:f,rows:l,selectionAreaData:b,setSelectionAreaData:A,setActiveCellCoordinates:O,selectedHeaderReorderActive:q,setSelectedHeaderReorderActive:N,selectionAreas:I,setContainerHasFocus:B,setSelectionAreas:w,scrollBarSize:T,totalColumnsWidth:P,clickAndHoldActive:M,setClickAndHoldActive:z,currentMatcher:J,setCurrentMatcher:U,onSelectionAreaChange:C,setActiveCellInsideSelectionArea:n,totalVisibleColumns:$,setHeaderCellHoldActive:X,setColumnOrder:W,visibleColumns:E},j)=>{const[ie,ue]=u.useState(!1),K=u.useRef(),k=Qe({selectionAreaData:b,clickAndHoldActive:M,rowHeight:a==null?void 0:a.rowHeight})||{};u.useEffect(()=>{j==null||j.current.style.setProperty(`--${v}--total-width`,re((P||0)+(T||0)))},[j,T,P]),u.useEffect(()=>{var S,L,V,Y;if(b!=null&&b.length){let H=!1;(((S=k==null?void 0:k.selectionAreaData)==null?void 0:S.length)!==(b==null?void 0:b.length)||((L=b==null?void 0:b[0])==null?void 0:L.cells.length)!==((Y=(V=k==null?void 0:k.selectionAreaData)==null?void 0:V[0])==null?void 0:Y.cells.length))&&(H=!0),(!M&&(k!=null&&k.clickAndHoldActive)||H)&&(C==null||C(b))}},[k==null?void 0:k.selectionAreaData,b,C,M,k==null?void 0:k.clickAndHoldActive]),u.useEffect(()=>{I&&I.length&&I.map(S=>{if(S.areaCreated){const L=Math.min(S.point1.row,S.point2.row),V=Math.max(S.point1.row,S.point2.row),Y=Math.min(S.point1.column,S.point2.column),H=Math.max(S.point1.column,S.point2.column),Z={rows:{start:L,end:V},columns:{start:Y,end:H},cells:Q({rowStart:L,rowEnd:V,columnStart:Y,columnEnd:H}),selectionId:S.matcher};A==null||A(R=>[...me(R).filter(he=>he.selectionId!==S.matcher),Z])}!S.areaCreated&&S.point1&&S.point2&&S.matcher&&yt({ref:j,area:S,blockClass:v,defaultColumn:a,selectionAreas:I,setSelectionAreas:w,setActiveCellInsideSelectionArea:n,visibleColumns:E})})},[I,w,a,C,A,j,r,n,E,p]);const Q=({rowStart:S,rowEnd:L,columnStart:V,columnEnd:Y})=>{const H=[];for(let Z=S;Z<=L;Z++)for(let R=V;R<=Y;R++)H.push([Z,R,`${v}__cell--${Z}--${R}`]);return H};$n({currentMatcher:J,setClickAndHoldActive:z,setSelectionAreas:w,setValidStartingPoint:ue,selectedHeaderReorderActive:q,setSelectedHeaderReorderActive:N,validStartingPoint:ie,ref:j,setHeaderCellHoldActive:X,setColumnOrder:W,visibleColumns:E,setActiveCellCoordinates:O,rows:l,activeCellCoordinates:r,defaultColumn:a,selectionAreas:I}),u.useEffect(()=>{let S,L;if(ce!=null&&ce.current&&(S=ce==null?void 0:ce.current,L=S==null?void 0:S.querySelector(`.${v}__active-cell--highlight`)),L&&(a==null?void 0:a.rowHeight)!==k.rowHeight&&(L.style.height=`${a==null?void 0:a.rowHeight}px`,r)){const V=j==null?void 0:j.current.querySelector(`[data-row-index="${r.row}"][data-column-index="${r.column}"]`),Y=j==null?void 0:j.current.querySelector(`.${v}__list--container`);let H;V&&Y&&(H=(V==null?void 0:V.getBoundingClientRect().top)-Y.getBoundingClientRect().top),L.style.top=re(H),xe({matcher:void 0,spreadsheetRef:j}),I==null||I.map(Z=>{if(!Z.areaCreated&&Z.point1&&Z.point2&&Z.matcher)return yt({ref:j,area:Z,blockClass:v,defaultColumn:a,selectionAreas:I,setSelectionAreas:w,setActiveCellInsideSelectionArea:n,visibleColumns:E})})}},[a,j,r,k==null?void 0:k.rowHeight,I,n,w,E,p]);const ee=u.useCallback(()=>{const S=[],L=[];j==null||j.current.querySelectorAll(`.${v}__selection-area--element`).forEach(V=>{const{top:Y,left:H,height:Z,width:R}=V.style,fe=`${Y}${H}${Z}${R}`;S.indexOf(fe)==-1?S.push(fe):(V.remove(),L.push(V.getAttribute("data-matcher-id")))}),L.length&&(w==null||w(V=>me(V).filter(H=>!L.includes(H.matcher))),A==null||A(V=>me(V).filter(H=>!L.includes(H.selectionId))))},[j,w,A]);u.useEffect(()=>{ee()},[I,ee]);const ae=u.useCallback((S,L)=>V=>{Nn(S,L,V,J,r,I,O,w,B,z,U,j,A,n,e,ue)},[J,r,I,O,w,B,z,U,j,A,n,e]),de=()=>{const S=j.current.querySelector(`
        .${v}__header--container .${v}__tr`)||new HTMLDivElement;S.scrollLeft=K==null?void 0:K.current.scrollLeft};u.useEffect(()=>{K.current.addEventListener("scroll",()=>de());const S=K.current||new HTMLElement;return()=>{S.removeEventListener("scroll",de)}});const we=u.useCallback((S,L)=>()=>{Pn(S,L,M,J,w)},[M,J,w]),be=u.useCallback(S=>L=>{Wn(S,L,t,j,w,U,O,r,l,A)},[t,j,w,U,O,r,l,A]);u.useEffect(()=>{if(l!=null&&l.length||(()=>{const L=[];[...Array(s)].map(()=>{var Y;const V={};(Y=c==null?void 0:c[0])==null||Y.headers.map(H=>{V[H.id]=null}),L.push(V)}),h==null||h(L)})(),c!=null&&c[0]&&typeof m=="function"){const S=c[0].headers;m(S)}},[l,c,s,h,m]);const Se=()=>x.jsx("div",{}),Ae=u.useCallback(({index:S,style:L})=>{const V=l==null?void 0:l[S];if(l&&l.length){f==null||f(V);const Y=ve(V.getRowProps({style:L}),"key");return x.jsxs("div",{...Y,className:ye(`${v}__tr`),"data-row-index":S,"aria-rowindex":S+1,"aria-owns":`${v}__cell-editor-text-area`,children:[x.jsx("div",{role:"rowheader",className:`${v}__td-th--cell-container`,children:x.jsxs("button",{id:`${v}__cell--${S}--header`,tabIndex:-1,"data-row-index":S,"data-column-index":"header",type:"button",onClick:be(S),className:ye(`${v}__td`,`${v}__td-th`,`${v}--interactive-cell-element`,{[`${v}__td_custom`]:!!p,[`${v}__td-th--active-header`]:!p&&((r==null?void 0:r.row)===S||Ce(S,I,"row")),[`${v}__td-th--selected-header`]:!p&&Rt(S,I,"row",t)}),style:{width:a==null?void 0:a.rowHeaderWidth,flexDirection:p?_==="Left"?"row-reverse":V:void 0},children:[S+1,p&&typeof D=="function"&&D(S)]})}),V.cells.map((H,Z)=>{var fe;const R=ve(H.getCellProps(),"key");return x.jsx("div",{"aria-colindex":Z+1,...R,role:"gridcell",style:{...H.getCellProps().style,display:"grid",minWidth:((fe=H==null?void 0:H.column)==null?void 0:fe.width)||(a==null?void 0:a.width)},children:x.jsx("button",{id:`${v}__cell--${H.row.index}--${Z}`,tabIndex:-1,"data-row-index":H.row.index,"data-column-index":Z,className:ye(`${v}__td`,`${v}__body--td`,`${v}--interactive-cell-element`),onMouseDown:ae(H,Z),onMouseOver:we(H,Z),onFocus:()=>{},type:"button",children:H.render("Cell")})},`cell_${Z}`)})]},{...V.getRowProps().key})}},[f,D,_,l,p,r==null?void 0:r.row,I,be,ae,we,a,t]),ce=u.useRef();return x.jsx("div",{ref:ce,className:ye(`${v}__body--container`),...d==null?void 0:d(),children:x.jsx(bn,{className:ye(`${v}__list--container`,`${v}__list--container--${i}`),height:400,itemCount:(l==null?void 0:l.length)||s,itemSize:a==null?void 0:a.rowHeight,width:Xt({headerGroup:void 0,type:void 0,scrollBarSizeValue:T,totalVisibleColumns:$,defaultColumn:a,totalColumnsWidth:P,visibleColumns:E}),outerRef:K,children:l!=null&&l.length?Ae:Se})})});et.propTypes={activeCellCoordinates:o.shape({row:o.oneOfType([o.string,o.number]),column:o.oneOfType([o.string,o.number])}),activeCellRef:o.object,clickAndHoldActive:o.bool,columns:o.array,currentMatcher:o.string,defaultColumn:o.shape({rowHeight:o.number,rowHeaderWidth:o.number,width:o.number}),defaultEmptyRowCount:o.number,getTableBodyProps:o.func,hasCustomRowHeader:o.bool,headerGroups:o.arrayOf(o.object),id:o.oneOfType([o.number,o.string]),onActiveCellChange:o.func,onDataUpdate:o.func,onSelectionAreaChange:o.func,prepareRow:o.func,renderRowHeader:o.func,renderRowHeaderDirection:o.string,rows:o.arrayOf(o.object),scrollBarSize:o.number,selectedHeaderReorderActive:o.bool,selectionAreaData:o.array,selectionAreas:o.array,setActiveCellCoordinates:o.func,setActiveCellInsideSelectionArea:o.func,setClickAndHoldActive:o.func,setColumnOrder:o.func,setContainerHasFocus:o.func,setCurrentColumns:o.func,setCurrentMatcher:o.func,setHeaderCellHoldActive:o.func,setSelectedHeaderReorderActive:o.func,setSelectionAreaData:o.func,setSelectionAreas:o.func,totalColumnsWidth:o.number,totalVisibleColumns:o.number,visibleColumns:o.array};et.__docgenInfo={description:"",methods:[],displayName:"DataSpreadsheetBody",props:{activeCellCoordinates:{required:!1,tsType:{name:"union",raw:"ActiveCellCoordinates | null",elements:[{name:"ActiveCellCoordinates"},{name:"null"}]},description:"Object containing the active cell coordinates",type:{name:"shape",value:{row:{name:"union",value:[{name:"string"},{name:"number"}],required:!1},column:{name:"union",value:[{name:"string"},{name:"number"}],required:!1}}}},activeCellRef:{required:!1,tsType:{name:"MutableRefObject",elements:[{name:"union",raw:"HTMLElement | undefined",elements:[{name:"HTMLElement"},{name:"undefined"}]}],raw:"MutableRefObject<HTMLElement | undefined>"},description:"This is the ref of the button input, which is the active cell element",type:{name:"object"}},clickAndHoldActive:{required:!1,tsType:{name:"boolean"},description:"Is the user clicking and holding in the data spreadsheet body",type:{name:"bool"}},columns:{required:!1,tsType:{name:"unknown"},description:"All of the spreadsheet columns",type:{name:"array"}},currentMatcher:{required:!1,tsType:{name:"string"},description:"This represents the id of the current cell selection area",type:{name:"string"}},defaultColumn:{required:!1,tsType:{name:"SpreadsheetColumn"},description:"Default spreadsheet sizing values",type:{name:"shape",value:{rowHeight:{name:"number",required:!1},rowHeaderWidth:{name:"number",required:!1},width:{name:"number",required:!1}}}},defaultEmptyRowCount:{required:!1,tsType:{name:"number"},description:"Sets the number of empty rows to be created when there is no data provided",type:{name:"number"}},getTableBodyProps:{required:!1,tsType:{name:"signature",type:"function",raw:"(propGetter?: TableBodyPropGetter<any>) => TableBodyProps",signature:{arguments:[{type:{name:"TableBodyPropGetter",elements:[{name:"any"}],raw:"TableBodyPropGetter<any>"},name:"propGetter"}],return:{name:"TableBodyProps"}}},description:"Function to set table body prop values",type:{name:"func"}},headerGroups:{required:!1,tsType:{name:"Array",elements:[{name:"any"}],raw:"any[]"},description:"Headers provided from useTable hook",type:{name:"arrayOf",value:{name:"object"}}},id:{required:!1,tsType:{name:"union",raw:"number | string",elements:[{name:"number"},{name:"string"}]},description:"The spreadsheet id",type:{name:"union",value:[{name:"number"},{name:"string"}]}},setCurrentColumns:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"Array",elements:[{name:"object"}],raw:"object[]"}],raw:"SetStateAction<object[]>"}],raw:"Dispatch<SetStateAction<object[]>>"},description:"Set current columns after drag drop",type:{name:"func"}},onActiveCellChange:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"The event handler that is called when the active cell changes",type:{name:"func"}},hasCustomRowHeader:{required:!1,tsType:{name:"boolean"},description:"Check if user is using custom component",type:{name:"bool"}},renderRowHeader:{required:!1,tsType:{name:"signature",type:"function",raw:"(index: number) => any[]",signature:{arguments:[{type:{name:"number"},name:"index"}],return:{name:"Array",elements:[{name:"any"}],raw:"any[]"}}},description:"Component next to numbering rows",type:{name:"func"}},renderRowHeaderDirection:{required:!1,tsType:{name:"string"},description:"Component next to numbering rows",type:{name:"string"}},onDataUpdate:{required:!1,tsType:{name:"signature",type:"function",raw:"({ ...args }) => void",signature:{arguments:[{name:""}],return:{name:"void"}}},description:"The event handler that is called to set the rows for the empty spreadsheet",type:{name:"func"}},onSelectionAreaChange:{required:!1,tsType:{name:"signature",type:"function",raw:"({ ...args }) => void",signature:{arguments:[{name:""}],return:{name:"void"}}},description:"The event handler that is called when the selection areas change",type:{name:"func"}},prepareRow:{required:!1,tsType:{name:"signature",type:"function",raw:"(...args) => void",signature:{arguments:[{name:"args",rest:!0}],return:{name:"void"}}},description:"Prepare row function from react-table",type:{name:"func"}},rows:{required:!1,tsType:{name:"Array",elements:[{name:"any"}],raw:"any[]"},description:"All of the spreadsheet row data",type:{name:"arrayOf",value:{name:"object"}}},scrollBarSize:{required:!1,tsType:{name:"number"},description:"The scrollbar width",type:{name:"number"}},selectionAreaData:{required:!1,tsType:{name:"Array",elements:[{name:"any"}],raw:"any[]"},description:"Array of selection area data",type:{name:"array"}},selectedHeaderReorderActive:{required:!1,tsType:{name:"boolean"},description:"Header reordering is active",type:{name:"bool"}},setSelectedHeaderReorderActive:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"boolean"}],raw:"SetStateAction<boolean>"}],raw:"Dispatch<SetStateAction<boolean>>"},description:"Set header reordering active or not",type:{name:"func"}},selectionAreas:{required:!1,tsType:{name:"Array",elements:[{name:"any"}],raw:"any[]"},description:"Array of selection areas",type:{name:"array"}},setActiveCellCoordinates:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"union",raw:"ActiveCellCoordinates | null",elements:[{name:"ActiveCellCoordinates"},{name:"null"}]}],raw:"SetStateAction<ActiveCellCoordinates | null>"}],raw:`Dispatch<
  SetStateAction<ActiveCellCoordinates | null>
>`},description:"Setter fn for activeCellCoordinates state value",type:{name:"func"}},setActiveCellInsideSelectionArea:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"boolean"}],raw:"SetStateAction<boolean>"}],raw:"Dispatch<SetStateAction<boolean>>"},description:"Setter fn for active cell inside of selection area",type:{name:"func"}},setClickAndHoldActive:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"boolean"}],raw:"SetStateAction<boolean>"}],raw:"Dispatch<SetStateAction<boolean>>"},description:"Setter fn for clickAndHold state value",type:{name:"func"}},setColumnOrder:{required:!1,tsType:{name:"signature",type:"function",raw:`(
  updater:
    | ((columnOrder: Array<IdType<any>>) => Array<IdType<any>>)
    | Array<IdType<any>>
) => void`,signature:{arguments:[{type:{name:"union",raw:`| ((columnOrder: Array<IdType<any>>) => Array<IdType<any>>)
| Array<IdType<any>>`,elements:[{name:"unknown"},{name:"Array",elements:[{name:"IdType",elements:[{name:"any"}],raw:"IdType<any>"}],raw:"Array<IdType<any>>"}]},name:"updater"}],return:{name:"void"}}},description:"Setter fn for column ordering, provided from react-table",type:{name:"func"}},setContainerHasFocus:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"boolean"}],raw:"SetStateAction<boolean>"}],raw:"Dispatch<SetStateAction<boolean>>"},description:"Setter fn for containerHasFocus state value",type:{name:"func"}},setCurrentMatcher:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"string"}],raw:"SetStateAction<string>"}],raw:"Dispatch<SetStateAction<string>>"},description:"Setter fn for currentMatcher state value",type:{name:"func"}},setHeaderCellHoldActive:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"boolean"}],raw:"SetStateAction<boolean>"}],raw:"Dispatch<SetStateAction<boolean>>"},description:"Setter fn for header cell hold active value",type:{name:"func"}},setSelectionAreaData:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"Array",elements:[{name:"object"}],raw:"object[]"}],raw:"SetStateAction<object[]>"}],raw:"Dispatch<SetStateAction<object[]>>"},description:"Setter fn for selectionAreaData state value",type:{name:"func"}},setSelectionAreas:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"Array",elements:[{name:"object"}],raw:"object[]"}],raw:"SetStateAction<object[]>"}],raw:"Dispatch<SetStateAction<object[]>>"},description:"Setter fn for selectionAreas state value",type:{name:"func"}},totalColumnsWidth:{required:!1,tsType:{name:"number"},description:"The total columns width",type:{name:"number"}},totalVisibleColumns:{required:!1,tsType:{name:"number"},description:`The total number of columns to be initially visible, additional columns will be rendered and
visible via horizontal scrollbar`,type:{name:"number"}},visibleColumns:{required:!1,tsType:{name:"Array",elements:[{name:"Column",elements:[{name:"object"}],raw:"Column<object>"}],raw:"Column<object>[]"},description:"Prop from react-table used to reorder columns",type:{name:"array"}}}};const ne=`${ge.prefix}--data-spreadsheet`,tt=u.forwardRef(({activeCellCoordinates:e,cellSize:t,columns:r,currentMatcher:a,defaultColumn:s,headerGroups:d,scrollBarSize:c,selectionAreas:m,selectedHeaderReorderActive:i,setSelectedHeaderReorderActive:h,setActiveCellCoordinates:D,setCurrentMatcher:_,setSelectionAreas:p,readOnlyTable:f,disableColumnSwapping:l,setSelectionAreaData:b,rows:A,totalVisibleColumns:O,updateActiveCellCoordinates:q,setHeaderCellHoldActive:N,headerCellHoldActive:I,selectAllAriaLabel:B,visibleColumns:w},T)=>{const[P,M]=u.useState(0),z=Qe({cellSize:t})||{};u.useEffect(()=>{var n;if((z==null?void 0:z.cellSize)!==t){const $=(n=T==null?void 0:T.current)==null?void 0:n.querySelector(`.${ne}__list--container`),W=($==null?void 0:$.scrollHeight)&&($==null?void 0:$.clientHeight)&&($==null?void 0:$.scrollHeight)>($==null?void 0:$.clientHeight)?0:c;$!=null&&$.getAttribute("tabIndex")||$==null||$.setAttribute("tabIndex","0"),M(W)}},[t,T,c,z==null?void 0:z.cellSize]);const J=n=>$=>{const X=Ke($,"cmd"),W=Ke($,"shiftKey");Je({type:"column",activeCellCoordinates:e,rows:A,columns:r,currentMatcher:a,setActiveCellCoordinates:D,setCurrentMatcher:_,setSelectionAreas:p,spreadsheetRef:T,index:n,isKeyboard:void 0,setSelectionAreaData:b,isHoldingCommandKey:X,isHoldingShiftKey:W})},U=()=>{Ft({ref:T,setCurrentMatcher:_,setSelectionAreas:p,rows:A,columns:r,activeCellCoordinates:e,updateActiveCellCoordinates:q})},C=n=>$=>{var we,be,Se,Ae,ce,S;if($.shiftKey)return;const X=m==null?void 0:m.filter(L=>(L==null?void 0:L.matcher)===a),W=T.current.querySelector(`[data-matcher-id="${(we=X==null?void 0:X[0])==null?void 0:we.matcher}"]`);W&&W.classList.add(`${ne}__selection-area--element`),typeof h=="function"&&h(!0);const E=$.clientX,j=$.target.getBoundingClientRect(),ie=$.target.getAttribute("data-column-index"),ue=E-j.left,K=Math.min(((Se=(be=X==null?void 0:X[0])==null?void 0:be.point1)==null?void 0:Se.column)||0,((ce=(Ae=X==null?void 0:X[0])==null?void 0:Ae.point2)==null?void 0:ce.column)||0),k=(W==null?void 0:W.getBoundingClientRect())||new DOMRect,Q=K<parseInt(ie)?ue+(j.left-(k==null?void 0:k.left)):ue,ee=(S=document==null?void 0:document.querySelector(`.${ne}__list--container`))==null?void 0:S.firstElementChild,ae=W==null?void 0:W.cloneNode(),de=W==null?void 0:W.cloneNode();de&&(de.className=`${ne}__reorder-indicator-line`,de.style.width=re(2)),ae.classList.add(`${ne}__selection-area--element-cloned`),ae.setAttribute("data-clone-offset-x",`${Q}`),ae.setAttribute("data-column-index-original",n),ee==null||ee.appendChild(ae),ee==null||ee.appendChild(de),N==null||N(!0)};return Mn({ref:T,headerCellHoldActive:I,defaultColumn:s}),x.jsx("div",{className:ye(`${ne}__header--container`),role:"rowgroup",children:d==null?void 0:d.map((n,$)=>{const X=ve(n.getHeaderGroupProps(),"key");return x.jsxs("div",{...X,style:{...n.getHeaderGroupProps().style,width:Xt({type:"header",headerGroup:n,scrollBarSizeValue:P,totalVisibleColumns:O,defaultColumn:s,totalColumnsWidth:void 0,visibleColumns:w}),overflow:"hidden"},className:`${ne}__tr`,children:[x.jsx("div",{role:"columnheader",className:`${ne}__select-all-cell-container`,style:{width:s==null?void 0:s.rowHeaderWidth,height:s==null?void 0:s.rowHeight},children:x.jsx("button",{id:`${ne}__cell--header--header`,"data-row-index":"header","data-column-index":"header",type:"button",style:{width:s==null?void 0:s.rowHeaderWidth},tabIndex:-1,"aria-label":B,onClick:U,className:ye(`${ne}__th`,`${ne}--interactive-cell-element`,`${ne}__th--select-all`,{[`${ne}__th--active-header`]:(e==null?void 0:e.column)==="header"&&(e==null?void 0:e.row)==="header"}),children:"Â "})}),n.headers.map((W,E)=>{const j=ve(W.getHeaderProps(),"key"),ie=Rt(E,m,"column",A);return x.jsx("div",{role:"columnheader",className:`${ne}__columnheader`,...j,children:x.jsx("button",{id:`${ne}__cell--header--${E}`,"data-row-index":"header","data-column-index":E,tabIndex:-1,onMouseDown:ie&&!f&&!l?C(E):void 0,onMouseUp:ie&&!f&&!l&&typeof h=="function"?()=>h(!1):void 0,onClick:ie?void 0:J(E),style:{height:s==null?void 0:s.rowHeight,width:(W==null?void 0:W.width)||(s==null?void 0:s.width)},className:ye(`${ne}__th`,`${ne}--interactive-cell-element`,{[`${ne}__th--active-header`]:(e==null?void 0:e.column)===E||Ce(E,m,"column"),[`${ne}__th--active-header-disabledSwapping`]:l||f,[`${ne}__th--selected-header`]:ie,[`${ne}__th--selected-header-reorder-active`]:i}),type:"button",children:W.render("Header")})},`column_${E}`)})]},`header_${$}`)})})});tt.propTypes={activeCellCoordinates:o.shape({row:o.oneOfType([o.number,o.string]),column:o.oneOfType([o.number,o.string])}),cellSize:o.oneOf(["xs","sm","md","lg"]),columns:o.array,currentMatcher:o.string,defaultColumn:o.shape({rowHeight:o.number,rowHeaderWidth:o.number,width:o.number}),disableColumnSwapping:o.bool,headerCellHoldActive:o.bool,headerGroups:o.arrayOf(o.object),readOnlyTable:o.bool,rows:o.arrayOf(o.object),scrollBarSize:o.number,selectAllAriaLabel:o.string.isRequired,selectedHeaderReorderActive:o.bool,selectionAreas:o.arrayOf(o.object),setActiveCellCoordinates:o.func,setCurrentMatcher:o.func,setHeaderCellHoldActive:o.func,setSelectedHeaderReorderActive:o.func,setSelectionAreaData:o.func,setSelectionAreas:o.func,totalVisibleColumns:o.number,updateActiveCellCoordinates:o.func,visibleColumns:o.array};tt.__docgenInfo={description:"",methods:[],displayName:"DataSpreadsheetHeader",props:{activeCellCoordinates:{required:!1,tsType:{name:"union",raw:"ActiveCellCoordinates | null",elements:[{name:"ActiveCellCoordinates"},{name:"null"}]},description:"Object containing the active cell coordinates",type:{name:"shape",value:{row:{name:"union",value:[{name:"number"},{name:"string"}],required:!1},column:{name:"union",value:[{name:"number"},{name:"string"}],required:!1}}}},cellSize:{required:!1,tsType:{name:"union",raw:"'xs' | 'sm' | 'md' | 'lg'",elements:[{name:"literal",value:"'xs'"},{name:"literal",value:"'sm'"},{name:"literal",value:"'md'"},{name:"literal",value:"'lg'"}]},description:"Specifies the cell height",type:{name:"enum",value:[{value:"'xs'",computed:!1},{value:"'sm'",computed:!1},{value:"'md'",computed:!1},{value:"'lg'",computed:!1}]}},disableColumnSwapping:{required:!1,tsType:{name:"boolean"},description:"Disable column swapping, default false",type:{name:"bool"}},columns:{required:!1,tsType:{name:"unknown"},description:"All of the spreadsheet columns",type:{name:"array"}},currentMatcher:{required:!1,tsType:{name:"string"},description:"uuid that corresponds to the current selection area",type:{name:"string"}},defaultColumn:{required:!1,tsType:{name:"SpreadsheetColumn"},description:"Default spreadsheet sizing values",type:{name:"shape",value:{rowHeight:{name:"number",required:!1},rowHeaderWidth:{name:"number",required:!1},width:{name:"number",required:!1}}}},headerCellHoldActive:{required:!1,tsType:{name:"boolean"},description:"Whether or not a click/hold is active on a header cell",type:{name:"bool"}},headerGroups:{required:!1,tsType:{name:"Array",elements:[{name:"any"}],raw:"any[]"},description:"Headers provided from useTable hook",type:{name:"arrayOf",value:{name:"object"}}},readOnlyTable:{required:!1,tsType:{name:"boolean"},description:"Read-only table",type:{name:"bool"}},rows:{required:!1,tsType:{name:"Array",elements:[{name:"object"}],raw:"object[]"},description:"All of the spreadsheet row data",type:{name:"arrayOf",value:{name:"object"}}},scrollBarSize:{required:!1,tsType:{name:"number"},description:"The scrollbar width",type:{name:"number"}},selectAllAriaLabel:{required:!0,tsType:{name:"string"},description:"The aria label applied to the Select all button",type:{name:"string"}},selectionAreas:{required:!1,tsType:{name:"Array",elements:[{name:"ItemType"}],raw:"ItemType[]"},description:"All of the cell selection area items",type:{name:"arrayOf",value:{name:"object"}}},setActiveCellCoordinates:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"union",raw:"ActiveCellCoordinates | null",elements:[{name:"ActiveCellCoordinates"},{name:"null"}]}],raw:"SetStateAction<ActiveCellCoordinates | null>"}],raw:`Dispatch<
  SetStateAction<ActiveCellCoordinates | null>
>`},description:"Setter fn for activeCellCoordinates value",type:{name:"func"}},selectedHeaderReorderActive:{required:!1,tsType:{name:"boolean"},description:"Header reordering is active",type:{name:"bool"}},setSelectedHeaderReorderActive:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"boolean"}],raw:"SetStateAction<boolean>"}],raw:"Dispatch<SetStateAction<boolean>>"},description:"Set header reordering active or not",type:{name:"func"}},setCurrentMatcher:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"string"}],raw:"SetStateAction<string>"}],raw:"Dispatch<SetStateAction<string>>"},description:"Setter fn for currentMatcher value",type:{name:"func"}},setHeaderCellHoldActive:{required:!1,tsType:{name:"signature",type:"function",raw:"(arg: boolean) => void",signature:{arguments:[{type:{name:"boolean"},name:"arg"}],return:{name:"void"}}},description:"Setter fn for header cell hold active value",type:{name:"func"}},setSelectionAreaData:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"Array",elements:[{name:"object"}],raw:"object[]"}],raw:"SetStateAction<object[]>"}],raw:"Dispatch<SetStateAction<object[]>>"},description:"Setter fn for selectionAreaData state value",type:{name:"func"}},setSelectionAreas:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"Array",elements:[{name:"object"}],raw:"object[]"}],raw:"SetStateAction<object[]>"}],raw:"Dispatch<SetStateAction<object[]>>"},description:"Setter fn for selectionAreas value",type:{name:"func"}},totalVisibleColumns:{required:!1,tsType:{name:"number"},description:`The total number of columns to be initially visible, additional columns will be rendered and
visible via horizontal scrollbar`,type:{name:"number"}},updateActiveCellCoordinates:{required:!1,tsType:{name:"signature",type:"function",raw:"(arg) => void",signature:{arguments:[{name:"arg"}],return:{name:"void"}}},description:"Function used to update the active cell coordinates",type:{name:"func"}},visibleColumns:{required:!1,tsType:{name:"Array",elements:[{name:"Column",elements:[{name:"object"}],raw:"Column<object>"}],raw:"Column<object>[]"},description:"Array of visible columns provided by react-table useTable hook",type:{name:"array"}}}};const Bn=({placementElement:e,coords:t,addToHeader:r=!1,contextRef:a,blockClass:s=`${ge.prefix}--data-spreadsheet`,onActiveCellChange:d,activeCellValue:c,activeCellRef:m,cellEditorRef:i,defaultColumn:h})=>{if(!t)return;const D=document.querySelector(`[data-row-index="${t.row}"][data-column-index="${t.column}"]`)||document.querySelector(`.${s}__body--td`),_=D.offsetWidth,p=D.offsetHeight,f=r?a==null?void 0:a.current.querySelector(`.${s}__header--container`):a==null?void 0:a.current.querySelector(`.${s}__list--container`).firstElementChild,l={top:e?e.getBoundingClientRect().top-f.getBoundingClientRect().top:t.row===0?0:p*t.row,left:e?e.getBoundingClientRect().left-f.getBoundingClientRect().left:t.column===0?0+(h.rowHeaderWidth-4):_*t.column+(h.rowHeaderWidth-4)},b=m==null?void 0:m.current;b.style.width=re(e?e==null?void 0:e.offsetWidth:_),b.style.height=re(e?e==null?void 0:e.offsetHeight:p),b.style.left=re(l.left),b.style.top=re(l.top),b.style.display="block",b.setAttribute("data-active-row-index",typeof(t==null?void 0:t.row)=="number"?t.row:"header"),b.setAttribute("data-active-column-index",typeof(t==null?void 0:t.column)=="number"?t.column:"header"),f.appendChild(b),b.focus(),r||f.appendChild(i.current),typeof(t==null?void 0:t.column)=="number"&&typeof(t==null?void 0:t.row)=="number"&&(d==null||d(c))},ze=e=>Number(e.replace("rem","")*on),En=e=>{switch(e){case"xs":return ze(un);case"sm":return ze(gt);case"md":return ze(ln);case"lg":return ze(cn);default:return ze(gt)}},zn=()=>{const e=document.createElement("div");e.setAttribute("style","width: 100px; height: 100px; overflow: scroll; position:absolute; top:-9999px;"),document.body.appendChild(e);const t=e.offsetWidth-e.clientWidth;return document.body.removeChild(e),t},Un=({activeCellCoordinates:e,cellEditorRulerRef:t,columns:r,previousState:a,removeCellEditor:s,rows:d,setActiveCellCoordinates:c,setCurrentMatcher:m,setSelectionAreas:i,spreadsheetRef:h,updateData:D})=>_=>{const{key:p}=_,f=({type:l})=>{const b=()=>{const q=a==null?void 0:a.activeCellCoordinates,N=d[q==null?void 0:q.row].cells[q==null?void 0:q.column];s(),D(q==null?void 0:q.row,N.column.id)};xe({spreadsheetRef:h}),b();const A=Ue(),O={row:l==="Enter"?e.row===d.length-1?e.row:e.row+1:e.row,column:l==="Tab"?e.column===r.length-1?e.column:e.column+1:e.column};i([{point1:O,point2:O,matcher:A,areaCreated:!1}]),m(A),t.current.textContent=""};p==="Enter"&&(f({type:"Enter"}),c(l=>({...l,row:l.row===d.length-1?l.row:l.row+1}))),p==="Tab"&&(_.preventDefault(),f({type:"Tab"}),c(l=>({...l,column:l.column===r.length-1?l.column:l.column+1})))},le=`${ge.prefix}--data-spreadsheet`,nt="DataSpreadsheet",Ie={columns:Object.freeze([]),data:Object.freeze([]),defaultEmptyRowCount:16,onDataUpdate:Object.freeze(()=>{}),onColDrag:Object.freeze(()=>{}),onActiveCellChange:Object.freeze(()=>{}),onSelectionAreaChange:Object.freeze(()=>{}),theme:"light"};let pe=mn.forwardRef(({cellSize:e="sm",className:t,columns:r=Ie.columns,data:a=Ie.data,defaultEmptyRowCount:s=Ie.defaultEmptyRowCount,onDataUpdate:d=Ie.onDataUpdate,onColDrag:c=Ie.onColDrag,id:m,onActiveCellChange:i=Ie.onActiveCellChange,onSelectionAreaChange:h=Ie.onSelectionAreaChange,renderRowHeader:D,renderRowHeaderDirection:_,disableColumnSwapping:p=!1,readOnlyTable:f=!1,selectAllAriaLabel:l,spreadsheetAriaLabel:b,theme:A,totalVisibleColumns:O,...q},N)=>{const I=u.useRef(null),B=u.useRef(),w=N||B,T=An(),[P,M]=u.useState(r),[z,J]=u.useState([]),[U,C]=u.useState(!1),[n,$]=u.useState(null),[X,W]=u.useState([]),[E,j]=u.useState([]),[ie,ue]=u.useState(!1),[K,k]=u.useState(""),[Q,ee]=u.useState(!1),[ae,de]=u.useState(""),[we,be]=u.useState(!1),[Se,Ae]=u.useState(!1),ce=u.useRef(!1),[S,L]=u.useState(!1),[V,Y]=u.useState(!1),H=Qe({activeCellCoordinates:n,isEditing:Q,cellEditorValue:ae,selectedHeaderReorderActive:Se})||{},Z=En(e),R=u.useRef(),[fe,Me]=u.useState(),he=u.useRef(),te=u.useRef(),Ye=typeof D=="function",rt=a.length.toString().length,je=u.useMemo(()=>({width:150,rowHeaderWidth:Ye?40+rt*8.56:64,rowHeight:Z}),[Z,Ye,rt]),{keysPressedList:at,usingMac:st}=xn({ref:I,containerHasFocus:U,isEditing:Q}),ot=u.useMemo(()=>zn(),[]),{getTableProps:vt,getTableBodyProps:Jt,headerGroups:ct,rows:se,totalColumnsWidth:Qt,prepareRow:Yt,setColumnOrder:Zt,visibleColumns:Ze}=Ge.useTable({columns:r,data:a,defaultColumn:je},Ge.useBlockLayout,Ge.useColumnOrder),Ee=u.useCallback((g,y,F)=>{d(G=>G.map((oe,De)=>De===g?{...G[g],[y]:ae||F}:oe))},[ae,d]);u.useEffect(()=>{const g=[];Object.keys(P).length>0&&Object.keys(P).forEach(y=>{typeof P[y].Header=="object"?P[y].column_name?g.push(P[y].column_name):g.push(Dn(P[y].Header)):P[y].Header&&g.push(P[y].Header)}),H.selectedHeaderReorderActive&&J(g),!H.selectedHeaderReorderActive&&z.length>0&&!we&&JSON.stringify(g)!==JSON.stringify(z)&&(c({headers:g,data:fe.props.data}),g.length===0&&J([]))},[H==null?void 0:H.selectedHeaderReorderActive,P,we,r,fe,c,z]);const Fe=u.useCallback(()=>{var y;const g=(y=w==null?void 0:w.current)==null?void 0:y.querySelector(`.${le}__active-cell--highlight`);g&&(g.style.display="none")},[w]),Te=u.useCallback(()=>{de(""),ee(!1),R!=null&&R.current&&(R.current.style.display="none")},[]);u.useEffect(()=>{const g=H==null?void 0:H.activeCellCoordinates;if(((g==null?void 0:g.row)!==(n==null?void 0:n.row)||(g==null?void 0:g.column)!==(n==null?void 0:n.column))&&Q){const y=se[Number(g==null?void 0:g.row)].cells[Number(g==null?void 0:g.column)];Te(),Ee(g==null?void 0:g.row,y.column.id,void 0),te!=null&&te.current&&(te.current.textContent="")}if((g==null?void 0:g.row)!==(n==null?void 0:n.row)||(g==null?void 0:g.column)!==(n==null?void 0:n.column)){if(n&&(n==null?void 0:n.row)!=="header"&&(n==null?void 0:n.column)!=="header"){const y=typeof(n==null?void 0:n.column)=="number"&&typeof(n==null?void 0:n.row)=="number"?se[n==null?void 0:n.row].cells[n==null?void 0:n.column]:null;Me(y?y.render("Cell"):null)}(n&&(n==null?void 0:n.row)==="header"||(n==null?void 0:n.column)==="header")&&(Me(null),L(y=>!y))}Q&&H.activeCellCoordinates&&ce.current&&(Me(H.cellEditorValue),ce.current=!1,Te())},[ce,n,H==null?void 0:H.activeCellCoordinates,H==null?void 0:H.cellEditorValue,Ee,se,Q,Te,fe]);const Gt=u.useCallback(({placementElement:g,coords:y,addToHeader:F=!1})=>{const G=typeof(y==null?void 0:y.column)=="number"&&typeof(y==null?void 0:y.row)=="number"?se[y==null?void 0:y.row].cells[y==null?void 0:y.column]:null,oe=G?Object.values(G.row.values)[y==null?void 0:y.column]:null;Bn({placementElement:g,coords:y,addToHeader:F,contextRef:w,blockClass:le,onActiveCellChange:i,activeCellValue:oe,activeCellRef:he,cellEditorRef:R,defaultColumn:je})},[w,se,i,je]);Hn({focusedElement:T,removeActiveCell:Fe,setContainerHasFocus:C}),Tn({isBlurSpreadsheet:ce,spreadsheetRef:w,setActiveCellCoordinates:$,setSelectionAreas:W,removeActiveCell:Fe,setContainerHasFocus:C,removeCellEditor:Te}),_n({spreadsheetRef:w,activeCellCoordinates:n,containerHasFocus:U,createActiveCell:Gt,activeCellContent:fe,isActiveHeaderCellChanged:S});const it=u.useCallback(()=>{Y(!1),n||$({column:"header",row:"header"})},[n]),_e=u.useCallback(({coords:g={...n},updatedValue:y,optOutOfSelectionAreaUpdate:F=!1})=>{const G={...g,...y};if($(G),G.row!=="header"&&G.column!=="header"&&!F){const oe=Ue();W([{point1:G,matcher:oe}]),k(oe)}},[n]),lt=u.useCallback(({type:g})=>{const y={...n};_e({coords:y,updatedValue:{column:g==="Home"?0:r.length-1}}),xe({matcher:void 0,spreadsheetRef:w})},[n,_e,w,r.length]),ut=u.useCallback(g=>Q||g==="Meta"||g==="Control",[Q]),mt=u.useCallback(g=>{event==null||event.preventDefault(),it();const y={...n};let F;switch(g){case"ArrowLeft":{if(y.column==="header")return;typeof y.column=="number"&&(y.column===0?F={column:"header"}:F={column:y.column-1});break}case"ArrowUp":{if(y.row==="header")return;typeof y.row=="number"&&(y.row===0?F={row:"header"}:F={row:y.row-1});break}case"ArrowRight":{if(y.column==="header"&&(F={column:0}),typeof y.column=="number"){if(r.length-1===y.column)return;F={column:y.column+1}}break}case"ArrowDown":{if(y.row==="header"&&(F={row:0}),typeof y.row=="number"){if(se.length-1===y.row)return;F={row:y.row+1}}break}}F&&_e({coords:y,updatedValue:F})},[it,_e,n,r,se]),Ct=u.useCallback(g=>{Vn(g,V,_e,n,Fe,r,se,w,K,Te,X,lt,at,st,Ee,ut,mt,W,j,k,he,$,C,Me,f)},[V,_e,n,Fe,r,se,w,K,Te,X,lt,at,st,Ee,ut,mt,f]),dt=()=>{var F,G,oe,De,ft;ee(!0),ue(!1);const g=typeof(n==null?void 0:n.column)=="number"&&typeof(n==null?void 0:n.row)=="number"?se[n==null?void 0:n.row].cells[n==null?void 0:n.column]:null,y=(oe=(G=(F=g==null?void 0:g.row)==null?void 0:F.cells)==null?void 0:G[Number(n==null?void 0:n.column)])==null?void 0:oe.value;de(y||""),te!=null&&te.current&&(te.current.textContent=y),R!=null&&R.current&&(he!=null&&he.current)&&(R.current.style.width=(ft=(De=he==null?void 0:he.current)==null?void 0:De.style)==null?void 0:ft.width)};u.useEffect(()=>{var g,y,F,G,oe,De;Q&&!(H!=null&&H.isEditing)&&((oe=R==null?void 0:R.current)==null||oe.setSelectionRange(Number((y=(g=te==null?void 0:te.current)==null?void 0:g.textContent)==null?void 0:y.length),Number((G=(F=te==null?void 0:te.current)==null?void 0:F.textContent)==null?void 0:G.length)),(De=R==null?void 0:R.current)==null||De.focus())},[Q,H==null?void 0:H.isEditing]);const en=()=>{if((n==null?void 0:n.row)==="header"||(n==null?void 0:n.column)==="header"){const g=(n==null?void 0:n.row)==="header"?n==null?void 0:n.column:n==null?void 0:n.row;if((n==null?void 0:n.row)==="header"&&(n==null?void 0:n.column)==="header")return;ht({isKeyboard:!1,index:Number(g)})}},tn=()=>{ue(!1)},nn=()=>{if((n==null?void 0:n.row)!=="header"||(n==null?void 0:n.column)!=="header"){const g=Ue();ue(!0),xe({matcher:null,spreadsheetRef:w}),W([{point1:n,matcher:g}]),k(g),j([]),Y(!1)}},rn=g=>{const{key:y}=g;y==="Enter"&&!V&&!f&&((n==null?void 0:n.column)!=="header"&&(n==null?void 0:n.row)!=="header"&&dt(),((n==null?void 0:n.row)==="header"||(n==null?void 0:n.column)==="header")&&ht({isKeyboard:!0}))},ht=({isKeyboard:g,index:y=-1})=>{const F={activeCellCoordinates:n,rows:se,columns:r,currentMatcher:K,setActiveCellCoordinates:$,setCurrentMatcher:k,setSelectionAreas:W,spreadsheetRef:w,index:y,isKeyboard:g,setSelectionAreaData:j,isHoldingCommandKey:null,isHoldingShiftKey:null};(n==null?void 0:n.row)==="header"&&(n==null?void 0:n.column)!=="header"&&Je({type:"column",...F}),(n==null?void 0:n.column)==="header"&&(n==null?void 0:n.row)!=="header"&&Je({type:"row",...F}),(n==null?void 0:n.column)==="header"&&(n==null?void 0:n.row)==="header"&&Ft({ref:w,setCurrentMatcher:k,setSelectionAreas:W,rows:se,columns:r,activeCellCoordinates:n,updateActiveCellCoordinates:_e})},an=g=>{g||dt()};In({isEditing:Q,rows:se,activeCellCoordinates:n,activeCellRef:he,cellEditorRef:R,cellEditorRulerRef:te,visibleColumns:Ze,defaultColumn:je,cellEditorValue:ae});const pt=u.useCallback((g,y)=>{K&&g&&g.length&&y&&K&&W(F=>{const G=me(F),oe=G.findIndex(De=>De.matcher===K);return oe===-1?F:typeof G[oe].point2=="object"&&G[oe].areaCreated?(G[oe].point2=G[oe].point1,G[oe].areaCreated=!1,Y(!1),xe({matcher:K,spreadsheetRef:w}),G):F})},[w,K]),sn=u.useCallback(()=>{pt(X,ie)},[ie,X,pt]);return x.jsx("div",{...q,...vt(),...Sn(nt),className:ye(le,t,`${le}--interactive-cell-element`,{[`${le}__container-has-focus`]:U,[`${le}__${A}`]:A==="dark"}),ref:w,role:"grid",tabIndex:0,"aria-rowcount":(se==null?void 0:se.length)||0,"aria-colcount":(r==null?void 0:r.length)||0,"aria-label":b,onKeyDown:Ct,onFocus:()=>C(!0),children:x.jsxs("div",{ref:I,children:[x.jsx(tt,{ref:w,activeCellCoordinates:n,cellSize:e,columns:r,currentMatcher:K,defaultColumn:je,selectedHeaderReorderActive:Se,setSelectedHeaderReorderActive:Ae,headerGroups:ct,rows:se,scrollBarSize:ot,selectionAreas:X,setActiveCellCoordinates:$,setSelectionAreas:W,setCurrentMatcher:k,setSelectionAreaData:j,disableColumnSwapping:p,readOnlyTable:f,totalVisibleColumns:O,updateActiveCellCoordinates:_e,setHeaderCellHoldActive:be,headerCellHoldActive:we,visibleColumns:Ze,selectAllAriaLabel:l}),x.jsx(et,{activeCellRef:he,activeCellCoordinates:n,setCurrentColumns:M,ref:w,clickAndHoldActive:ie,setClickAndHoldActive:ue,currentMatcher:K,setCurrentMatcher:k,setContainerHasFocus:C,selectedHeaderReorderActive:Se,setSelectedHeaderReorderActive:Ae,selectionAreas:X,setSelectionAreas:W,headerGroups:ct,defaultColumn:je,getTableBodyProps:Jt,hasCustomRowHeader:Ye,onDataUpdate:d,renderRowHeaderDirection:_,renderRowHeader:D,onActiveCellChange:i,onSelectionAreaChange:h,prepareRow:Yt,rows:se,selectionAreaData:E,setSelectionAreaData:j,setActiveCellCoordinates:$,scrollBarSize:ot,totalColumnsWidth:Qt,id:m,columns:r,defaultEmptyRowCount:s,setActiveCellInsideSelectionArea:Y,totalVisibleColumns:O,setHeaderCellHoldActive:be,setColumnOrder:Zt,visibleColumns:Ze}),x.jsx("button",{onMouseDown:nn,onMouseUp:tn,onClick:en,onKeyDown:rn,onDoubleClick:()=>an(f),onMouseEnter:sn,ref:he,className:ye(`${le}--interactive-cell-element`,`${le}__active-cell--highlight`,{[`${le}__active-cell--with-selection`]:V}),type:"button",children:fe}),x.jsx("textarea",{id:`${le}__cell-editor-text-area`,value:ae,onKeyDown:Un({activeCellCoordinates:n,cellEditorRulerRef:te,columns:r,previousState:H,removeCellEditor:Te,rows:se,setActiveCellCoordinates:$,setCurrentMatcher:k,setSelectionAreas:W,spreadsheetRef:w,updateData:Ee}),onChange:g=>{H.isEditing&&(de(g.target.value),te!=null&&te.current&&(te.current.textContent=g.target.value))},ref:R,"aria-labelledby":n?`${le}__cell--${n==null?void 0:n.row}--${n==null?void 0:n.column}`:"",className:ye(`${le}__cell-editor`,`${le}--interactive-cell-element`,`${le}__cell-editor--${e}`,{[`${le}__cell-editor--active`]:Q})}),x.jsx("pre",{"aria-hidden":!0,ref:te,className:`${le}__cell-editor-ruler`})]})})});pe=ge.checkComponentEnabled(pe,nt);pe.displayName=nt;pe.propTypes={cellSize:o.oneOf(["xs","sm","md","lg"]),className:o.string,columns:o.arrayOf(o.shape({Header:o.string,accessor:o.oneOfType([o.string,o.func]),Cell:o.func})),data:o.arrayOf(o.shape),defaultEmptyRowCount:o.number,disableColumnSwapping:o.bool,hasCustomRowHeader:o.bool,id:o.oneOfType([o.number,o.string]),onActiveCellChange:o.func,onColDrag:o.func,onDataUpdate:o.func,onSelectionAreaChange:o.func,readOnlyTable:o.bool,renderRowHeader:o.func,renderRowHeaderDirection:o.oneOf(["left","right"]),selectAllAriaLabel:o.string.isRequired,spreadsheetAriaLabel:o.string.isRequired,theme:o.oneOf(["light","dark"]),totalVisibleColumns:o.number};pe.__docgenInfo={description:"DataSpreadsheet: used to organize and display large amounts of structured data, separated by columns and rows in a grid-like format.",methods:[],displayName:"DataSpreadsheet",props:{cellSize:{required:!1,tsType:{name:"union",raw:"'xs' | 'sm' | 'md' | 'lg'",elements:[{name:"literal",value:"'xs'"},{name:"literal",value:"'sm'"},{name:"literal",value:"'md'"},{name:"literal",value:"'lg'"}]},description:"Specifies the cell height",defaultValue:{value:"'sm'",computed:!1},type:{name:"enum",value:[{value:"'xs'",computed:!1},{value:"'sm'",computed:!1},{value:"'md'",computed:!1},{value:"'lg'",computed:!1}]}},className:{required:!1,tsType:{name:"string"},description:"Provide an optional class to be applied to the containing node.",type:{name:"string"}},columns:{required:!1,tsType:{name:"unknown"},description:"The data that will build the column headers",defaultValue:{value:"Object.freeze([])",computed:!0},type:{name:"arrayOf",value:{name:"shape",value:{Header:{name:"string",required:!1},accessor:{name:"union",value:[{name:"string"},{name:"func"}],required:!1},Cell:{name:"func",required:!1}}}}},disableColumnSwapping:{required:!1,tsType:{name:"boolean"},description:"Disable column swapping, default false",defaultValue:{value:"false",computed:!1},type:{name:"bool"}},data:{required:!1,tsType:{name:"unknown"},description:"The spreadsheet data that will be rendered in the body of the spreadsheet component",defaultValue:{value:"Object.freeze([])",computed:!0},type:{name:"arrayOf",value:{name:"shape",value:"",computed:!0}}},defaultEmptyRowCount:{required:!1,tsType:{name:"number"},description:"Sets the number of empty rows to be created when there is no data provided",defaultValue:{value:"16",computed:!1},type:{name:"number"}},hasCustomRowHeader:{required:!1,tsType:{name:"boolean"},description:"Check if has custom row header component attached",type:{name:"bool"}},id:{required:!1,tsType:{name:"union",raw:"number | string",elements:[{name:"number"},{name:"string"}]},description:"The spreadsheet id",type:{name:"union",value:[{name:"number"},{name:"string"}]}},onActiveCellChange:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"The event handler that is called when the active cell changes",defaultValue:{value:"Object.freeze(() => {})",computed:!0},type:{name:"func"}},onColDrag:{required:!1,tsType:{name:"signature",type:"function",raw:"({ ...args }) => void",signature:{arguments:[{name:""}],return:{name:"void"}}},description:"Callback for columns after being dragged",defaultValue:{value:"Object.freeze(() => {})",computed:!0},type:{name:"func"}},onDataUpdate:{required:!1,tsType:{name:"signature",type:"function",raw:"({ ...args }) => void",signature:{arguments:[{name:""}],return:{name:"void"}}},description:"The setter fn for the data prop",defaultValue:{value:"Object.freeze(() => {})",computed:!0},type:{name:"func"}},onSelectionAreaChange:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"The event handler that is called when the selection area values change",defaultValue:{value:"Object.freeze(() => {})",computed:!0},type:{name:"func"}},readOnlyTable:{required:!1,tsType:{name:"boolean"},description:"Read-only table",defaultValue:{value:"false",computed:!1},type:{name:"bool"}},renderRowHeaderDirection:{required:!1,tsType:{name:"union",raw:"'left' | 'right'",elements:[{name:"literal",value:"'left'"},{name:"literal",value:"'right'"}]},description:"Position of the custom row numbering component",type:{name:"enum",value:[{value:"'left'",computed:!1},{value:"'right'",computed:!1}]}},renderRowHeader:{required:!1,tsType:{name:"signature",type:"function",raw:"(index: number) => any[]",signature:{arguments:[{type:{name:"number"},name:"index"}],return:{name:"Array",elements:[{name:"any"}],raw:"any[]"}}},description:"Component next to numbering rows",type:{name:"func"}},selectAllAriaLabel:{required:!0,tsType:{name:"string"},description:"The aria label applied to the Select all button",type:{name:"string"}},spreadsheetAriaLabel:{required:!0,tsType:{name:"string"},description:"The aria label applied to the Data spreadsheet component",type:{name:"string"}},theme:{required:!1,tsType:{name:"union",raw:"'light' | 'dark'",elements:[{name:"literal",value:"'light'"},{name:"literal",value:"'dark'"}]},description:"The theme the DataSpreadsheet should use (only used to render active cell/selection area colors on dark theme)",type:{name:"enum",value:[{value:"'light'",computed:!1},{value:"'dark'",computed:!1}]}},totalVisibleColumns:{required:!1,tsType:{name:"number"},description:`The total number of columns to be initially visible, additional columns will be rendered and
visible via horizontal scrollbar`,type:{name:"number"}}}};const xt=["dog","cat","bird","lizard","frog","hamster","fish","rabbit","snake"],Re=["Bruno","Willow","Kona","Heidi","Rusty","Bonnie","Cash","Gucci","Brody","Emma","Loki","Angel","Astro","Sherman","Layla","Peanut","Grace","Mickey","Sasha","Finn","Tucker","Bear","Mocha","Roscoe"],Kn=e=>{const t=[];for(let r=0;r<e;r++)t.push(r);return t},Fn=e=>{const t=e&&{ownerName:Re[Math.floor(Math.random()*Re.length)],weight:Math.floor(Math.random()*40)},r={petType:xt[Math.floor(Math.random()*xt.length)],firstName:Re[Math.floor(Math.random()*Re.length)],age:Math.floor(Math.random()*30),visits:Math.floor(Math.random()*40),health:Math.floor(Math.random()*100)};return e?{...r,...t}:r},Ve=({rows:e,extraColumns:t})=>((a=0)=>{const d=[e][a];return Kn(d).map(()=>({...Fn(t)}))})();function St(e){const t={a:"a",h1:"h1",h2:"h2",li:"li",ul:"ul",...Kt(),...e.components};return x.jsxs(x.Fragment,{children:[x.jsx(t.h1,{id:"dataspreadsheet",children:"DataSpreadsheet"}),`
`,x.jsx(t.h2,{id:"table-of-contents",children:"Table of Contents"}),`
`,x.jsxs(t.ul,{children:[`
`,x.jsx(t.li,{children:x.jsx(t.a,{href:"#overview",children:"Overview"})}),`
`,x.jsx(t.li,{children:x.jsx(t.a,{href:"#example-usage",children:"Example usage"})}),`
`,x.jsx(t.li,{children:x.jsx(t.a,{href:"#component-api",children:"Component API"})}),`
`]}),`
`,x.jsx(t.h2,{id:"overview",children:"Overview"}),`
`,`
`,x.jsx(t.h2,{id:"example-usage",children:"Example usage"}),`
`,`
`,x.jsx(dn,{children:x.jsx(hn,{of:$e})}),`
`,x.jsx(t.h2,{id:"code-sample",children:"Code sample"}),`
`,`
`,x.jsx(t.h2,{id:"component-api",children:"Component API"}),`
`,x.jsx(pn,{})]})}function Rn(e={}){const{wrapper:t}={...Kt(),...e.components};return t?x.jsx(t,{...e,children:x.jsx(St,{...e})}):St(e)}const Xn="div[data-story-title*=DataSpreadsheet] .docs-story>div:first-child>div:first-child{overflow:auto;width:100%}",kr={title:"Experimental/Components/Data spreadsheet/DataSpreadsheet",component:pe,tags:["autodocs"],argTypes:{onActiveCellChange:{action:"active cell change"},onColDrag:{action:"on column drag"},onSelectionAreaChange:{action:"selection area change"}},parameters:{styles:Xn,docs:{page:Rn}}},He=({value:e})=>x.jsx("span",{style:{display:"flex",justifyContent:"flex-end"},children:e}),vn=[{Header:"Row Index",accessor:(e,t)=>t,Cell:({cell:{value:e}})=>x.jsx(He,{value:e}),placement:"right",width:275},{Header:"Pet type",accessor:"petType"},{Header:x.jsx("div",{children:x.jsxs("div",{children:[x.jsx("span",{children:"First Name"}),"Â ",x.jsx("span",{children:"(Pets)"})]})}),accessor:"firstName",column_name:"First Name"},{Header:"Age",accessor:"age",Cell:({cell:{value:e}})=>x.jsx(He,{value:e}),placement:"right"},{Header:"Vet visits",accessor:"visits",Cell:({cell:{value:e}})=>x.jsx(He,{value:e}),placement:"right"},{Header:"Health",accessor:"health",Cell:({cell:{value:e}})=>x.jsx(He,{value:e}),placement:"right"}],Be=[{Header:"Row index",accessor:(e,t)=>t,Cell:({cell:{value:e}})=>x.jsx(He,{value:e}),placement:"right",width:275},{Header:"Pet Type",accessor:"petType"},{Header:"First Name",accessor:"firstName"},{Header:"Age",accessor:"age",Cell:({cell:{value:e}})=>x.jsx(He,{value:e}),placement:"right"},{Header:"Vet visits",accessor:"visits",Cell:({cell:{value:e}})=>x.jsx(He,{value:e}),placement:"right"},{Header:"Health",accessor:"health",Cell:({cell:{value:e}})=>x.jsx(He,{value:e}),placement:"right"}],Jn=({...e})=>{const[t,r]=u.useState(()=>Ve({rows:16})),a=u.useMemo(()=>Be,[]);return x.jsx(pe,{columns:a,data:t,onDataUpdate:r,id:"spreadsheet--id",...e})},Qn=({...e})=>{const[t,r]=u.useState(()=>Ve({rows:1e5})),a=u.useMemo(()=>Be,[]),s=d=>x.jsx(fn,{style:{width:"32px",height:"32px",minWidth:"32px",minHeight:"32px"},children:x.jsx(gn,{itemText:`Test item ${d}`})});return x.jsx(pe,{columns:a,data:t,onDataUpdate:r,renderRowHeaderDirection:"Left",renderRowHeader:s,id:"spreadsheet--id",...e})},Yn=({...e})=>{const[t,r]=u.useState(()=>Ve({rows:1e3})),a=u.useMemo(()=>Be,[]);return x.jsx(pe,{columns:a,data:t,onDataUpdate:r,id:"spreadsheet--id",...e})},Zn=({...e})=>{const[t,r]=u.useState([]),a=u.useMemo(()=>[...Be.filter(d=>d.Header!=="Row Index")],[]),s=u.useMemo(()=>a,[a]);return x.jsx(pe,{columns:s,data:t,onDataUpdate:r,id:"spreadsheet--id",...e})},Gn=({...e})=>{const[t,r]=u.useState(()=>Ve({rows:24,extraColumns:!0})),a=u.useMemo(()=>[...Be,{Header:"Owner name",accessor:"ownerName"},{Header:"Weight",accessor:"weight"}],[]),s=u.useMemo(()=>a,[a]);return x.jsx(pe,{columns:s,data:t,onDataUpdate:r,id:"spreadsheet--id",...e})},Cn=({...e})=>{const[t,r]=u.useState(()=>Ve({rows:24,extraColumns:!0})),a=u.useMemo(()=>[...Be,{Header:"Owner name",accessor:"ownerName"},{Header:"Weight",accessor:"weight"}],[]),s=u.useMemo(()=>a,[a]);return x.jsx(pe,{columns:s,data:t,onDataUpdate:r,id:"spreadsheet--id",...e})},er=({...e})=>{const[t,r]=u.useState(()=>Ve({rows:24,extraColumns:!0})),a=c=>{},s=u.useMemo(()=>[...vn,{Header:"Owner name",accessor:"ownerName"},{Header:"Weight",accessor:"weight"}],[]),d=u.useMemo(()=>s,[s]);return x.jsx(pe,{columns:d,data:t,onDataUpdate:r,onColDrag:a,id:"spreadsheet--id",...e})},$e=Jn.bind({});$e.storyName="Basic spreadsheet";$e.args={selectAllAriaLabel:"Select all",spreadsheetAriaLabel:"Example data spreadsheet"};const Oe=Yn.bind({});Oe.storyName="Large dataset";Oe.args={cellSize:"lg",selectAllAriaLabel:"Select all",spreadsheetAriaLabel:"Example data spreadsheet"};const ke=Qn.bind({});ke.storyName="Large dataset with optional component";ke.args={cellSize:"lg",selectAllAriaLabel:"Select all",spreadsheetAriaLabel:"Example data spreadsheet"};const Le=Zn.bind({});Le.storyName="Empty with cells";Le.args={defaultEmptyRowCount:24,selectAllAriaLabel:"Select all",spreadsheetAriaLabel:"Example data spreadsheet"};const Ne=Gn.bind({});Ne.storyName="With many columns";Ne.args={selectAllAriaLabel:"Select all",spreadsheetAriaLabel:"Example data spreadsheet",totalVisibleColumns:5};const Pe=Cn.bind({});Pe.storyName="With different options";Pe.args={readOnlyTable:!1,disableColumnSwapping:!1,selectAllAriaLabel:"Select all",spreadsheetAriaLabel:"Example data spreadsheet",totalVisibleColumns:5};const We=er.bind({});We.storyName="With drag drop  callback";We.args={selectAllAriaLabel:"Select all",spreadsheetAriaLabel:"Example data spreadsheet",totalVisibleColumns:5};var Dt,At,_t;$e.parameters={...$e.parameters,docs:{...(Dt=$e.parameters)==null?void 0:Dt.docs,source:{originalSource:`({
  ...args
}) => {
  const [data, setData] = useState(() => generateData({
    rows: 16
  }));
  const columns = useMemo(() => columnData, []);
  return <DataSpreadsheet columns={columns} data={data} onDataUpdate={setData} id="spreadsheet--id" {...args} />;
}`,...(_t=(At=$e.parameters)==null?void 0:At.docs)==null?void 0:_t.source}}};var Ht,Tt,It;Oe.parameters={...Oe.parameters,docs:{...(Ht=Oe.parameters)==null?void 0:Ht.docs,source:{originalSource:`({
  ...args
}) => {
  const [data, setData] = useState(() => generateData({
    rows: 1000
  }));
  const columns = useMemo(() => columnData, []);
  return <DataSpreadsheet columns={columns} data={data} onDataUpdate={setData} id="spreadsheet--id" {...args} />;
}`,...(It=(Tt=Oe.parameters)==null?void 0:Tt.docs)==null?void 0:It.source}}};var $t,qt,Mt;ke.parameters={...ke.parameters,docs:{...($t=ke.parameters)==null?void 0:$t.docs,source:{originalSource:`({
  ...args
}) => {
  const [data, setData] = useState(() => generateData({
    rows: 100000
  }));
  const columns = useMemo(() => columnData, []);
  const buildComponent = index => <OverflowMenu style={{
    width: '32px',
    height: '32px',
    minWidth: '32px',
    minHeight: '32px'
  }}>
      <OverflowMenuItem itemText={\`Test item \${index}\`} />
    </OverflowMenu>;
  return <DataSpreadsheet columns={columns} data={data} onDataUpdate={setData} renderRowHeaderDirection="Left" renderRowHeader={buildComponent} id="spreadsheet--id" {...args} />;
}`,...(Mt=(qt=ke.parameters)==null?void 0:qt.docs)==null?void 0:Mt.source}}};var jt,Ot,kt;Le.parameters={...Le.parameters,docs:{...(jt=Le.parameters)==null?void 0:jt.docs,source:{originalSource:`({
  ...args
}) => {
  const [data, setData] = useState([]);
  const columnDataClone = useMemo(() => [...columnData.filter(item => item.Header !== 'Row Index')], []);
  const columns = useMemo(() => columnDataClone, [columnDataClone]);
  return <DataSpreadsheet columns={columns} data={data} onDataUpdate={setData} id="spreadsheet--id" {...args} />;
}`,...(kt=(Ot=Le.parameters)==null?void 0:Ot.docs)==null?void 0:kt.source}}};var Lt,Nt,Pt;Ne.parameters={...Ne.parameters,docs:{...(Lt=Ne.parameters)==null?void 0:Lt.docs,source:{originalSource:`({
  ...args
}) => {
  const [data, setData] = useState(() => generateData({
    rows: 24,
    extraColumns: true
  }));
  const columnDataClone = useMemo(() => [...columnData, {
    Header: 'Owner name',
    accessor: 'ownerName'
  }, {
    Header: 'Weight',
    accessor: 'weight'
  }], []);
  const columns = useMemo(() => columnDataClone, [columnDataClone]);
  return <DataSpreadsheet columns={columns} data={data} onDataUpdate={setData} id="spreadsheet--id" {...args} />;
}`,...(Pt=(Nt=Ne.parameters)==null?void 0:Nt.docs)==null?void 0:Pt.source}}};var Wt,Vt,Bt;Pe.parameters={...Pe.parameters,docs:{...(Wt=Pe.parameters)==null?void 0:Wt.docs,source:{originalSource:`({
  ...args
}) => {
  const [data, setData] = useState(() => generateData({
    rows: 24,
    extraColumns: true
  }));
  const columnDataClone = useMemo(() => [...columnData, {
    Header: 'Owner name',
    accessor: 'ownerName'
  }, {
    Header: 'Weight',
    accessor: 'weight'
  }], []);
  const columns = useMemo(() => columnDataClone, [columnDataClone]);
  return <DataSpreadsheet columns={columns} data={data} onDataUpdate={setData} id="spreadsheet--id" {...args} />;
}`,...(Bt=(Vt=Pe.parameters)==null?void 0:Vt.docs)==null?void 0:Bt.source}}};var Et,zt,Ut;We.parameters={...We.parameters,docs:{...(Et=We.parameters)==null?void 0:Et.docs,source:{originalSource:`({
  ...args
}) => {
  const [data, setData] = useState(() => generateData({
    rows: 24,
    extraColumns: true
  }));
  const onColumnDragDrop = tableData => {
    // Dev can debug here
  };
  const columnDataClone = useMemo(() => [...customColumnData, {
    Header: 'Owner name',
    accessor: 'ownerName'
  }, {
    Header: 'Weight',
    accessor: 'weight'
  }], []);
  const columns = useMemo(() => columnDataClone, [columnDataClone]);
  return <DataSpreadsheet columns={columns} data={data} onDataUpdate={setData} onColDrag={onColumnDragDrop} id="spreadsheet--id" {...args} />;
}`,...(Ut=(zt=We.parameters)==null?void 0:zt.docs)==null?void 0:Ut.source}}};const Lr=["dataSpreadsheet","largeDatasetSpreadsheet","largeDatasetSpreadsheetCustom","emptyWithCells","withManyColumns","withDifferentOptions","withDragDropCallback"];export{Lr as __namedExportsOrder,$e as dataSpreadsheet,kr as default,Le as emptyWithCells,Oe as largeDatasetSpreadsheet,ke as largeDatasetSpreadsheetCustom,Pe as withDifferentOptions,We as withDragDropCallback,Ne as withManyColumns};
