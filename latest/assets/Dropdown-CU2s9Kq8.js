import{u as Ae,c as h,_ as m,d as H,s as Ce}from"./deprecate-D9ms-jbM.js";import{R as o,r as b}from"./index-BwDkhjyp.js";import{u as V,L as x,a as Ne,b as Pe}from"./index-mZNF_Ndq.js";import{P as t}from"./index-Dk74W0Oi.js";import{m as je}from"./mergeRefs-CTUecegF.js";import{F as Le}from"./FormContext-C7kRVu4t.js";import{W as Oe,a as Re}from"./bucket-17-CArjO86K.js";import{C as Be}from"./events-Bq7WR1mU.js";const Ke=Ce(),{ToggleButtonKeyDownArrowDown:Fe,ToggleButtonKeyDownArrowUp:ke,ToggleButtonKeyDownHome:Me,ToggleButtonKeyDownEnd:We,ItemMouseMove:qe,MenuMouseLeave:ze}=V.stateChangeTypes,G=l=>typeof l=="string"?l:typeof l=="number"?`${l}`:l!==null&&typeof l=="object"&&"label"in l&&typeof l.label=="string"?l.label:"",J=o.forwardRef((l,Q)=>{var z;let{className:X,disabled:f=!1,direction:Y="bottom",items:D,label:A,["aria-label"]:Z,ariaLabel:ee,itemToString:p=G,itemToElement:C=null,renderSelectedItem:N,type:te="default",size:_,onChange:P,id:ne,titleText:j="",hideLabel:oe,helperText:I="",translateWithId:le,light:L,invalid:s,invalidText:se,warn:g,warnText:re,initialSelectedItem:ie,selectedItem:O,downshiftProps:ae,readOnly:$,slug:w,...de}=l;const n=Ae(),{isFluid:T}=b.useContext(Le),R={...ae,items:D,itemToString:p,initialSelectedItem:ie,onSelectedItemChange:$e,stateReducer:pe,isItemDisabled(e,r){return e!==null&&typeof e=="object"&&"disabled"in e&&e.disabled===!0}},{current:ce}=b.useRef(Ke());function pe(e,r){const{changes:d,props:c,type:S}=r,{highlightedIndex:U}=d;switch(S){case Fe:case ke:case Me:case We:if(U>-1){const De=document.querySelectorAll(`li.${n}--list-box__menu-item[role="option"]`);c.scrollIntoView(De[U])}return d;case qe:case ze:return{...d,highlightedIndex:e.highlightedIndex}}return d}O!==void 0&&(R.selectedItem=O);const{isOpen:u,getToggleButtonProps:ue,getLabelProps:me,getMenuProps:be,getItemProps:fe,selectedItem:i,highlightedIndex:ge}=V(R),a=te==="inline",B=!s&&g,[we,ye]=b.useState(!1),he=h(`${n}--dropdown`,{[`${n}--dropdown--invalid`]:s,[`${n}--dropdown--warning`]:B,[`${n}--dropdown--open`]:u,[`${n}--dropdown--inline`]:a,[`${n}--dropdown--disabled`]:f,[`${n}--dropdown--light`]:L,[`${n}--dropdown--readonly`]:$,[`${n}--dropdown--${_}`]:_,[`${n}--list-box--up`]:Y==="top"}),xe=h(`${n}--label`,{[`${n}--label--disabled`]:f,[`${n}--visually-hidden`]:oe}),_e=h(`${n}--form__helper-text`,{[`${n}--form__helper-text--disabled`]:f}),Ie=h(`${n}--dropdown__wrapper`,`${n}--list-box__wrapper`,X,{[`${n}--dropdown__wrapper--inline`]:a,[`${n}--list-box__wrapper--inline`]:a,[`${n}--dropdown__wrapper--inline--invalid`]:a&&s,[`${n}--list-box__wrapper--inline--invalid`]:a&&s,[`${n}--list-box__wrapper--fluid--invalid`]:T&&s,[`${n}--list-box__wrapper--fluid--focus`]:T&&we&&!u,[`${n}--list-box__wrapper--slug`]:w}),K=I?`dropdown-helper-text-${ce}`:void 0,E=C,y=ue(),F=I&&!T?o.createElement("div",{id:K,className:_e},I):null;function $e(e){let{selectedItem:r}=e;P&&P({selectedItem:r??null})}const k=e=>{ye(e.type==="focus")},v=je(y.ref,Q),[M,Te]=b.useState();let[Ee,W]=b.useState(!1);const ve=$?{onClick:e=>{e.preventDefault(),v.current!==void 0&&v.current.focus()},onKeyDown:e=>{["ArrowDown","ArrowUp"," ","Enter"].includes(e.key)&&e.preventDefault()}}:{onKeyDown:e=>{(e.code!=="Space"||!["ArrowDown","ArrowUp"," ","Enter"].includes(e.key))&&W(!0),(Ee&&e.code==="Space"||!["ArrowDown","ArrowUp"," ","Enter"].includes(e.key))&&(M&&clearTimeout(M),Te(setTimeout(()=>{W(!1)},3e3))),y.onKeyDown&&y.onKeyDown(e)}},Se=be();let q;return w&&((z=w.type)==null?void 0:z.displayName)==="Slug"&&(q=o.cloneElement(w,{size:"mini"})),o.createElement("div",m({className:Ie},de),j&&o.createElement("label",m({className:xe},me()),j),o.createElement(x,{onFocus:k,onBlur:k,"aria-label":ee||Z,size:_,className:he,invalid:s,invalidText:se,warn:g,warnText:re,light:L,isOpen:u,id:ne},s&&o.createElement(Oe,{className:`${n}--list-box__invalid-icon`}),B&&o.createElement(Re,{className:`${n}--list-box__invalid-icon ${n}--list-box__invalid-icon--warning`}),o.createElement("button",m({type:"button",className:`${n}--list-box__field`,disabled:f,"aria-disabled":$?!0:void 0,"aria-describedby":!a&&!s&&!g&&F?K:void 0,title:i&&p!==void 0?p(i):G(A)},y,ve,{ref:v}),o.createElement("span",{className:`${n}--list-box__label`},i?N?N(i):p(i):A),o.createElement(x.MenuIcon,{isOpen:u,translateWithId:le})),q,o.createElement(x.Menu,Se,u&&D.map((e,r)=>{const d=e!==null&&typeof e=="object",c=fe({item:e,index:r});e!==null&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"id")&&(c.id=e.id);const S=d&&"text"in e&&C?e.text:p(e);return o.createElement(x.MenuItem,m({key:c.id,isActive:i===e,isHighlighted:ge===r,title:S,disabled:c["aria-disabled"]},c),typeof e=="object"&&E!==void 0&&E!==null?o.createElement(E,m({key:c.id},e)):p(e),i===e&&o.createElement(Be,{className:`${n}--list-box__menu-item__selected-icon`}))}))),!a&&!s&&!g&&F)});J.displayName="Dropdown";J.propTypes={"aria-label":t.string,ariaLabel:H(t.string),className:t.string,direction:t.oneOf(["top","bottom"]),disabled:t.bool,downshiftProps:t.object,helperText:t.node,hideLabel:t.bool,id:t.string.isRequired,initialSelectedItem:t.oneOfType([t.object,t.string,t.number]),invalid:t.bool,invalidText:t.node,itemToElement:t.func,itemToString:t.func,items:t.array.isRequired,label:t.node.isRequired,light:H(t.bool),onChange:t.func,readOnly:t.bool,renderSelectedItem:t.func,selectedItem:t.oneOfType([t.object,t.string,t.number]),size:Ne,slug:t.node,titleText:t.node.isRequired,translateWithId:t.func,type:Pe,warn:t.bool,warnText:t.node};export{J as D};
