import{r as u,t as C,u as he,g as ge,m as be,D as _e,c as h,e as n,_ as we,P as t,l as S}from"./iframe-Bt_4wi2_.js";import{F as ve}from"./FormContext-DZ5Pn6PQ.js";import{g as $e}from"./TextInput-DudcF1-K.js";import{A as Te}from"./index-xWfRmBau.js";import{i as ye}from"./utils-Dx5MzUE-.js";import{T as b}from"./Text-CKKshe8_.js";import{W as j,a as B}from"./bucket-19-Cu112eOp.js";const Ce=u.forwardRef,G=Ce((H,J)=>{const{className:Q,decorator:v,disabled:d=!1,id:$,labelText:E,hideLabel:U,onChange:N=C,onClick:A=C,onKeyDown:I=C,invalid:o=!1,invalidText:X="",helperText:_="",light:Y,placeholder:Z="",enableCounter:g=!1,maxCount:l,counterMode:s="character",warn:m=!1,warnText:ee="",rows:te=4,slug:T,...f}=H,e=he(),{isFluid:i}=u.useContext(ve),{defaultValue:L,value:D}=f,ae=ge(),c=u.useRef(null),re=be([J,c]);function W(){const r=(L||D||c.current?.value||"").toString();return s==="character"?r.length:r.match(new RegExp("\\p{L}+","gu"))?.length||0}const[w,p]=u.useState(W());u.useEffect(()=>{p(W())},[D,L,s]),_e(()=>{f.cols&&c.current?(c.current.style.width="",c.current.style.resize="none"):c.current&&(c.current.style.width="100%")},[f.cols]);const F={id:$,onKeyDown:a=>{if(!d&&g&&s==="word"){const r=a.which;(l&&w>=l&&r===32||l&&w>=l&&r===13)&&a.preventDefault()}!d&&I&&I(a)},onPaste:a=>{if(!d&&s==="word"&&g&&typeof l<"u"&&c.current!==null){const r=c.current.value.match(new RegExp("\\p{L}+","gu"))||[],M=a.clipboardData.getData("Text").match(new RegExp("\\p{L}+","gu"))||[];if(r.length+M.length>l){a.preventDefault();const xe=r.concat(M).slice(0,l);setTimeout(()=>{p(l)},0),c.current.value=xe.join(" ")}}},onChange:a=>{if(!d){if(s=="character")a?.persist?.(),setTimeout(()=>{p(a.target?.value?.length)},0);else if(s=="word"){if(!a.target.value){setTimeout(()=>{p(0)},0);return}if(g&&typeof l<"u"&&c.current!==null){const r=a.target?.value?.match(new RegExp("\\p{L}+","gu"));r&&r.length<=l?(c.current.removeAttribute("maxLength"),setTimeout(()=>{p(r.length)},0)):r&&r.length>l&&setTimeout(()=>{p(r.length)},0)}}N&&N(a)}},onClick:a=>{!d&&A&&A(a)}},ne=h(`${e}--form-item`,Q),le=h(`${e}--text-area__wrapper`,{[`${e}--text-area__wrapper--cols`]:f.cols,[`${e}--text-area__wrapper--readonly`]:f.readOnly,[`${e}--text-area__wrapper--warn`]:m,[`${e}--text-area__wrapper--slug`]:T,[`${e}--text-area__wrapper--decorator`]:v}),oe=h(`${e}--label`,{[`${e}--visually-hidden`]:U&&!i,[`${e}--label--disabled`]:d}),se=h(`${e}--text-area`,{[`${e}--text-area--light`]:Y,[`${e}--text-area--invalid`]:o,[`${e}--text-area--warn`]:m}),ie=h(`${e}--label`,{[`${e}--label--disabled`]:d,[`${e}--text-area__label-counter`]:!0}),ce=h(`${e}--form__helper-text`,{[`${e}--form__helper-text--disabled`]:d}),de=E?n.createElement(b,{as:"label",htmlFor:$,className:oe},E):null,ue=g&&l&&(s==="character"||s==="word")?n.createElement(b,{as:"div",className:ie},`${w}/${l}`):null,O=_?`text-area-helper-text-${ae}`:void 0,me=_?n.createElement(b,{as:"div",id:O,className:ce},_):null,R=$+"-error-msg",P=o?n.createElement(b,{as:"div",role:"alert",className:`${e}--form-requirement`,id:R},X,i&&n.createElement(j,{className:`${e}--text-area__invalid-icon`})):null,V=m?n.createElement(b,{as:"div",role:"alert",className:`${e}--form-requirement`},ee,i&&n.createElement(B,{className:`${e}--text-area__invalid-icon ${e}--text-area__invalid-icon--warning`})):null;let y;o?y=R:!o&&!m&&!i&&_&&(y=O),g&&s=="character"&&(F.maxLength=l);const k=u.useRef(null),[q,fe]=u.useState(""),x=$e(w,l,s==="word"?"word":void 0,s==="word"?"words":void 0);u.useEffect(()=>{if(x&&x!==q){const a=k.current;if(a){a.textContent="";const r=setTimeout(()=>{a&&(a.textContent=x,fe(x))},s==="word"?2e3:1e3);return()=>{r&&clearTimeout(r)}}}},[x,q,s]);const pe=n.createElement("textarea",we({},f,F,{placeholder:Z,"aria-readonly":!!f.readOnly,className:se,"aria-invalid":o,"aria-describedby":y,disabled:d,rows:te,readOnly:f.readOnly,ref:re})),z=T??v,K=ye(z,Te)?u.cloneElement(z,{size:"mini"}):null;return n.createElement("div",{className:ne},n.createElement("div",{className:`${e}--text-area__label-wrapper`},de,ue),n.createElement("div",{className:le,"data-invalid":o||null},o&&!i&&n.createElement(j,{className:`${e}--text-area__invalid-icon`}),m&&!o&&!i&&n.createElement(B,{className:`${e}--text-area__invalid-icon ${e}--text-area__invalid-icon--warning`}),pe,T?K:v?n.createElement("div",{className:`${e}--text-area__inner-wrapper--decorator`},K):"",n.createElement("span",{className:`${e}--text-area__counter-alert`,role:"alert","aria-live":"assertive","aria-atomic":"true",ref:k},x),i&&n.createElement("hr",{className:`${e}--text-area__divider`}),i&&o?P:null,i&&m&&!o?V:null),!o&&!m&&!i?me:null,o&&!i?P:null,m&&!o&&!i?V:null)});G.displayName="TextArea";G.propTypes={className:t.string,cols:t.number,counterMode:t.oneOf(["character","word"]),decorator:t.node,defaultValue:t.oneOfType([t.string,t.number]),disabled:t.bool,enableCounter:t.bool,helperText:t.node,hideLabel:t.bool,id:t.string,invalid:t.bool,invalidText:t.node,labelText:t.node.isRequired,light:S(t.bool),maxCount:t.number,onChange:t.func,onClick:t.func,onKeyDown:t.func,placeholder:t.string,readOnly:t.bool,rows:t.number,slug:S(t.node),value:t.oneOfType([t.string,t.number]),warn:t.bool,warnText:t.node};export{G as T};
