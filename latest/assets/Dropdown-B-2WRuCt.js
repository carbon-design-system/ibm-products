import{u as Oe,a as ze,b as Ke,c as Re,d as T,_ as h,C as Be,e as Ue,s as We,f as qe,h as He,P as n,g as j}from"./index-CMVdkQrl.js";import{e as l,r as s}from"./index-DtHxqM--.js";import{u as pe,L as v,a as Ve,b as Ge}from"./index-BCwPvCrC.js";import{m as Je}from"./mergeRefs-CTUecegF.js";import{F as Qe}from"./FormContext-C4Nuixum.js";import{W as Xe,a as Ye}from"./bucket-18-xYgoy0Nr.js";const{ItemMouseMove:Ze,MenuMouseLeave:et}=pe.stateChangeTypes,de=i=>typeof i=="string"?i:typeof i=="number"?`${i}`:i!==null&&typeof i=="object"&&"label"in i&&typeof i.label=="string"?i.label:"";function ce(i,A){const{changes:r,type:S}=A;switch(S){case Ze:case et:return r.highlightedIndex===i.highlightedIndex?i:r;default:return r}}const ue=l.forwardRef((i,A)=>{let{autoAlign:r=!1,className:S,decorator:y,disabled:x=!1,direction:O="bottom",items:z,label:K,["aria-label"]:me,ariaLabel:be,itemToString:p=de,itemToElement:R=null,renderSelectedItem:B,type:fe="default",size:C,onChange:k,id:ge,titleText:D="",hideLabel:we,helperText:F="",translateWithId:he,light:U,invalid:a,invalidText:ye,warn:_,warnText:xe,initialSelectedItem:W,selectedItem:q,downshiftProps:H,readOnly:$,slug:I,..._e}=i;const g=Oe("enable-v12-dynamic-floating-styles"),{refs:b,floatingStyles:V,middlewareData:$e}=ze(g||r?{placement:O,strategy:"fixed",middleware:[We({apply(e){let{rects:o,elements:c}=e;Object.assign(c.floating.style,{width:`${o.reference.width}px`})}}),r&&qe(),r&&He()],whileElementsMounted:Ue}:{});s.useEffect(()=>{var e;if(g||r){const o={...V,visibility:(e=$e.hide)!=null&&e.referenceHidden?"hidden":"visible"};Object.keys(o).forEach(c=>{b.floating.current&&(b.floating.current.style[c]=o[c])})}},[V,r,b.floating]);const t=Ke(),{isFluid:G}=s.useContext(Qe),J=s.useCallback(e=>{let{selectedItem:o}=e;k&&k({selectedItem:o??null})},[k]),Q=s.useCallback((e,o)=>e!==null&&typeof e=="object"&&"disabled"in e&&e.disabled===!0,[]),X=s.useCallback(e=>{const{highlightedIndex:o}=e;if(o!==void 0&&o>-1&&typeof window!==void 0){const m=document.querySelectorAll(`li.${t}--list-box__menu-item[role="option"]`)[o];m&&m.scrollIntoView({behavior:"smooth",block:"nearest"})}},[t]),P=s.useMemo(()=>z,[z]),Y=s.useMemo(()=>({items:P,itemToString:p,initialSelectedItem:W,onSelectedItemChange:J,stateReducer:ce,isItemDisabled:Q,onHighlightedIndexChange:X,...H}),[P,p,W,J,ce,Q,X,H]),Ie=Re();q!==void 0&&(Y.selectedItem=q);const{isOpen:f,getToggleButtonProps:Ee,getLabelProps:Te,getMenuProps:Z,getItemProps:ve,selectedItem:d,highlightedIndex:Ae}=pe(Y),u=fe==="inline",ee=!a&&_,[Se,N]=s.useState(!1),Ce=T(`${t}--dropdown`,{[`${t}--dropdown--invalid`]:a,[`${t}--dropdown--warning`]:ee,[`${t}--dropdown--open`]:f,[`${t}--dropdown--focus`]:Se,[`${t}--dropdown--inline`]:u,[`${t}--dropdown--disabled`]:x,[`${t}--dropdown--light`]:U,[`${t}--dropdown--readonly`]:$,[`${t}--dropdown--${C}`]:C,[`${t}--list-box--up`]:O==="top",[`${t}--autoalign`]:r}),ke=T(`${t}--label`,{[`${t}--label--disabled`]:x,[`${t}--visually-hidden`]:we}),De=T(`${t}--form__helper-text`,{[`${t}--form__helper-text--disabled`]:x}),Fe=T(`${t}--dropdown__wrapper`,`${t}--list-box__wrapper`,S,{[`${t}--dropdown__wrapper--inline`]:u,[`${t}--list-box__wrapper--inline`]:u,[`${t}--dropdown__wrapper--inline--invalid`]:u&&a,[`${t}--list-box__wrapper--inline--invalid`]:u&&a,[`${t}--list-box__wrapper--fluid--invalid`]:G&&a,[`${t}--list-box__wrapper--slug`]:I,[`${t}--list-box__wrapper--decorator`]:y}),te=F?`dropdown-helper-text-${Ie}`:void 0,L=R,w=Ee({"aria-label":me||be}),ne=F&&!G?l.createElement("div",{id:te,className:De},F):null,oe=e=>{N(e.type==="focus"&&!d)},E=Je(w.ref,A),[M,Pe]=s.useState(),[le,se]=s.useState(!1),ie=s.useCallback(e=>{(e.code!=="Space"||!["ArrowDown","ArrowUp"," ","Enter"].includes(e.key))&&se(!0),(le&&e.code==="Space"||!["ArrowDown","ArrowUp"," ","Enter"].includes(e.key))&&(M&&clearTimeout(M),Pe(setTimeout(()=>{se(!1)},3e3))),["ArrowDown"].includes(e.key)&&N(!1),["Enter"].includes(e.key)&&!d&&!f&&N(!0),w.onKeyDown&&(e.key!=="ArrowUp"||f&&e.key==="ArrowUp")&&w.onKeyDown(e)},[le,M,w]),Ne=s.useMemo(()=>$?{onClick:e=>{var o;e.preventDefault(),(o=E==null?void 0:E.current)==null||o.focus()},onKeyDown:e=>{["ArrowDown","ArrowUp"," ","Enter"].includes(e.key)&&e.preventDefault()}}:{onKeyDown:ie},[$,ie]),Le=s.useMemo(()=>Z({ref:g||r?b.setFloating:null}),[r,Z,b.setFloating,g]),re=s.useMemo(()=>{var o;let e=I??y;return e&&((o=e.type)==null?void 0:o.displayName)==="AILabel"?l.cloneElement(e,{size:"mini"}):l.isValidElement(e)?e:null},[I,y]),ae=Te(),Me=s.isValidElement(D)?{id:ae.id}:ae;return l.createElement("div",h({className:Fe},_e),D&&l.createElement("label",h({className:ke},Me),D),l.createElement(v,{onFocus:oe,onBlur:oe,size:C,className:Ce,invalid:a,invalidText:ye,warn:_,warnText:xe,light:U,isOpen:f,ref:g||r?b.setReference:null,id:ge},a&&l.createElement(Xe,{className:`${t}--list-box__invalid-icon`}),ee&&l.createElement(Ye,{className:`${t}--list-box__invalid-icon ${t}--list-box__invalid-icon--warning`}),l.createElement("button",h({type:"button",className:`${t}--list-box__field`,disabled:x,"aria-disabled":$?!0:void 0,"aria-describedby":!u&&!a&&!_&&ne?te:void 0,title:d&&p!==void 0?p(d):de(K)},w,Ne,{ref:E}),l.createElement("span",{className:`${t}--list-box__label`},d?B?B(d):p(d):K),l.createElement(v.MenuIcon,{isOpen:f,translateWithId:he})),I?re:y?l.createElement("div",{className:`${t}--list-box__inner-wrapper--decorator`},re):"",l.createElement(v.Menu,Le,f&&P.map((e,o)=>{const c=e!==null&&typeof e=="object",m=ve({item:e,index:o}),je=c&&"text"in e&&R?e.text:p(e);return l.createElement(v.MenuItem,h({key:m.id,isActive:d===e,isHighlighted:Ae===o,title:je,disabled:m["aria-disabled"]},m),typeof e=="object"&&L!==void 0&&L!==null?l.createElement(L,h({key:m.id},e)):p(e),d===e&&l.createElement(Be,{className:`${t}--list-box__menu-item__selected-icon`}))}))),!u&&!a&&!_&&ne)});ue.displayName="Dropdown";ue.propTypes={"aria-label":n.string,ariaLabel:j(n.string),autoAlign:n.bool,className:n.string,decorator:n.node,direction:n.oneOf(["top","bottom"]),disabled:n.bool,downshiftProps:n.object,helperText:n.node,hideLabel:n.bool,id:n.string.isRequired,initialSelectedItem:n.oneOfType([n.object,n.string,n.number]),invalid:n.bool,invalidText:n.node,itemToElement:n.func,itemToString:n.func,items:n.array.isRequired,label:n.node.isRequired,light:j(n.bool),onChange:n.func,readOnly:n.bool,renderSelectedItem:n.func,selectedItem:n.oneOfType([n.object,n.string,n.number]),size:Ge,slug:j(n.node),titleText:n.node.isRequired,translateWithId:n.func,type:Ve,warn:n.bool,warnText:n.node};export{ue as D};
