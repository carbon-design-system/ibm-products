import{r as u,c as h,p as $}from"./iframe-BlQ-LkYW.js";import{d as x}from"./useDatagrid-CnxV8z7J.js";const d=`${$.prefix}--datagrid`,S=`${d}__right-sticky-column`,y=`${d}__left-sticky-column`,w=`${S}-offset-scroll`,z=e=>{const s=u.useRef(void 0),r=u.useRef(void 0),[f,a]=u.useState(void 0);u.useEffect(()=>{a(window?.innerWidth)},[]),u.useLayoutEffect(()=>{function i(){a(window.innerWidth)}return window.addEventListener("resize",i),()=>window.removeEventListener("resize",i)},[]),e.getCellProps.push(g.bind(null,"cell",null,f)),e.getHeaderProps.push(g.bind(null,"header",r,f)),e.getTableBodyProps.push(b.bind(null,s)),e.getHeaderGroupProps.push(i=>[i,{style:{...i.style,minWidth:"unset"}}]);const m=i=>{u.useEffect(()=>{const n=s.current,t=r?.current;_(n)&&t&&t?.classList?.add(w);const c=x(L.bind(null,n,t),250);return typeof window<"u"&&window.addEventListener("resize",c),()=>{typeof window<"u"&&window.removeEventListener("resize",c)}},[i.rows,i.isFetching]),u.useEffect(()=>{const n=s.current,t=r.current,c=o=>{p(o.target,t)};return p(n,t),n&&n?.addEventListener("scroll",c),()=>{n&&n.removeEventListener("scroll",c)}},[i.rows,i.isFetching])},v=i=>{const n=s.current,t=r.current;u.useEffect(()=>{L(n,t)},[i.rows,t,n])};e.useInstance.push(m),e.useInstance.push(v),e.useInstance.push(i=>{Object.assign(i,{withStickyColumn:!0})}),e.useInstance.push(i=>{const n=i.visibleColumns;let t=n.findIndex(l=>l.id==="spacer"),c=n.findIndex(l=>l.sticky==="right");if(t>=0&&c>=0&&c<t){const l=n[t];n[t]=n[c],n[c]=l}const o=i.headers;if(t=o.findIndex(l=>l.id==="spacer"),c=o.findIndex(l=>l.sticky==="right"),t>=0&&c>=0&&c<t){const l=o[t];o[t]=o[c],o[t].canResize=!1,o[t].disableResizing=!0,delete o[t].getResizerProps,o[c]=l}})},b=(e,s)=>[s,{ref:e}],g=(e,s,r,f,a)=>{const m=a.column||a.cell?.column;return m?.sticky==="right"?[f,{className:h({[`${S}-${e}`]:!0,[`${d}__resizableColumn`]:!1,[`${d}__sortableColumn`]:!1}),...s&&{ref:s}}]:m?.sticky==="left"?[f,{className:h({[`${y}-${e}`]:r&&r>671,[`${y}-${e}--with-extra-select-column`]:a?.instance?.withSelectRows&&r&&r>671}),...s&&{ref:s}}]:[f]},L=(e,s)=>{s&&(_(e)?s.classList.add(w):s.classList.remove(w),p(e,s))},p=(e,s)=>{e&&s&&(e.scrollLeft+e.clientWidth===e.scrollWidth?(s.classList.add(`${d}__sticky-noShadow`),e.classList.add(`${d}__sticky-column-noShadow`)):(s.classList.remove(`${d}__sticky-noShadow`),e.classList.remove(`${d}__sticky-column-noShadow`)))},_=e=>{if(!e)return!1;const{scrollHeight:s,clientHeight:r}=e;return s>r};export{z as u};
