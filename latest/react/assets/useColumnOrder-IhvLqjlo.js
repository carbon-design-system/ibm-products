import{e as r,r as l}from"./index-DtHxqM--.js";import{d as W,P as t,a2 as O,bs as ne}from"./index-4poXP75K.js";import{p as H,B as ie}from"./settings-Bzj6EGPa.js";import"./feature-flags-eU_vhwbI.js";import{C as te}from"./Checkbox-BrqLuRFj.js";import{u as ae}from"./useId-DyRoBmqU.js";import{u as oe,C as le,a as ee,P as ce,K as de,b as ue,D as me,r as pe,e as ge,c as be,S as fe,v as ye}from"./modifiers.esm-DDFNLOS6.js";import{i as Ce}from"./bucket-6-DLW23Ky6.js";import{aY as he}from"./bucket-10-CJixWMOF.js";import{g as V}from"./getNodeTextContent-C8IeKkUQ.js";import{u as Te}from"./uuidv4-BN2rGLQG.js";import{S as qe}from"./Search-Dh4hBxPL.js";import{T as _e}from"./TearsheetNarrow-BI8kbgq3.js";import{l as xe}from"./useDatagrid-BbhmPntb.js";import{r as ve}from"./index.esm-fQjxfktm.js";const K=s=>typeof s.isVisible=="boolean"?s.isVisible:!0,N=`${H.prefix}--datagrid`,U=({id:s,elementId:a,children:n,classList:m,disabled:o,ariaLabel:b,isSticky:y,selected:T})=>{const{attributes:u,isDragging:$,listeners:d,setNodeRef:h,transform:I,transition:E}=oe({disabled:o,id:s}),{"aria-pressed":R,"aria-describedby":L}=u,k=y?r.createElement("div",{className:W({disabled:o},`${N}__draggable-handleStyle`)},r.createElement(he,{size:16})," "):r.createElement("button",{className:`${N}__draggable-handleStyle`,type:"button","aria-label":b,"aria-describedby":L,"aria-pressed":R,...d},r.createElement(Ce,{size:16})),z=r.createElement(r.Fragment,null,k,n),e={transform:o?void 0:le.Transform.toString(I),transition:E};return r.createElement("li",{className:W(m,`${N}__draggable-handleHolder`,{[`${N}__draggable-handleHolder--selected`]:T,[`${N}__draggable-handleHolder--sticky`]:y,[`${N}__draggable-handleHolder--dragging`]:$}),id:a||s,ref:h,style:e},r.createElement("div",{className:W([`${N}__draggable-handleHolder-droppable`])},z))};U.propTypes={ariaLabel:t.string.isRequired,children:t.element.isRequired,classList:t.string,disabled:t.bool,elementId:t.string,id:t.string.isRequired,isSticky:t.bool,selected:t.bool};U.__docgenInfo={description:"Single row in the DraggableItemsList used by CustomizeColumnsTearsheet.",methods:[],displayName:"DraggableElement",props:{ariaLabel:{required:!0,tsType:{name:"string"},description:"",type:{name:"string"}},children:{required:!0,tsType:{name:"ReactNode"},description:"",type:{name:"element"}},classList:{required:!1,tsType:{name:"string"},description:"",type:{name:"string"}},disabled:{required:!1,tsType:{name:"boolean"},description:"",type:{name:"bool"}},id:{required:!0,tsType:{name:"string"},description:"",type:{name:"string"}},elementId:{required:!1,tsType:{name:"string"},description:"",type:{name:"string"}},isSticky:{required:!1,tsType:{name:"boolean"},description:"",type:{name:"bool"}},selected:{required:!1,tsType:{name:"boolean"},description:"",type:{name:"bool"}}},composes:["PropsWithChildren"]};const j=`${H.prefix}--datagrid`,P=(s,a)=>s&&a&&s.id===a.id,G=({columns:s,filterString:a,id:n,moveElement:m,onSelectColumn:o,setAriaRegionText:b})=>{const y=`${j}__draggable-item`,T=ae(),u=s.filter(e=>V(e.Header).trim().length!==0).filter(Boolean).filter(e=>!e.isAction).filter(e=>e.id!=="spacer").filter(e=>a.length===0||V(e.Header).toLowerCase().includes(a)),d=(()=>{const e=[...u];return e.forEach(c=>{c.sticky&&(c.disabled=!0)}),e})(),h=e=>{var F;const{active:c,over:f}=e,i=d.filter(x=>x.id===f.id);if(i!=null&&i.length&&((F=i[0])!=null&&F.disabled))return;const p=d.findIndex(x=>P(x,c)),D=d.findIndex(x=>P(x,f)),q=V(d[p].Header);b(`${q} dropped. New position ${D+1} of ${d.length}.`);const _=s.findIndex(x=>P(x,c)),A=s.findIndex(x=>P(x,f));m(_,A)},I=e=>{const{active:c}=e,f=d.findIndex(p=>P(p,c)),i=V(d[f].Header);b(`${i} grabbed. Current position ${f+1} of ${d.length}.`)},E=e=>{const{active:c,over:f}=e,i=d.findIndex(q=>P(q,c)),p=d.findIndex(q=>P(q,f)),D=V(d[i].Header);b(`${D} grabbed. Original position ${i+1}, new position ${p+1} of ${d.length}.`)},R=ee(ce,{activationConstraint:{distance:4}}),L=ee(de,{coordinateGetter:(e,c)=>{const{currentCoordinates:f}=c;let i=e.target;for(;i&&!i.classList.contains(y);)i=i.parentNode;const p=i.offsetHeight;switch(e.code){case"ArrowRight":case"ArrowLeft":return f;case"ArrowUp":return{...f,y:f.y-p};case"ArrowDown":return{...f,y:f.y+p}}}}),k=ue(R,L),z=(e,c)=>{if(e.code==="Space")return o(c,!K(c)),e.preventDefault(),e.stopPropagation(),!1};return r.createElement(me,{collisionDetection:be,onDragEnd:h,onDragStart:I,onDragMove:E,sensors:k,modifiers:[pe,ge]},r.createElement(r.Fragment,null,r.createElement("div",{className:`${j}__draggable-underlay`,"aria-hidden":"true",key:`draggable-underlay-${n}`},u.map(e=>r.createElement("div",{className:`${j}__draggable-underlay-item`,key:e.id}))),r.createElement(fe,{items:d,strategy:ye},u.map(e=>{const c=V(e.Header),i=c.split(new RegExp(`(${a})`,"gi")).map(_=>_.toLowerCase()===a.toLowerCase()?r.createElement("strong",null,_):_),p=!!e.sticky,D=e.disabled,q=r.createElement(te,{checked:K(e),disabled:D||p,onChange:(_,{checked:A})=>o(e,A),id:`${j}__customization-column-${e.id}`,labelText:i,className:`${j}__customize-columns-checkbox`,onKeyDown:_=>z(_,e)});return r.createElement(U,{classList:y,key:e.id,id:e.id,elementId:`${e.id}-${T}`,disabled:a.length>0||p,ariaLabel:c,isSticky:p,selected:K(e)},q)}))))};G.propTypes={columns:O.PropTypes.array.isRequired,filterString:O.PropTypes.string.isRequired,id:O.PropTypes.string.isRequired,moveElement:O.PropTypes.func.isRequired,onSelectColumn:O.PropTypes.func.isRequired,setAriaRegionText:O.PropTypes.func.isRequired};G.__docgenInfo={description:"",methods:[],displayName:"DraggableItemsList",props:{columns:{description:"",type:{name:"array"},required:!0},filterString:{description:"",type:{name:"string"},required:!0},id:{description:"",type:{name:"string"},required:!0},moveElement:{description:"",type:{name:"func"},required:!0},onSelectColumn:{description:"",type:{name:"func"},required:!0},setAriaRegionText:{description:"",type:{name:"func"},required:!0}}};const v=`${H.prefix}--datagrid`,M=({getVisibleColumnsCount:s,filterString:a,columns:n,setColumnsObject:m,onSelectColumn:o,assistiveTextInstructionsLabel:b,assistiveTextDisabledInstructionsLabel:y,selectAllLabel:T,customizeTearsheetHeadingLabel:u})=>{const $=l.useRef(Te()),d=l.useRef(null),[h,I]=r.useState(""),E=r.useCallback((L,k)=>{m(z=>{const e=[...z],c=e[L];return e.splice(L,1),e.splice(k,0,c),e})},[m]),R=n==null?void 0:n.filter(L=>!L.sticky);return r.createElement("div",{className:`${v}__customize-columns-column-list`,ref:d},r.createElement("ol",{className:`${v}__customize-columns-column-list--focus`,"aria-label":u,"aria-describedby":`${v}__customize-columns--instructions`},r.createElement("span",{"aria-live":"assertive",className:`${v}__shared-ui--assistive-text`},h),r.createElement("span",{id:`${v}__customize-columns--instructions`,className:`${v}__shared-ui--assistive-text`},a.length===0?b:y),r.createElement("div",{id:`${v}__customize-columns-select-all`,className:W(`${v}__customize-columns-select-all`,{[`${v}__customize-columns-select-all--selected`]:s()>0}),selected:s()>0},r.createElement(te,{className:`${v}__customize-columns-checkbox-wrapper`,checked:s()===n.length,indeterminate:s()<n.length&&s()>0,onChange:()=>{o(R,s()!==n.length)},id:`${v}__customization-column-select-all`,labelText:T})),r.createElement(G,{id:$.current,columns:n,filterString:a,moveElement:E,setAriaRegionText:I,onSelectColumn:o})))};M.propTypes={assistiveTextDisabledInstructionsLabel:t.string,assistiveTextInstructionsLabel:t.string,columns:t.array.isRequired,customizeTearsheetHeadingLabel:t.string,disabledInstructionsLabel:t.string,filterString:t.string.isRequired,getVisibleColumnsCount:t.func.isRequired,instructionsLabel:t.string,onSelectColumn:t.func.isRequired,selectAllLabel:t.string,setColumnStatus:t.func,setColumnsObject:t.func.isRequired};M.__docgenInfo={description:"",methods:[],displayName:"Columns",props:{assistiveTextDisabledInstructionsLabel:{description:"",type:{name:"string"},required:!1},assistiveTextInstructionsLabel:{description:"",type:{name:"string"},required:!1},columns:{description:"",type:{name:"array"},required:!0},customizeTearsheetHeadingLabel:{description:"",type:{name:"string"},required:!1},disabledInstructionsLabel:{description:"",type:{name:"string"},required:!1},filterString:{description:"",type:{name:"string"},required:!0},getVisibleColumnsCount:{description:"",type:{name:"func"},required:!0},instructionsLabel:{description:"",type:{name:"string"},required:!1},onSelectColumn:{description:"",type:{name:"func"},required:!0},selectAllLabel:{description:"",type:{name:"string"},required:!1},setColumnStatus:{description:"",type:{name:"func"},required:!1},setColumnsObject:{description:"",type:{name:"func"},required:!0}}};const $e=`${H.prefix}--datagrid`,Y=({searchText:s,setSearchText:a,findColumnPlaceholderLabel:n})=>l.createElement("div",{className:`${$e}__customize-columns-tearsheet--actions`},l.createElement(qe,{placeholder:n,value:s,size:"lg",labelText:n,onChange:m=>{a(m.target.value)}}));Y.propTypes={columns:t.array.isRequired,findColumnPlaceholderLabel:t.string,originalColumnDefinitions:t.array.isRequired,resetToDefaultLabel:t.string,searchText:t.string.isRequired,setColumnsObject:t.func.isRequired,setSearchText:t.func.isRequired};Y.__docgenInfo={description:"",methods:[],displayName:"Actions",props:{columns:{description:"",type:{name:"array"},required:!0},findColumnPlaceholderLabel:{description:"",type:{name:"string"},required:!1},originalColumnDefinitions:{description:"",type:{name:"array"},required:!0},resetToDefaultLabel:{description:"",type:{name:"string"},required:!1},searchText:{description:"",type:{name:"string"},required:!0},setColumnsObject:{description:"",type:{name:"func"},required:!0},setSearchText:{description:"",type:{name:"func"},required:!0}}};const Le=`${H.prefix}--datagrid`,J=({isOpen:s,setIsTearsheetOpen:a,launcherButtonRef:n,onSaveColumnPrefs:m,columnDefinitions:o,originalColumnDefinitions:b,customizeTearsheetHeadingLabel:y="Customize columns",primaryButtonTextLabel:T="Save",secondaryButtonTextLabel:u="Cancel",instructionsLabel:$="Select columns to display them. Click and drag the box to reorder the columns. These specifications will be saved and persist if you leave and return to the data table.",findColumnPlaceholderLabel:d="Find column",resetToDefaultLabel:h="Reset to default",assistiveTextInstructionsLabel:I="Press space bar to toggle drag drop mode, use arrow keys to move selected elements.",assistiveTextDisabledInstructionsLabel:E="Reordering columns are disabled because they are filtered currently.",selectAllLabel:R="Column name"})=>{const[L,k]=l.useState(""),[z,e]=l.useState(""),[c,f]=l.useState(""),[i,p]=l.useState(o),[D,q]=l.useState(!1),_=l.useRef(void 0),A=()=>{p(o),a(!1)},F=()=>{a(!1);const C=i.map(S=>({id:S.id,isVisible:S.isVisible}));m(C)},x=(C,S)=>{const w=i.map(g=>Array.isArray(C)?C.includes(g)&&g.canFilter&&!g.disabled?{...g,isVisible:S}:g:C.id===g.id?{...g,isVisible:S}:g),Z=w.filter(g=>g.isVisible&&!["datagridSelection","actions"].includes(g.id)).length,re=w.map(g=>Z>0?["datagridSelection","actions"].includes(g.id)?{...g,isVisible:!0}:g:["datagridSelection","actions"].includes(g.id)?{...g,isVisible:!1}:g);p(re),q(Z!==0)},B=l.useCallback(()=>i.filter(C=>C.isVisible).length,[i]),se=c.trim().toLowerCase();return l.useEffect(()=>{_.current!==o&&p(o);const C=i.filter(w=>w.id==="actions").length,S=i.filter(w=>w.id==="datagridSelection").length;k(B()-C-S<0?0:B()-C-S),e(i.length-C-S),_.current=o},[B,i,o]),r.createElement(_e,{className:`${Le}__customize-columns-tearsheet`,open:s,title:`${y} (${L}/${z})`,description:$,launcherButtonRef:n,actions:[{kind:"secondary",label:u,onClick:A},{kind:"primary",label:T,onClick:F,disabled:!D}]},r.createElement(Y,{columns:i,originalColumnDefinitions:b,searchText:c,setColumnsObject:C=>{p(C),q(!0)},setSearchText:f,findColumnPlaceholderLabel:d,resetToDefaultLabel:h}),s&&r.createElement(M,{assistiveTextInstructionsLabel:I,assistiveTextDisabledInstructionsLabel:E,getVisibleColumnsCount:B,columns:i,filterString:se,onSelectColumn:x,setColumnsObject:C=>{p(C),q(B()!==0)},selectAllLabel:R,customizeTearsheetHeadingLabel:y}))};J.propTypes={assistiveTextDisabledInstructionsLabel:t.string,assistiveTextInstructionsLabel:t.string,columnDefinitions:t.array.isRequired,customizeTearsheetHeadingLabel:t.string,findColumnPlaceholderLabel:t.string,instructionsLabel:t.string,isOpen:t.bool.isRequired,onSaveColumnPrefs:t.func.isRequired,originalColumnDefinitions:t.array.isRequired,primaryButtonTextLabel:t.string,resetToDefaultLabel:t.string,secondaryButtonTextLabel:t.string,selectAllLabel:t.string,setIsTearsheetOpen:t.func.isRequired};J.__docgenInfo={description:"",methods:[],displayName:"CustomizeColumnsTearsheet",props:{customizeTearsheetHeadingLabel:{defaultValue:{value:"'Customize columns'",computed:!1},description:"",type:{name:"string"},required:!1},primaryButtonTextLabel:{defaultValue:{value:"'Save'",computed:!1},description:"",type:{name:"string"},required:!1},secondaryButtonTextLabel:{defaultValue:{value:"'Cancel'",computed:!1},description:"",type:{name:"string"},required:!1},instructionsLabel:{defaultValue:{value:"'Select columns to display them. Click and drag the box to reorder the columns. These specifications will be saved and persist if you leave and return to the data table.'",computed:!1},description:"",type:{name:"string"},required:!1},findColumnPlaceholderLabel:{defaultValue:{value:"'Find column'",computed:!1},description:"",type:{name:"string"},required:!1},resetToDefaultLabel:{defaultValue:{value:"'Reset to default'",computed:!1},description:"",type:{name:"string"},required:!1},assistiveTextInstructionsLabel:{defaultValue:{value:"'Press space bar to toggle drag drop mode, use arrow keys to move selected elements.'",computed:!1},description:"",type:{name:"string"},required:!1},assistiveTextDisabledInstructionsLabel:{defaultValue:{value:"'Reordering columns are disabled because they are filtered currently.'",computed:!1},description:"",type:{name:"string"},required:!1},selectAllLabel:{defaultValue:{value:"'Column name'",computed:!1},description:"",type:{name:"string"},required:!1},columnDefinitions:{description:"",type:{name:"array"},required:!0},isOpen:{description:"",type:{name:"bool"},required:!0},onSaveColumnPrefs:{description:"",type:{name:"func"},required:!0},originalColumnDefinitions:{description:"",type:{name:"array"},required:!0},setIsTearsheetOpen:{description:"",type:{name:"func"},required:!0}}};const Q=({instance:s,launcherButtonRef:a})=>{const{onSaveColumnPrefs:n,isTearsheetOpen:m,setIsTearsheetOpen:o,labels:b,...y}=s.customizeColumnsProps,{state:T}=l.useContext(xe),{featureFlags:u}=T||{};return l.useEffect(()=>{u&&!(u!=null&&u["enable-datagrid-useCustomizeColumns"])&&console.error("Datagrid useCustomizeColumns extension has not been enabled via feature flag.")},[u]),r.createElement(J,{...y,...b,isOpen:m,setIsTearsheetOpen:o,launcherButtonRef:a,columnDefinitions:s.allColumns,originalColumnDefinitions:s.columns,onSaveColumnPrefs:$=>{setTimeout(()=>{const d=$.filter(h=>!h.isVisible).map(h=>h.id);s.setHiddenColumns(d),typeof s.setColumnOrder=="function"?s.setColumnOrder($.map(h=>h.id)):console.warn("Column order can not be updated. Did you forget to add 'useColumnOrder' in 'useDatagrid'")},0),typeof n=="function"&&n($)}})};Q.propTypes={instance:t.object.isRequired};Q.__docgenInfo={description:"",methods:[],displayName:"TearsheetWrapper",props:{instance:{description:"",type:{name:"object"},required:!0}}};const Se=`${H.prefix}--datagrid`,X=l.forwardRef(({onClick:s,setIsTearsheetOpen:a,isTearsheetOpen:n,iconTooltipLabel:m="Customize columns",...o},b)=>l.createElement(ie,{...o,renderIcon:y=>l.createElement(ne,{size:16,...y}),iconDescription:m,tooltipPosition:"bottom",kind:"ghost",hasIconOnly:!0,"test-id":`${Se}__customize-columns-trigger`,ref:b,onClick:()=>{a(!n),typeof s=="function"&&s()}}));X.propTypes={iconTooltipLabel:t.string,isTearsheetOpen:t.bool.isRequired,onClick:t.func.isRequired,setIsTearsheetOpen:t.func.isRequired};X.__docgenInfo={description:"",methods:[],displayName:"ButtonWrapper",props:{isTearsheetOpen:{required:!0,tsType:{name:"boolean"},description:"",type:{name:"bool"}},iconTooltipLabel:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:"'Customize columns'",computed:!1},type:{name:"string"}},onClick:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"",type:{name:"func"}},setIsTearsheetOpen:{required:!0,tsType:{name:"signature",type:"function",raw:"(open: boolean) => void",signature:{arguments:[{type:{name:"boolean"},name:"open"}],return:{name:"void"}}},description:"",type:{name:"func"}}},composes:["ComponentProps"]};const Ie=s=>{const{customizeColumnsProps:a}=s,{labels:n}=a||{},[m,o]=l.useState(!1),b=l.useRef(null),y=l.useCallback(u=>l.createElement(X,{...u,iconTooltipLabel:n==null?void 0:n.iconTooltipLabel,isTearsheetOpen:m,setIsTearsheetOpen:o,ref:b}),[m,n==null?void 0:n.iconTooltipLabel]),T=l.useCallback(u=>l.createElement(Q,{...u,launcherButtonRef:b}),[b]);Object.assign(s,{customizeColumnsProps:{...a,isTearsheetOpen:m,setIsTearsheetOpen:o},CustomizeColumnsButton:y,CustomizeColumnsTearsheet:T})},We=s=>{s.useInstance.push(Ie)},Ke=ve.useColumnOrder;export{We as a,Ke as u};
