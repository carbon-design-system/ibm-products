{"version":3,"file":"useFiltering-D_DS8xkX.js","sources":["../../src/components/Datagrid/Datagrid/addons/Filtering/FilterFlyout.js","../../src/components/Datagrid/useFiltering.ts"],"sourcesContent":["/**\n * Copyright IBM Corp. 2022, 2024\n *\n * This source code is licensed under the Apache-2.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport {\n  BATCH,\n  CLEAR_FILTERS,\n  FLYOUT,\n  INSTANT,\n  SAVED_FILTERS,\n} from './constants';\nimport { IconButton, usePrefix } from '@carbon/react';\nimport React, { useContext, useEffect, useRef, useState } from 'react';\nimport { breakpoints, px } from '@carbon/layout';\nimport {\n  useClickOutside,\n  useWindowResize,\n} from '../../../../../global/js/hooks';\nimport {\n  useFilters,\n  useShouldDisableButtons,\n  useSubscribeToEventEmitter,\n} from './hooks';\n\nimport { ActionSet } from '../../../../ActionSet';\nimport { Filter } from '@carbon/react/icons';\nimport PropTypes from 'prop-types';\nimport cx from 'classnames';\nimport { pkg } from '../../../../../settings';\nimport { FilterContext } from './FilterProvider';\n\nconst blockClass = `${pkg.prefix}--datagrid`;\nconst componentClass = `${blockClass}-filter-flyout`;\n\nconst defaults = {\n  flyoutIconDescription: 'Open filters',\n  title: 'Filter',\n  primaryActionLabel: 'Apply',\n  secondaryActionLabel: 'Cancel',\n  align: 'bottom',\n};\n\n// Use same empty array every time, for benefit of useEffect() etc. dependency checking.\nconst emptyArray = [];\n\nconst FilterFlyout = ({\n  updateMethod,\n  flyoutIconDescription = defaults.flyoutIconDescription,\n  align = defaults.align,\n  filters = emptyArray,\n  title = defaults.title,\n  primaryActionLabel = defaults.primaryActionLabel,\n  onFlyoutOpen = () => {},\n  onFlyoutClose = () => {},\n  onApply = () => {},\n  onCancel = () => {},\n  secondaryActionLabel = defaults.secondaryActionLabel,\n  setAllFilters,\n  data = emptyArray,\n  reactTableFiltersState = emptyArray,\n}) => {\n  /** State */\n  const [open, setOpen] = useState(false);\n  const [stackedLayout, setStackedLayout] = useState(false);\n\n  const handleCancel = () => {\n    setOpen(false);\n    onCancel();\n  };\n\n  const {\n    filtersState,\n    prevFiltersObjectArrayRef,\n    prevFiltersRef,\n    cancel,\n    reset,\n    renderFilter,\n    filtersObjectArray,\n    lastAppliedFilters,\n  } = useFilters({\n    updateMethod,\n    filters,\n    setAllFilters,\n    variation: FLYOUT,\n    reactTableFiltersState,\n    onCancel: handleCancel,\n  });\n\n  const { width } = breakpoints.md;\n  const mdPxWidth = parseInt(width) * 16;\n\n  /** Refs */\n  const filterFlyoutRef = useRef(null);\n  const flyoutInnerRef = useRef(null);\n  const flyoutFiltersContainerRef = useRef(null);\n\n  /** State from hooks */\n  const [shouldDisableButtons, setShouldDisableButtons] =\n    useShouldDisableButtons({\n      initialValue: true,\n      filtersState,\n      prevFiltersRef,\n      open,\n    });\n\n  // Skip resize testing\n  /* istanbul ignore next */\n  const handleResize = (current) => {\n    const filterFlyoutRefPosition =\n      flyoutInnerRef?.current.getBoundingClientRect();\n    const originalFlyoutWidth = parseInt(\n      window.getComputedStyle(flyoutInnerRef?.current).getPropertyValue('width')\n    );\n    // Check to see if left value from flyout getBoundingClientRect is a negative number\n    // If it is, that is the amount we need to subtract from the flyout width\n    if (Math.sign(filterFlyoutRefPosition.left) === -1) {\n      const newFlyoutWidth =\n        originalFlyoutWidth - Math.abs(filterFlyoutRefPosition.left);\n      flyoutInnerRef.current.style.width = px(newFlyoutWidth);\n    }\n    // Check to see if left value from flyout getBoundingClientRect is a positive number or 0\n    // If it is, that is the amount we need to add to the flyout width until we reach the\n    // max-width of the flyout (642)\n    if (\n      (originalFlyoutWidth < 642 &&\n        Math.sign(filterFlyoutRefPosition.left) === 1) ||\n      Math.sign(filterFlyoutRefPosition.left).toString() === '0'\n    ) {\n      const newFlyoutWidth =\n        originalFlyoutWidth + Math.abs(filterFlyoutRefPosition.left);\n      flyoutInnerRef.current.style.width = px(newFlyoutWidth);\n    }\n    // Begin stacking filters at this specific point\n    if (current?.innerWidth <= mdPxWidth + 254) {\n      setStackedLayout(true);\n    } else {\n      setStackedLayout(false);\n    }\n  };\n\n  useWindowResize(({ current }) => {\n    handleResize(current);\n  });\n\n  /** Context */\n  const { dispatch: localDispatch } = useContext(FilterContext);\n\n  /** Memos */\n  const showActionSet = updateMethod === BATCH;\n  const carbonPrefix = usePrefix();\n\n  /** Methods */\n  const openFlyout = () => {\n    setOpen(true);\n    onFlyoutOpen();\n  };\n\n  const closeFlyout = () => {\n    setOpen(false);\n    onFlyoutClose();\n    flyoutInnerRef.current.style.width = px(642);\n  };\n\n  useEffect(() => {\n    // Initialize flyout width\n    flyoutInnerRef.current.style.width = px(642);\n  }, []);\n\n  const apply = () => {\n    setAllFilters(filtersObjectArray);\n    closeFlyout();\n    // From the user\n    onApply({\n      filtersState,\n      filtersObjectArray,\n      lastAppliedFilters,\n    });\n    // When the user clicks apply, the action set buttons should be disabled again\n    setShouldDisableButtons(true);\n\n    // updates the ref so next time the flyout opens we have records of the previous filters\n    prevFiltersRef.current = JSON.stringify(filtersState);\n    prevFiltersObjectArrayRef.current = JSON.stringify(filtersObjectArray);\n\n    // Update the last applied filters\n    lastAppliedFilters.current = JSON.stringify(filtersObjectArray);\n\n    // Dispatch action from local filter context to track filters in order\n    // to keep history if `isFetching` becomes true. If so, react-table\n    // clears all filter history\n    localDispatch({\n      type: SAVED_FILTERS,\n      payload: {\n        savedFilters: filtersObjectArray,\n      },\n    });\n  };\n\n  /** Renders all filters */\n  const renderFilters = () => filters.map(renderFilter);\n\n  const renderActionSet = () => {\n    return (\n      showActionSet && (\n        <ActionSet\n          actions={[\n            {\n              key: 1,\n              kind: 'primary',\n              label: primaryActionLabel,\n              onClick: apply,\n              isExpressive: false,\n              disabled: shouldDisableButtons,\n            },\n            {\n              key: 3,\n              kind: 'secondary',\n              label: secondaryActionLabel,\n              onClick: cancel,\n              isExpressive: false,\n            },\n          ]}\n          size=\"md\"\n          buttonSize=\"md\"\n        />\n      )\n    );\n  };\n\n  /** Effects */\n  // Close flyout when clicking outside\n  useClickOutside(filterFlyoutRef, (target) => {\n    const hasClickedOnDatePicker = target.closest('.flatpickr-calendar');\n    const hasClickedOnDropdown =\n      target.className === `${carbonPrefix}--list-box__menu-item__option`;\n\n    // Do not do anything if flyout is closed or if clicking on anything\n    // rendered via a portal\n    if (!open || hasClickedOnDatePicker || hasClickedOnDropdown) {\n      return;\n    }\n\n    closeFlyout();\n    cancel();\n  });\n\n  // tableId is passed in from the event emitter from the FilterSummary component\n  // in  DatagridContent\n  useSubscribeToEventEmitter(CLEAR_FILTERS, (tableId) => {\n    reset(tableId);\n  });\n\n  return (\n    <div className={`${componentClass}__container`} ref={filterFlyoutRef}>\n      <IconButton\n        label={flyoutIconDescription}\n        kind=\"ghost\"\n        align={align}\n        onClick={open ? closeFlyout : openFlyout}\n        className={cx(`${componentClass}__trigger`, {\n          [`${componentClass}__trigger--open`]: open,\n        })}\n        disabled={data.length === 0}\n      >\n        <Filter />\n      </IconButton>\n      <div\n        className={cx(componentClass, {\n          [`${componentClass}--open`]: open,\n          [`${componentClass}--batch`]: showActionSet,\n          [`${componentClass}--instant`]: !showActionSet,\n        })}\n        ref={flyoutInnerRef}\n      >\n        <div className={`${componentClass}__inner-container`}>\n          <span className={`${componentClass}__title`}>{title}</span>\n          <div\n            className={cx(`${componentClass}__filters`, {\n              [`${componentClass}__stacked`]: stackedLayout,\n            })}\n            ref={flyoutFiltersContainerRef}\n          >\n            {renderFilters()}\n          </div>\n        </div>\n        {renderActionSet()}\n      </div>\n    </div>\n  );\n};\n\nFilterFlyout.propTypes = {\n  /**\n   * Tooltip alignment for the filter button\n   */\n  align: PropTypes.string,\n  /**\n   * All data rows in the table\n   */\n  data: PropTypes.array.isRequired,\n\n  /**\n   * Array of filters to render\n   */\n  filters: PropTypes.arrayOf(\n    PropTypes.shape({\n      type: PropTypes.string.isRequired,\n      column: PropTypes.string.isRequired,\n      props: PropTypes.object.isRequired,\n    })\n  ).isRequired,\n\n  /**\n   * Icon description for the filter flyout button\n   */\n  flyoutIconDescription: PropTypes.string,\n\n  /**\n   * Callback when the apply button is clicked\n   */\n  onApply: PropTypes.func,\n\n  /**\n   * Callback when the cancel button is clicked\n   */\n  onCancel: PropTypes.func,\n\n  /**\n   * Callback when the flyout closes\n   */\n  onFlyoutClose: PropTypes.func,\n\n  /**\n   * Callback when the flyout opens\n   */\n  onFlyoutOpen: PropTypes.func,\n\n  /**\n   * Label text of the primary action in the flyout\n   */\n  primaryActionLabel: PropTypes.string,\n\n  /**\n   * Filters from react table's state\n   */\n  reactTableFiltersState: PropTypes.arrayOf(\n    PropTypes.shape({\n      id: PropTypes.string.isRequired,\n      type: PropTypes.string.isRequired,\n      value: PropTypes.any.isRequired,\n    })\n  ),\n\n  /**\n   * Label text of the secondary action in the flyout\n   */\n  secondaryActionLabel: PropTypes.string,\n\n  /**\n   * Function that sets all the filters, this comes from the datagridState\n   */\n  setAllFilters: PropTypes.func.isRequired,\n\n  /**\n   * Title of the filter flyout\n   */\n  title: PropTypes.string,\n\n  /**\n   * The update method used to apply the filters\n   */\n  updateMethod: PropTypes.oneOf([BATCH, INSTANT]).isRequired,\n};\n\nexport default FilterFlyout;\n","/**\n * Copyright IBM Corp. 2022, 2024\n *\n * This source code is licensed under the Apache-2.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport { useMemo } from 'react';\nimport { FilterFlyout } from './Datagrid/addons/Filtering';\nimport {\n  BATCH,\n  CHECKBOX,\n  DATE,\n  MULTISELECT,\n  NUMBER,\n  RADIO,\n} from './Datagrid/addons/Filtering/constants';\nimport { Hooks, TableInstance } from 'react-table';\nimport { DataGridState } from './types';\n\n// This function was taken from https://github.com/TanStack/table/blob/v7/src/filterTypes.js\nexport const exactText = (rows, ids, filterValue) => {\n  return rows.filter((row) => {\n    return ids.some((id) => {\n      const rowValue = row.values[id];\n      return rowValue !== undefined\n        ? String(rowValue).toLowerCase() === String(filterValue).toLowerCase()\n        : true;\n    });\n  });\n};\n\nconst handleMultiFilter = (rows, id, value) => {\n  // gets all the items that are selected and returns their value\n  const selectedItems = value\n    .filter((item) => item.selected)\n    .map((item) => item.value);\n\n  // if the user removed all checkboxes then display all rows\n  if (selectedItems.length === 0) {\n    return rows;\n  }\n\n  return rows.filter((row) => {\n    const rowValue = row.values[id];\n    return selectedItems.includes(rowValue);\n  });\n};\n\nconst useFiltering = (hooks: Hooks) => {\n  /* istanbul ignore next */\n  const filterTypes = useMemo(\n    () => ({\n      [DATE]: (rows, id, [startDate, endDate]) => {\n        return rows.filter((row) => {\n          const rowValue = row.values[id];\n          const startDateObj =\n            typeof startDate === 'object' ? startDate : new Date(startDate);\n          const endDateObj =\n            typeof endDate === 'object' ? endDate : new Date(endDate);\n          const rowValueDateObj =\n            typeof rowValue === 'object' ? rowValue : new Date(rowValue);\n          if (\n            rowValueDateObj.getTime() <= endDateObj.getTime() &&\n            rowValueDateObj.getTime() >= startDateObj.getTime()\n          ) {\n            // In date range\n            return true;\n          } else {\n            // Not in date range\n            return false;\n          }\n        });\n      },\n      [NUMBER]: (rows, id, value) => {\n        if (value === '') {\n          return rows;\n        }\n\n        const parsedValue = parseInt(value);\n        return rows.filter((row) => {\n          const rowValue = row.values[id];\n          return rowValue === parsedValue;\n        });\n      },\n      [CHECKBOX]: (rows, id, value) => handleMultiFilter(rows, id, value),\n      [MULTISELECT]: (rows, id, value) => handleMultiFilter(rows, id, value),\n      [RADIO]: (rows, id, value) => exactText(rows, id, value),\n    }),\n    []\n  );\n\n  hooks.useInstance.push((instance: TableInstance) => {\n    const { filterProps, setAllFilters, setFilter, headers, data, state } =\n      instance as DataGridState;\n\n    const defaultProps = {\n      variation: 'flyout',\n      updateMethod: BATCH,\n      panelIconDescription: 'Open filter panel',\n      reactTableFiltersState: state.filters,\n    };\n\n    const getFilterFlyoutProps = () => ({\n      ...defaultProps,\n      ...filterProps,\n      setAllFilters,\n      setFilter,\n      headers,\n      data,\n    });\n\n    Object.assign(instance, {\n      filterProps: {\n        ...defaultProps,\n        ...(instance as DataGridState)?.filterProps,\n      },\n      filterTypes,\n      getFilterFlyoutProps,\n      FilterFlyout,\n    });\n  });\n};\n\nexport default useFiltering;\n"],"names":["blockClass","pkg","componentClass","defaults","emptyArray","FilterFlyout","updateMethod","flyoutIconDescription","align","filters","title","primaryActionLabel","onFlyoutOpen","onFlyoutClose","onApply","onCancel","secondaryActionLabel","setAllFilters","data","reactTableFiltersState","open","setOpen","useState","stackedLayout","setStackedLayout","handleCancel","filtersState","prevFiltersObjectArrayRef","prevFiltersRef","cancel","reset","renderFilter","filtersObjectArray","lastAppliedFilters","useFilters","FLYOUT","width","breakpoints","mdPxWidth","filterFlyoutRef","useRef","flyoutInnerRef","flyoutFiltersContainerRef","shouldDisableButtons","setShouldDisableButtons","useShouldDisableButtons","handleResize","current","filterFlyoutRefPosition","originalFlyoutWidth","newFlyoutWidth","px","useWindowResize","localDispatch","useContext","FilterContext","showActionSet","BATCH","carbonPrefix","usePrefix","openFlyout","closeFlyout","useEffect","apply","SAVED_FILTERS","renderFilters","renderActionSet","React","ActionSet","useClickOutside","target","hasClickedOnDatePicker","hasClickedOnDropdown","useSubscribeToEventEmitter","CLEAR_FILTERS","tableId","IconButton","cx","Filter","PropTypes","INSTANT","exactText","rows","ids","filterValue","row","id","rowValue","handleMultiFilter","value","selectedItems","item","useFiltering","hooks","filterTypes","useMemo","DATE","startDate","endDate","startDateObj","endDateObj","rowValueDateObj","NUMBER","parsedValue","CHECKBOX","MULTISELECT","RADIO","instance","filterProps","setFilter","headers","state","defaultProps","getFilterFlyoutProps"],"mappings":"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"}