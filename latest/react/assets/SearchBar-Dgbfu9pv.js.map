{"version":3,"file":"SearchBar-Dgbfu9pv.js","sources":["../../src/components/SearchBar/SearchBar.tsx"],"sourcesContent":["/**\n * Copyright IBM Corp. 2024, 2024\n *\n * This source code is licensed under the Apache-2.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n// Carbon and package components we use.\nimport { Button, MultiSelect, Search } from '@carbon/react';\n// Import portions of React that are needed.\nimport React, {\n  PropsWithChildren,\n  ReactNode,\n  useEffect,\n  useState,\n} from 'react';\n\n// Other standard imports.\nimport PropTypes from 'prop-types';\nimport cx from 'classnames';\nimport { getDevtoolsProps } from '../../global/js/utils/devtools';\nimport { pkg } from '../../settings';\n\n// The block part of our conventional BEM class names (blockClass__E--M).\nconst blockClass = `${pkg.prefix}--search-bar`;\nconst componentName = 'SearchBar';\n\n// NOTE: the component SCSS is not imported here: it is rolled up separately.\n\n// Default values for props\nconst defaults = {\n  onSubmit: () => {},\n  onChange: () => {},\n  scopes: [],\n  selectedScopes: [],\n  hideScopesLabel: true,\n};\n\ntype Scopes = string[] | object[];\n\nexport interface SearchBarProps extends PropsWithChildren {\n  /** @type {string} Optional additional class name. */\n  className?: string;\n\n  /** @type {string} The label text for the search text input. */\n  clearButtonLabelText: string;\n\n  /**\n   * Whether or not the scopes MultiSelect label is visually hidden.\n   */\n  hideScopesLabel?: boolean;\n\n  /** @type {string} The label text for the search text input. */\n  labelText: string;\n\n  /** @type {Function} Function handler for when the user changes their query search. */\n  onChange?: (event: any) => void;\n\n  /** @type {Function} Function handler for when the user submits a search. */\n  onSubmit?: (event: any) => void;\n\n  /** @type {string} Placeholder text to be displayed in the search input. */\n  placeholderText: string;\n\n  /** @type {Function} Function to get the text for each scope to display in dropdown. */\n  scopeToString?: (item: string | object) => string;\n\n  /** @type {Array<any>} Array of allowed search scopes. */\n  scopes?: Scopes;\n\n  /** @type {string} The name text for the search scope type. */\n\n  scopesTypeLabel?: NonNullable<ReactNode>;\n\n  /** @type {Array<any> Array of initially selected search scopes. */\n  selectedScopes?: Scopes;\n\n  /**\n   * Optional custom sorting algorithm for an array of scope items.\n   * By default, scope items are sorted in ascending alphabetical order,\n   * with \"selected\" items moved to the start of the scope items array.\n   */\n  sortItems?: (items: readonly unknown[]) => unknown[];\n\n  /** @type {string} The label text for the search submit button. */\n  submitLabel: string;\n\n  /**\n   * Provide accessible label text for the scopes MultiSelect.\n   */\n  titleText?: string;\n\n  /** @type {func} Callback function for translating MultiSelect's child ListBoxMenuIcon SVG title. */\n  translateWithId?: (\n    messageId: 'close.menu' | 'open.menu' | 'clear.all' | 'clear.selection'\n  ) => string;\n\n  /** @type {string} Search query value. */\n  value?: string;\n  /**\n   * Search bar with input field and search button\n   */\n}\n\nexport const SearchBar = React.forwardRef<HTMLFormElement, SearchBarProps>(\n  (\n    {\n      // The component props, in alphabetical order (for consistency).\n      className,\n      clearButtonLabelText,\n      hideScopesLabel = defaults.hideScopesLabel,\n      labelText,\n      onChange = defaults.onChange,\n      onSubmit = defaults.onSubmit,\n      placeholderText,\n      scopes = [],\n      scopesTypeLabel,\n      scopeToString,\n      selectedScopes = [],\n      sortItems,\n      submitLabel,\n      translateWithId,\n      value,\n      // Collect any other property values passed in.\n      ...rest\n    }: SearchBarProps,\n    ref\n  ) => {\n    const [text, setText] = useState(value || '');\n    const [_selectedScopes, setSelectedScopes] = useState(selectedScopes || []);\n    const [isInputDirty, setIsInputDirty] = useState(false);\n\n    useEffect(() => {\n      if (!text || !text.length) {\n        setIsInputDirty(false);\n      } else {\n        setIsInputDirty(true);\n      }\n    }, [text]);\n    /**\n     * Handler for form submit that calls onSubmit prop.\n     * @param {Event} event Submit event generated.\n     */\n    const handleSubmit = (event: any) => {\n      event.preventDefault();\n      const eventObject: { value: string; selectedScopes?: Scopes } = {\n        value: text,\n      };\n      if (scopes.length > 0) {\n        eventObject.selectedScopes = _selectedScopes;\n      }\n\n      onSubmit(eventObject);\n    };\n\n    /**\n     * Handler for when scope selection changes that calls onChangeProp.\n     * @param {{selectedItems: Array<any>}} {selectedItems} Object containing array of selected items.\n     */\n    const handleSearchScopeChange = ({\n      selectedItems,\n    }: {\n      selectedItems: Scopes[];\n    }) => {\n      setSelectedScopes(selectedItems);\n\n      onChange({\n        selectedScopes: selectedItems,\n        value: text,\n      });\n    };\n\n    /**\n     * Handler for search input changes that calls onChange prop.\n     * @param {KeyboardEvent} event Event object from input change.\n     */\n    const handleInputChange = (event: any) => {\n      const { value } = event.target;\n      const eventObject: { value: string; selectedScopes?: Scopes } = { value };\n      if (scopes.length > 0) {\n        eventObject.selectedScopes = selectedScopes;\n      }\n\n      setText(value);\n      onChange(eventObject);\n    };\n\n    const multiSelectProps = {\n      initialSelectedItems: selectedScopes,\n      items: scopes,\n      itemToString: scopeToString,\n      label: scopesTypeLabel as NonNullable<ReactNode>,\n      sortItems,\n      translateWithId,\n    };\n\n    return (\n      <form\n        {...rest}\n        ref={ref}\n        {...getDevtoolsProps(componentName)}\n        className={cx(blockClass, className, {\n          [`${blockClass}--hide-scopes-label`]: hideScopesLabel,\n        })}\n        onSubmit={handleSubmit}\n      >\n        {scopes?.length ? (\n          <MultiSelect\n            {...multiSelectProps}\n            id={`${blockClass}__multi-select`}\n            className={`${blockClass}__scopes`}\n            onChange={handleSearchScopeChange}\n            size=\"lg\"\n          />\n        ) : null}\n        <Search\n          className={`${blockClass}__input`}\n          closeButtonLabelText={clearButtonLabelText}\n          labelText={labelText}\n          {...{ name: 'search-input' }}\n          onChange={handleInputChange}\n          placeholder={placeholderText}\n          value={text}\n          size=\"lg\"\n        />\n        <Button\n          name=\"search-submit\"\n          kind=\"primary\"\n          type=\"submit\"\n          className={`${blockClass}__submit`}\n          disabled={!isInputDirty}\n        >\n          {submitLabel}\n        </Button>\n      </form>\n    );\n  }\n);\n\n// Return a placeholder if not released and not enabled by feature flag\n\n// The display name of the component, used by React. Note that displayName\n// is used in preference to relying on function.name.\nSearchBar.displayName = componentName;\n\nconst conditionalScopePropValidator = (\n  props,\n  propName,\n  componentName,\n  ...rest\n) => {\n  if (props.scopes && props.scopes.length > 0 && !props[propName]) {\n    return new Error(\n      `Required \\`${propName}\\` when \\`scopes\\` prop type is supplied to \\`${componentName}\\`. Validation failed.`\n    );\n  }\n  /**@ts-ignore */\n  return PropTypes.string(props, propName, componentName, ...rest);\n};\n\nexport const deprecatedProps = {\n  /**\n   * **Deprecated**\n   *\n   * Provide accessible label text for the scopes MultiSelect.\n   */\n  titleText: PropTypes.string,\n};\n\n// The types and DocGen commentary for the component props,\n// in alphabetical order (for consistency).\n// See https://www.npmjs.com/package/prop-types#usage.\nSearchBar.propTypes = {\n  /** @type {string} Optional additional class name. */\n  className: PropTypes.string,\n\n  /** @type {string} The label text for the search text input. */\n  clearButtonLabelText: PropTypes.string.isRequired,\n\n  /**\n   * Whether or not the scopes MultiSelect label is visually hidden.\n   */\n  hideScopesLabel: PropTypes.bool,\n\n  /** @type {string} The label text for the search text input. */\n  labelText: PropTypes.string.isRequired,\n\n  /** @type {Function} Function handler for when the user changes their query search. */\n  onChange: PropTypes.func,\n\n  /** @type {Function} Function handler for when the user submits a search. */\n  onSubmit: PropTypes.func,\n\n  /** @type {string} Placeholder text to be displayed in the search input. */\n  placeholderText: PropTypes.string.isRequired,\n\n  /** @type {Function} Function to get the text for each scope to display in dropdown. */\n  scopeToString: PropTypes.func,\n\n  /** @type {Array<any>} Array of allowed search scopes. */\n  /**@ts-ignore */\n  scopes: PropTypes.arrayOf(\n    PropTypes.oneOfType([PropTypes.string, PropTypes.object])\n  ),\n\n  /** @type {string} The name text for the search scope type. */\n  scopesTypeLabel: conditionalScopePropValidator,\n\n  /** @type {Array<any> Array of initially selected search scopes. */\n  /**@ts-ignore */\n  selectedScopes: PropTypes.arrayOf(\n    PropTypes.oneOfType([PropTypes.string, PropTypes.object])\n  ),\n\n  /**\n   * Optional custom sorting algorithm for an array of scope items.\n   * By default, scope items are sorted in ascending alphabetical order,\n   * with \"selected\" items moved to the start of the scope items array.\n   */\n  sortItems: PropTypes.func,\n\n  /** @type {string} The label text for the search submit button. */\n  submitLabel: PropTypes.string.isRequired,\n\n  /** @type {func} Callback function for translating MultiSelect's child ListBoxMenuIcon SVG title. */\n  translateWithId: PropTypes.func,\n\n  /** @type {string} Search query value. */\n  value: PropTypes.string,\n\n  ...deprecatedProps,\n};\n"],"names":["blockClass","pkg","componentName","defaults","SearchBar","React","className","clearButtonLabelText","hideScopesLabel","labelText","onChange","onSubmit","placeholderText","scopes","scopesTypeLabel","scopeToString","selectedScopes","sortItems","submitLabel","translateWithId","value","rest","ref","text","setText","useState","_selectedScopes","setSelectedScopes","isInputDirty","setIsInputDirty","useEffect","handleSubmit","event","eventObject","handleSearchScopeChange","selectedItems","handleInputChange","multiSelectProps","getDevtoolsProps","cx","MultiSelect","Search","Button","conditionalScopePropValidator","props","propName","PropTypes","deprecatedProps"],"mappings":"8MAwBA,MAAMA,EAAa,GAAGC,EAAI,MAAM,eAC1BC,EAAgB,YAKhBC,EAAW,CACf,SAAU,IAAM,CAAC,EACjB,SAAU,IAAM,CAAC,EAGjB,gBAAiB,EACnB,EAoEaC,EAAYC,EAAM,WAC7B,CACE,CAEE,UAAAC,EACA,qBAAAC,EACA,gBAAAC,EAAkBL,EAAS,gBAC3B,UAAAM,EACA,SAAAC,EAAWP,EAAS,SACpB,SAAAQ,EAAWR,EAAS,SACpB,gBAAAS,EACA,OAAAC,EAAS,CAAA,EACT,gBAAAC,EACA,cAAAC,EACA,eAAAC,EAAiB,CAAA,EACjB,UAAAC,EACA,YAAAC,EACA,gBAAAC,EACA,MAAAC,EAEA,GAAGC,CAAA,EAELC,IACG,CACH,KAAM,CAACC,EAAMC,CAAO,EAAIC,EAAAA,SAASL,GAAS,EAAE,EACtC,CAACM,EAAiBC,CAAiB,EAAIF,EAAAA,SAAST,GAAkB,CAAA,CAAE,EACpE,CAACY,EAAcC,CAAe,EAAIJ,EAAAA,SAAS,EAAK,EAEtDK,EAAAA,UAAU,IAAM,CACV,CAACP,GAAQ,CAACA,EAAK,OACjBM,EAAgB,EAAK,EAErBA,EAAgB,EAAI,CAExB,EAAG,CAACN,CAAI,CAAC,EAKT,MAAMQ,EAAgBC,GAAe,CACnCA,EAAM,eAAA,EACN,MAAMC,EAA0D,CAC9D,MAAOV,CAAA,EAELV,EAAO,OAAS,IAClBoB,EAAY,eAAiBP,GAG/Bf,EAASsB,CAAW,CACtB,EAMMC,EAA0B,CAAC,CAC/B,cAAAC,CAAA,IAGI,CACJR,EAAkBQ,CAAa,EAE/BzB,EAAS,CACP,eAAgByB,EAChB,MAAOZ,CAAA,CACR,CACH,EAMMa,EAAqBJ,GAAe,CACxC,KAAM,CAAE,MAAAZ,CAAAA,EAAUY,EAAM,OAClBC,EAA0D,CAAE,MAAAb,CAAAA,EAC9DP,EAAO,OAAS,IAClBoB,EAAY,eAAiBjB,GAG/BQ,EAAQJ,CAAK,EACbV,EAASuB,CAAW,CACtB,EAEMI,EAAmB,CACvB,qBAAsBrB,EACtB,MAAOH,EACP,aAAcE,EACd,MAAOD,EACP,UAAAG,EACA,gBAAAE,CAAA,EAGF,OACEd,EAAA,cAAC,OAAA,CACE,GAAGgB,EACJ,IAAAC,EACC,GAAGgB,EAAiBpC,CAAa,EAClC,UAAWqC,EAAGvC,EAAYM,EAAW,CACnC,CAAC,GAAGN,CAAU,qBAAqB,EAAGQ,CAAA,CACvC,EACD,SAAUuB,CAAA,EAETlB,GAAQ,OACPR,EAAA,cAACmC,EAAA,CACE,GAAGH,EACJ,GAAI,GAAGrC,CAAU,iBACjB,UAAW,GAAGA,CAAU,WACxB,SAAUkC,EACV,KAAK,IAAA,CAAA,EAEL,KACJ7B,EAAA,cAACoC,EAAA,CACC,UAAW,GAAGzC,CAAU,UACxB,qBAAsBO,EACtB,UAAAE,EACM,KAAM,eACZ,SAAU2B,EACV,YAAaxB,EACb,MAAOW,EACP,KAAK,IAAA,CAAA,EAEPlB,EAAA,cAACqC,EAAA,CACC,KAAK,gBACL,KAAK,UACL,KAAK,SACL,UAAW,GAAG1C,CAAU,WACxB,SAAU,CAAC4B,CAAA,EAEVV,CAAA,CACH,CAGN,CACF,EAMAd,EAAU,YAAcF,EAExB,MAAMyC,EAAgC,CACpCC,EACAC,EACA3C,KACGmB,IAECuB,EAAM,QAAUA,EAAM,OAAO,OAAS,GAAK,CAACA,EAAMC,CAAQ,EACrD,IAAI,MACT,cAAcA,CAAQ,iDAAiD3C,CAAa,wBAAA,EAIjF4C,EAAU,OAAOF,EAAOC,EAAU3C,EAAe,GAAGmB,CAAI,EAGpD0B,EAAkB,CAM7B,UAAWD,EAAU,MACvB,EAKA1C,EAAU,UAAY,CAEpB,UAAW0C,EAAU,OAGrB,qBAAsBA,EAAU,OAAO,WAKvC,gBAAiBA,EAAU,KAG3B,UAAWA,EAAU,OAAO,WAG5B,SAAUA,EAAU,KAGpB,SAAUA,EAAU,KAGpB,gBAAiBA,EAAU,OAAO,WAGlC,cAAeA,EAAU,KAIzB,OAAQA,EAAU,QAChBA,EAAU,UAAU,CAACA,EAAU,OAAQA,EAAU,MAAM,CAAC,CAAA,EAI1D,gBAAiBH,EAIjB,eAAgBG,EAAU,QACxBA,EAAU,UAAU,CAACA,EAAU,OAAQA,EAAU,MAAM,CAAC,CAAA,EAQ1D,UAAWA,EAAU,KAGrB,YAAaA,EAAU,OAAO,WAG9B,gBAAiBA,EAAU,KAG3B,MAAOA,EAAU,OAEjB,GAAGC,CACL;;;;;;;;;;;;;;;;;"}