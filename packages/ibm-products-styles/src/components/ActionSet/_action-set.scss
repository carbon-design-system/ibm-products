//
// Copyright IBM Corp. 2021, 2023
//
// This source code is licensed under the Apache-2.0 license found in the
// LICENSE file in the root directory of this source tree.
//

@use '@carbon/layout/scss/convert' as *;

@use '@carbon/styles/scss/theme' as *;
@use '@carbon/styles/scss/type';
@use '@carbon/styles/scss/spacing' as *;

@use '../../global/styles/project-settings' as c4p-settings;
@use '../SidePanel/side-panel-variables' as spv;
@use 'sass:map';

// The block part of our conventional BEM class names (blockClass__E--M).
$action-set-block-class: #{c4p-settings.$pkg-prefix}--action-set;

@mixin action-set-column() {
  --flex-direction: column;

  .#{$action-set-block-class}__action-button {
    width: 100%;
    max-width: none;
    flex: initial;
  }

  .#{$action-set-block-class}__action-button--ghost {
    padding-left: $spacing-05;
  }
}

@mixin action-set-layout() {
  /* for actions container query - note this changes the size calculation */
  container-name: action-set;
  container-type: inline-size;

  .#{$action-set-block-class} {
    --flex-direction: row;

    flex-direction: var(--flex-direction);
  }

  /* stylelint-disable-next-line */
  $min-action-width: to-rem(176px);

  .#{$action-set-block-class}.#{$action-set-block-class} // extra classes needed for specificity
    .#{$action-set-block-class}__action-button {
    min-width: $min-action-width;
    /* stylelint-disable-next-line */
    max-width: to-rem(232px);
    flex: 0 1 25%;
  }

  .#{$action-set-block-class}.#{$action-set-block-class}
    .#{$action-set-block-class}__action-button--ghost {
    max-width: none;
    flex: 1 1 25%;
  }

  @container (width <= #{4 * $min-action-width}) {
    .#{$action-set-block-class}.#{$action-set-block-class}.#{$action-set-block-class}--quadruple {
      @include action-set-column();
    }

    .#{$action-set-block-class}.#{$action-set-block-class}.#{$action-set-block-class}--double {
      // Note that at 642px(40.125rem) flyout filter expects 1 row
      .#{$action-set-block-class}__action-button {
        max-width: none;
        flex-basis: 50%;
      }
    }
  }

  @container (width <= #{3 * $min-action-width}) {
    // Note that by 640px(40rem) sidepanel expects 1 row
    .#{$action-set-block-class}.#{$action-set-block-class}.#{$action-set-block-class}--triple {
      @include action-set-column();
    }
  }

  @container (width <= #{2 * $min-action-width}) {
    // Note that by 480px(30rem) side panel expects 1 row
    .#{$action-set-block-class}.#{$action-set-block-class}.#{$action-set-block-class}--double {
      @include action-set-column();
    }
  }
}

.#{$action-set-block-class}__container {
  @include action-set-layout();

  width: 100%;
}

.#{$action-set-block-class} {
  align-items: stretch;
  justify-content: flex-end;
  background-color: $layer-01;
}

.#{$action-set-block-class} .#{$action-set-block-class}__action-button {
  @include type.type-style('body-short-01');

  align-items: center;
  margin: 0;

  &.#{$action-set-block-class}__action-button--expressive {
    height: $spacing-10;
    padding-top: $spacing-05;
    padding-bottom: $spacing-07;
  }
}

.#{$action-set-block-class}:not(.#{$action-set-block-class}--stacking)
  .#{$action-set-block-class}__action-button--ghost {
  padding-left: $spacing-07;
}

.#{$action-set-block-class}
  .#{$action-set-block-class}__action-button
  .#{c4p-settings.$carbon-prefix}--inline-loading {
  position: absolute;
  top: 0;
  right: 0;
  width: $spacing-07;
}
