import{y as C,p as he,j as I,q as Zt,D as lt,E as vt,F as Ct,G as en}from"./settings-BiUEFdm2.js";import{r as d,R as tn}from"./index-BwDkhjyp.js";import{useMDXComponents as kt}from"./index-DlpNa54Y.js";import"./chunk-HLWAVYOI-CsZ1lTTC.js";import{e as nn,i as rn,C as an}from"./index-CDYzkStP.js";import{c as pe}from"./deprecate-D9ms-jbM.js";import{O as sn,a as on}from"./index-B7Id7uWF.js";import{d as me,a as ye,i as mt,h as cn,b as un,F as ln,s as Pt,u as mn,r as Ge}from"./useMultipleKeyTracking-CqX4c2qk.js";import{P as o}from"./index-Dk74W0Oi.js";import{u as Pe}from"./uuidv4-BQrI85uz.js";import{p as Ue}from"./props-helper-1oU9hECe.js";import{u as Fe}from"./usePreviousValue-DDnp_zt4.js";import{g as dn}from"./devtools-BPcQvzXy.js";import"./_commonjsHelpers-BosuxZz1.js";import"./index-CJvxHwuA.js";import"./events-Bq7WR1mU.js";import"./index-BONylQH5.js";import"./iframe-j3s5A4v9.js";import"../sb-preview/runtime.js";import"./react-18-Dd3bHtks.js";import"./extends-CCbyfPlC.js";import"./index-C2eUe6cH.js";import"./index-BjQFKvNH.js";import"./isSymbol-BZYRlrjc.js";import"./index-DrFu-skq.js";import"./Text-_TFgs5hl.js";import"./index-gKY8typL.js";import"./useAttachedMenu-BGzc4N1_.js";import"./bucket-11-S2aFzyL7.js";import"./wrapFocus-CuszVIVc.js";import"./mergeRefs-CTUecegF.js";import"./createClassWrapper-EbB2Yi8H.js";const hn=()=>{const[t,e]=d.useState(document.activeElement),a=()=>{e(document.activeElement)};return d.useEffect(()=>(document.addEventListener("focusin",a),()=>{document.removeEventListener("focusin",a)}),[]),t},De=t=>{const e=Math.max(t.point1.row,t.point2.row),a=Math.max(t.point1.column,t.point2.column),r=Math.min(t.point1.row,t.point2.row),s=Math.min(t.point1.column,t.point2.column);return{greatestRowIndex:e,greatestColumnIndex:a,lowestColumnIndex:s,lowestRowIndex:r}},dt=({ref:t,area:e,blockClass:a,defaultColumn:r,selectionAreas:s,setSelectionAreas:p,setActiveCellInsideSelectionArea:c,visibleColumns:u})=>{const{lowestColumnIndex:i,lowestRowIndex:f,greatestColumnIndex:T,greatestRowIndex:b}=De(e);(b-f>0||T-i>0)&&(c(!0),t.current.querySelector(`.${a}__active-cell--highlight`).setAttribute("data-selection-id",e.matcher));let w=0;u.forEach((k,$)=>{$>=i&&$<=T&&(w+=(k==null?void 0:k.width)||(r==null?void 0:r.width))});const m=(document.querySelector(`[data-row-index="${e.point1.row}"][data-column-index="${e.point1.column}"]`)||document.querySelector(`.${a}__body--td`)).offsetHeight,y=m*(b-f+1),H=document.querySelector(`.${a}__list--container`).firstElementChild,N=H.querySelector(`[data-row-index="${f}"][data-column-index="${i}"]`),q={top:N?N.getBoundingClientRect().top-H.getBoundingClientRect().top:f===0?0:m*f,left:N?N.getBoundingClientRect().left-H.getBoundingClientRect().left:i===0?0+(r.rowHeaderWidth-4):r.width*i+(r.rowHeaderWidth-4)},D=document.querySelector(`[data-matcher-id="${e.matcher}"]`)||document.createElement("div");D.classList.add(`${a}__selection-area--element`),D.setAttribute("data-matcher-id",e.matcher),D.style.width=C(w),D.style.height=C(y),D.style.left=C(q.left),D.style.top=C(q.top),H.appendChild(D);const z=me(s),g=z.findIndex(k=>k.matcher===e.matcher);z[g].areaCreated=!0,p(z)},Je=(t,e,a)=>{const r=me(e),s=[];r.forEach(c=>{var f,T,b,w;const u=Math.max((f=c.point1)==null?void 0:f[a],(T=c.point2)==null?void 0:T[a]),i=Math.min((b=c.point1)==null?void 0:b[a],(w=c.point2)==null?void 0:w[a]);for(let l=i;l<=u;l++)s.push(l)});const p=[...new Set(s)];return!!(r!=null&&r.length&&p.includes(t))},Nt=(t,e,a,r)=>me(e).some(c=>{var l,m,y,H,N,q,D,z;const u=a==="column"?"row":"column",i=Math.min((l=c==null?void 0:c.point1)==null?void 0:l[u],(m=c==null?void 0:c.point2)==null?void 0:m[u]),f=Math.max((y=c==null?void 0:c.point1)==null?void 0:y[u],(H=c==null?void 0:c.point2)==null?void 0:H[u]),T=Math.min((N=c==null?void 0:c.point1)==null?void 0:N[a],(q=c==null?void 0:c.point2)==null?void 0:q[a]),b=Math.max((D=c==null?void 0:c.point1)==null?void 0:D[a],(z=c==null?void 0:c.point2)==null?void 0:z[a]),w=(r==null?void 0:r.length)-1===f&&i===0;for(let g=T;g<=b;g++)if(t===g&&w)return!0;return!1}),Wt=({type:t,headerGroup:e,scrollBarSizeValue:a,totalVisibleColumns:r,defaultColumn:s,totalColumnsWidth:p,visibleColumns:c})=>{const u=a+s.rowHeaderWidth;if(!r){if(t==="header")return C(parseInt(e.getHeaderGroupProps().style.width)+u);if(t!=="header")return p+u}if(r)return c.map((f,T)=>T<=r-1&&((f==null?void 0:f.width)||(s==null?void 0:s.width))).reduce((f,T)=>f+T,0)+u},pn=({spreadsheetRef:t,activeCellCoordinates:e,containerHasFocus:a,createActiveCell:r,activeCellContent:s,isActiveHeaderCellChanged:p})=>{let c;d.useEffect(()=>{c()},[s,c,p]),c=d.useCallback(()=>{const u=t==null?void 0:t.current.querySelector(`[data-row-index="${e==null?void 0:e.row}"][data-column-index="${e==null?void 0:e.column}"]`),i=(e==null?void 0:e.row)==="header"&&!0,f=t==null?void 0:t.current.querySelector('[data-row-index="header"][data-column-index="header"]');a&&r({placementElement:e?u:f,coords:e,addToHeader:i})},[t,e,a,r])},fn=({blockClass:t=`${he.prefix}--data-spreadsheet`,focusedElement:e,removeActiveCell:a,setContainerHasFocus:r})=>{d.useEffect(()=>{e.classList.contains(`${t}--interactive-cell-element`)||(r(!1),a()),(e.classList.contains(t)||e.classList.contains(`${t}--interactive-cell-element`))&&r(!0)},[e,a,t,r])},wn=({isBlurSpreadsheet:t,spreadsheetRef:e,blockClass:a=`${he.prefix}--data-spreadsheet`,setActiveCellCoordinates:r,setSelectionAreas:s,removeActiveCell:p,setContainerHasFocus:c,removeCellEditor:u})=>{d.useEffect(()=>{const i=f=>{!e.current||e.current.contains(f.target)||f.target.classList.contains(`${a}__active-cell--highlight`)||f.target.classList.contains(`${a}--interactive-cell-element`)||(t.current=!0,r(null),s([]),p(),ye({spreadsheetRef:e}),c(!1))};return document.addEventListener("click",i),()=>{document.removeEventListener("click",i)}},[t,e,p,a,r,c,s,u])},yn=({isEditing:t,rows:e,activeCellCoordinates:a,activeCellRef:r,cellEditorRef:s,cellEditorRulerRef:p,visibleColumns:c,defaultColumn:u,cellEditorValue:i,blockClass:f=`${he.prefix}--data-spreadsheet`})=>{const[T,b]=d.useState(null),w=Fe({nextIndex:T});d.useEffect(()=>{w!=null&&w.nextIndex||b(a==null?void 0:a.column)},[w==null?void 0:w.nextIndex,a]),d.useEffect(()=>{var y,H,N,q,D;const l=p.current.offsetWidth,m=parseInt(s.current.style.width);if(t){const z=(y=e[a==null?void 0:a.row])==null?void 0:y.cells[a==null?void 0:a.column],g=r==null?void 0:r.current.style.left,k=r==null?void 0:r.current.style.top;if(s.current.style.left=g,s.current.style.top=k,s.current.style.display="block",s.current.style.height=r==null?void 0:r.current.style.height,s.current.style.paddingTop=`${(parseInt(r==null?void 0:r.current.style.height)-16)/2-1}px`,s.current.style.textAlign=((H=z==null?void 0:z.column)==null?void 0:H.placement)==="right"?"right":"left",(N=s.current)==null||N.focus(),l<m){const $=((q=c[T])==null?void 0:q.width)||(u==null?void 0:u.width);l<m-$&&(s.current.style.width=C(parseInt(s.current.style.width)-$),b(P=>P===0?P:P-1))}if(l>=m){b(O=>O===c.length-1?O:O+1);const P=T+1===c.length?0:((D=c[T+1])==null?void 0:D.width)||(u==null?void 0:u.width),n=a==null?void 0:a.row,F=(e.length-n)*u.rowHeight;s.current.style.maxHeight=C(F),s.current.style.width=C(P+m),s.current.style.height=C(s.current.scrollHeight),s.current.clientHeight===F-1?s.current.style.overflow="auto":s.current.style.overflow="hidden"}}t||(s.current.style.overflow="hidden",s.current.style.display="none",s.current.blur(),r.current.focus(),b(a==null?void 0:a.column))},[t,a,e,i,u,r,s,p,c,f,w==null?void 0:w.cellEditorValue,T])},gn=({currentMatcher:t,setSelectionAreas:e,selectedHeaderReorderActive:a,setSelectedHeaderReorderActive:r,setClickAndHoldActive:s,setValidStartingPoint:p,validStartingPoint:c,blockClass:u=`${he.prefix}--data-spreadsheet`,ref:i,setHeaderCellHoldActive:f,setColumnOrder:T,visibleColumns:b,setActiveCellCoordinates:w,activeCellCoordinates:l,rows:m,defaultColumn:y,selectionAreas:H})=>{d.useEffect(()=>{const N=q=>{var z,g;let D=!1;if((z=H==null?void 0:H[0])!=null&&z.header&&H[0].header.type==="column"&&(D=!0),!c&&D){f(!1);const k=i.current.querySelector(`.${u}__selection-area--element`),$=i.current.querySelector(`.${u}__selection-area--element-cloned`);if(!$)return;if($){const P=q.target.closest(`.${u}--interactive-cell-element`),n=parseInt==null?void 0:parseInt(P==null?void 0:P.getAttribute("data-column-index")),L=parseInt==null?void 0:parseInt($==null?void 0:$.getAttribute("data-column-index-original")),O=H.filter(B=>(B==null?void 0:B.matcher)===t)[0].header.selectedIndexList;if(!i.current.querySelector(`[data-row-index="header"][data-column-index="${n}"]`))return;const R=i.current.querySelector(`[data-matcher-id="${t}"]`),j=i.current.getBoundingClientRect(),M=i.current.querySelector(`.${u}__list--container`).scrollLeft,_=n<L,J=n>L,ae=J?n-L:L-n;if(e(B=>{const se=me(B);if(L===n)return B;const oe=se.findIndex(Z=>Z.matcher===t);if(oe===-1)return B;if(!O.includes(n)){const Z=J?O.map(ce=>ce+ae):O.map(ce=>ce-ae);se[oe].header.selectedIndexList=Z,se[oe].point1.column=Math.min(...Z),se[oe].point2.column=Math.max(...Z)}return se[oe].areaCreated=!1,se}),!O.includes(n)){const B=O.length,se=Math.min(...O),oe=b.map(A=>A.id),Z=[...oe],ce=()=>{const A=[];return O.map(Q=>A.push(oe[Q])),A};Z.splice(se,B);const le=O.findIndex(A=>A===L),ge=n-le;Z.splice(ge,0,...ce()),T(Z);const xe={...l,column:J?l.column+ae:l.column-ae};w(xe);const h=Array.from(i.current.querySelectorAll(`.${u}__th--selected-header`))[0].getBoundingClientRect().left-j.left+M,W=_?h:n===L?R.style.left:h;R.style.left=C(W)}const te=i.current.querySelector(`.${u}__reorder-indicator-line`);te==null||te.remove(),$==null||$.remove(),(g=k==null?void 0:k.classList)==null||g.remove(`${u}__selection-area--element`),r(!1)}}if(c||q.type==="mouseup"){s(!1),p(!1);const k=q.target.closest(`.${u}__body--td`);if(k){const $={row:Number(k.getAttribute("data-row-index")),column:Number(k.getAttribute("data-column-index"))};e(P=>{const n=me(P),L=n.findIndex(F=>F.matcher===t);return L===-1?P:(n[L].point2=$,n[L].areaCreated=!1,n)})}}};return document.addEventListener("mouseup",N),()=>{document.removeEventListener("mouseup",N)}},[u,t,e,s,p,c,a,r,i,f,T,b,w,l,m,y,H])},bn=({blockClass:t=`${he.prefix}--data-spreadsheet`,clonedSelectionElement:e,ref:a,spreadsheetCoords:r,leftScrollAmount:s})=>{const p=event.target.closest(`.${t}--interactive-cell-element`),c=p==null?void 0:p.getAttribute("data-column-index"),u=e==null?void 0:e.getAttribute("data-column-index-original"),i=p.getBoundingClientRect(),f=a.current.querySelector(`.${t}__reorder-indicator-line`),T=e==null?void 0:e.getAttribute("data-matcher-id"),b=a.current.querySelector(`[data-matcher-id="${T}"]`),w=a.current.querySelector(`.${t}__list--container`),l=10,m=120,y=100,{clientX:H}=event,{left:N,right:q}=w.getBoundingClientRect();if(H<m&&window.scrollBy(-l,0),H>window.innerWidth-y&&window.scrollBy(l,0),H>N&&H<N+m&&w.scrollBy(-l,0),H<q&&H>q-y&&w.scrollBy(l,0),Number(c)>Number(u)){const D=i.left-r.left+p.offsetWidth-2+s;f.style.left=C(D)}if(Number(c)<Number(u)){const D=i.left-r.left+s;f.style.left=C(D)}Number(c)===Number(u)&&(f.style.left=b.style.left)},xn=({ref:t,blockClass:e=`${he.prefix}--data-spreadsheet`,headerCellHoldActive:a,defaultColumn:r})=>{d.useEffect(()=>{const s=c=>{const u=t.current.querySelector(`.${e}__selection-area--element-cloned`);u&&t.current.addEventListener("mousemove",s);const i=t.current.getBoundingClientRect(),f=t.current.querySelector(`.${e}__list--container`),T=f.scrollLeft;bn({clonedSelectionElement:u,ref:t,spreadsheetCoords:i,leftScrollAmount:T}),t.current.getBoundingClientRect();const w=c.clientX-i.left,l=u==null?void 0:u.getAttribute("data-clone-offset-x"),m=f.scrollWidth,y=u.offsetWidth,H=Math.max(w-l,r==null?void 0:r.rowHeaderWidth),N=m-y>=H?H+T:m-y;N<i.right-40&&(u.style.left=C(N))};a&&t.current.addEventListener("mousemove",s);const p=t.current;return a||p==null||p.removeEventListener("mousemove",s),()=>{p==null||p.removeEventListener("mousemove",s)}})},Ne=(t,e)=>e=="cmd"?t.metaKey||t.ctrlKey:t[e],Sn=({indexList:t,newIndex:e,activeCellIndex:a})=>{const r=e>a?a:Math.min(...t,e),s=e<a?a:Math.max(...t,e),p=[];for(let c=r;c<=s;c++)p.push(c);return[...p]},Ke=({type:t,activeCellCoordinates:e,rows:a,columns:r,currentMatcher:s,setActiveCellCoordinates:p,setCurrentMatcher:c,setSelectionAreas:u,spreadsheetRef:i,index:f,isKeyboard:T,setSelectionAreaData:b,isHoldingCommandKey:w,isHoldingShiftKey:l})=>{w||(b([]),ye({spreadsheetRef:i}));const m=T?e==null?void 0:e.row:f,y=T?e==null?void 0:e.column:f,H={row:t==="column"?0:m,column:t==="column"?y:0},N={row:t==="column"?a.length-1:m,column:t==="column"?y:r.length-1},q=Pe();l||(p({row:t==="column"?0:m,column:t==="column"?y:0}),c(q));const D={point1:H,point2:N,areaCreated:!1,matcher:q,header:{type:t,selectedIndexList:[t==="column"?y:m]}};u(z=>{var k,$;const g=me(z);if(w){const n=g.filter(F=>{var O;return(O=F.header)==null?void 0:O.type}).filter(F=>{var O;return((O=F.header)==null?void 0:O.type)===t}),L=Je(f,n,t);return n.length&&L?z:[...z,D]}if(l){const n=g.filter(_=>{var J;return(J=_.header)==null?void 0:J.type}).filter(_=>_.matcher===s)[0],L=Math.max(n==null?void 0:n.point1[t],n==null?void 0:n.point2[t],e==null?void 0:e[t]),F=t==="column"?y:m,O={row:L<F?a.length-1:0,column:y},ee=me(z),R=ee.findIndex(_=>_.matcher===s),j=Sn({indexList:(($=(k=ee[R])==null?void 0:k.header)==null?void 0:$.selectedIndexList)||[t==="column"?y:m],newIndex:F,activeCellIndex:e==null?void 0:e[t]}),G=_=>_<F?{row:t==="column"?0:Math.min(...j),column:t==="column"?Math.min(...j):0}:O,M=_=>_<F?O:{row:t==="column"?a.length-1:Math.max(...j),column:t==="column"?Math.max(...j):r.length-1};if(!e||typeof e>"u"){c(q);const _={point1:G(t==="column"?y:m),point2:M(t==="column"?y:m),areaCreated:!1,matcher:q,header:{type:t,selectedIndexList:[t==="column"?y:m]}};return p({row:t==="column"?0:m,column:t==="column"?y:0}),[_]}return ee[R].point1=G(e==null?void 0:e[t]),ee[R].point2=M(e==null?void 0:e[t]),ee[R].areaCreated=!1,ee[R].header.selectedIndexList=j,ee}return[D]})},An=({activeCellInsideSelectionArea:t,activeCellCoordinates:e,activeCellRef:a,selectionAreas:r,updateActiveCellCoordinates:s})=>{if(!t)return;const p=a.current.getAttribute("data-selection-id"),c=r.findIndex(l=>l.matcher===p),u=r[c],{lowestColumnIndex:i,lowestRowIndex:f,greatestColumnIndex:T,greatestRowIndex:b}=De(u),w={...e};if((e==null?void 0:e.row)<b&&s({coords:w,updatedValue:{row:(w==null?void 0:w.row)+1},optOutOfSelectionAreaUpdate:!0}),(e==null?void 0:e.row)===b&&((e==null?void 0:e.column)<T&&s({coords:w,updatedValue:{column:(w==null?void 0:w.column)+1,row:f},optOutOfSelectionAreaUpdate:!0}),(e==null?void 0:e.column)===T)){if(r.length>1)if(r[c+1]){a.current.setAttribute("data-selection-id",r[c+1].matcher);const l=r[c+1],{lowestColumnIndex:m,lowestRowIndex:y}=De(l);s({coords:w,updatedValue:{column:m,row:y},optOutOfSelectionAreaUpdate:!0});return}else{a.current.setAttribute("data-selection-id",r[0].matcher);const l=r[0],{lowestColumnIndex:m,lowestRowIndex:y}=De(l);s({coords:w,updatedValue:{column:m,row:y},optOutOfSelectionAreaUpdate:!0})}if(r.length===1)return s({coords:w,updatedValue:{column:i,row:f},optOutOfSelectionAreaUpdate:!0})}},_n=({activeCellInsideSelectionArea:t,activeCellCoordinates:e,activeCellRef:a,selectionAreas:r,updateActiveCellCoordinates:s})=>{if(!t)return;const p=a.current.getAttribute("data-selection-id"),c=r.findIndex(w=>w.matcher===p),u=r[c],{lowestColumnIndex:i,lowestRowIndex:f,greatestColumnIndex:T,greatestRowIndex:b}=De(u);if((e==null?void 0:e.column)<T&&s({updatedValue:{column:(e==null?void 0:e.column)+1},optOutOfSelectionAreaUpdate:!0}),(e==null?void 0:e.column)===T&&((e==null?void 0:e.row)<b&&s({updatedValue:{column:i,row:(e==null?void 0:e.row)+1},optOutOfSelectionAreaUpdate:!0}),(e==null?void 0:e.row)===b)){if(r.length>1)if(r[c+1]){a.current.setAttribute("data-selection-id",r[c+1].matcher);const w=r[c+1],{lowestColumnIndex:l,lowestRowIndex:m}=De(w);s({updatedValue:{column:l,row:m},optOutOfSelectionAreaUpdate:!0});return}else{a.current.setAttribute("data-selection-id",r[0].matcher);const w=r[0],{lowestColumnIndex:l,lowestRowIndex:m}=De(w);s({updatedValue:{column:l,row:m},optOutOfSelectionAreaUpdate:!0})}if(r.length===1)return s({updatedValue:{column:i,row:f},optOutOfSelectionAreaUpdate:!0})}},ht=(t,e,a)=>{for(let r=t;r<=e;r++)a(r)},Tn=({activeCellCoordinates:t,selectionAreas:e,currentMatcher:a,rows:r,setActiveCellContent:s,updateData:p})=>{var l,m,y,H,N,q,D,z;if((t==null?void 0:t.column)==="header"||(t==null?void 0:t.row)==="header")return;const c=me(e),u=c.findIndex(g=>g.matcher===a),i=c[u],f=Math.min((l=i==null?void 0:i.point1)==null?void 0:l.column,(m=i==null?void 0:i.point2)==null?void 0:m.column),T=Math.max((y=i==null?void 0:i.point1)==null?void 0:y.column,(H=i==null?void 0:i.point2)==null?void 0:H.column),b=Math.min((N=i==null?void 0:i.point1)==null?void 0:N.row,(q=i==null?void 0:i.point2)==null?void 0:q.row),w=Math.max((D=i==null?void 0:i.point1)==null?void 0:D.row,(z=i==null?void 0:i.point2)==null?void 0:z.row);ht(f,T,g=>{ht(b,w,k=>{const $=r[k].cells[g];p(k,$==null?void 0:$.column.id,"")})}),s(null)},ze=`${he.prefix}--data-spreadsheet`,Dn=(t,e,a,...r)=>{const[s,p,c,u,i,f,T,b,w,l,m,y,H]=r;a.preventDefault();const q=a.target.closest(`.${ze}__body--td`).classList.contains(`${ze}__body--td`);H(q);const D=Ne(a,"cmd"),z=Ne(a,"shiftKey");f(!0);const g={row:t.row.index,column:e},k=Pe();if(T(!0),D)w.current.querySelector(`.${ze}__active-cell--highlight`).setAttribute("data-selection-id",k),m(!0),u(g),b(k),i(P=>[...P,{point1:g,matcher:k}]);else if(z){f(!0);const $=me(c),P=$.findIndex(n=>n.matcher===s);if(P===-1)return;$[P].point1=p,$[P].point2=g,$[P].areaCreated=!1,$[P].matcher=s,i($)}else y.current.style.display="none",m(!1),u(g),ye({spreadsheetRef:w}),i([{point1:g,matcher:k}]),b(k),l([])},In=(t,e,...a)=>{const[r,s,p]=a;if(r){const c={row:t.row.index,column:e};p(u=>{var T,b;const i=me(u),f=i.findIndex(w=>w.matcher===s);return f===-1||((T=i[f].point2)==null?void 0:T.row)===c.row&&((b=i[f].point2)==null?void 0:b.column)===c.column?u:(i[f].point2=c,i[f].areaCreated=!1,i)})}},Hn=(t,e,...a)=>{const[r,s,p,c,u,i,f,T]=a,b=Ne(e,"cmd");Ke({type:"row",activeCellCoordinates:i,rows:f,columns:r,setActiveCellCoordinates:u,setCurrentMatcher:c,setSelectionAreas:p,spreadsheetRef:s,index:t,setSelectionAreaData:T,isHoldingCommandKey:b})},$n=(t,...e)=>{const[a,r,s,p,c,u,i,f,T,b,w,l,m,y,H,N,q,D,z,g,k,$,P]=e,{key:n}=t;if(!H(n)&&(["ArrowLeft","ArrowUp","ArrowRight","ArrowDown"].indexOf(n)>-1&&b!=null&&b.length&&l.length<2&&!mt(l)&&(q([]),D([]),ye({spreadsheetRef:i})),(l==null?void 0:l.length)>1&&cn({activeCellCoordinates:s,event:t,keysPressedList:l,selectionAreas:b,currentMatcher:f,rows:u,setSelectionAreas:q,columns:c,updateActiveCellCoordinates:r,spreadsheetRef:i,removeCellSelections:ye,blockClass:ze,setCurrentMatcher:z,usingMac:m}),l.length<2&&!mt(l)||s.row==="header"||s.column==="header"))switch(n){case"Backspace":case"Delete":{Tn({selectionAreas:b,currentMatcher:f,rows:u,setActiveCellContent:P,updateData:y,activeCellCoordinates:s});break}case"Enter":{An({activeCellInsideSelectionArea:a,activeCellCoordinates:s,activeCellRef:g,selectionAreas:b,updateActiveCellCoordinates:r});break}case"Home":case"End":{if(t.preventDefault(),un(l,m))return;w({type:n});break}case"Tab":{if(a)return t.preventDefault(),_n({activeCellInsideSelectionArea:a,activeCellCoordinates:s,activeCellRef:g,selectionAreas:b,updateActiveCellCoordinates:r});q([]),p(),T(),$(!1),k(null);break}case"ArrowLeft":case"ArrowUp":case"ArrowRight":case"ArrowDown":N(n)}},X=`${he.prefix}--data-spreadsheet`,Qe=d.forwardRef(({activeCellRef:t,columns:e,activeCellCoordinates:a,defaultColumn:r,defaultEmptyRowCount:s,getTableBodyProps:p,headerGroups:c,id:u,onDataUpdate:i,renderRowHeader:f,renderRowHeaderDirection:T,hasCustomRowHeader:b,prepareRow:w,rows:l,selectionAreaData:m,setSelectionAreaData:y,setActiveCellCoordinates:H,selectedHeaderReorderActive:N,setSelectedHeaderReorderActive:q,selectionAreas:D,setContainerHasFocus:z,setSelectionAreas:g,scrollBarSize:k,totalColumnsWidth:$,clickAndHoldActive:P,setClickAndHoldActive:n,currentMatcher:L,setCurrentMatcher:F,onSelectionAreaChange:O,setActiveCellInsideSelectionArea:ee,totalVisibleColumns:R,setHeaderCellHoldActive:j,setColumnOrder:G,visibleColumns:M},_)=>{const[J,ae]=d.useState(!1),te=d.useRef(),B=Fe({selectionAreaData:m,clickAndHoldActive:P,rowHeight:r==null?void 0:r.rowHeight})||{};d.useEffect(()=>{_==null||_.current.style.setProperty(`--${X}--total-width`,C(($||0)+(k||0)))},[_,k,$]),d.useEffect(()=>{var h,W,A,Q;if(m!=null&&m.length){let V=!1;(((h=B==null?void 0:B.selectionAreaData)==null?void 0:h.length)!==(m==null?void 0:m.length)||((W=m==null?void 0:m[0])==null?void 0:W.cells.length)!==((Q=(A=B==null?void 0:B.selectionAreaData)==null?void 0:A[0])==null?void 0:Q.cells.length))&&(V=!0),(!P&&(B!=null&&B.clickAndHoldActive)||V)&&(O==null||O(m))}},[B==null?void 0:B.selectionAreaData,m,O,P,B==null?void 0:B.clickAndHoldActive]),d.useEffect(()=>{D&&D.length&&D.map(h=>{if(h.areaCreated){const W=Math.min(h.point1.row,h.point2.row),A=Math.max(h.point1.row,h.point2.row),Q=Math.min(h.point1.column,h.point2.column),V=Math.max(h.point1.column,h.point2.column),E={rows:{start:W,end:A},columns:{start:Q,end:V},cells:se({rowStart:W,rowEnd:A,columnStart:Q,columnEnd:V}),selectionId:h.matcher};y==null||y(U=>[...me(U).filter(Se=>Se.selectionId!==h.matcher),E])}!h.areaCreated&&h.point1&&h.point2&&h.matcher&&dt({ref:_,area:h,blockClass:X,defaultColumn:r,selectionAreas:D,setSelectionAreas:g,setActiveCellInsideSelectionArea:ee,visibleColumns:M})})},[D,g,r,O,y,_,a,ee,M,b]);const se=({rowStart:h,rowEnd:W,columnStart:A,columnEnd:Q})=>{const V=[];for(let E=h;E<=W;E++)for(let U=A;U<=Q;U++)V.push([E,U,`${X}__cell--${E}--${U}`]);return V};gn({currentMatcher:L,setClickAndHoldActive:n,setSelectionAreas:g,setValidStartingPoint:ae,selectedHeaderReorderActive:N,setSelectedHeaderReorderActive:q,validStartingPoint:J,ref:_,setHeaderCellHoldActive:j,setColumnOrder:G,visibleColumns:M,setActiveCellCoordinates:H,rows:l,activeCellCoordinates:a,defaultColumn:r,selectionAreas:D}),d.useEffect(()=>{let h,W;if(ie!=null&&ie.current&&(h=ie==null?void 0:ie.current,W=h==null?void 0:h.querySelector(`.${X}__active-cell--highlight`)),W&&(r==null?void 0:r.rowHeight)!==B.rowHeight&&(W.style.height=`${r==null?void 0:r.rowHeight}px`,a)){const A=_==null?void 0:_.current.querySelector(`[data-row-index="${a.row}"][data-column-index="${a.column}"]`),Q=_==null?void 0:_.current.querySelector(`.${X}__list--container`);let V;A&&Q&&(V=(A==null?void 0:A.getBoundingClientRect().top)-Q.getBoundingClientRect().top),W.style.top=C(V),ye({matcher:void 0,spreadsheetRef:_}),D==null||D.map(E=>{if(!E.areaCreated&&E.point1&&E.point2&&E.matcher)return dt({ref:_,area:E,blockClass:X,defaultColumn:r,selectionAreas:D,setSelectionAreas:g,setActiveCellInsideSelectionArea:ee,visibleColumns:M})})}},[r,_,a,B==null?void 0:B.rowHeight,D,ee,g,M,b]);const oe=d.useCallback(()=>{const h=[],W=[];_==null||_.current.querySelectorAll(`.${X}__selection-area--element`).forEach(A=>{const{top:Q,left:V,height:E,width:U}=A.style,we=`${Q}${V}${E}${U}`;h.indexOf(we)==-1?h.push(we):(A.remove(),W.push(A.getAttribute("data-matcher-id")))}),W.length&&(g==null||g(A=>me(A).filter(V=>!W.includes(V.matcher))),y==null||y(A=>me(A).filter(V=>!W.includes(V.selectionId))))},[_,g,y]);d.useEffect(()=>{oe()},[D,oe]);const Z=d.useCallback((h,W)=>A=>{Dn(h,W,A,L,a,D,H,g,z,n,F,_,y,ee,t,ae)},[L,a,D,H,g,z,n,F,_,y,ee,t]),ce=()=>{const h=_.current.querySelector(`
        .${X}__header--container .${X}__tr`)||new HTMLDivElement;h.scrollLeft=te==null?void 0:te.current.scrollLeft};d.useEffect(()=>{te.current.addEventListener("scroll",()=>ce());const h=te.current||new HTMLElement;return()=>{h.removeEventListener("scroll",ce)}});const le=d.useCallback((h,W)=>()=>{In(h,W,P,L,g)},[P,L,g]),ge=d.useCallback(h=>W=>{Hn(h,W,e,_,g,F,H,a,l,y)},[e,_,g,F,H,a,l,y]);d.useEffect(()=>{l!=null&&l.length||(()=>{const W=[];[...Array(s)].map(()=>{var Q;const A={};(Q=c==null?void 0:c[0])==null||Q.headers.map(V=>{A[V.id]=null}),W.push(A)}),i==null||i(W)})()},[l,c,s,i]);const xe=()=>I.jsx("div",{}),fe=d.useCallback(({index:h,style:W})=>{const A=l==null?void 0:l[h];if(l&&l.length){w==null||w(A);const Q=Ue(A.getRowProps({style:W}),"key");return I.jsxs("div",{...Q,className:pe(`${X}__tr`),"data-row-index":h,"aria-rowindex":h+1,"aria-owns":`${X}__cell-editor-text-area`,children:[I.jsx("div",{role:"rowheader",className:`${X}__td-th--cell-container`,children:I.jsxs("button",{id:`${X}__cell--${h}--header`,tabIndex:-1,"data-row-index":h,"data-column-index":"header",type:"button",onClick:ge(h),className:pe(`${X}__td`,`${X}__td-th`,`${X}--interactive-cell-element`,{[`${X}__td_custom`]:!!b,[`${X}__td-th--active-header`]:!b&&((a==null?void 0:a.row)===h||Je(h,D,"row")),[`${X}__td-th--selected-header`]:!b&&Nt(h,D,"row",e)}),style:{width:r==null?void 0:r.rowHeaderWidth,flexDirection:b?T==="Left"?"row-reverse":A:void 0},children:[h+1,b&&typeof f=="function"&&f(h)]})}),A.cells.map((V,E)=>{var we;const U=Ue(V.getCellProps(),"key");return I.jsx("div",{"aria-colindex":E+1,...U,role:"gridcell",style:{...V.getCellProps().style,display:"grid",minWidth:((we=V==null?void 0:V.column)==null?void 0:we.width)||(r==null?void 0:r.width)},children:I.jsx("button",{id:`${X}__cell--${V.row.index}--${E}`,tabIndex:-1,"data-row-index":V.row.index,"data-column-index":E,className:pe(`${X}__td`,`${X}__body--td`,`${X}--interactive-cell-element`),onMouseDown:Z(V,E),onMouseOver:le(V,E),onFocus:()=>{},type:"button",children:V.render("Cell")})},`cell_${E}`)})]},{...A.getRowProps().key})}},[w,f,T,l,b,a==null?void 0:a.row,D,ge,Z,le,r,e]),ie=d.useRef();return I.jsx("div",{ref:ie,className:pe(`${X}__body--container`),...p==null?void 0:p(),children:I.jsx(ln,{className:pe(`${X}__list--container`,`${X}__list--container--${u}`),height:400,itemCount:(l==null?void 0:l.length)||s,itemSize:r==null?void 0:r.rowHeight,width:Wt({headerGroup:void 0,type:void 0,scrollBarSizeValue:k,totalVisibleColumns:R,defaultColumn:r,totalColumnsWidth:$,visibleColumns:M}),outerRef:te,children:l!=null&&l.length?fe:xe})})});Qe.propTypes={activeCellCoordinates:o.shape({row:o.oneOfType([o.string,o.number]),column:o.oneOfType([o.string,o.number])}),activeCellRef:o.object,clickAndHoldActive:o.bool,columns:o.array,currentMatcher:o.string,defaultColumn:o.shape({rowHeight:o.number,rowHeaderWidth:o.number,width:o.number}),defaultEmptyRowCount:o.number,getTableBodyProps:o.func,hasCustomRowHeader:o.bool,headerGroups:o.arrayOf(o.object),id:o.oneOfType([o.number,o.string]),onActiveCellChange:o.func,onDataUpdate:o.func,onSelectionAreaChange:o.func,prepareRow:o.func,renderRowHeader:o.func,renderRowHeaderDirection:o.string,rows:o.arrayOf(o.object),scrollBarSize:o.number,selectedHeaderReorderActive:o.bool,selectionAreaData:o.array,selectionAreas:o.array,setActiveCellCoordinates:o.func,setActiveCellInsideSelectionArea:o.func,setClickAndHoldActive:o.func,setColumnOrder:o.func,setContainerHasFocus:o.func,setCurrentMatcher:o.func,setHeaderCellHoldActive:o.func,setSelectedHeaderReorderActive:o.func,setSelectionAreaData:o.func,setSelectionAreas:o.func,totalColumnsWidth:o.number,totalVisibleColumns:o.number,visibleColumns:o.array};Qe.__docgenInfo={description:"",methods:[],displayName:"DataSpreadsheetBody",props:{activeCellCoordinates:{required:!1,tsType:{name:"union",raw:"ActiveCellCoordinates | null",elements:[{name:"ActiveCellCoordinates"},{name:"null"}]},description:"Object containing the active cell coordinates",type:{name:"shape",value:{row:{name:"union",value:[{name:"string"},{name:"number"}],required:!1},column:{name:"union",value:[{name:"string"},{name:"number"}],required:!1}}}},activeCellRef:{required:!1,tsType:{name:"MutableRefObject",elements:[{name:"union",raw:"HTMLElement | undefined",elements:[{name:"HTMLElement"},{name:"undefined"}]}],raw:"MutableRefObject<HTMLElement | undefined>"},description:"This is the ref of the button input, which is the active cell element",type:{name:"object"}},clickAndHoldActive:{required:!1,tsType:{name:"boolean"},description:"Is the user clicking and holding in the data spreadsheet body",type:{name:"bool"}},columns:{required:!1,tsType:{name:"unknown"},description:"All of the spreadsheet columns",type:{name:"array"}},currentMatcher:{required:!1,tsType:{name:"string"},description:"This represents the id of the current cell selection area",type:{name:"string"}},defaultColumn:{required:!1,tsType:{name:"SpreadsheetColumn"},description:"Default spreadsheet sizing values",type:{name:"shape",value:{rowHeight:{name:"number",required:!1},rowHeaderWidth:{name:"number",required:!1},width:{name:"number",required:!1}}}},defaultEmptyRowCount:{required:!1,tsType:{name:"number"},description:"Sets the number of empty rows to be created when there is no data provided",type:{name:"number"}},getTableBodyProps:{required:!1,tsType:{name:"signature",type:"function",raw:"(propGetter?: TableBodyPropGetter<any>) => TableBodyProps",signature:{arguments:[{type:{name:"TableBodyPropGetter",elements:[{name:"any"}],raw:"TableBodyPropGetter<any>"},name:"propGetter"}],return:{name:"TableBodyProps"}}},description:"Function to set table body prop values",type:{name:"func"}},headerGroups:{required:!1,tsType:{name:"Array",elements:[{name:"any"}],raw:"any[]"},description:"Headers provided from useTable hook",type:{name:"arrayOf",value:{name:"object"}}},id:{required:!1,tsType:{name:"union",raw:"number | string",elements:[{name:"number"},{name:"string"}]},description:"The spreadsheet id",type:{name:"union",value:[{name:"number"},{name:"string"}]}},onActiveCellChange:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"The event handler that is called when the active cell changes",type:{name:"func"}},hasCustomRowHeader:{required:!1,tsType:{name:"boolean"},description:"Check if user is using custom component",type:{name:"bool"}},renderRowHeader:{required:!1,tsType:{name:"signature",type:"function",raw:"(index: number) => any[]",signature:{arguments:[{type:{name:"number"},name:"index"}],return:{name:"Array",elements:[{name:"any"}],raw:"any[]"}}},description:"Component next to numbering rows",type:{name:"func"}},renderRowHeaderDirection:{required:!1,tsType:{name:"string"},description:"Component next to numbering rows",type:{name:"string"}},onDataUpdate:{required:!1,tsType:{name:"signature",type:"function",raw:"({ ...args }) => void",signature:{arguments:[{name:""}],return:{name:"void"}}},description:"The event handler that is called to set the rows for the empty spreadsheet",type:{name:"func"}},onSelectionAreaChange:{required:!1,tsType:{name:"signature",type:"function",raw:"({ ...args }) => void",signature:{arguments:[{name:""}],return:{name:"void"}}},description:"The event handler that is called when the selection areas change",type:{name:"func"}},prepareRow:{required:!1,tsType:{name:"signature",type:"function",raw:"(...args) => void",signature:{arguments:[{name:"args",rest:!0}],return:{name:"void"}}},description:"Prepare row function from react-table",type:{name:"func"}},rows:{required:!1,tsType:{name:"Array",elements:[{name:"any"}],raw:"any[]"},description:"All of the spreadsheet row data",type:{name:"arrayOf",value:{name:"object"}}},scrollBarSize:{required:!1,tsType:{name:"number"},description:"The scrollbar width",type:{name:"number"}},selectionAreaData:{required:!1,tsType:{name:"Array",elements:[{name:"any"}],raw:"any[]"},description:"Array of selection area data",type:{name:"array"}},selectedHeaderReorderActive:{required:!1,tsType:{name:"boolean"},description:"Header reordering is active",type:{name:"bool"}},setSelectedHeaderReorderActive:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"boolean"}],raw:"SetStateAction<boolean>"}],raw:"Dispatch<SetStateAction<boolean>>"},description:"Set header reordering active or not",type:{name:"func"}},selectionAreas:{required:!1,tsType:{name:"Array",elements:[{name:"any"}],raw:"any[]"},description:"Array of selection areas",type:{name:"array"}},setActiveCellCoordinates:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"union",raw:"ActiveCellCoordinates | null",elements:[{name:"ActiveCellCoordinates"},{name:"null"}]}],raw:"SetStateAction<ActiveCellCoordinates | null>"}],raw:`Dispatch<
  SetStateAction<ActiveCellCoordinates | null>
>`},description:"Setter fn for activeCellCoordinates state value",type:{name:"func"}},setActiveCellInsideSelectionArea:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"boolean"}],raw:"SetStateAction<boolean>"}],raw:"Dispatch<SetStateAction<boolean>>"},description:"Setter fn for active cell inside of selection area",type:{name:"func"}},setClickAndHoldActive:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"boolean"}],raw:"SetStateAction<boolean>"}],raw:"Dispatch<SetStateAction<boolean>>"},description:"Setter fn for clickAndHold state value",type:{name:"func"}},setColumnOrder:{required:!1,tsType:{name:"signature",type:"function",raw:`(
  updater:
    | ((columnOrder: Array<IdType<any>>) => Array<IdType<any>>)
    | Array<IdType<any>>
) => void`,signature:{arguments:[{type:{name:"union",raw:`| ((columnOrder: Array<IdType<any>>) => Array<IdType<any>>)
| Array<IdType<any>>`,elements:[{name:"unknown"},{name:"Array",elements:[{name:"IdType",elements:[{name:"any"}],raw:"IdType<any>"}],raw:"Array<IdType<any>>"}]},name:"updater"}],return:{name:"void"}}},description:"Setter fn for column ordering, provided from react-table",type:{name:"func"}},setContainerHasFocus:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"boolean"}],raw:"SetStateAction<boolean>"}],raw:"Dispatch<SetStateAction<boolean>>"},description:"Setter fn for containerHasFocus state value",type:{name:"func"}},setCurrentMatcher:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"string"}],raw:"SetStateAction<string>"}],raw:"Dispatch<SetStateAction<string>>"},description:"Setter fn for currentMatcher state value",type:{name:"func"}},setHeaderCellHoldActive:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"boolean"}],raw:"SetStateAction<boolean>"}],raw:"Dispatch<SetStateAction<boolean>>"},description:"Setter fn for header cell hold active value",type:{name:"func"}},setSelectionAreaData:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"Array",elements:[{name:"object"}],raw:"object[]"}],raw:"SetStateAction<object[]>"}],raw:"Dispatch<SetStateAction<object[]>>"},description:"Setter fn for selectionAreaData state value",type:{name:"func"}},setSelectionAreas:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"Array",elements:[{name:"object"}],raw:"object[]"}],raw:"SetStateAction<object[]>"}],raw:"Dispatch<SetStateAction<object[]>>"},description:"Setter fn for selectionAreas state value",type:{name:"func"}},totalColumnsWidth:{required:!1,tsType:{name:"number"},description:"The total columns width",type:{name:"number"}},totalVisibleColumns:{required:!1,tsType:{name:"number"},description:`The total number of columns to be initially visible, additional columns will be rendered and
visible via horizontal scrollbar`,type:{name:"number"}},visibleColumns:{required:!1,tsType:{name:"Array",elements:[{name:"Column",elements:[{name:"object"}],raw:"Column<object>"}],raw:"Column<object>[]"},description:"Prop from react-table used to reorder columns",type:{name:"array"}}}};const v=`${he.prefix}--data-spreadsheet`,Ye=d.forwardRef(({activeCellCoordinates:t,cellSize:e,columns:a,currentMatcher:r,defaultColumn:s,headerGroups:p,scrollBarSize:c,selectionAreas:u,selectedHeaderReorderActive:i,setSelectedHeaderReorderActive:f,setActiveCellCoordinates:T,setCurrentMatcher:b,setSelectionAreas:w,readOnlyTable:l,disableColumnSwapping:m,setSelectionAreaData:y,rows:H,totalVisibleColumns:N,updateActiveCellCoordinates:q,setHeaderCellHoldActive:D,headerCellHoldActive:z,selectAllAriaLabel:g,visibleColumns:k},$)=>{const[P,n]=d.useState(0),L=Fe({cellSize:e})||{};d.useEffect(()=>{var R;if((L==null?void 0:L.cellSize)!==e){const j=(R=$==null?void 0:$.current)==null?void 0:R.querySelector(`.${v}__list--container`),M=(j==null?void 0:j.scrollHeight)&&(j==null?void 0:j.clientHeight)&&(j==null?void 0:j.scrollHeight)>(j==null?void 0:j.clientHeight)?0:c;j!=null&&j.getAttribute("tabIndex")||j==null||j.setAttribute("tabIndex","0"),n(M)}},[e,$,c,L==null?void 0:L.cellSize]);const F=R=>j=>{const G=Ne(j,"cmd"),M=Ne(j,"shiftKey");Ke({type:"column",activeCellCoordinates:t,rows:H,columns:a,currentMatcher:r,setActiveCellCoordinates:T,setCurrentMatcher:b,setSelectionAreas:w,spreadsheetRef:$,index:R,isKeyboard:void 0,setSelectionAreaData:y,isHoldingCommandKey:G,isHoldingShiftKey:M})},O=()=>{Pt({ref:$,setCurrentMatcher:b,setSelectionAreas:w,rows:H,columns:a,activeCellCoordinates:t,updateActiveCellCoordinates:q})},ee=R=>j=>{var ge,xe,fe,ie,h,W;if(j.shiftKey)return;const G=u==null?void 0:u.filter(A=>(A==null?void 0:A.matcher)===r),M=$.current.querySelector(`[data-matcher-id="${(ge=G==null?void 0:G[0])==null?void 0:ge.matcher}"]`);M&&M.classList.add(`${v}__selection-area--element`),typeof f=="function"&&f(!0);const _=j.clientX,J=j.target.getBoundingClientRect(),ae=j.target.getAttribute("data-column-index"),te=_-J.left,B=Math.min(((fe=(xe=G==null?void 0:G[0])==null?void 0:xe.point1)==null?void 0:fe.column)||0,((h=(ie=G==null?void 0:G[0])==null?void 0:ie.point2)==null?void 0:h.column)||0),se=(M==null?void 0:M.getBoundingClientRect())||new DOMRect,oe=B<parseInt(ae)?te+(J.left-(se==null?void 0:se.left)):te,Z=(W=document==null?void 0:document.querySelector(`.${v}__list--container`))==null?void 0:W.firstElementChild,ce=M==null?void 0:M.cloneNode(),le=M==null?void 0:M.cloneNode();le&&(le.className=`${v}__reorder-indicator-line`,le.style.width=C(2)),ce.classList.add(`${v}__selection-area--element-cloned`),ce.setAttribute("data-clone-offset-x",`${oe}`),ce.setAttribute("data-column-index-original",R),Z==null||Z.appendChild(ce),Z==null||Z.appendChild(le),D==null||D(!0)};return xn({ref:$,headerCellHoldActive:z,defaultColumn:s}),I.jsx("div",{className:pe(`${v}__header--container`),role:"rowgroup",children:p==null?void 0:p.map((R,j)=>{const G=Ue(R.getHeaderGroupProps(),"key");return I.jsxs("div",{...G,style:{...R.getHeaderGroupProps().style,width:Wt({type:"header",headerGroup:R,scrollBarSizeValue:P,totalVisibleColumns:N,defaultColumn:s,totalColumnsWidth:void 0,visibleColumns:k}),overflow:"hidden"},className:`${v}__tr`,children:[I.jsx("div",{role:"columnheader",className:`${v}__select-all-cell-container`,style:{width:s==null?void 0:s.rowHeaderWidth,height:s==null?void 0:s.rowHeight},children:I.jsx("button",{id:`${v}__cell--header--header`,"data-row-index":"header","data-column-index":"header",type:"button",style:{width:s==null?void 0:s.rowHeaderWidth},tabIndex:-1,"aria-label":g,onClick:O,className:pe(`${v}__th`,`${v}--interactive-cell-element`,`${v}__th--select-all`,{[`${v}__th--active-header`]:(t==null?void 0:t.column)==="header"&&(t==null?void 0:t.row)==="header"}),children:"Â "})}),R.headers.map((M,_)=>{const J=Ue(M.getHeaderProps(),"key"),ae=Nt(_,u,"column",H);return I.jsx("div",{role:"columnheader",className:`${v}__columnheader`,...J,children:I.jsx("button",{id:`${v}__cell--header--${_}`,"data-row-index":"header","data-column-index":_,tabIndex:-1,onMouseDown:ae&&!l&&!m?ee(_):void 0,onMouseUp:ae&&!l&&!m&&typeof f=="function"?()=>f(!1):void 0,onClick:ae?void 0:F(_),style:{height:s==null?void 0:s.rowHeight,width:(M==null?void 0:M.width)||(s==null?void 0:s.width)},className:pe(`${v}__th`,`${v}--interactive-cell-element`,{[`${v}__th--active-header`]:(t==null?void 0:t.column)===_||Je(_,u,"column"),[`${v}__th--active-header-disabledSwapping`]:m||l,[`${v}__th--selected-header`]:ae,[`${v}__th--selected-header-reorder-active`]:i}),type:"button",children:M.render("Header")})},`column_${_}`)})]},`header_${j}`)})})});Ye.propTypes={activeCellCoordinates:o.shape({row:o.oneOfType([o.number,o.string]),column:o.oneOfType([o.number,o.string])}),cellSize:o.oneOf(["xs","sm","md","lg"]),columns:o.array,currentMatcher:o.string,defaultColumn:o.shape({rowHeight:o.number,rowHeaderWidth:o.number,width:o.number}),disableColumnSwapping:o.bool,headerCellHoldActive:o.bool,headerGroups:o.arrayOf(o.object),readOnlyTable:o.bool,rows:o.arrayOf(o.object),scrollBarSize:o.number,selectAllAriaLabel:o.string.isRequired,selectedHeaderReorderActive:o.bool,selectionAreas:o.arrayOf(o.object),setActiveCellCoordinates:o.func,setCurrentMatcher:o.func,setHeaderCellHoldActive:o.func,setSelectedHeaderReorderActive:o.func,setSelectionAreaData:o.func,setSelectionAreas:o.func,totalVisibleColumns:o.number,updateActiveCellCoordinates:o.func,visibleColumns:o.array};Ye.__docgenInfo={description:"",methods:[],displayName:"DataSpreadsheetHeader",props:{activeCellCoordinates:{required:!1,tsType:{name:"union",raw:"ActiveCellCoordinates | null",elements:[{name:"ActiveCellCoordinates"},{name:"null"}]},description:"Object containing the active cell coordinates",type:{name:"shape",value:{row:{name:"union",value:[{name:"number"},{name:"string"}],required:!1},column:{name:"union",value:[{name:"number"},{name:"string"}],required:!1}}}},cellSize:{required:!1,tsType:{name:"union",raw:"'xs' | 'sm' | 'md' | 'lg'",elements:[{name:"literal",value:"'xs'"},{name:"literal",value:"'sm'"},{name:"literal",value:"'md'"},{name:"literal",value:"'lg'"}]},description:"Specifies the cell height",type:{name:"enum",value:[{value:"'xs'",computed:!1},{value:"'sm'",computed:!1},{value:"'md'",computed:!1},{value:"'lg'",computed:!1}]}},disableColumnSwapping:{required:!1,tsType:{name:"boolean"},description:"Disable column swapping, default false",type:{name:"bool"}},columns:{required:!1,tsType:{name:"unknown"},description:"All of the spreadsheet columns",type:{name:"array"}},currentMatcher:{required:!1,tsType:{name:"string"},description:"uuid that corresponds to the current selection area",type:{name:"string"}},defaultColumn:{required:!1,tsType:{name:"SpreadsheetColumn"},description:"Default spreadsheet sizing values",type:{name:"shape",value:{rowHeight:{name:"number",required:!1},rowHeaderWidth:{name:"number",required:!1},width:{name:"number",required:!1}}}},headerCellHoldActive:{required:!1,tsType:{name:"boolean"},description:"Whether or not a click/hold is active on a header cell",type:{name:"bool"}},headerGroups:{required:!1,tsType:{name:"Array",elements:[{name:"any"}],raw:"any[]"},description:"Headers provided from useTable hook",type:{name:"arrayOf",value:{name:"object"}}},readOnlyTable:{required:!1,tsType:{name:"boolean"},description:"Read-only table",type:{name:"bool"}},rows:{required:!1,tsType:{name:"Array",elements:[{name:"object"}],raw:"object[]"},description:"All of the spreadsheet row data",type:{name:"arrayOf",value:{name:"object"}}},scrollBarSize:{required:!1,tsType:{name:"number"},description:"The scrollbar width",type:{name:"number"}},selectAllAriaLabel:{required:!0,tsType:{name:"string"},description:"The aria label applied to the Select all button",type:{name:"string"}},selectionAreas:{required:!1,tsType:{name:"Array",elements:[{name:"ItemType"}],raw:"ItemType[]"},description:"All of the cell selection area items",type:{name:"arrayOf",value:{name:"object"}}},setActiveCellCoordinates:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"union",raw:"ActiveCellCoordinates | null",elements:[{name:"ActiveCellCoordinates"},{name:"null"}]}],raw:"SetStateAction<ActiveCellCoordinates | null>"}],raw:`Dispatch<
  SetStateAction<ActiveCellCoordinates | null>
>`},description:"Setter fn for activeCellCoordinates value",type:{name:"func"}},selectedHeaderReorderActive:{required:!1,tsType:{name:"boolean"},description:"Header reordering is active",type:{name:"bool"}},setSelectedHeaderReorderActive:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"boolean"}],raw:"SetStateAction<boolean>"}],raw:"Dispatch<SetStateAction<boolean>>"},description:"Set header reordering active or not",type:{name:"func"}},setCurrentMatcher:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"string"}],raw:"SetStateAction<string>"}],raw:"Dispatch<SetStateAction<string>>"},description:"Setter fn for currentMatcher value",type:{name:"func"}},setHeaderCellHoldActive:{required:!1,tsType:{name:"signature",type:"function",raw:"(arg: boolean) => void",signature:{arguments:[{type:{name:"boolean"},name:"arg"}],return:{name:"void"}}},description:"Setter fn for header cell hold active value",type:{name:"func"}},setSelectionAreaData:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"Array",elements:[{name:"object"}],raw:"object[]"}],raw:"SetStateAction<object[]>"}],raw:"Dispatch<SetStateAction<object[]>>"},description:"Setter fn for selectionAreaData state value",type:{name:"func"}},setSelectionAreas:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"Array",elements:[{name:"object"}],raw:"object[]"}],raw:"SetStateAction<object[]>"}],raw:"Dispatch<SetStateAction<object[]>>"},description:"Setter fn for selectionAreas value",type:{name:"func"}},totalVisibleColumns:{required:!1,tsType:{name:"number"},description:`The total number of columns to be initially visible, additional columns will be rendered and
visible via horizontal scrollbar`,type:{name:"number"}},updateActiveCellCoordinates:{required:!1,tsType:{name:"signature",type:"function",raw:"(arg) => void",signature:{arguments:[{name:"arg"}],return:{name:"void"}}},description:"Function used to update the active cell coordinates",type:{name:"func"}},visibleColumns:{required:!1,tsType:{name:"Array",elements:[{name:"Column",elements:[{name:"object"}],raw:"Column<object>"}],raw:"Column<object>[]"},description:"Array of visible columns provided by react-table useTable hook",type:{name:"array"}}}};const qn=()=>{const t=document.createElement("div");t.setAttribute("style","width: 100px; height: 100px; overflow: scroll; position:absolute; top:-9999px;"),document.body.appendChild(t);const e=t.offsetWidth-t.clientWidth;return document.body.removeChild(t),e},Mn=({placementElement:t,coords:e,addToHeader:a=!1,contextRef:r,blockClass:s=`${he.prefix}--data-spreadsheet`,onActiveCellChange:p,activeCellValue:c,activeCellRef:u,cellEditorRef:i,defaultColumn:f})=>{if(!e)return;const T=document.querySelector(`[data-row-index="${e.row}"][data-column-index="${e.column}"]`)||document.querySelector(`.${s}__body--td`),b=T.offsetWidth,w=T.offsetHeight,l=a?r==null?void 0:r.current.querySelector(`.${s}__header--container`):r==null?void 0:r.current.querySelector(`.${s}__list--container`).firstElementChild,m={top:t?t.getBoundingClientRect().top-l.getBoundingClientRect().top:e.row===0?0:w*e.row,left:t?t.getBoundingClientRect().left-l.getBoundingClientRect().left:e.column===0?0+(f.rowHeaderWidth-4):b*e.column+(f.rowHeaderWidth-4)},y=u==null?void 0:u.current;y.style.width=C(t?t==null?void 0:t.offsetWidth:b),y.style.height=C(t?t==null?void 0:t.offsetHeight:w),y.style.left=C(m.left),y.style.top=C(m.top),y.style.display="block",y.setAttribute("data-active-row-index",typeof(e==null?void 0:e.row)=="number"?e.row:"header"),y.setAttribute("data-active-column-index",typeof(e==null?void 0:e.column)=="number"?e.column:"header"),l.appendChild(y),y.focus(),a||l.appendChild(i.current),typeof(e==null?void 0:e.column)=="number"&&typeof(e==null?void 0:e.row)=="number"&&(p==null||p(c))},ke=t=>Number(t.replace("rem","")*Zt),jn=t=>{switch(t){case"xs":return ke(en);case"sm":return ke(lt);case"md":return ke(Ct);case"lg":return ke(vt);default:return ke(lt)}},On=({activeCellCoordinates:t,cellEditorRulerRef:e,columns:a,previousState:r,removeCellEditor:s,rows:p,setActiveCellCoordinates:c,setCurrentMatcher:u,setSelectionAreas:i,spreadsheetRef:f,updateData:T})=>b=>{const{key:w}=b,l=({type:m})=>{const y=()=>{const q=r==null?void 0:r.activeCellCoordinates,D=p[q==null?void 0:q.row].cells[q==null?void 0:q.column];s(),T(q==null?void 0:q.row,D.column.id)};ye({spreadsheetRef:f}),y();const H=Pe(),N={row:m==="Enter"?t.row===p.length-1?t.row:t.row+1:t.row,column:m==="Tab"?t.column===a.length-1?t.column:t.column+1:t.column};i([{point1:N,point2:N,matcher:H,areaCreated:!1}]),u(H),e.current.textContent=""};w==="Enter"&&(l({type:"Enter"}),c(m=>({...m,row:m.row===p.length-1?m.row:m.row+1}))),w==="Tab"&&(b.preventDefault(),l({type:"Tab"}),c(m=>({...m,column:m.column===a.length-1?m.column:m.column+1})))},ue=`${he.prefix}--data-spreadsheet`,Ze="DataSpreadsheet",Ie={columns:Object.freeze([]),data:Object.freeze([]),defaultEmptyRowCount:16,onDataUpdate:Object.freeze(()=>{}),onActiveCellChange:Object.freeze(()=>{}),onSelectionAreaChange:Object.freeze(()=>{}),theme:"light"};let de=tn.forwardRef(({cellSize:t="sm",className:e,columns:a=Ie.columns,data:r=Ie.data,defaultEmptyRowCount:s=Ie.defaultEmptyRowCount,onDataUpdate:p=Ie.onDataUpdate,id:c,onActiveCellChange:u=Ie.onActiveCellChange,onSelectionAreaChange:i=Ie.onSelectionAreaChange,renderRowHeader:f,renderRowHeaderDirection:T,disableColumnSwapping:b=!1,readOnlyTable:w=!1,selectAllAriaLabel:l,spreadsheetAriaLabel:m,theme:y,totalVisibleColumns:H,...N},q)=>{const D=d.useRef(null),z=d.useRef(),g=q||z,k=hn(),[$,P]=d.useState(!1),[n,L]=d.useState(null),[F,O]=d.useState([]),[ee,R]=d.useState([]),[j,G]=d.useState(!1),[M,_]=d.useState(""),[J,ae]=d.useState(!1),[te,B]=d.useState(""),[se,oe]=d.useState(!1),[Z,ce]=d.useState(!1),le=d.useRef(!1),[ge,xe]=d.useState(!1),[fe,ie]=d.useState(!1),h=Fe({activeCellCoordinates:n,isEditing:J,cellEditorValue:te})||{},W=jn(t),A=d.useRef(),[Q,V]=d.useState(),E=d.useRef(),U=d.useRef(),we=typeof f=="function",Re=r.length.toString().length,Se=d.useMemo(()=>({width:150,rowHeaderWidth:we?40+Re*8.56:64,rowHeight:W}),[W,we,Re]),{keysPressedList:ve,usingMac:Ce}=mn({ref:D,containerHasFocus:$,isEditing:J}),et=d.useMemo(()=>qn(),[]),{getTableProps:Vt,getTableBodyProps:Bt,headerGroups:tt,rows:ne,totalColumnsWidth:Et,prepareRow:zt,setColumnOrder:Ut,visibleColumns:Xe}=Ge.useTable({columns:a,data:r,defaultColumn:Se},Ge.useBlockLayout,Ge.useColumnOrder),Le=d.useCallback((x,S,K)=>{p(Y=>Y.map((re,be)=>be===x?{...Y[x],[S]:te||K}:re))},[te,p]),Ve=d.useCallback(()=>{var S;const x=(S=g==null?void 0:g.current)==null?void 0:S.querySelector(`.${ue}__active-cell--highlight`);x&&(x.style.display="none")},[g]),_e=d.useCallback(()=>{B(""),ae(!1),A!=null&&A.current&&(A.current.style.display="none")},[]);d.useEffect(()=>{const x=h==null?void 0:h.activeCellCoordinates;if(((x==null?void 0:x.row)!==(n==null?void 0:n.row)||(x==null?void 0:x.column)!==(n==null?void 0:n.column))&&J){const S=ne[Number(x==null?void 0:x.row)].cells[Number(x==null?void 0:x.column)];_e(),Le(x==null?void 0:x.row,S.column.id,void 0),U!=null&&U.current&&(U.current.textContent="")}if((x==null?void 0:x.row)!==(n==null?void 0:n.row)||(x==null?void 0:x.column)!==(n==null?void 0:n.column)){if(n&&(n==null?void 0:n.row)!=="header"&&(n==null?void 0:n.column)!=="header"){const S=typeof(n==null?void 0:n.column)=="number"&&typeof(n==null?void 0:n.row)=="number"?ne[n==null?void 0:n.row].cells[n==null?void 0:n.column]:null;V(S?S.render("Cell"):null)}(n&&(n==null?void 0:n.row)==="header"||(n==null?void 0:n.column)==="header")&&(V(null),xe(S=>!S))}J&&h.activeCellCoordinates&&le.current&&(V(h.cellEditorValue),le.current=!1,_e())},[le,n,h==null?void 0:h.activeCellCoordinates,h==null?void 0:h.cellEditorValue,Le,ne,J,_e,Q]);const Kt=d.useCallback(({placementElement:x,coords:S,addToHeader:K=!1})=>{const Y=typeof(S==null?void 0:S.column)=="number"&&typeof(S==null?void 0:S.row)=="number"?ne[S==null?void 0:S.row].cells[S==null?void 0:S.column]:null,re=Y?Object.values(Y.row.values)[S==null?void 0:S.column]:null;Mn({placementElement:x,coords:S,addToHeader:K,contextRef:g,blockClass:ue,onActiveCellChange:u,activeCellValue:re,activeCellRef:E,cellEditorRef:A,defaultColumn:Se})},[g,ne,u,Se]);fn({focusedElement:k,removeActiveCell:Ve,setContainerHasFocus:P}),wn({isBlurSpreadsheet:le,spreadsheetRef:g,setActiveCellCoordinates:L,setSelectionAreas:O,removeActiveCell:Ve,setContainerHasFocus:P,removeCellEditor:_e}),pn({spreadsheetRef:g,activeCellCoordinates:n,containerHasFocus:$,createActiveCell:Kt,activeCellContent:Q,isActiveHeaderCellChanged:ge});const nt=d.useCallback(()=>{ie(!1),n||L({column:"header",row:"header"})},[n]),Ae=d.useCallback(({coords:x={...n},updatedValue:S,optOutOfSelectionAreaUpdate:K=!1})=>{const Y={...x,...S};if(L(Y),Y.row!=="header"&&Y.column!=="header"&&!K){const re=Pe();O([{point1:Y,matcher:re}]),_(re)}},[n]),rt=d.useCallback(({type:x})=>{const S={...n};Ae({coords:S,updatedValue:{column:x==="Home"?0:a.length-1}}),ye({matcher:void 0,spreadsheetRef:g})},[n,Ae,g,a.length]),at=d.useCallback(x=>J||x==="Meta"||x==="Control",[J]),st=d.useCallback(x=>{event==null||event.preventDefault(),nt();const S={...n};let K;switch(x){case"ArrowLeft":{if(S.column==="header")return;typeof S.column=="number"&&(S.column===0?K={column:"header"}:K={column:S.column-1});break}case"ArrowUp":{if(S.row==="header")return;typeof S.row=="number"&&(S.row===0?K={row:"header"}:K={row:S.row-1});break}case"ArrowRight":{if(S.column==="header"&&(K={column:0}),typeof S.column=="number"){if(a.length-1===S.column)return;K={column:S.column+1}}break}case"ArrowDown":{if(S.row==="header"&&(K={row:0}),typeof S.row=="number"){if(ne.length-1===S.row)return;K={row:S.row+1}}break}}K&&Ae({coords:S,updatedValue:K})},[nt,Ae,n,a,ne]),Ft=d.useCallback(x=>{$n(x,fe,Ae,n,Ve,a,ne,g,M,_e,F,rt,ve,Ce,Le,at,st,O,R,_,E,L,P,V,w)},[fe,Ae,n,Ve,a,ne,g,M,_e,F,rt,ve,Ce,Le,at,st,w]),ot=()=>{var K,Y,re,be,ut;ae(!0),G(!1);const x=typeof(n==null?void 0:n.column)=="number"&&typeof(n==null?void 0:n.row)=="number"?ne[n==null?void 0:n.row].cells[n==null?void 0:n.column]:null,S=(re=(Y=(K=x==null?void 0:x.row)==null?void 0:K.cells)==null?void 0:Y[Number(n==null?void 0:n.column)])==null?void 0:re.value;B(S||""),U!=null&&U.current&&(U.current.textContent=S),A!=null&&A.current&&(E!=null&&E.current)&&(A.current.style.width=(ut=(be=E==null?void 0:E.current)==null?void 0:be.style)==null?void 0:ut.width)};d.useEffect(()=>{var x,S,K,Y,re,be;J&&!(h!=null&&h.isEditing)&&((re=A==null?void 0:A.current)==null||re.setSelectionRange(Number((S=(x=U==null?void 0:U.current)==null?void 0:x.textContent)==null?void 0:S.length),Number((Y=(K=U==null?void 0:U.current)==null?void 0:K.textContent)==null?void 0:Y.length)),(be=A==null?void 0:A.current)==null||be.focus())},[J,h==null?void 0:h.isEditing]);const Rt=()=>{if((n==null?void 0:n.row)==="header"||(n==null?void 0:n.column)==="header"){const x=(n==null?void 0:n.row)==="header"?n==null?void 0:n.column:n==null?void 0:n.row;if((n==null?void 0:n.row)==="header"&&(n==null?void 0:n.column)==="header")return;ct({isKeyboard:!1,index:Number(x)})}},Xt=()=>{G(!1)},Gt=()=>{if((n==null?void 0:n.row)!=="header"||(n==null?void 0:n.column)!=="header"){const x=Pe();G(!0),ye({matcher:null,spreadsheetRef:g}),O([{point1:n,matcher:x}]),_(x),R([]),ie(!1)}},Jt=x=>{const{key:S}=x;S==="Enter"&&!fe&&!w&&((n==null?void 0:n.column)!=="header"&&(n==null?void 0:n.row)!=="header"&&ot(),((n==null?void 0:n.row)==="header"||(n==null?void 0:n.column)==="header")&&ct({isKeyboard:!0}))},ct=({isKeyboard:x,index:S=-1})=>{const K={activeCellCoordinates:n,rows:ne,columns:a,currentMatcher:M,setActiveCellCoordinates:L,setCurrentMatcher:_,setSelectionAreas:O,spreadsheetRef:g,index:S,isKeyboard:x,setSelectionAreaData:R,isHoldingCommandKey:null,isHoldingShiftKey:null};(n==null?void 0:n.row)==="header"&&(n==null?void 0:n.column)!=="header"&&Ke({type:"column",...K}),(n==null?void 0:n.column)==="header"&&(n==null?void 0:n.row)!=="header"&&Ke({type:"row",...K}),(n==null?void 0:n.column)==="header"&&(n==null?void 0:n.row)==="header"&&Pt({ref:g,setCurrentMatcher:_,setSelectionAreas:O,rows:ne,columns:a,activeCellCoordinates:n,updateActiveCellCoordinates:Ae})},Qt=x=>{x||ot()};yn({isEditing:J,rows:ne,activeCellCoordinates:n,activeCellRef:E,cellEditorRef:A,cellEditorRulerRef:U,visibleColumns:Xe,defaultColumn:Se,cellEditorValue:te});const it=d.useCallback((x,S)=>{M&&x&&x.length&&S&&M&&O(K=>{const Y=me(K),re=Y.findIndex(be=>be.matcher===M);return re===-1?K:typeof Y[re].point2=="object"&&Y[re].areaCreated?(Y[re].point2=Y[re].point1,Y[re].areaCreated=!1,ie(!1),ye({matcher:M,spreadsheetRef:g}),Y):K})},[g,M]),Yt=d.useCallback(()=>{it(F,j)},[j,F,it]);return I.jsx("div",{...N,...Vt(),...dn(Ze),className:pe(ue,e,`${ue}--interactive-cell-element`,{[`${ue}__container-has-focus`]:$,[`${ue}__${y}`]:y==="dark"}),ref:g,role:"grid",tabIndex:0,"aria-rowcount":(ne==null?void 0:ne.length)||0,"aria-colcount":(a==null?void 0:a.length)||0,"aria-label":m,onKeyDown:Ft,onFocus:()=>P(!0),children:I.jsxs("div",{ref:D,children:[I.jsx(Ye,{ref:g,activeCellCoordinates:n,cellSize:t,columns:a,currentMatcher:M,defaultColumn:Se,selectedHeaderReorderActive:Z,setSelectedHeaderReorderActive:ce,headerGroups:tt,rows:ne,scrollBarSize:et,selectionAreas:F,setActiveCellCoordinates:L,setSelectionAreas:O,setCurrentMatcher:_,setSelectionAreaData:R,disableColumnSwapping:b,readOnlyTable:w,totalVisibleColumns:H,updateActiveCellCoordinates:Ae,setHeaderCellHoldActive:oe,headerCellHoldActive:se,visibleColumns:Xe,selectAllAriaLabel:l}),I.jsx(Qe,{activeCellRef:E,activeCellCoordinates:n,ref:g,clickAndHoldActive:j,setClickAndHoldActive:G,currentMatcher:M,setCurrentMatcher:_,setContainerHasFocus:P,selectedHeaderReorderActive:Z,setSelectedHeaderReorderActive:ce,selectionAreas:F,setSelectionAreas:O,headerGroups:tt,defaultColumn:Se,getTableBodyProps:Bt,hasCustomRowHeader:we,onDataUpdate:p,renderRowHeaderDirection:T,renderRowHeader:f,onActiveCellChange:u,onSelectionAreaChange:i,prepareRow:zt,rows:ne,selectionAreaData:ee,setSelectionAreaData:R,setActiveCellCoordinates:L,scrollBarSize:et,totalColumnsWidth:Et,id:c,columns:a,defaultEmptyRowCount:s,setActiveCellInsideSelectionArea:ie,totalVisibleColumns:H,setHeaderCellHoldActive:oe,setColumnOrder:Ut,visibleColumns:Xe}),I.jsx("button",{onMouseDown:Gt,onMouseUp:Xt,onClick:Rt,onKeyDown:Jt,onDoubleClick:()=>Qt(w),onMouseEnter:Yt,ref:E,className:pe(`${ue}--interactive-cell-element`,`${ue}__active-cell--highlight`,{[`${ue}__active-cell--with-selection`]:fe}),type:"button",children:Q}),I.jsx("textarea",{id:`${ue}__cell-editor-text-area`,value:te,onKeyDown:On({activeCellCoordinates:n,cellEditorRulerRef:U,columns:a,previousState:h,removeCellEditor:_e,rows:ne,setActiveCellCoordinates:L,setCurrentMatcher:_,setSelectionAreas:O,spreadsheetRef:g,updateData:Le}),onChange:x=>{h.isEditing&&(B(x.target.value),U!=null&&U.current&&(U.current.textContent=x.target.value))},ref:A,"aria-labelledby":n?`${ue}__cell--${n==null?void 0:n.row}--${n==null?void 0:n.column}`:"",className:pe(`${ue}__cell-editor`,`${ue}--interactive-cell-element`,`${ue}__cell-editor--${t}`,{[`${ue}__cell-editor--active`]:J})}),I.jsx("pre",{"aria-hidden":!0,ref:U,className:`${ue}__cell-editor-ruler`})]})})});de=he.checkComponentEnabled(de,Ze);de.displayName=Ze;de.propTypes={cellSize:o.oneOf(["xs","sm","md","lg"]),className:o.string,columns:o.arrayOf(o.shape({Header:o.string,accessor:o.oneOfType([o.string,o.func]),Cell:o.func})),data:o.arrayOf(o.shape),defaultEmptyRowCount:o.number,disableColumnSwapping:o.bool,hasCustomRowHeader:o.bool,id:o.oneOfType([o.number,o.string]),onActiveCellChange:o.func,onDataUpdate:o.func,onSelectionAreaChange:o.func,readOnlyTable:o.bool,renderRowHeader:o.func,renderRowHeaderDirection:o.oneOf(["left","right"]),selectAllAriaLabel:o.string.isRequired,spreadsheetAriaLabel:o.string.isRequired,theme:o.oneOf(["light","dark"]),totalVisibleColumns:o.number};de.__docgenInfo={description:"DataSpreadsheet: used to organize and display large amounts of structured data, separated by columns and rows in a grid-like format.",methods:[],displayName:"DataSpreadsheet",props:{cellSize:{required:!1,tsType:{name:"union",raw:"'xs' | 'sm' | 'md' | 'lg'",elements:[{name:"literal",value:"'xs'"},{name:"literal",value:"'sm'"},{name:"literal",value:"'md'"},{name:"literal",value:"'lg'"}]},description:"Specifies the cell height",defaultValue:{value:"'sm'",computed:!1},type:{name:"enum",value:[{value:"'xs'",computed:!1},{value:"'sm'",computed:!1},{value:"'md'",computed:!1},{value:"'lg'",computed:!1}]}},className:{required:!1,tsType:{name:"string"},description:"Provide an optional class to be applied to the containing node.",type:{name:"string"}},columns:{required:!1,tsType:{name:"unknown"},description:"The data that will build the column headers",defaultValue:{value:"Object.freeze([])",computed:!0},type:{name:"arrayOf",value:{name:"shape",value:{Header:{name:"string",required:!1},accessor:{name:"union",value:[{name:"string"},{name:"func"}],required:!1},Cell:{name:"func",required:!1}}}}},disableColumnSwapping:{required:!1,tsType:{name:"boolean"},description:"Disable column swapping, default false",defaultValue:{value:"false",computed:!1},type:{name:"bool"}},data:{required:!1,tsType:{name:"unknown"},description:"The spreadsheet data that will be rendered in the body of the spreadsheet component",defaultValue:{value:"Object.freeze([])",computed:!0},type:{name:"arrayOf",value:{name:"shape",value:"",computed:!0}}},defaultEmptyRowCount:{required:!1,tsType:{name:"number"},description:"Sets the number of empty rows to be created when there is no data provided",defaultValue:{value:"16",computed:!1},type:{name:"number"}},hasCustomRowHeader:{required:!1,tsType:{name:"boolean"},description:"Check if has custom row header component attached",type:{name:"bool"}},id:{required:!1,tsType:{name:"union",raw:"number | string",elements:[{name:"number"},{name:"string"}]},description:"The spreadsheet id",type:{name:"union",value:[{name:"number"},{name:"string"}]}},onActiveCellChange:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"The event handler that is called when the active cell changes",defaultValue:{value:"Object.freeze(() => {})",computed:!0},type:{name:"func"}},onDataUpdate:{required:!1,tsType:{name:"signature",type:"function",raw:"({ ...args }) => void",signature:{arguments:[{name:""}],return:{name:"void"}}},description:"The setter fn for the data prop",defaultValue:{value:"Object.freeze(() => {})",computed:!0},type:{name:"func"}},onSelectionAreaChange:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"The event handler that is called when the selection area values change",defaultValue:{value:"Object.freeze(() => {})",computed:!0},type:{name:"func"}},readOnlyTable:{required:!1,tsType:{name:"boolean"},description:"Read-only table",defaultValue:{value:"false",computed:!1},type:{name:"bool"}},renderRowHeaderDirection:{required:!1,tsType:{name:"union",raw:"'left' | 'right'",elements:[{name:"literal",value:"'left'"},{name:"literal",value:"'right'"}]},description:"Position of the custom row numbering component",type:{name:"enum",value:[{value:"'left'",computed:!1},{value:"'right'",computed:!1}]}},renderRowHeader:{required:!1,tsType:{name:"signature",type:"function",raw:"(index: number) => any[]",signature:{arguments:[{type:{name:"number"},name:"index"}],return:{name:"Array",elements:[{name:"any"}],raw:"any[]"}}},description:"Component next to numbering rows",type:{name:"func"}},selectAllAriaLabel:{required:!0,tsType:{name:"string"},description:"The aria label applied to the Select all button",type:{name:"string"}},spreadsheetAriaLabel:{required:!0,tsType:{name:"string"},description:"The aria label applied to the Data spreadsheet component",type:{name:"string"}},theme:{required:!1,tsType:{name:"union",raw:"'light' | 'dark'",elements:[{name:"literal",value:"'light'"},{name:"literal",value:"'dark'"}]},description:"The theme the DataSpreadsheet should use (only used to render active cell/selection area colors on dark theme)",type:{name:"enum",value:[{value:"'light'",computed:!1},{value:"'dark'",computed:!1}]}},totalVisibleColumns:{required:!1,tsType:{name:"number"},description:`The total number of columns to be initially visible, additional columns will be rendered and
visible via horizontal scrollbar`,type:{name:"number"}}}};const pt=["dog","cat","bird","lizard","frog","hamster","fish","rabbit","snake"],Be=["Bruno","Willow","Kona","Heidi","Rusty","Bonnie","Cash","Gucci","Brody","Emma","Loki","Angel","Astro","Sherman","Layla","Peanut","Grace","Mickey","Sasha","Finn","Tucker","Bear","Mocha","Roscoe"],Ln=t=>{const e=[];for(let a=0;a<t;a++)e.push(a);return e},kn=t=>{const e=t&&{ownerName:Be[Math.floor(Math.random()*Be.length)],weight:Math.floor(Math.random()*40)},a={petType:pt[Math.floor(Math.random()*pt.length)],firstName:Be[Math.floor(Math.random()*Be.length)],age:Math.floor(Math.random()*30),visits:Math.floor(Math.random()*40),health:Math.floor(Math.random()*100)};return t?{...a,...e}:a},We=({rows:t,extraColumns:e})=>((r=0)=>{const p=[t][r];return Ln(p).map(()=>({...kn(e)}))})();function ft(t){const e={a:"a",h1:"h1",h2:"h2",li:"li",ul:"ul",...kt(),...t.components};return I.jsxs(I.Fragment,{children:[I.jsx(e.h1,{id:"dataspreadsheet",children:"DataSpreadsheet"}),`
`,I.jsx(e.h2,{id:"table-of-contents",children:"Table of Contents"}),`
`,I.jsxs(e.ul,{children:[`
`,I.jsx(e.li,{children:I.jsx(e.a,{href:"#overview",children:"Overview"})}),`
`,I.jsx(e.li,{children:I.jsx(e.a,{href:"#example-usage",children:"Example usage"})}),`
`,I.jsx(e.li,{children:I.jsx(e.a,{href:"#component-api",children:"Component API"})}),`
`]}),`
`,I.jsx(e.h2,{id:"overview",children:"Overview"}),`
`,`
`,I.jsx(e.h2,{id:"example-usage",children:"Example usage"}),`
`,`
`,I.jsx(nn,{children:I.jsx(rn,{of:Te})}),`
`,I.jsx(e.h2,{id:"code-sample",children:"Code sample"}),`
`,`
`,I.jsx(e.h2,{id:"component-api",children:"Component API"}),`
`,I.jsx(an,{})]})}function Pn(t={}){const{wrapper:e}={...kt(),...t.components};return e?I.jsx(e,{...t,children:I.jsx(ft,{...t})}):ft(t)}const Nn="div[data-story-title*=DataSpreadsheet] .docs-story>div:first-child>div:first-child{overflow:auto;width:100%}",Sr={title:"IBM Products/Components/Data spreadsheet/DataSpreadsheet",component:de,tags:["autodocs"],argTypes:{onActiveCellChange:{action:"active cell change"},onSelectionAreaChange:{action:"selection area change"}},parameters:{styles:Nn,docs:{page:Pn}}},Ee=({value:t})=>I.jsx("span",{style:{display:"flex",justifyContent:"flex-end"},children:t}),Oe=[{Header:"Row Index",accessor:(t,e)=>e,Cell:({cell:{value:t}})=>I.jsx(Ee,{value:t}),placement:"right",width:275},{Header:"Pet type",accessor:"petType"},{Header:"First Name",accessor:"firstName"},{Header:"Age",accessor:"age",Cell:({cell:{value:t}})=>I.jsx(Ee,{value:t}),placement:"right"},{Header:"Vet visits",accessor:"visits",Cell:({cell:{value:t}})=>I.jsx(Ee,{value:t}),placement:"right"},{Header:"Health",accessor:"health",Cell:({cell:{value:t}})=>I.jsx(Ee,{value:t}),placement:"right"}],Wn=({...t})=>{const[e,a]=d.useState(()=>We({rows:16})),r=d.useMemo(()=>Oe,[]);return I.jsx(de,{columns:r,data:e,onDataUpdate:a,id:"spreadsheet--id",...t})},Vn=({...t})=>{const[e,a]=d.useState(()=>We({rows:1e5})),r=d.useMemo(()=>Oe,[]),s=p=>I.jsx(sn,{style:{width:"32px",height:"32px",minWidth:"32px",minHeight:"32px"},children:I.jsx(on,{itemText:`Test item ${p}`})});return I.jsx(de,{columns:r,data:e,onDataUpdate:a,renderRowHeaderDirection:"Left",renderRowHeader:s,id:"spreadsheet--id",...t})},Bn=({...t})=>{const[e,a]=d.useState(()=>We({rows:1e3})),r=d.useMemo(()=>Oe,[]);return I.jsx(de,{columns:r,data:e,onDataUpdate:a,id:"spreadsheet--id",...t})},En=({...t})=>{const[e,a]=d.useState([]),r=d.useMemo(()=>[...Oe.filter(p=>p.Header!=="Row Index")],[]),s=d.useMemo(()=>r,[r]);return I.jsx(de,{columns:s,data:e,onDataUpdate:a,id:"spreadsheet--id",...t})},zn=({...t})=>{const[e,a]=d.useState(()=>We({rows:24,extraColumns:!0})),r=d.useMemo(()=>[...Oe,{Header:"Owner name",accessor:"ownerName"},{Header:"Weight",accessor:"weight"}],[]),s=d.useMemo(()=>r,[r]);return I.jsx(de,{columns:s,data:e,onDataUpdate:a,id:"spreadsheet--id",...t})},Un=({...t})=>{const[e,a]=d.useState(()=>We({rows:24,extraColumns:!0})),r=d.useMemo(()=>[...Oe,{Header:"Owner name",accessor:"ownerName"},{Header:"Weight",accessor:"weight"}],[]),s=d.useMemo(()=>r,[r]);return I.jsx(de,{columns:s,data:e,onDataUpdate:a,id:"spreadsheet--id",...t})},Te=Wn.bind({});Te.storyName="Basic spreadsheet";Te.args={selectAllAriaLabel:"Select all",spreadsheetAriaLabel:"Example data spreadsheet"};const He=Bn.bind({});He.storyName="Large dataset";He.args={cellSize:"lg",selectAllAriaLabel:"Select all",spreadsheetAriaLabel:"Example data spreadsheet"};const $e=Vn.bind({});$e.storyName="Large dataset with optional component";$e.args={cellSize:"lg",selectAllAriaLabel:"Select all",spreadsheetAriaLabel:"Example data spreadsheet"};const qe=En.bind({});qe.storyName="Empty with cells";qe.args={defaultEmptyRowCount:24,selectAllAriaLabel:"Select all",spreadsheetAriaLabel:"Example data spreadsheet"};const Me=zn.bind({});Me.storyName="With many columns";Me.args={selectAllAriaLabel:"Select all",spreadsheetAriaLabel:"Example data spreadsheet",totalVisibleColumns:5};const je=Un.bind({});je.storyName="With different options";je.args={readOnlyTable:!1,disableColumnSwapping:!1,selectAllAriaLabel:"Select all",spreadsheetAriaLabel:"Example data spreadsheet",totalVisibleColumns:5};var wt,yt,gt;Te.parameters={...Te.parameters,docs:{...(wt=Te.parameters)==null?void 0:wt.docs,source:{originalSource:`({
  ...args
}) => {
  const [data, setData] = useState(() => generateData({
    rows: 16
  }));
  const columns = useMemo(() => columnData, []);
  return <DataSpreadsheet columns={columns} data={data} onDataUpdate={setData} id="spreadsheet--id" {...args} />;
}`,...(gt=(yt=Te.parameters)==null?void 0:yt.docs)==null?void 0:gt.source}}};var bt,xt,St;He.parameters={...He.parameters,docs:{...(bt=He.parameters)==null?void 0:bt.docs,source:{originalSource:`({
  ...args
}) => {
  const [data, setData] = useState(() => generateData({
    rows: 1000
  }));
  const columns = useMemo(() => columnData, []);
  return <DataSpreadsheet columns={columns} data={data} onDataUpdate={setData} id="spreadsheet--id" {...args} />;
}`,...(St=(xt=He.parameters)==null?void 0:xt.docs)==null?void 0:St.source}}};var At,_t,Tt;$e.parameters={...$e.parameters,docs:{...(At=$e.parameters)==null?void 0:At.docs,source:{originalSource:`({
  ...args
}) => {
  const [data, setData] = useState(() => generateData({
    rows: 100000
  }));
  const columns = useMemo(() => columnData, []);
  const buildComponent = index => <OverflowMenu style={{
    width: '32px',
    height: '32px',
    minWidth: '32px',
    minHeight: '32px'
  }}>
      <OverflowMenuItem itemText={\`Test item \${index}\`} />
    </OverflowMenu>;
  return <DataSpreadsheet columns={columns} data={data} onDataUpdate={setData} renderRowHeaderDirection="Left" renderRowHeader={buildComponent} id="spreadsheet--id" {...args} />;
}`,...(Tt=(_t=$e.parameters)==null?void 0:_t.docs)==null?void 0:Tt.source}}};var Dt,It,Ht;qe.parameters={...qe.parameters,docs:{...(Dt=qe.parameters)==null?void 0:Dt.docs,source:{originalSource:`({
  ...args
}) => {
  const [data, setData] = useState([]);
  const columnDataClone = useMemo(() => [...columnData.filter(item => item.Header !== 'Row Index')], []);
  const columns = useMemo(() => columnDataClone, [columnDataClone]);
  return <DataSpreadsheet columns={columns} data={data} onDataUpdate={setData} id="spreadsheet--id" {...args} />;
}`,...(Ht=(It=qe.parameters)==null?void 0:It.docs)==null?void 0:Ht.source}}};var $t,qt,Mt;Me.parameters={...Me.parameters,docs:{...($t=Me.parameters)==null?void 0:$t.docs,source:{originalSource:`({
  ...args
}) => {
  const [data, setData] = useState(() => generateData({
    rows: 24,
    extraColumns: true
  }));
  const columnDataClone = useMemo(() => [...columnData, {
    Header: 'Owner name',
    accessor: 'ownerName'
  }, {
    Header: 'Weight',
    accessor: 'weight'
  }], []);
  const columns = useMemo(() => columnDataClone, [columnDataClone]);
  return <DataSpreadsheet columns={columns} data={data} onDataUpdate={setData} id="spreadsheet--id" {...args} />;
}`,...(Mt=(qt=Me.parameters)==null?void 0:qt.docs)==null?void 0:Mt.source}}};var jt,Ot,Lt;je.parameters={...je.parameters,docs:{...(jt=je.parameters)==null?void 0:jt.docs,source:{originalSource:`({
  ...args
}) => {
  const [data, setData] = useState(() => generateData({
    rows: 24,
    extraColumns: true
  }));
  const columnDataClone = useMemo(() => [...columnData, {
    Header: 'Owner name',
    accessor: 'ownerName'
  }, {
    Header: 'Weight',
    accessor: 'weight'
  }], []);
  const columns = useMemo(() => columnDataClone, [columnDataClone]);
  return <DataSpreadsheet columns={columns} data={data} onDataUpdate={setData} id="spreadsheet--id" {...args} />;
}`,...(Lt=(Ot=je.parameters)==null?void 0:Ot.docs)==null?void 0:Lt.source}}};const Ar=["dataSpreadsheet","largeDatasetSpreadsheet","largeDatasetSpreadsheetCustom","emptyWithCells","withManyColumns","withDifferentOptions"];export{Ar as __namedExportsOrder,Te as dataSpreadsheet,Sr as default,qe as emptyWithCells,He as largeDatasetSpreadsheet,$e as largeDatasetSpreadsheetCustom,je as withDifferentOptions,Me as withManyColumns};
