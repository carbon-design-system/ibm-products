import{e as i,c as _,p as b,r as E,u as C,aM as R,C as h}from"./iframe-Cbdf71kV.js";import{u as $}from"./useFocusRowExpander-CqVyzEAB.js";const l=`${b.prefix}--datagrid`,v=o=>a=>{const{row:t}=a,{expandedContentHeight:c}=t,r=(e,n="")=>{if(e?.target?.closest("tr").previousElementSibling){const x=e?.target?.closest("tr").previousElementSibling;n==="enter"?x.classList.add(`${l}__expandable-row--hover`):x.classList.remove(`${l}__expandable-row--hover`)}},{key:p,...d}=a;return i.createElement("tr",{className:_(`${l}__expanded-row`,{[`${l}__slug--row`]:E.isValidElement(t?.original?.slug),[`${l}__ai-label--row`]:E.isValidElement(t?.original?.aiLabel)}),onMouseEnter:e=>r(e,"enter"),onMouseLeave:e=>r(e)},i.createElement("td",{className:`${l}__expanded-row-cell-wrapper`},i.createElement("div",{className:`${l}__expanded-row-content`,ref:e=>{e&&e.style&&c&&(e.style.height=`${c}px`)}},i.createElement(o,{key:p,...d}))))},g=`${b.prefix}--datagrid`,f=o=>{const a=E.useRef(void 0),t=E.useRef(void 0),c=d=>{a.current=d},r=C();$({instance:a?.current,lastExpandedRowIndex:t?.current,blockClass:g,activeElement:document.activeElement});const p=d=>[{id:"expander",Cell:({row:n})=>{const x={...n.getToggleRowExpandedProps(),onClick:m=>{m.stopPropagation(),n.toggleRowExpanded(),n?.onClick?.(n,m),t.current=n.id},title:null},{expanderButtonTitleExpanded:w,expanderButtonTitleCollapsed:s}=a?.current||{},u=n.isExpanded?w:s;return n.canExpand&&i.createElement("button",{type:"button","aria-label":u,className:_(`${g}__row-expander`,`${r}--btn`,`${r}--btn--ghost`),...x},n.isExpanded?i.createElement(R,{className:`${g}__row-expander--icon`}):i.createElement(h,{className:`${g}__row-expander--icon`}))},width:48,disableResizing:!0,disableSortBy:!0,Header:""},...d];o.visibleColumns.push(p),o.useInstance.push(c)},I=o=>{f(o);const a=t=>{const{rows:c,expandedContentHeight:r,ExpandedRowContentComponent:p,onRowExpand:d}=t,[e,n]=E.useState({}),x=(s,u)=>n({...e,[s]:u}),w=c.map(s=>({...s,canExpand:s.original&&!s.original.notExpandable,expandedContentHeight:e[s.index]||r,RowExpansionRenderer:p&&v(p),onClick:(u,m)=>d?.(u,m)}));Object.assign(t,{rows:w,setExpandedRowHeight:x,withExpandedRows:!0})};o.useInstance.push(a)};export{I as u};
