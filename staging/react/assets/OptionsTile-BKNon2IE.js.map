{"version":3,"file":"OptionsTile-BKNon2IE.js","sources":["../../src/components/OptionsTile/OptionsTile.tsx"],"sourcesContent":["/**\n * Copyright IBM Corp. 2021, 2024\n *\n * This source code is licensed under the Apache-2.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport * as carbonMotion from '@carbon/motion';\n\nimport {\n  ChevronDown,\n  Locked,\n  WarningAltFilled,\n  WarningFilled,\n} from '@carbon/react/icons';\nimport { Heading, Layer, Section, Toggle } from '@carbon/react';\nimport React, { MouseEvent, ReactNode, useRef, useState } from 'react';\nimport { CarbonIconType } from '@carbon/icons-react/lib/CarbonIcon';\nimport { useNoInteractiveChildren } from '@carbon/utilities-react';\nimport PropTypes from 'prop-types';\nimport cx from 'classnames';\nimport { getDevtoolsProps } from '../../global/js/utils/devtools';\nimport { pkg } from '../../settings';\nimport {\n  useControllableState,\n  usePrefersReducedMotion,\n} from '../../global/js/hooks';\nimport uuidv4 from '../../global/js/utils/uuidv4';\n\nconst blockClass = `${pkg.prefix}--options-tile`;\nconst componentName = 'OptionsTile';\n\nexport interface OptionsTileProps {\n  /**\n   * Provide content to render as expandable OptionsTile. If no children\n   * are present, the OptionsTile will render as its variant.\n   */\n  children?: ReactNode;\n\n  /**\n   * Provide an optional class to be applied to the containing node.\n   */\n  className?: string;\n\n  /**\n   * Whether the toggle is enabled or disabled. If nothing is passed,\n   * no toggle will be rendered.\n   */\n  enabled?: boolean;\n\n  /**\n   * Whether the OptionsTile is in invalid validation state.\n   */\n  invalid?: boolean;\n\n  /**\n   * Provide a text explaining why the OptionsTile is in invalid state.\n   */\n  invalidText?: string;\n\n  /**\n   * Whether the OptionsTile is in locked validation state.\n   */\n  locked?: boolean;\n\n  /**\n   * Provide a text explaining why the OptionsTile is in locked state.\n   */\n  lockedText?: string;\n\n  /**\n   * A handler for managing the controlled state of open prop. If not passed the open prop will not be honored and an uncontrolled state will be used.\n   */\n  onChange?: (value: boolean) => void;\n\n  /**\n   * Provide a function which will be called each time the user\n   * interacts with the toggle.\n   */\n  onToggle?: (value: boolean) => void;\n\n  /**\n   * For controlled usage of the tile open state. This prop only works when an onChange prop is also passed, otherwise an uncontrolled state is used.\n   */\n  open?: boolean;\n\n  /**\n   * Define the size of the OptionsTile.\n   */\n  size?: 'lg' | 'xl';\n\n  /**\n   * Optionally provide a text summarizing the current state of the content.\n   */\n  summary?: string;\n\n  /**\n   * Provide the title for this OptionsTile. Must not contain any interactive elements.\n   */\n  title: ReactNode;\n\n  /**\n   * Optionally provide an id which should be used for the title.\n   */\n  titleId?: string;\n\n  /**\n   * Whether the OptionsTile is in warning validation state.\n   */\n  warn?: boolean;\n\n  /**\n   * Provide a text explaining why the OptionsTile is in warning state.\n   */\n  warnText?: string;\n}\n\n// Default values for props\nconst defaults = {\n  size: 'lg' as const,\n};\n\nexport const OptionsTile = React.forwardRef<HTMLDivElement, OptionsTileProps>(\n  (props, ref) => {\n    const {\n      children,\n      className,\n      enabled,\n      invalid,\n      invalidText,\n      locked,\n      lockedText,\n      onChange,\n      onToggle,\n      open: userOpen,\n      size = defaults.size,\n      summary,\n      title,\n      titleId: userDefinedTitleId,\n      warn,\n      warnText,\n      ...rest\n    } = props;\n    const [closing, setClosing] = useState(false);\n    const [open, setOpen] = useControllableState(userOpen ?? false, onChange);\n\n    const detailsRef = useRef<HTMLDetailsElement>(null);\n    const contentRef = useRef<HTMLDivElement>(null);\n    const headingRef = useRef<HTMLHeadingElement>(null);\n\n    useNoInteractiveChildren(headingRef);\n\n    const titleId = userDefinedTitleId ?? `${uuidv4()}-title`;\n    const isExpandable = children !== undefined;\n    const isWarn = !invalid && warn;\n    const isLocked = !invalid && !isWarn && locked;\n    const shouldReduceMotion = usePrefersReducedMotion();\n\n    const expand = () => {\n      if (detailsRef.current && contentRef.current && !shouldReduceMotion) {\n        setOpen(true);\n\n        detailsRef.current.open = true;\n        const { paddingTop, paddingBottom, height } = getComputedStyle(\n          contentRef.current\n        );\n\n        contentRef.current.animate(\n          [\n            {\n              paddingTop: 0,\n              paddingBottom: 0,\n              height: 0,\n              opacity: 0,\n              overflow: 'hidden',\n            },\n            {\n              paddingTop,\n              paddingBottom,\n              height,\n              opacity: 1,\n              overflow: 'hidden',\n            },\n          ],\n          {\n            duration: Number(carbonMotion.moderate01.replace('ms', '')),\n            easing: carbonMotion.easings.entrance.productive,\n          }\n        );\n      } else {\n        setOpen(true);\n      }\n    };\n\n    const collapse = () => {\n      if (contentRef.current && !shouldReduceMotion) {\n        setClosing(true);\n\n        const { paddingTop, paddingBottom, height } = getComputedStyle(\n          contentRef.current\n        );\n\n        const animationDuration = Number(\n          carbonMotion.moderate01.replace('ms', '')\n        );\n\n        const animation = contentRef.current.animate(\n          [\n            {\n              paddingTop,\n              paddingBottom,\n              height,\n              opacity: 1,\n            },\n            {\n              paddingTop: 0,\n              paddingBottom: 0,\n              height: 0,\n              opacity: 0,\n            },\n          ],\n          {\n            duration: animationDuration,\n            easing: carbonMotion.easings.entrance.productive,\n          }\n        );\n\n        const callback = () => {\n          setOpen(false);\n          setClosing(false);\n        };\n\n        setTimeout(() => {\n          callback();\n        }, animationDuration * 0.9);\n        animation.oncancel = callback;\n      } else {\n        setOpen(false);\n      }\n    };\n\n    const toggle = (evt: MouseEvent) => {\n      evt.preventDefault();\n\n      if (open) {\n        collapse();\n      } else {\n        expand();\n      }\n    };\n\n    const renderTitle = () => {\n      let Icon: CarbonIconType | null = null;\n      let text = summary;\n\n      if (invalid) {\n        Icon = WarningFilled;\n        text = invalidText;\n      } else if (warn) {\n        Icon = WarningAltFilled;\n        text = warnText;\n      } else if (locked) {\n        Icon = Locked;\n        if (!text) {\n          text = lockedText;\n        }\n      }\n\n      const hasValidationState = invalid || warn || locked;\n      const summaryHidden = !hasValidationState && enabled === false;\n      const summaryClasses = cx(`${blockClass}__summary`, {\n        [`${blockClass}__summary--closing`]: closing,\n        [`${blockClass}__summary--open`]: open,\n        [`${blockClass}__summary--invalid`]: invalid,\n        [`${blockClass}__summary--warn`]: warn,\n        [`${blockClass}__summary--locked`]: locked,\n        [`${blockClass}__summary--hidden`]: summaryHidden,\n      });\n\n      return (\n        <div className={`${blockClass}__heading`}>\n          <Heading\n            ref={headingRef}\n            id={titleId}\n            className={`${blockClass}__title`}\n          >\n            {title}\n          </Heading>\n          {text && (\n            <span className={summaryClasses} aria-hidden={summaryHidden}>\n              {Icon && <Icon size={16} />}\n              <span className={`${blockClass}__summary-text`}>{text}</span>\n            </span>\n          )}\n        </div>\n      );\n    };\n\n    return (\n      <Section\n        {...rest}\n        className={cx(blockClass, className, `${blockClass}--${size}`, {\n          [`${blockClass}--closing`]: closing,\n        })}\n        ref={ref}\n        {...getDevtoolsProps(componentName)}\n      >\n        {enabled !== undefined && (\n          <div className={`${blockClass}__toggle-container`}>\n            <Toggle\n              id={`${titleId}-toggle`}\n              className={`${blockClass}__toggle`}\n              toggled={enabled}\n              aria-labelledby={titleId}\n              hideLabel\n              onToggle={onToggle}\n              size=\"sm\"\n              disabled={isLocked}\n            />\n          </div>\n        )}\n        {isExpandable ? (\n          <details\n            className={`${blockClass}__details`}\n            open={open}\n            ref={detailsRef}\n          >\n            <summary className={`${blockClass}__header`} onClick={toggle}>\n              <ChevronDown\n                size={16}\n                className={cx(`${blockClass}__chevron`, {\n                  [`${blockClass}__chevron--open`]: open,\n                  [`${blockClass}__chevron--closing`]: closing,\n                })}\n              />\n              {renderTitle()}\n            </summary>\n            <div className={`${blockClass}__content`} ref={contentRef}>\n              <Layer>\n                {isLocked && (\n                  <p className={`${blockClass}__locked-text`}>\n                    <Locked size={16} />\n                    {lockedText}\n                  </p>\n                )}\n                {children}\n              </Layer>\n            </div>\n          </details>\n        ) : (\n          <div className={`${blockClass}__static-content`}>{renderTitle()}</div>\n        )}\n      </Section>\n    );\n  }\n);\n\n// Return a placeholder if not released and not enabled by feature flag\n\n// The display name of the component, used by React. Note that displayName\n// is used in preference to relying on function.name.\nOptionsTile.displayName = componentName;\n\n// The types and DocGen commentary for the component props,\n// in alphabetical order (for consistency).\n// See https://www.npmjs.com/package/prop-types#usage.\nOptionsTile.propTypes = {\n  /**\n   * Provide content to render as expandable OptionsTile. If no children\n   * are present, the OptionsTile will render as its variant.\n   */\n  children: PropTypes.node,\n\n  /**\n   * Provide an optional class to be applied to the containing node.\n   */\n  className: PropTypes.string,\n\n  /**\n   * Whether the toggle is enabled or disabled. If nothing is passed,\n   * no toggle will be rendered.\n   */\n  enabled: PropTypes.bool,\n\n  /**\n   * Whether the OptionsTile is in invalid validation state.\n   */\n  invalid: PropTypes.bool,\n\n  /**\n   * Provide a text explaining why the OptionsTile is in invalid state.\n   */\n  invalidText: PropTypes.string,\n\n  /**\n   * Whether the OptionsTile is in locked validation state.\n   */\n  locked: PropTypes.bool,\n\n  /**\n   * Provide a text explaining why the OptionsTile is in locked state.\n   */\n  lockedText: PropTypes.string,\n\n  /**\n   * A handler for managing the controlled state of open prop. If not passed the open prop will not be honored and an uncontrolled state will be used.\n   */\n  onChange: PropTypes.func,\n\n  /**\n   * Provide a function which will be called each time the user\n   * interacts with the toggle.\n   */\n  onToggle: PropTypes.func,\n\n  /**\n   * For controlled usage of the tile open state. This prop only works when an onChange prop is also passed, otherwise an uncontrolled state is used.\n   */\n  open: PropTypes.bool,\n\n  /**\n   * Define the size of the OptionsTile.\n   */\n  size: PropTypes.oneOf(['lg', 'xl']),\n\n  /**\n   * Optionally provide a text summarizing the current state of the content.\n   */\n  summary: PropTypes.string,\n\n  /**\n   * Provide the title for this OptionsTile. Must not contain any interactive elements.\n   */\n  title: PropTypes.oneOfType([PropTypes.string, PropTypes.node]).isRequired,\n\n  /**\n   * Optionally provide an id which should be used for the title.\n   */\n  titleId: PropTypes.string,\n\n  /**\n   * Whether the OptionsTile is in warning validation state.\n   */\n  warn: PropTypes.bool,\n\n  /**\n   * Provide a text explaining why the OptionsTile is in warning state.\n   */\n  warnText: PropTypes.string,\n};\n"],"names":["blockClass","pkg","componentName","defaults","OptionsTile","React","props","ref","children","className","enabled","invalid","invalidText","locked","lockedText","onChange","onToggle","userOpen","size","summary","title","userDefinedTitleId","warn","warnText","rest","closing","setClosing","useState","open","setOpen","useControllableState","detailsRef","useRef","contentRef","headingRef","titleId","uuidv4","isExpandable","isLocked","shouldReduceMotion","usePrefersReducedMotion","expand","paddingTop","paddingBottom","height","carbonMotion.moderate01","carbonMotion.easings","collapse","animationDuration","animation","callback","toggle","evt","renderTitle","Icon","text","WarningFilled","WarningAltFilled","Locked","summaryHidden","summaryClasses","cx","Heading","Section","getDevtoolsProps","Toggle","ChevronDown","Layer","PropTypes"],"mappings":"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"}