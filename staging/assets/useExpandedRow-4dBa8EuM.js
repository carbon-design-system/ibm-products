import{e as c,r as g}from"./index-DzvNrmz8.js";import{p as C,c as b}from"./settings-CP9zVSjJ.js";import{d as h,aa as $,k as R}from"./index-5As4T26e.js";import{u as f}from"./useFocusRowExpander-CzKGws3E.js";const l=`${C.prefix}--datagrid`,H=d=>a=>{var e,m;const{row:t}=a,{expandedContentHeight:p}=t,x=(n,E="")=>{var s,o;if((s=n==null?void 0:n.target)!=null&&s.closest("tr").previousElementSibling){const i=(o=n==null?void 0:n.target)==null?void 0:o.closest("tr").previousElementSibling;E==="enter"?i.classList.add(`${l}__expandable-row--hover`):i.classList.remove(`${l}__expandable-row--hover`)}},{key:r,...u}=a;return c.createElement("tr",{className:h(`${l}__expanded-row`,{[`${l}__slug--row`]:g.isValidElement((e=t==null?void 0:t.original)==null?void 0:e.slug),[`${l}__ai-label--row`]:g.isValidElement((m=t==null?void 0:t.original)==null?void 0:m.aiLabel)}),onMouseEnter:n=>x(n,"enter"),onMouseLeave:n=>x(n)},c.createElement("td",{className:`${l}__expanded-row-cell-wrapper`},c.createElement("div",{className:`${l}__expanded-row-content`,ref:n=>{n&&n.style&&p&&(n.style.height=`${p}px`)}},c.createElement(d,{key:r,...u}))))},_=`${C.prefix}--datagrid`,w=d=>{const a=g.useRef(void 0),t=g.useRef(void 0),p=r=>{a.current=r};f({instance:a==null?void 0:a.current,lastExpandedRowIndex:t==null?void 0:t.current,blockClass:_,activeElement:document.activeElement});const x=r=>[{id:"expander",Cell:({row:e})=>{const m={...e.getToggleRowExpandedProps(),onClick:o=>{var i;o.stopPropagation(),e.toggleRowExpanded(),(i=e==null?void 0:e.onClick)==null||i.call(e,e,o),t.current=e.id},title:null},{expanderButtonTitleExpanded:n,expanderButtonTitleCollapsed:E}=(a==null?void 0:a.current)||{},s=e.isExpanded?n:E;return e.canExpand&&c.createElement("button",{type:"button","aria-label":s,className:h(`${_}__row-expander`,`${b.prefix}--btn`,`${b.prefix}--btn--ghost`),...m},e.isExpanded?c.createElement($,{className:`${_}__row-expander--icon`}):c.createElement(R,{className:`${_}__row-expander--icon`}))},width:48,disableResizing:!0,disableSortBy:!0,Header:""},...r];d.visibleColumns.push(x),d.useInstance.push(p)},B=d=>{w(d);const a=t=>{const{rows:p,expandedContentHeight:x,ExpandedRowContentComponent:r,onRowExpand:u}=t,[e,m]=g.useState({}),n=(s,o)=>m({...e,[s]:o}),E=p.map(s=>({...s,canExpand:s.original&&!s.original.notExpandable,expandedContentHeight:e[s.index]||x,RowExpansionRenderer:r&&H(r),onClick:(o,i)=>u==null?void 0:u(o,i)}));Object.assign(t,{rows:E,setExpandedRowHeight:n,withExpandedRows:!0})};d.useInstance.push(a)};export{B as u};
