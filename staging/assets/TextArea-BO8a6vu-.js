import{b as he,d as ge,j as be,l as we,c as w,_ as _e,e as $e}from"./index-C8rbkH0g.js";import{P as t}from"./index-Dk74W0Oi.js";import{R as r,r as x}from"./index-BwDkhjyp.js";import{F as Te}from"./FormContext-C7kRVu4t.js";import{u as ye}from"./useAnnouncer-Dwt0jqXi.js";import{n as N}from"./settings-DI4GKhuL.js";import{T as $}from"./Text-DZylbEPL.js";import{W as B,a as G}from"./bucket-18--U95jA7N.js";const H=r.forwardRef((J,Q)=>{var M;const{className:U,disabled:d=!1,id:C,labelText:A,hideLabel:X,onChange:I=N,onClick:W=N,onKeyDown:R=N,invalid:s=!1,invalidText:Y="",helperText:T="",light:Z,placeholder:ee="",enableCounter:_=!1,maxCount:n=void 0,counterMode:o="character",warn:m=!1,warnText:te="",rows:ae=4,slug:y,...f}=J,e=he(),{isFluid:i}=x.useContext(Te),{defaultValue:D,value:O}=f,re=ge(),c=x.useRef(null),ne=be([Q,c]);function F(){var p,b;const l=(D||O||((p=c.current)==null?void 0:p.value)||"").toString();return o==="character"?l.length:((b=l.match(/\w+/g))==null?void 0:b.length)||0}const[v,h]=x.useState(F());x.useEffect(()=>{h(F())},[O,D,o]),we(()=>{f.cols&&c.current?(c.current.style.width="",c.current.style.resize="none"):c.current&&(c.current.style.width="100%")},[f.cols]);const P={id:C,onKeyDown:a=>{if(!d&&_&&o==="word"){const l=a.which;(n&&v>=n&&l===32||n&&v>=n&&l===13)&&a.preventDefault()}!d&&R&&R(a)},onPaste:a=>{if(!d&&o==="word"&&_&&typeof n<"u"&&c.current!==null){const l=c.current.value.match(/\w+/g)||[],p=a.clipboardData.getData("Text").match(/\w+/g)||[];if(l.length+p.length>n){a.preventDefault();const u=l.concat(p).slice(0,n);setTimeout(()=>{h(n)},0),c.current.value=u.join(" ")}}},onChange:a=>{var l,p,b;if(!d){if(o=="character")(l=a==null?void 0:a.persist)==null||l.call(a),setTimeout(()=>{var u,j;h((j=(u=a.target)==null?void 0:u.value)==null?void 0:j.length)},0);else if(o=="word"){if(!a.target.value){setTimeout(()=>{h(0)},0);return}if(_&&typeof n<"u"&&c.current!==null){const u=(b=(p=a.target)==null?void 0:p.value)==null?void 0:b.match(/\w+/g);u&&u.length<=n?(c.current.removeAttribute("maxLength"),setTimeout(()=>{h(u.length)},0)):u&&u.length>n&&setTimeout(()=>{h(u.length)},0)}}I&&I(a)}},onClick:a=>{!d&&W&&W(a)}},le=w(`${e}--form-item`,U),se=w(`${e}--text-area__wrapper`,{[`${e}--text-area__wrapper--cols`]:f.cols,[`${e}--text-area__wrapper--readonly`]:f.readOnly,[`${e}--text-area__wrapper--warn`]:m,[`${e}--text-area__wrapper--slug`]:y}),oe=w(`${e}--label`,{[`${e}--visually-hidden`]:X&&!i,[`${e}--label--disabled`]:d}),ie=w(`${e}--text-area`,{[`${e}--text-area--light`]:Z,[`${e}--text-area--invalid`]:s,[`${e}--text-area--warn`]:m}),ce=w(`${e}--label`,{[`${e}--label--disabled`]:d}),ue=w(`${e}--form__helper-text`,{[`${e}--form__helper-text--disabled`]:d}),de=A?r.createElement($,{as:"label",htmlFor:C,className:oe},A):null,me=_&&n&&(o==="character"||o==="word")?r.createElement($,{as:"div",className:ce},`${v}/${n}`):null,L=T?`text-area-helper-text-${re}`:void 0,fe=T?r.createElement($,{as:"div",id:L,className:ue},T):null,V=C+"-error-msg",k=s?r.createElement($,{as:"div",role:"alert",className:`${e}--form-requirement`,id:V},Y,i&&r.createElement(B,{className:`${e}--text-area__invalid-icon`})):null,S=m?r.createElement($,{as:"div",role:"alert",className:`${e}--form-requirement`},te,i&&r.createElement(G,{className:`${e}--text-area__invalid-icon ${e}--text-area__invalid-icon--warning`})):null;let E;s?E=V:!s&&!m&&!i&&T&&(E=L),_&&o=="character"&&(P.maxLength=n);const q=x.useRef(null),[z,pe]=x.useState(""),g=ye(v,n,o==="word"?"words":void 0);x.useEffect(()=>{if(g&&g!==z){const a=q.current;if(a){a.textContent="";const l=setTimeout(()=>{a&&(a.textContent=g,pe(g))},o==="word"?2e3:1e3);return()=>{l&&clearTimeout(l)}}}},[g,z,o]);const xe=r.createElement("textarea",_e({},f,P,{placeholder:ee,"aria-readonly":!!f.readOnly,className:ie,"aria-invalid":s,"aria-describedby":E,disabled:d,rows:ae,readOnly:f.readOnly,ref:ne}));let K;return y&&((M=y.type)==null?void 0:M.displayName)==="AILabel"&&(K=r.cloneElement(y,{size:"mini"})),r.createElement("div",{className:le},r.createElement("div",{className:`${e}--text-area__label-wrapper`},de,me),r.createElement("div",{className:se,"data-invalid":s||null},s&&!i&&r.createElement(B,{className:`${e}--text-area__invalid-icon`}),m&&!s&&!i&&r.createElement(G,{className:`${e}--text-area__invalid-icon ${e}--text-area__invalid-icon--warning`}),xe,K,r.createElement("span",{className:`${e}--text-area__counter-alert`,role:"alert","aria-live":"assertive","aria-atomic":"true",ref:q},g),i&&r.createElement("hr",{className:`${e}--text-area__divider`}),i&&s?k:null,i&&m&&!s?S:null),!s&&!m&&!i?fe:null,s&&!i?k:null,m&&!s&&!i?S:null)});H.displayName="TextArea";H.propTypes={className:t.string,cols:t.number,counterMode:t.oneOf(["character","word"]),defaultValue:t.oneOfType([t.string,t.number]),disabled:t.bool,enableCounter:t.bool,helperText:t.node,hideLabel:t.bool,id:t.string,invalid:t.bool,invalidText:t.node,labelText:t.node.isRequired,light:$e(t.bool),maxCount:t.number,onChange:t.func,onClick:t.func,onKeyDown:t.func,placeholder:t.string,readOnly:t.bool,rows:t.number,slug:t.node,value:t.oneOfType([t.string,t.number]),warn:t.bool,warnText:t.node};export{H as T};
