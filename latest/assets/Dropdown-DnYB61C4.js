import{u as ke,a as Oe,b as Le,d as ze,c as E,_ as w,P as n,e as k,s as Ke,f as Re,h as Be,g as We}from"./index-B_euquWE.js";import{e as l,r as s}from"./index-DxDX2vOa.js";import{u as ue,L as T,a as qe,b as He}from"./index-D4Cc84yY.js";import{m as Ue}from"./mergeRefs-CTUecegF.js";import{F as Ve}from"./FormContext-Dj7olUH1.js";import{W as Ge,a as Je}from"./bucket-18-Dvh787Y8.js";import{C as Qe}from"./bucket-2-BDpMY3Ys.js";const{ItemMouseMove:Xe,MenuMouseLeave:Ye}=ue.stateChangeTypes,ce=i=>typeof i=="string"?i:typeof i=="number"?`${i}`:i!==null&&typeof i=="object"&&"label"in i&&typeof i.label=="string"?i.label:"";function pe(i,S){const{changes:r,type:C}=S;switch(C){case Xe:case Ye:return r.highlightedIndex===i.highlightedIndex?i:r;default:return r}}const me=l.forwardRef((i,S)=>{let{autoAlign:r=!1,className:C,decorator:y,disabled:x=!1,direction:O="bottom",items:L,label:z,["aria-label"]:K,ariaLabel:R,itemToString:p=ce,itemToElement:B=null,renderSelectedItem:W,type:be="default",size:A,onChange:D,id:fe,titleText:q="",hideLabel:ge,helperText:F="",translateWithId:he,light:H,invalid:a,invalidText:we,warn:_,warnText:ye,initialSelectedItem:U,selectedItem:V,downshiftProps:G,readOnly:$,slug:I,...xe}=i;const g=ke("enable-v12-dynamic-floating-styles"),{refs:b,floatingStyles:J,middlewareData:_e}=Oe(g||r?{placement:O,strategy:"fixed",middleware:[Ke({apply(e){let{rects:o,elements:d}=e;Object.assign(d.floating.style,{width:`${o.reference.width}px`})}}),r&&Re(),r&&Be()],whileElementsMounted:We}:{});s.useEffect(()=>{var e;if(g||r){const o={...J,visibility:(e=_e.hide)!=null&&e.referenceHidden?"hidden":"visible"};Object.keys(o).forEach(d=>{b.floating.current&&(b.floating.current.style[d]=o[d])})}},[J,r,b.floating]);const t=Le(),{isFluid:M}=s.useContext(Ve),Q=s.useCallback(e=>{let{selectedItem:o}=e;D&&D({selectedItem:o??null})},[D]),X=s.useCallback((e,o)=>e!==null&&typeof e=="object"&&"disabled"in e&&e.disabled===!0,[]),Y=s.useCallback(e=>{const{highlightedIndex:o}=e;if(o!==void 0&&o>-1&&typeof window!==void 0){const c=document.querySelectorAll(`li.${t}--list-box__menu-item[role="option"]`)[o];c&&c.scrollIntoView({behavior:"smooth",block:"nearest"})}},[t]),N=s.useMemo(()=>L,[L]),Z=s.useMemo(()=>({items:N,itemToString:p,initialSelectedItem:U,onSelectedItemChange:Q,stateReducer:pe,isItemDisabled:X,onHighlightedIndexChange:Y,...G}),[N,p,U,Q,pe,X,Y,G]),$e=ze();V!==void 0&&(Z.selectedItem=V);const{isOpen:f,getToggleButtonProps:ee,getLabelProps:Ie,getMenuProps:te,getItemProps:ve,selectedItem:u,highlightedIndex:Ee}=ue(Z),m=be==="inline",ne=!a&&_,[Te,Se]=s.useState(!1),Ce=E(`${t}--dropdown`,{[`${t}--dropdown--invalid`]:a,[`${t}--dropdown--warning`]:ne,[`${t}--dropdown--open`]:f,[`${t}--dropdown--inline`]:m,[`${t}--dropdown--disabled`]:x,[`${t}--dropdown--light`]:H,[`${t}--dropdown--readonly`]:$,[`${t}--dropdown--${A}`]:A,[`${t}--list-box--up`]:O==="top",[`${t}--autoalign`]:r}),Ae=E(`${t}--label`,{[`${t}--label--disabled`]:x,[`${t}--visually-hidden`]:ge}),De=E(`${t}--form__helper-text`,{[`${t}--form__helper-text--disabled`]:x}),Fe=E(`${t}--dropdown__wrapper`,`${t}--list-box__wrapper`,C,{[`${t}--dropdown__wrapper--inline`]:m,[`${t}--list-box__wrapper--inline`]:m,[`${t}--dropdown__wrapper--inline--invalid`]:m&&a,[`${t}--list-box__wrapper--inline--invalid`]:m&&a,[`${t}--list-box__wrapper--fluid--invalid`]:M&&a,[`${t}--list-box__wrapper--fluid--focus`]:M&&Te&&!f,[`${t}--list-box__wrapper--slug`]:I,[`${t}--list-box__wrapper--decorator`]:y}),oe=F?`dropdown-helper-text-${$e}`:void 0,P=B,h=s.useMemo(()=>ee({"aria-label":K||R}),[ee,K,R,f]),le=F&&!M?l.createElement("div",{id:oe,className:De},F):null,se=e=>{Se(e.type==="focus")},v=Ue(h.ref,S),[j,Me]=s.useState(),[ie,re]=s.useState(!1),ae=s.useCallback(e=>{(e.code!=="Space"||!["ArrowDown","ArrowUp"," ","Enter"].includes(e.key))&&re(!0),(ie&&e.code==="Space"||!["ArrowDown","ArrowUp"," ","Enter"].includes(e.key))&&(j&&clearTimeout(j),Me(setTimeout(()=>{re(!1)},3e3))),h.onKeyDown&&h.onKeyDown(e)},[ie,j,h]),Ne=s.useMemo(()=>$?{onClick:e=>{var o;e.preventDefault(),(o=v==null?void 0:v.current)==null||o.focus()},onKeyDown:e=>{["ArrowDown","ArrowUp"," ","Enter"].includes(e.key)&&e.preventDefault()}}:{onKeyDown:ae},[$,ae]),Pe=s.useMemo(()=>te({ref:g||r?b.setFloating:null}),[r,te,b.setFloating,g]),de=s.useMemo(()=>{var o;let e=I??y;return e&&((o=e.type)==null?void 0:o.displayName)==="AILabel"?l.cloneElement(e,{size:"mini"}):l.isValidElement(e)?e:null},[I,y]);return l.createElement("div",w({className:Fe},xe),q&&l.createElement("label",w({className:Ae},Ie()),q),l.createElement(T,{onFocus:se,onBlur:se,size:A,className:Ce,invalid:a,invalidText:we,warn:_,warnText:ye,light:H,isOpen:f,ref:g||r?b.setReference:null,id:fe},a&&l.createElement(Ge,{className:`${t}--list-box__invalid-icon`}),ne&&l.createElement(Je,{className:`${t}--list-box__invalid-icon ${t}--list-box__invalid-icon--warning`}),l.createElement("button",w({type:"button",className:`${t}--list-box__field`,disabled:x,"aria-disabled":$?!0:void 0,"aria-describedby":!m&&!a&&!_&&le?oe:void 0,title:u&&p!==void 0?p(u):ce(z)},h,Ne,{ref:v}),l.createElement("span",{className:`${t}--list-box__label`},u?W?W(u):p(u):z),l.createElement(T.MenuIcon,{isOpen:f,translateWithId:he})),I?de:y?l.createElement("div",{className:`${t}--list-box__inner-wrapper--decorator`},de):"",l.createElement(T.Menu,Pe,f&&N.map((e,o)=>{const d=e!==null&&typeof e=="object",c=ve({item:e,index:o});e!==null&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"id")&&(c.id=e.id);const je=d&&"text"in e&&B?e.text:p(e);return l.createElement(T.MenuItem,w({key:c.id,isActive:u===e,isHighlighted:Ee===o,title:je,disabled:c["aria-disabled"]},c),typeof e=="object"&&P!==void 0&&P!==null?l.createElement(P,w({key:c.id},e)):p(e),u===e&&l.createElement(Qe,{className:`${t}--list-box__menu-item__selected-icon`}))}))),!m&&!a&&!_&&le)});me.displayName="Dropdown";me.propTypes={"aria-label":n.string,ariaLabel:k(n.string),autoAlign:n.bool,className:n.string,decorator:n.node,direction:n.oneOf(["top","bottom"]),disabled:n.bool,downshiftProps:n.object,helperText:n.node,hideLabel:n.bool,id:n.string.isRequired,initialSelectedItem:n.oneOfType([n.object,n.string,n.number]),invalid:n.bool,invalidText:n.node,itemToElement:n.func,itemToString:n.func,items:n.array.isRequired,label:n.node.isRequired,light:k(n.bool),onChange:n.func,readOnly:n.bool,renderSelectedItem:n.func,selectedItem:n.oneOfType([n.object,n.string,n.number]),size:qe,slug:k(n.node),titleText:n.node.isRequired,translateWithId:n.func,type:He,warn:n.bool,warnText:n.node};export{me as D};
