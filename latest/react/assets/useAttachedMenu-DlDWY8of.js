import{r as o,e as N,u as fe,m as de,c as he,_ as me,ab as pe,a7 as xe,o as v,w as ye,ar as be,aa as we,a9 as Ie,P as t,l as Re}from"./iframe-6Ea7Lnhj.js";const ze={isRoot:!0,hasIcons:!1,hasSelectableItems:!1,size:null,items:[],requestCloseRoot:()=>{}};function Ce(a,f){switch(f.type){case"enableIcons":return{...a,hasIcons:!0};case"enableSelectableItems":return{...a,hasSelectableItems:!0};case"registerItem":return{...a,items:[...a.items,f.payload].filter(h=>h.ref.current!==null)}}}const Y=o.createContext({state:ze,dispatch:a=>{}}),Ee=N.createContext({direction:"ltr"});function Se(){return o.useContext(Ee)}const D=8,Me=o.forwardRef(function({children:f,className:h,containerRef:b,label:O,menuAlignment:c,mode:P,onClose:m,onOpen:I,open:n,size:R="sm",legacyAutoalign:w="true",target:z=pe&&document.body,x:g=0,y:Z=0,..._},ee){const l=fe(),B=o.useRef(null),C=o.useContext(Y),d=C.state.isRoot,te=d?R:C.state.size,[k,K]=o.useReducer(Ce,{...C.state,isRoot:!1,size:R,requestCloseRoot:d?T:C.state.requestCloseRoot}),E=o.useMemo(()=>({state:k,dispatch:K}),[k,K]),r=o.useRef(null),ne=de([ee,r]),[U,W]=o.useState([-1,-1]),p=E.state.items.filter(e=>!e.disabled&&e.ref.current);let x;if(b?.current){const{width:e}=b.current.getBoundingClientRect();x=e}const{direction:se}=Se();function oe(){B.current&&B.current.focus()}function re(){if(r.current){if(B.current=document.activeElement,w){const e=ue();(document?.dir==="rtl"||se==="rtl")&&!_?.id?.includes("MenuButton")?(r.current.style.insetInlineStart="initial",r.current.style.insetInlineEnd=`${e[0]}px`):(r.current.style.insetInlineStart=`${e[0]}px`,r.current.style.insetInlineEnd="initial"),r.current.style.insetBlockStart=`${e[1]}px`,W(e)}r.current.focus(),I&&I()}}function T(){oe(),m&&m()}function ce(e){e.stopPropagation(),(v(e,ye)||!d&&v(e,be))&&m?T():j(e)}function j(e){const i=p.findIndex(S=>S.ref?.current?.contains(document.activeElement));let s=i;i===-1?s=0:e&&(v(e,we)&&(s=s-1),v(e,Ie)&&(s=s+1)),s<0&&(s=p.length-1),s>=p.length&&(s=0),s!==i&&(p[s].ref?.current?.focus(),e?.preventDefault())}function ie(e){n&&m&&d&&!r.current?.contains(e.relatedTarget)&&T()}function H(e,i){if(!r.current)return;const{width:s,height:S}=r.current.getBoundingClientRect(),M=d?"vertical":"horizontal",u={x:{max:window.innerWidth,size:s,anchor:M==="horizontal"?e[1]:e[0],reversedAnchor:M==="horizontal"?e[0]:e[1],offset:0},y:{max:window.innerHeight,size:S,anchor:M==="horizontal"?e[0]:e[1],reversedAnchor:M==="horizontal"?e[1]:e[0],offset:d?0:4}};if(x&&x<u.x.size&&(c==="bottom"||c==="top")&&(u.x.size=x),x&&(c==="bottom-end"||c==="top-end")&&u.x.anchor>=87&&x<u.x.size){const L=u.x.anchor+u.x.reversedAnchor;u.x.anchor=u.x.anchor+L}const{max:G,size:$,anchor:q,reversedAnchor:J,offset:A}=u[i],y=[G-D-$-q>=0?q-A:!1,J-$>=0?J-$+A:!1,G-D-$],Q=c==="top"||c==="top-end"||c==="top-start";typeof y[0]=="number"&&Q&&y[0]>=0&&!y[1]&&i==="y"?r.current.style.transform="translate(0)":Q&&!y[0]&&i==="y"&&(y[0]=q-A);const X=y.find(L=>L!==!1);return X>=D?X:D}function ae(e){return e!=null}function V(e){if(Array.isArray(e)){const i=e.filter(ae);return i.length===2?i:void 0}else return[e,e]}function ue(){const e={x:V(g),y:V(Z)};return!e.x||!e.y?[-1,-1]:[H(e.x,"x")??-1,H(e.y,"y")??-1]}o.useEffect(()=>{if(n){const e=requestAnimationFrame(()=>{p.length>0&&j()});return()=>cancelAnimationFrame(e)}},[n,p]),o.useEffect(()=>{n?re():W([-1,-1])},[n]);const le=he(h,`${l}--menu`,`${l}--menu--${te}`,{[`${l}--menu--box-shadow-top`]:c&&c.slice(0,3)==="top",[`${l}--menu--open`]:n,[`${l}--menu--shown`]:n&&!w||U[0]>=0&&U[1]>=0,[`${l}--menu--with-icons`]:E.state.hasIcons,[`${l}--menu--with-selectable-items`]:E.state.hasSelectableItems,[`${l}--autoalign`]:!w}),F=N.createElement(Y.Provider,{value:E},N.createElement("ul",me({},_,{className:le,role:"menu",ref:ne,"aria-label":O,tabIndex:-1,onKeyDown:ce,onBlur:ie}),f));return z&&d?n&&xe.createPortal(F,z)||null:F});Me.propTypes={children:t.node,className:t.string,label:t.string,menuAlignment:t.string,mode:Re(t.oneOf(["full","basic"])),onClose:t.func,onOpen:t.func,open:t.bool,size:t.oneOf(["xs","sm","md","lg"]),target:t.object,x:t.oneOfType([t.number,t.arrayOf(t.number)]),y:t.oneOfType([t.number,t.arrayOf(t.number)])};function ve(a){const[f,h]=o.useState(!1),[b,O]=o.useState([[-1,-1],[-1,-1]]);function c(){const n=a?.current||a;if(n){const{left:R,top:w,right:z,bottom:g}=n.getBoundingClientRect();O([[R,z],[w,g]])}h(!0)}function P(){h(!1)}function m(){f?P():c()}function I(n){n.preventDefault()}return{open:f,x:b[0],y:b[1],handleClick:m,handleMousedown:I,handleClose:P}}export{Ee as L,Y as M,Me as a,ve as b,Se as u};
