import{e as g,a as pe,b as Ae,d as Be,f as Le,k as De,u as We,r as t,c as q,_ as Q,O as me,P as e,a5 as ge,b0 as he,aN as be,v as ce,b1 as He,o as Ve,a4 as qe,b2 as ze,n as ee,$ as ae,a2 as Ke,X as je,a1 as Xe,an as Ye,t as Ge,g as ie}from"./iframe-BBf3bqTv.js";import{b as Ue,a as Je}from"./useAttachedMenu-tCJ9pwqm.js";import{m as te}from"./mergeRefs-BZpmU3mx.js";import{c as we}from"./bucket-13-h41i3c0G.js";import{s as Qe,b as Ze,w as et,a as tt}from"./wrapFocus-DaSELL9x.js";import{u as ot}from"./useOutsideClick-DliSUker.js";const fe="md",ve=g.forwardRef(({autoAlign:r=!1,children:l,className:O,label:d="Options",renderIcon:w=we,size:a=fe,menuAlignment:s="bottom-start",tooltipAlignment:T,menuTarget:P,...h},M)=>{const f=pe("enable-v12-dynamic-floating-styles")||r,{refs:v,floatingStyles:c,placement:N,middlewareData:p}=Ae(f?{placement:s,strategy:"fixed",middleware:[r&&Le({fallbackPlacements:s.includes("bottom")?["bottom-start","bottom-end","top-start","top-end"]:["top-start","top-end","bottom-start","bottom-end"]})],whileElementsMounted:Be}:{}),y=De("overflowmenu"),u=We(),m=t.useRef(null),{open:E,x:L,y:F,handleClick:D,handleMousedown:z,handleClose:W}=Ue(m);t.useEffect(()=>{f&&Object.keys(c).forEach(R=>{v.floating.current&&(v.floating.current.style[R]=c[R])})},[c,f,v.floating,E,N,p]);function b(){m.current&&D()}const i=q(O,`${u}--overflow-menu__container`,{[`${u}--autoalign`]:f}),x=q(`${u}--overflow-menu__${s}`),n=q(`${u}--overflow-menu`,{[`${u}--overflow-menu--open`]:E},a!==fe&&`${u}--overflow-menu--${a}`),C=te(m,v.setReference);return g.createElement("div",Q({},h,{className:i,"aria-owns":E?y:void 0,ref:M}),g.createElement(me,{"aria-controls":E?y:void 0,"aria-haspopup":!0,"aria-expanded":E,className:n,onClick:b,onMouseDown:z,ref:C,label:d,align:T,kind:"ghost"},g.createElement(w,{className:`${u}--overflow-menu__icon`})),g.createElement(Je,{containerRef:m,ref:v.setFloating,menuAlignment:s,className:x,id:y,size:a,legacyAutoalign:!f,open:E,onClose:W,x:L,y:F,label:d,target:P},l))});ve.propTypes={autoAlign:e.bool,children:e.node,className:e.string,label:e.string,menuAlignment:e.oneOf(["top-start","top-end","bottom-start","bottom-end"]),renderIcon:e.oneOfType([e.func,e.object]),size:e.oneOf(["xs","sm","md","lg"]),tooltipAlignment:ge(e.oneOf(["top","top-left","top-right","bottom","bottom-left","bottom-right","left","left-bottom","left-top","right","right-bottom","right-top","top-start","top-end","bottom-start","bottom-end","left-end","left-start","right-end","right-start"]),["top","top-start","top-end","bottom","bottom-start","bottom-end","left","left-start","left-end","right","right-start","right-end"],he),menuTarget:e.instanceOf(typeof Element<"u"?Element:Object)};const ue=globalThis,nt=(()=>{const r=[];let l=!1;const O=()=>{r.forEach(a=>{a()}),l=!1},d=()=>{l||(l=!0,ue.requestAnimationFrame(O))},w=a=>{r.indexOf(a)<0&&r.push(a)};return{add:a=>(r.length||ue.addEventListener("resize",d),w(a),{remove:()=>{const s=r.indexOf(a);s>=0&&r.splice(s,1)}})}})(),st="left",oe="top",rt="right",G="bottom",lt=({menuSize:r,refPosition:l,offset:O,direction:d,scrollX:w,scrollY:a,container:s})=>{const{left:T=0,top:P=0,right:h=0,bottom:M=0}=l,f=s.position!=="static"?0:w,v=s.position!=="static"?0:a,c={top:s.position!=="static"?s.rect.top:0,left:s.position!=="static"?s.rect.left:0},{width:N,height:p}=r,{top:y=0,left:u=0}=O,m=(T+h)/2,E=(P+M)/2;return{[st]:()=>({left:T-N+f-u-c.left,top:E-p/2+v+y-9-c.top}),[oe]:()=>({left:m-N/2+f+u-c.left,top:P-p+v-y-c.top}),[rt]:()=>({left:h+f+u-c.left,top:E-p/2+v+y+3-c.top}),[G]:()=>({left:m-N/2+f+u-c.left,top:M+v+y-c.top})}[d]()},ct=({children:r,flipped:l,focusTrap:O,menuDirection:d=G,menuOffset:w={top:0,left:0},menuRef:a,onPlace:s,selectorPrimaryFocus:T,styles:P,target:h=()=>document.body,triggerRef:M,updateOrientation:f})=>{const v=t.useContext(be),[c,N]=t.useState(void 0),p=t.useRef(null),y=t.useRef(null),u=t.useRef(null),m=t.useRef(!1),E=t.useCallback(n=>{const C=p.current;if(!C)return;const R=M.current,$=C.getBoundingClientRect(),_=R?R.getBoundingClientRect():void 0,K=typeof w=="function"?w(C,d,R,l):w,k=globalThis.scrollX??0,j=globalThis.scrollY??0;if(f&&f({menuSize:$,refPosition:_,direction:d,offset:K,scrollX:k,scrollY:j,container:{rect:h().getBoundingClientRect(),position:getComputedStyle(h()).position}}),$.width>0&&$.height>0||!K){const H=lt({menuSize:$,refPosition:_??{left:0,top:0,right:0,bottom:0},offset:K,direction:d,scrollX:k,scrollY:j,container:{rect:h().getBoundingClientRect(),position:getComputedStyle(h()).position}});if((!c||c.left!==H.left||c.top!==H.top)&&N(H),!n){const V=C.getBoundingClientRect();(V.width!==$.width||V.height!==$.height)&&E(!0)}}},[M,w,d,l,h,f,c]),L=n=>{const C=T?n.querySelector(T):null,R=n.querySelector(Qe),$=n.querySelector(Ze);(C||R||$||n).focus()},F=n=>{p.current=n,m.current=!!n,a&&a(n),n&&E()};t.useEffect(()=>{m.current&&c&&p.current&&(p.current.contains(document.activeElement)||L(p.current),typeof s=="function"&&s(p.current),m.current=!1)},[c,s]),t.useEffect(()=>{const n=nt.add(()=>{E()});return()=>{n.remove()}},[M,w,d,l,h,f]),t.useEffect(()=>{E()},[w,d,l,M,h,f]);const D=()=>{const n=c,C=n?{left:`${n.left}px`,top:`${n.top}px`,right:"auto"}:{visibility:"hidden",top:"0px"},R=r;return t.cloneElement(R,{ref:F,style:{...P,...C,position:"absolute",opacity:1}})},z=n=>{const{target:C,relatedTarget:R}=n;p.current&&y.current&&u.current&&C instanceof HTMLElement&&R instanceof HTMLElement&&tt({bodyNode:p.current,startTrapNode:y.current,endTrapNode:u.current,currentActiveNode:R,oldActiveNode:C,prefix:v})},W=n=>{Ve(n,qe)&&p.current&&n.target instanceof HTMLElement&&et({containerNode:p.current,currentActiveNode:n.target,event:n})},b=ce("enable-experimental-focus-wrap-without-sentinels"),i=ce("enable-focus-wrap-without-sentinels"),x=b||i;if(typeof document<"u"){const n=h?h():document.body;return He.createPortal(g.createElement("div",{onBlur:O&&!x?z:void 0,onKeyDown:x?W:void 0},!x&&g.createElement("span",{ref:y,tabIndex:0,role:"link",className:`${v}--visually-hidden`},"Focus sentinel"),D(),!x&&g.createElement("span",{ref:u,tabIndex:0,role:"link",className:`${v}--visually-hidden`},"Focus sentinel")),n)}return null},at=ze(),it=(r,...l)=>(r.addEventListener(...l),{release(){return r.removeEventListener(...l),null}}),ft={[oe]:"bottom",[G]:"top"},de=(r,l,O,d)=>{const w=ft[l],{offsetWidth:a,offsetHeight:s}=r;switch(w){case"top":case"bottom":{const T=O?O.offsetWidth:0;return{left:(d?-1:1)*(a/2-T/2),top:0}}default:return{left:0,top:0}}},ne=t.forwardRef(({align:r,["aria-label"]:l=null,ariaLabel:O,children:d,className:w,direction:a=G,flipped:s=!1,focusTrap:T=!0,iconClass:P,iconDescription:h="Options",id:M,light:f,menuOffset:v=de,menuOffsetFlip:c=de,menuOptionsClass:N,onClick:p=ee,onClose:y=ee,onOpen:u=ee,open:m,renderIcon:E=we,selectorPrimaryFocus:L="[data-floating-menu-primary-focus]",size:F="md",innerRef:D,...z},W)=>{const b=t.useContext(be),[i,x]=t.useState(m??!1),[n,C]=t.useState(!1),[R,$]=t.useState(!1),_=t.useRef(null),K=t.useRef(at()),k=t.useRef(null),j=t.useRef({}),H=t.useRef(m),V=t.useRef(i),A=t.useRef(null),se=t.useRef(null);t.useEffect(()=>{H.current!==m&&(x(!!m),H.current=m)},[m]),t.useEffect(()=>{A.current&&$(!0)},[]),t.useEffect(()=>{i&&!V.current?u():!i&&V.current&&y(),V.current=i},[i,y,u]),ot(se,({target:o})=>{i&&(!k.current||o instanceof Node&&!k.current.contains(o))&&X()});const U=t.useCallback(()=>{A.current&&A.current.focus()},[]),X=t.useCallback(o=>{x(!1),o&&o()},[]),re=t.useCallback(()=>{const o=n,I=i;X(()=>{I&&!o&&U()})},[n,i,X,U]),ye=t.useCallback(()=>{const o=i;X(()=>{o&&U()})},[i,X,U]),Ce=o=>{C(!0),(!k.current||!k.current.contains(o.target))&&(x(I=>!I),p(o))},Re=o=>{i&&ae(o,[Ke,je,Xe,Ye])&&o.preventDefault(),ae(o,[Ge])&&(ye(),o.stopPropagation())},Oe=({currentIndex:o=0,direction:I})=>{const S=t.Children.toArray(d).reduce((B,le,_e)=>(g.isValidElement(le)&&!le.props.disabled&&B.push(_e),B),[]),Y=(()=>{const B=S.indexOf(o)+I;switch(B){case-1:return S.length-1;case S.length:return 0;default:return B}})();j.current[S[Y]]?.focus()},Te=o=>{o||(k.current=o),!o&&_.current&&(_.current=_.current.release())},Me=o=>{if(!o)return;k.current=o;const I="onfocusin"in window,S=I?"focusin":"focus";_.current=it(o.ownerDocument,S,Y=>{const J=Y.target,B=A.current;typeof J.matches=="function"&&!o.contains(J)&&B&&!J.matches(`.${b}--overflow-menu:first-child, .${b}--overflow-menu-options:first-child`)&&re()},!I)},Ie=()=>{const o=A.current;return o instanceof Element&&o.closest("[data-floating-menu-container]")||document.body},Z=`overflow-menu-${K.current}__menu-body`,xe=q(w,`${b}--overflow-menu`,{[`${b}--overflow-menu--open`]:i,[`${b}--overflow-menu--light`]:f,[`${b}--overflow-menu--${F}`]:F}),$e=q(N,`${b}--overflow-menu-options`,{[`${b}--overflow-menu--flip`]:s,[`${b}--overflow-menu-options--open`]:i,[`${b}--overflow-menu-options--light`]:f,[`${b}--overflow-menu-options--${F}`]:F}),Ne=q(`${b}--overflow-menu__icon`,P),Fe=t.Children.toArray(d).map((o,I)=>{if(t.isValidElement(o)){const S=o;return t.cloneElement(S,{closeMenu:S.props.closeMenu||re,handleOverflowMenuItemFocus:Oe,ref:Y=>{j.current[I]=Y},index:I})}return null}),ke=g.createElement("ul",{className:$e,tabIndex:-1,role:"menu","aria-label":l||O,onKeyDown:Re,id:Z},Fe),Se=g.createElement(ct,{focusTrap:T,triggerRef:A,menuDirection:a,menuOffset:s?c:v,menuRef:Te,flipped:s,target:Ie,onPlace:Me,selectorPrimaryFocus:L},t.cloneElement(ke,{"data-floating-menu-direction":a})),Pe=D?te(A,D,W):te(A,W);return g.createElement(g.Fragment,null,g.createElement("span",{className:`${b}--overflow-menu__wrapper`,"aria-owns":i?Z:void 0,ref:se},g.createElement(me,Q({},z,{align:r,type:"button","aria-haspopup":!0,"aria-expanded":i,"aria-controls":i?Z:void 0,className:xe,onClick:Ce,id:M,ref:Pe,size:F,label:h,kind:"ghost"}),g.createElement(E,{className:Ne,"aria-label":h})),i&&R&&Se))});ne.propTypes={align:ge(e.oneOf(["top","top-left","top-right","bottom","bottom-left","bottom-right","left","left-bottom","left-top","right","right-bottom","right-top","top-start","top-end","bottom-start","bottom-end","left-end","left-start","right-end","right-start"]),["top","top-start","top-end","bottom","bottom-start","bottom-end","left","left-start","left-end","right","right-start","right-end"],he),"aria-label":e.string,ariaLabel:ie(e.string),children:e.node,className:e.string,direction:e.oneOf([oe,G]),flipped:e.bool,focusTrap:e.bool,iconClass:e.string,iconDescription:e.string,id:e.string,light:ie(e.bool),menuOffset:e.oneOfType([e.shape({top:e.number.isRequired,left:e.number.isRequired}),e.func]),menuOffsetFlip:e.oneOfType([e.shape({top:e.number.isRequired,left:e.number.isRequired}),e.func]),menuOptionsClass:e.string,onClick:e.func,onClose:e.func,onFocus:e.func,onKeyDown:e.func,onOpen:e.func,open:e.bool,renderIcon:e.oneOfType([e.func,e.object]),selectorPrimaryFocus:e.string,size:e.oneOf(["xs","sm","md","lg"])};const Ee=t.forwardRef((r,l)=>pe("enable-v12-overflowmenu")?g.createElement(ve,Q({},r,{ref:l})):g.createElement(ne,Q({},r,{ref:l})));Ee.displayName="OverflowMenu";Ee.propTypes=ne.propTypes;export{Ee as O};
//# sourceMappingURL=index-Kk4BUWQg.js.map
