{"version":3,"file":"StringFormatter-DscWpoWv.js","sources":["../../src/components/StringFormatter/utils/enums.js","../../src/components/StringFormatter/StringFormatter.js"],"sourcesContent":["/**\n * Copyright IBM Corp. 2024\n *\n * This source code is licensed under the Apache-2.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nexport const deprecated_StringFormatterAlignment = {\n  TOP: 'top',\n  TOP_LEFT: 'top-left',\n  TOP_RIGHT: 'top-right',\n  BOTTOM: 'bottom',\n  BOTTOM_LEFT: 'bottom-left',\n  BOTTOM_RIGHT: 'bottom-right',\n  LEFT: 'left',\n  LEFT_BOTTOM: 'left-bottom',\n  LEFT_TOP: 'left-top',\n  RIGHT: 'right',\n  RIGHT_BOTTOM: 'right-bottom',\n  RIGHT_TOP: 'right-top',\n};\n\nexport const StringFormatterAlignment = {\n  TOP: 'top',\n  TOP_START: 'top-start',\n  TOP_END: 'top-end',\n  BOTTOM: 'bottom',\n  BOTTOM_START: 'bottom-start',\n  BOTTOM_END: 'bottom-end',\n  LEFT: 'left',\n  LEFT_END: 'left-end',\n  LEFT_START: 'left-start',\n  RIGHT: 'right',\n  RIGHT_END: 'right-end',\n  RIGHT_START: 'right-start',\n};\n\nexport const propMappingFunction = (deprecatedValue) => {\n  const mapping = {\n    [deprecated_StringFormatterAlignment.TOP_LEFT]:\n      StringFormatterAlignment.TOP_START,\n    [deprecated_StringFormatterAlignment.TOP_RIGHT]:\n      StringFormatterAlignment.TOP_END,\n    [deprecated_StringFormatterAlignment.BOTTOM_LEFT]:\n      StringFormatterAlignment.BOTTOM_START,\n    [deprecated_StringFormatterAlignment.BOTTOM_RIGHT]:\n      StringFormatterAlignment.BOTTOM_END,\n    [deprecated_StringFormatterAlignment.LEFT_BOTTOM]:\n      StringFormatterAlignment.LEFT_END,\n    [deprecated_StringFormatterAlignment.LEFT_TOP]:\n      StringFormatterAlignment.LEFT_START,\n    [deprecated_StringFormatterAlignment.RIGHT_BOTTOM]:\n      StringFormatterAlignment.RIGHT_END,\n    [deprecated_StringFormatterAlignment.RIGHT_START]:\n      StringFormatterAlignment.RIGHT_START,\n  };\n  return mapping[deprecatedValue];\n};\n","/**\n * Copyright IBM Corp. 2024, 2024\n *\n * This source code is licensed under the Apache-2.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React, { useRef, useState } from 'react';\n\nimport PropTypes from 'prop-types';\nimport cx from 'classnames';\n\nimport { getDevtoolsProps } from '../../global/js/utils/devtools';\nimport { pkg } from '../../settings';\n\nimport { DefinitionTooltip } from '@carbon/react';\nimport {\n  StringFormatterAlignment,\n  deprecated_StringFormatterAlignment,\n  propMappingFunction,\n} from './utils/enums';\nimport { allPropTypes } from '../../global/js/utils/props-helper';\nimport { useIsomorphicEffect } from '../../global/js/hooks';\n\nconst blockClass = `${pkg.prefix}--string-formatter`;\nconst componentName = 'StringFormatter';\n\nconst defaults = {\n  autoAlign: false,\n  lines: 1,\n  tooltipDirection: StringFormatterAlignment.BOTTOM_START,\n  truncate: false,\n  width: null,\n};\n\n/**\n * StringFormatter allows for truncating text while displaying a tooltip\n * overlay on hover or focus with the entirety of the provided copy.\n */\nexport let StringFormatter = React.forwardRef(\n  (\n    {\n      className,\n      autoAlign = defaults.autoAlign,\n      lines = defaults.lines,\n      tooltipDirection = defaults.tooltipDirection,\n      truncate = defaults.truncate,\n      width = defaults.width,\n      value,\n      ...rest\n    },\n    ref\n  ) => {\n    const outerRef = useRef(null);\n    const contentRef = useRef(null);\n    const [isTextTruncated, setIsTextTruncated] = useState(false);\n\n    const mergedRefs = (node) => {\n      outerRef.current = node;\n      if (typeof ref === 'function') {\n        ref(node);\n      } else if (ref) {\n        ref.current = node;\n      }\n    };\n\n    useIsomorphicEffect(() => {\n      const checkTruncation = () => {\n        const element = contentRef.current;\n        if (element) {\n          element.style.webkitLineClamp = truncate ? lines : undefined;\n          element.style.maxWidth = width;\n          const buffer = element.clientHeight / (2 * lines);\n          // add a buffer of at least half of line height/clientHeight. to get a stable outcome.\n          const isOverflowing =\n            element.scrollHeight > element.clientHeight + buffer;\n          setIsTextTruncated(isOverflowing);\n        }\n      };\n\n      const resizeObserver = new ResizeObserver(checkTruncation);\n\n      if (outerRef.current) {\n        resizeObserver.observe(outerRef.current);\n        checkTruncation();\n      }\n\n      return () => {\n        resizeObserver.disconnect();\n      };\n    }, [lines, value, width, truncate]);\n\n    const stringFormatterContent = (\n      <span\n        ref={contentRef}\n        className={cx(`${blockClass}--content`, {\n          [`${blockClass}--truncate`]: truncate,\n        })}\n      >\n        {value}\n      </span>\n    );\n\n    return (\n      <span\n        {...rest}\n        className={cx(blockClass, className)}\n        ref={mergedRefs}\n        {...getDevtoolsProps(componentName)}\n      >\n        {truncate && isTextTruncated ? (\n          <DefinitionTooltip\n            className={`${blockClass}__tooltip`}\n            align={tooltipDirection}\n            autoAlign={autoAlign}\n            definition={value}\n            openOnHover={true}\n          >\n            {stringFormatterContent}\n          </DefinitionTooltip>\n        ) : (\n          stringFormatterContent\n        )}\n      </span>\n    );\n  }\n);\n\nStringFormatter = pkg.checkComponentEnabled(StringFormatter, componentName);\n\nStringFormatter.displayName = componentName;\n\nStringFormatter.validateAlignment = () => (props, propName, componentName) => {\n  const prop = props[propName];\n  const deprecatedAlignValues = Object.values(\n    deprecated_StringFormatterAlignment\n  );\n  if (deprecatedAlignValues.includes(prop)) {\n    const mappedNewProp = propMappingFunction(prop);\n    console.warn(\n      `\"${prop}\" is a deprecated value for the \"${propName}\" prop on the \"${componentName}\" component. Use \"${mappedNewProp}\" instead. Allowable values are: ${Object.values(\n        StringFormatterAlignment\n      ).join(', ')}.`\n    );\n  }\n};\n\nStringFormatter.propTypes = {\n  /**\n   * Provide an optional class to be applied to the containing node.\n   */\n  className: PropTypes.string,\n  /** Number of lines to clamp value. */\n  lines: PropTypes.number,\n  /** Specify the direction of the tooltip. Can be either top or bottom. */\n  tooltipDirection: allPropTypes([\n    StringFormatter.validateAlignment(),\n    PropTypes.oneOf(\n      Object.values(deprecated_StringFormatterAlignment),\n      Object.values(StringFormatterAlignment)\n    ),\n  ]),\n  /** Whether or not the value should be truncated. if it exceeds lines. */\n  truncate: PropTypes.bool,\n  /** Value to format. */\n  value: PropTypes.string.isRequired,\n  /** Maximum width of value which should include */\n  width: PropTypes.string,\n};\n"],"names":["deprecated_StringFormatterAlignment","StringFormatterAlignment","propMappingFunction","deprecatedValue","blockClass","pkg","componentName","defaults","StringFormatter","React","className","autoAlign","lines","tooltipDirection","truncate","width","value","rest","ref","outerRef","useRef","contentRef","isTextTruncated","setIsTextTruncated","useState","mergedRefs","node","useIsomorphicEffect","checkTruncation","element","buffer","isOverflowing","resizeObserver","stringFormatterContent","cx","getDevtoolsProps","DefinitionTooltip","props","propName","prop","mappedNewProp","PropTypes","allPropTypes"],"mappings":"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"}