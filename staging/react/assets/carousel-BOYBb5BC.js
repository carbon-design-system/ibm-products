const C=(o,p,r,s)=>{let a=null,c=null,_=0;const $=400;let d=!1,h=null,m=null;const S=i=>{a=i.touches[0].clientX},v=i=>{c=i.touches[0].clientX},g=()=>{if(a!==null&&c!==null){const i=a-c;Math.abs(i)>50&&(i>0?p():r())}a=null,c=null},E=i=>{d=!0,h=i.clientX},w=i=>{d&&(m=i.clientX)},L=()=>{if(d&&h!==null&&m!==null){const i=h-m;Math.abs(i)>50&&(i>0?p():r())}d=!1,h=null,m=null},y=i=>{const x=Date.now();if(Math.abs(i.deltaX)>Math.abs(i.deltaY)&&Math.abs(i.deltaX)>20){if(i.preventDefault(),x-_<$)return;i.deltaX>0?p():r(),_=x}};s&&(o.removeEventListener("touchstart",S),o.removeEventListener("touchmove",v),o.removeEventListener("touchend",g),o.removeEventListener("mousedown",E),o.removeEventListener("mousemove",w),o.removeEventListener("mouseup",L),o.removeEventListener("wheel",y)),o.addEventListener("touchstart",S),o.addEventListener("touchmove",v),o.addEventListener("touchend",g),o.addEventListener("mousedown",E),o.addEventListener("mousemove",w),o.addEventListener("mouseup",L),o.addEventListener("wheel",y)},U=(o,p)=>{const r="carousel";let s=[0],f=[0];const a={},c=4,{onViewChangeStart:_,onViewChangeEnd:$,excludeSwipeSupport:d}=p||{},h=(t,e)=>{a[t]=e},m=(t,e)=>{if(t.querySelector(`.${e}`))return;const n=document.createElement("div");for(n.classList.add(`${e}`);t.firstChild;)n.appendChild(t.firstChild);t.appendChild(n)},S=()=>s.map(t=>({id:t,elem:a[t]})),v=()=>{const t=Object.keys(a).length,e=a[t-1],n=S();return{currentIndex:s[0],lastIndex:parseInt(e?.dataset.index||s[0].toString(),10),totalViews:t,historyStack:n}},g=()=>{f=[...s];const t=v();_?.(t)},E=t=>{if(!t)return;const e=t.dataset.index;if(e&&s[0]===parseInt(e,10)){const n=v();$?.(n)}},w=t=>{const n=Object.keys(a).length-1;return Math.max(0,Math.min(t,n))},L=t=>{const e=w(t);s[0]!==e&&(g(),s=[e,...s],H(!1))},y=t=>{E(t)},i=(t,e,n,l,b)=>{t.classList.add(`${r}__view`),t.classList.toggle(`${r}__view-in-stack`,e&&!n),t.classList.toggle(`${r}__view-active`,e&&n),b&&!l&&t.classList.add(`${r}__view-recycle-in`),!b&&l&&t.classList.add(`${r}__view-recycle-out`)},x=t=>{t.classList.remove(`${r}__view-recycle-in`,`${r}__view-recycle-out`)},X=t=>t*parseFloat(getComputedStyle(document.documentElement).fontSize),A=t=>{const e=X(c);if(o.clientHeight<e){t<e&&(t=e);const l=o.querySelector(`.${r}__itemsWrapper`);l&&(l.style.blockSize=`${t}px`)}},H=t=>{let e=0;Array.from(M).forEach((n,l)=>{const b=s.findIndex(u=>u===l),V=f.filter(u=>u===l).length,j=f.length>s.length&&f[0]===l&&V>0,O=f.length<s.length&&s[0]===l&&V>0,F=b>-1,N=l===s[0];if(i(n,F,N,j,O),t){h(l,n),setTimeout(()=>{(!e||n.offsetHeight<e&&e>X(c))&&(e=n.offsetHeight),n.style.position="absolute",A(e)});const u=P=>{x(n),P.target===a[s[0]]&&y(n)};n._carouselListener=u,n.addEventListener("animationend",u),n.addEventListener("transitionend",u),n.setAttribute("data-index",l.toString())}}),t&&E(Array.from(M)[0])},k=()=>{const t=s[0]+1;L(t)},D=()=>{s.length-1>=1&&(g(),s=s.slice(1),H(!1))},T=t=>{L(t)},I=()=>({index:s[0],item:a[s[0]]}),R=()=>{s=[0],H(!1)},W=()=>{Object.values(a).forEach(t=>{t&&t._carouselListener&&(t.removeEventListener("animationend",t._carouselListener),t.removeEventListener("transitionend",t._carouselListener))}),d||C(o,k,D,!0)},q=t=>{const e=t.querySelector("slot");return e?e.assignedElements({flatten:!0}):Array.from(t.children)};m(o,`${r}__itemsWrapper`);const z=o.querySelector(`.${r}__itemsWrapper`),M=q(z);return o.classList.add(`${r}__view-stack`),H(!0),d||C(o,k,D,!1),{next:k,prev:D,reset:R,goToIndex:T,getActiveItem:I,destroyEvents:W,allViews:a}};export{U as i};
