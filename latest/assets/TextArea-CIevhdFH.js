import{b as we,d as be,k as _e,n as $e,c as _,_ as Te,P as t,g as G}from"./index-Cd8snwnz.js";import{e as r,r as x}from"./index-BOZkNhcz.js";import{F as ye}from"./FormContext-qEw5DNxz.js";import{u as ve}from"./useAnnouncer-Dwt0jqXi.js";import{n as I}from"./settings-DqneCnpo.js";import{T}from"./Text-Rb3iZwUo.js";import{W as H,a as J}from"./bucket-18-D95sPjw6.js";const Q=r.forwardRef((U,X)=>{var j;const{className:Y,decorator:y,disabled:u=!1,id:N,labelText:W,hideLabel:Z,onChange:D=I,onClick:O=I,onKeyDown:F=I,invalid:s=!1,invalidText:ee="",helperText:v="",light:te,placeholder:ae="",enableCounter:$=!1,maxCount:n=void 0,counterMode:o="character",warn:m=!1,warnText:re="",rows:ne=4,slug:C,...f}=U,e=we(),{isFluid:i}=x.useContext(ye),{defaultValue:R,value:P}=f,le=be(),c=x.useRef(null),se=_e([X,c]);function V(){var p,b;const l=(R||P||((p=c.current)==null?void 0:p.value)||"").toString();return o==="character"?l.length:((b=l.match(/\w+/g))==null?void 0:b.length)||0}const[E,h]=x.useState(V());x.useEffect(()=>{h(V())},[P,R,o]),$e(()=>{f.cols&&c.current?(c.current.style.width="",c.current.style.resize="none"):c.current&&(c.current.style.width="100%")},[f.cols]);const k={id:N,onKeyDown:a=>{if(!u&&$&&o==="word"){const l=a.which;(n&&E>=n&&l===32||n&&E>=n&&l===13)&&a.preventDefault()}!u&&F&&F(a)},onPaste:a=>{if(!u&&o==="word"&&$&&typeof n<"u"&&c.current!==null){const l=c.current.value.match(/\w+/g)||[],p=a.clipboardData.getData("Text").match(/\w+/g)||[];if(l.length+p.length>n){a.preventDefault();const d=l.concat(p).slice(0,n);setTimeout(()=>{h(n)},0),c.current.value=d.join(" ")}}},onChange:a=>{var l,p,b;if(!u){if(o=="character")(l=a==null?void 0:a.persist)==null||l.call(a),setTimeout(()=>{var d,B;h((B=(d=a.target)==null?void 0:d.value)==null?void 0:B.length)},0);else if(o=="word"){if(!a.target.value){setTimeout(()=>{h(0)},0);return}if($&&typeof n<"u"&&c.current!==null){const d=(b=(p=a.target)==null?void 0:p.value)==null?void 0:b.match(/\w+/g);d&&d.length<=n?(c.current.removeAttribute("maxLength"),setTimeout(()=>{h(d.length)},0)):d&&d.length>n&&setTimeout(()=>{h(d.length)},0)}}D&&D(a)}},onClick:a=>{!u&&O&&O(a)}},oe=_(`${e}--form-item`,Y),ie=_(`${e}--text-area__wrapper`,{[`${e}--text-area__wrapper--cols`]:f.cols,[`${e}--text-area__wrapper--readonly`]:f.readOnly,[`${e}--text-area__wrapper--warn`]:m,[`${e}--text-area__wrapper--slug`]:C,[`${e}--text-area__wrapper--decorator`]:y}),ce=_(`${e}--label`,{[`${e}--visually-hidden`]:Z&&!i,[`${e}--label--disabled`]:u}),de=_(`${e}--text-area`,{[`${e}--text-area--light`]:te,[`${e}--text-area--invalid`]:s,[`${e}--text-area--warn`]:m}),ue=_(`${e}--label`,{[`${e}--label--disabled`]:u}),me=_(`${e}--form__helper-text`,{[`${e}--form__helper-text--disabled`]:u}),fe=W?r.createElement(T,{as:"label",htmlFor:N,className:ce},W):null,pe=$&&n&&(o==="character"||o==="word")?r.createElement(T,{as:"div",className:ue},`${E}/${n}`):null,L=v?`text-area-helper-text-${le}`:void 0,xe=v?r.createElement(T,{as:"div",id:L,className:me},v):null,q=N+"-error-msg",z=s?r.createElement(T,{as:"div",role:"alert",className:`${e}--form-requirement`,id:q},ee,i&&r.createElement(H,{className:`${e}--text-area__invalid-icon`})):null,K=m?r.createElement(T,{as:"div",role:"alert",className:`${e}--form-requirement`},re,i&&r.createElement(J,{className:`${e}--text-area__invalid-icon ${e}--text-area__invalid-icon--warning`})):null;let A;s?A=q:!s&&!m&&!i&&v&&(A=L),$&&o=="character"&&(k.maxLength=n);const M=x.useRef(null),[S,he]=x.useState(""),g=ve(E,n,o==="word"?"words":void 0);x.useEffect(()=>{if(g&&g!==S){const a=M.current;if(a){a.textContent="";const l=setTimeout(()=>{a&&(a.textContent=g,he(g))},o==="word"?2e3:1e3);return()=>{l&&clearTimeout(l)}}}},[g,S,o]);const ge=r.createElement("textarea",Te({},f,k,{placeholder:ae,"aria-readonly":!!f.readOnly,className:de,"aria-invalid":s,"aria-describedby":A,disabled:u,rows:ne,readOnly:f.readOnly,ref:se}));let w=r.isValidElement(C??y)?C??y:null;return w&&((j=w.type)==null?void 0:j.displayName)==="AILabel"&&(w=r.cloneElement(w,{size:"mini"})),r.createElement("div",{className:oe},r.createElement("div",{className:`${e}--text-area__label-wrapper`},fe,pe),r.createElement("div",{className:ie,"data-invalid":s||null},s&&!i&&r.createElement(H,{className:`${e}--text-area__invalid-icon`}),m&&!s&&!i&&r.createElement(J,{className:`${e}--text-area__invalid-icon ${e}--text-area__invalid-icon--warning`}),ge,C?w:y?r.createElement("div",{className:`${e}--text-area__inner-wrapper--decorator`},w):"",r.createElement("span",{className:`${e}--text-area__counter-alert`,role:"alert","aria-live":"assertive","aria-atomic":"true",ref:M},g),i&&r.createElement("hr",{className:`${e}--text-area__divider`}),i&&s?z:null,i&&m&&!s?K:null),!s&&!m&&!i?xe:null,s&&!i?z:null,m&&!s&&!i?K:null)});Q.displayName="TextArea";Q.propTypes={className:t.string,cols:t.number,counterMode:t.oneOf(["character","word"]),decorator:t.node,defaultValue:t.oneOfType([t.string,t.number]),disabled:t.bool,enableCounter:t.bool,helperText:t.node,hideLabel:t.bool,id:t.string,invalid:t.bool,invalidText:t.node,labelText:t.node.isRequired,light:G(t.bool),maxCount:t.number,onChange:t.func,onClick:t.func,onKeyDown:t.func,placeholder:t.string,readOnly:t.bool,rows:t.number,slug:G(t.node),value:t.oneOfType([t.string,t.number]),warn:t.bool,warnText:t.node};export{Q as T};
