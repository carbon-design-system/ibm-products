/*
* Copyright IBM Corp. 2025, 2025
*
* This source code is licensed under the Apache-2.0 license found in the
* LICENSE file in the root directory of this source tree.
*/

// $css--plex: true !default;

@use 'sass:map';
@use '@carbon/styles/scss/utilities' as *;
@use '@carbon/themes' as *;
@use '@carbon/styles/scss/theme' as *;
@use '@carbon/motion';

$prefix: 'c4p';
$carbon-prefix: 'cds';
$block-class: #{$prefix}--truncated-string;

// Common reset button style
%reset-button {
  border: none;
  cursor: pointer;
  font: inherit;
  line-height: inherit;
}

// Mixin for directional gradients
@mixin gradient-bg($direction, $color) {
  background: linear-gradient(
    $direction,
    rgba(255, 255, 255, 0) 0%,
    $color 90%
  );
}

:host(#{$prefix}-truncated-string) {
  display: block;
  inline-size: 100%;

  .#{$block-class}_transition {
    @media (prefers-reduced-motion: no-preference) {
      transition: max-height motion.$duration-moderate-01 ease-out;
    }
  }

  .#{$block-class}_content {
    display: -webkit-box;
    overflow: hidden;
    -webkit-box-orient: vertical;
    -webkit-line-clamp: var(--line-clamp, 0);
    text-overflow: clip;
    white-space: normal;
  }

  #{$carbon-prefix}-tooltip {
    display: inline-flex;
  }

  button:focus,
  .#{$block-class}_expand:focus,
  .#{$block-class}_collapse:focus {
    @include focus-outline('outline');
  }
}

.#{$block-class}_expand,
.#{$block-class}_collapse {
  @extend %reset-button;

  padding: 0;
  color: $link-primary;
}

.#{$block-class}_expand {
  position: absolute;
  background-color: $background;
  inset-block-end: 0;
  inset-inline-end: 0;

  &.#{$block-class}_layered {
    background-color: $layer;
  }

  &::before {
    position: absolute;
    block-size: 100%;
    content: '';
    inline-size: 1em;
    inset-block-start: 0;
    inset-inline-start: -1em;
  }

  // Gradient LTR
  &:dir(ltr)::before {
    @include gradient-bg(90deg, $background);
  }

  &.#{$block-class}_layered:dir(ltr)::before {
    @include gradient-bg(90deg, $layer);
  }

  // Gradient RTL
  &:dir(rtl)::before {
    @include gradient-bg(270deg, $background);
  }

  &.#{$block-class}_layered:dir(rtl)::before {
    @include gradient-bg(270deg, $layer);
  }
}

.#{$block-class}_collapse {
  background-color: transparent;
}
