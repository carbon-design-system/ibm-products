import{r as o,e as k,u as le,k as fe,c as de,_ as he,a5 as me,a1 as pe,n as $,t as xe,am as ye,a4 as be,a3 as we,P as t,i as Ie}from"./iframe-DKsKIeO_.js";const Re={isRoot:!0,hasIcons:!1,hasSelectableItems:!1,size:null,items:[],requestCloseRoot:()=>{}};function ze(l,m){switch(m.type){case"enableIcons":return{...l,hasIcons:!0};case"enableSelectableItems":return{...l,hasSelectableItems:!0};case"registerItem":{const p=m.payload,a=l.items.filter(c=>c.ref.current),I=p.ref.current?.nextElementSibling,n=a.findIndex(c=>c.ref.current===I);return a.splice(n<0?a.length:n,0,p),{...l,items:a}}}}const Y=o.createContext({state:Re,dispatch:l=>{}}),Ce=k.createContext({direction:"ltr"});function Ee(){return o.useContext(Ce)}const D=8,Se=o.forwardRef(function({children:m,className:p,containerRef:a,label:I,menuAlignment:n,onClose:c,onOpen:C,open:u,size:x="sm",legacyAutoalign:R="true",target:E=me&&document.body,x:O=0,y:P=0,...N},Z){const h=le(),B=o.useRef(null),S=o.useContext(Y),y=S.state.isRoot,ee=y?x:S.state.size,[_,K]=o.useReducer(ze,{...S.state,isRoot:!1,size:x,requestCloseRoot:y?T:S.state.requestCloseRoot}),g=o.useMemo(()=>({state:_,dispatch:K}),[_,K]),r=o.useRef(null),te=fe([Z,r]),[U,W]=o.useState([-1,-1]),v=g.state.items.filter(e=>!e.disabled&&e.ref.current);let b;if(a?.current){const{width:e}=a.current.getBoundingClientRect();b=e}const{direction:ne}=Ee();function se(){B.current&&B.current.focus()}function oe(){if(r.current){if(B.current=document.activeElement,R){const e=ae();(document?.dir==="rtl"||ne==="rtl")&&!N?.id?.includes("MenuButton")?(r.current.style.insetInlineStart="initial",r.current.style.insetInlineEnd=`${e[0]}px`):(r.current.style.insetInlineStart=`${e[0]}px`,r.current.style.insetInlineEnd="initial"),r.current.style.insetBlockStart=`${e[1]}px`,W(e)}r.current.focus(),C&&C()}}function T(){se(),c&&c()}function re(e){e.stopPropagation(),($(e,xe)||!y&&$(e,ye))&&c?T():j(e)}function j(e){const i=v?.filter(f=>f?.ref?.current);if(!i?.length)return;const z=v.findIndex(f=>f.ref?.current?.contains(document.activeElement));let s=z;z===-1?s=0:e&&($(e,be)&&(s=s-1),$(e,we)&&(s=s+1)),s<0&&(s=i.length-1),s>=i.length&&(s=0),s!==z&&(i[s]?.ref?.current?.focus(),e?.preventDefault())}function ce(e){u&&c&&y&&!r.current?.contains(e.relatedTarget)&&T()}function H(e,i){if(!r.current)return;const{width:z,height:s}=r.current.getBoundingClientRect(),f=y?"vertical":"horizontal",d={x:{max:window.innerWidth,size:z,anchor:f==="horizontal"?e[1]:e[0],reversedAnchor:f==="horizontal"?e[0]:e[1],offset:0},y:{max:window.innerHeight,size:s,anchor:f==="horizontal"?e[0]:e[1],reversedAnchor:f==="horizontal"?e[1]:e[0],offset:y?0:4}};if(b&&b<d.x.size&&(n==="bottom"||n==="top")&&(d.x.size=b),b&&(n==="bottom-end"||n==="top-end")&&d.x.anchor>=87&&b<d.x.size){const L=d.x.anchor+d.x.reversedAnchor;d.x.anchor=d.x.anchor+L}const{max:G,size:M,anchor:q,reversedAnchor:J,offset:A}=d[i],w=[G-D-M-q>=0?q-A:!1,J-M>=0?J-M+A:!1,G-D-M],Q=n==="top"||n==="top-end"||n==="top-start";typeof w[0]=="number"&&Q&&w[0]>=0&&!w[1]&&i==="y"?r.current.style.transform="translate(0)":Q&&!w[0]&&i==="y"&&(w[0]=q-A);const X=w.find(L=>L!==!1);return X>=D?X:D}function ie(e){return e!=null}function V(e){if(Array.isArray(e)){const i=e.filter(ie);return i.length===2?i:void 0}else return[e,e]}function ae(){const e={x:V(O),y:V(P)};return!e.x||!e.y?[-1,-1]:[H(e.x,"x")??-1,H(e.y,"y")??-1]}o.useEffect(()=>{if(u){const e=requestAnimationFrame(()=>{v.length>0&&j()});return()=>cancelAnimationFrame(e)}},[u,v]),o.useEffect(()=>{u?oe():W([-1,-1])},[u]);const ue=de(p,`${h}--menu`,`${h}--menu--${ee}`,{[`${h}--menu--box-shadow-top`]:n&&n.slice(0,3)==="top",[`${h}--menu--open`]:u,[`${h}--menu--shown`]:u&&!R||U[0]>=0&&U[1]>=0,[`${h}--menu--with-icons`]:g.state.hasIcons,[`${h}--menu--with-selectable-items`]:g.state.hasSelectableItems,[`${h}--autoalign`]:!R}),F=k.createElement(Y.Provider,{value:g},k.createElement("ul",he({},N,{className:ue,role:"menu",ref:te,"aria-label":I,tabIndex:-1,onKeyDown:re,onBlur:ce}),m));return E&&y?u&&pe.createPortal(F,E)||null:F});Se.propTypes={children:t.node,className:t.string,label:t.string,menuAlignment:t.string,mode:Ie(t.oneOf(["full","basic"])),onClose:t.func,onOpen:t.func,open:t.bool,size:t.oneOf(["xs","sm","md","lg"]),target:t.object,x:t.oneOfType([t.number,t.arrayOf(t.number)]),y:t.oneOfType([t.number,t.arrayOf(t.number)])};function ve(l){const[m,p]=o.useState(!1),[a,I]=o.useState([[-1,-1],[-1,-1]]);function n(){const x=l?.current||l;if(x){const{left:R,top:E,right:O,bottom:P}=x.getBoundingClientRect();I([[R,O],[E,P]])}p(!0)}function c(){p(!1)}function C(){m?c():n()}function u(x){x.preventDefault()}return{open:m,x:a[0],y:a[1],handleClick:C,handleMousedown:u,handleClose:c}}export{Ce as L,Y as M,Se as a,ve as b,Ee as u};
