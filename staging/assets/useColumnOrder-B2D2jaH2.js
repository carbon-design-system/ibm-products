import{e as r,r as g}from"./index-DzvNrmz8.js";import"./feature-flags-Cd4xSQCq.js";import{d as F,P as e,O as P,bc as re}from"./index-5As4T26e.js";import{C as ee}from"./Checkbox-CJAiUxDY.js";import{p as w,B as ne}from"./settings-DbzZchXt.js";import{u as ie,C as ae,a as Y,P as oe,K as le,b as ce,D as de,r as ue,e as me,c as pe,S as ge,v as fe}from"./modifiers.esm-DwdYzIzz.js";import{aZ as be}from"./bucket-5-CQjaVkio.js";import{aB as ye}from"./bucket-10-BLMdRzi0.js";import{g as O}from"./getNodeTextContent-C8IeKkUQ.js";import{u as Ce}from"./uuidv4-BN2rGLQG.js";import{S as he}from"./Search-BqckCrhT.js";import{T as Te}from"./TearsheetNarrow-CAfaHRdw.js";import{l as qe}from"./useDatagrid-BqCGh2fF.js";import{r as _e}from"./index.esm-D7_1_ES8.js";const K=s=>typeof s.isVisible=="boolean"?s.isVisible:!0,S=`${w.prefix}--datagrid`,U=({id:s,children:a,classList:l,disabled:o,ariaLabel:f,isSticky:d,selected:C})=>{const{attributes:b,isDragging:v,listeners:c,setNodeRef:h,transform:E,transition:I}=ie({disabled:o,id:s}),R=r.createElement(r.Fragment,null,r.createElement("div",{className:F({disabled:o},`${S}__draggable-handleStyle`)},d?r.createElement(ye,{size:16}):r.createElement(be,{size:16})),a),k={transform:o?void 0:ae.Transform.toString(E),transition:I};return r.createElement("li",{className:F(l,`${S}__draggable-handleHolder`,{[`${S}__draggable-handleHolder--selected`]:C,[`${S}__draggable-handleHolder--sticky`]:d,[`${S}__draggable-handleHolder--dragging`]:v}),id:s,ref:h,style:k,...b,...c,"aria-disabled":void 0,"aria-selected":C,role:"option"},r.createElement("span",{className:`${S}__shared-ui--assistive-text`},f),r.createElement("div",{className:F({[`${S}__draggable-handleStyle`]:!o},[`${S}__draggable-handleHolder-droppable`])},R))};U.propTypes={ariaLabel:e.string.isRequired,children:e.element.isRequired,classList:e.string,disabled:e.bool,id:e.string.isRequired,isSticky:e.bool,selected:e.bool};U.__docgenInfo={description:"",methods:[],displayName:"DraggableElement",props:{ariaLabel:{required:!0,tsType:{name:"string"},description:"",type:{name:"string"}},children:{required:!0,tsType:{name:"ReactNode"},description:"",type:{name:"element"}},classList:{required:!1,tsType:{name:"string"},description:"",type:{name:"string"}},disabled:{required:!1,tsType:{name:"boolean"},description:"",type:{name:"bool"}},id:{required:!0,tsType:{name:"string"},description:"",type:{name:"string"}},isSticky:{required:!1,tsType:{name:"boolean"},description:"",type:{name:"bool"}},selected:{required:!1,tsType:{name:"boolean"},description:"",type:{name:"bool"}}},composes:["PropsWithChildren"]};const V=`${w.prefix}--datagrid`,N=(s,a)=>s&&a&&s.id===a.id,M=({columns:s,filterString:a,id:l,moveElement:o,onSelectColumn:f,setAriaRegionText:d})=>{const C=`${V}__draggable-item`,b=s.filter(t=>O(t.Header).trim().length!==0).filter(Boolean).filter(t=>!t.isAction).filter(t=>t.id!=="spacer").filter(t=>a.length===0||O(t.Header).toLowerCase().includes(a)),c=(()=>{const t=[...b];return t.forEach(i=>{i.sticky&&(i.disabled=!0)}),t})(),h=t=>{var j;const{active:i,over:u}=t,n=c.filter(_=>_.id===u.id);if(n!=null&&n.length&&((j=n[0])!=null&&j.disabled))return;const m=c.findIndex(_=>N(_,i)),z=c.findIndex(_=>N(_,u)),T=O(c[m].Header);d(`${T} dropped. New position ${z+1} of ${c.length}.`);const q=s.findIndex(_=>N(_,i)),A=s.findIndex(_=>N(_,u));o(q,A)},E=t=>{const{active:i}=t,u=c.findIndex(m=>N(m,i)),n=O(c[u].Header);d(`${n} grabbed. Current position ${u+1} of ${c.length}.`)},I=t=>{const{active:i,over:u}=t,n=c.findIndex(T=>N(T,i)),m=c.findIndex(T=>N(T,u)),z=O(c[n].Header);d(`${z} grabbed. Original position ${n+1}, new position ${m+1} of ${c.length}.`)},R=Y(oe,{activationConstraint:{distance:4}}),k=Y(le,{coordinateGetter:(t,i)=>{const{currentCoordinates:u}=i;let n=t.target;for(;n&&!n.classList.contains(C);)n=n.parentNode;const m=n.offsetHeight;switch(t.code){case"ArrowRight":case"ArrowLeft":return u;case"ArrowUp":return{...u,y:u.y-m};case"ArrowDown":return{...u,y:u.y+m}}}}),L=ce(R,k),H=(t,i)=>{if(t.code==="Space")return f(i,!K(i)),t.preventDefault(),t.stopPropagation(),!1};return r.createElement(de,{collisionDetection:pe,onDragEnd:h,onDragStart:E,onDragMove:I,sensors:L,modifiers:[ue,me]},r.createElement(r.Fragment,null,r.createElement("div",{className:`${V}__draggable-underlay`,"aria-hidden":"true",key:`draggable-underlay-${l}`},b.map(t=>r.createElement("div",{className:`${V}__draggable-underlay-item`,key:t.id}))),r.createElement(ge,{items:c,strategy:fe},b.map(t=>{const i=O(t.Header),n=i.split(new RegExp(`(${a})`,"gi")).map(q=>q.toLowerCase()===a.toLowerCase()?`<strong>${q}</strong>`:q).join(""),m=!!t.sticky,z=t.disabled,T=r.createElement(r.Fragment,null,r.createElement(ee,{checked:K(t),disabled:z||m,onChange:(q,{checked:A})=>f(t,A),id:`${V}__customization-column-${t.id}`,labelText:i,title:i,className:`${V}__customize-columns-checkbox`,hideLabel:!0,onKeyDown:q=>H(q,t)}),r.createElement("div",{dangerouslySetInnerHTML:{__html:n},className:`${V}__customize-columns-checkbox-visible-label`}));return r.createElement(U,{classList:C,key:t.id,id:t.id,disabled:a.length>0||m,ariaLabel:i,isSticky:m,selected:K(t)},T)}))))};M.propTypes={columns:P.PropTypes.array.isRequired,filterString:P.PropTypes.string.isRequired,id:P.PropTypes.string.isRequired,moveElement:P.PropTypes.func.isRequired,onSelectColumn:P.PropTypes.func.isRequired,setAriaRegionText:P.PropTypes.func.isRequired};M.__docgenInfo={description:"",methods:[],displayName:"DraggableItemsList",props:{columns:{description:"",type:{name:"array"},required:!0},filterString:{description:"",type:{name:"string"},required:!0},id:{description:"",type:{name:"string"},required:!0},moveElement:{description:"",type:{name:"func"},required:!0},onSelectColumn:{description:"",type:{name:"func"},required:!0},setAriaRegionText:{description:"",type:{name:"func"},required:!0}}};const x=`${w.prefix}--datagrid`,G=({getVisibleColumnsCount:s,filterString:a,columns:l,setColumnsObject:o,onSelectColumn:f,assistiveTextInstructionsLabel:d,assistiveTextDisabledInstructionsLabel:C,selectAllLabel:b,customizeTearsheetHeadingLabel:v})=>{const c=g.useRef(Ce()),h=g.useRef(null),[E,I]=r.useState(""),R=r.useCallback((L,H)=>{o(t=>{const i=[...t],u=i[L];return i.splice(L,1),i.splice(H,0,u),i})},[o]),k=l==null?void 0:l.filter(L=>!L.sticky);return r.createElement("div",{className:`${x}__customize-columns-column-list`,ref:h},r.createElement("ol",{className:`${x}__customize-columns-column-list--focus`,role:"listbox","aria-label":v,"aria-describedby":`${x}__customize-columns--instructions`,tabIndex:0},r.createElement("span",{"aria-live":"assertive",className:`${x}__shared-ui--assistive-text`},E),r.createElement("span",{id:`${x}__customize-columns--instructions`,className:`${x}__shared-ui--assistive-text`},a.length===0?d:C),r.createElement("div",{id:`${x}__customize-columns-select-all`,className:F(`${x}__customize-columns-select-all`,{[`${x}__customize-columns-select-all--selected`]:s()>0}),selected:s()>0},r.createElement(ee,{className:`${x}__customize-columns-checkbox-wrapper`,checked:s()===l.length,indeterminate:s()<l.length&&s()>0,onChange:()=>{f(k,s()!==l.length)},id:`${x}__customization-column-select-all`,labelText:b})),r.createElement(M,{id:c.current,columns:l,filterString:a,moveElement:R,setAriaRegionText:I,onSelectColumn:f})))};G.propTypes={assistiveTextDisabledInstructionsLabel:e.string,assistiveTextInstructionsLabel:e.string,columns:e.array.isRequired,customizeTearsheetHeadingLabel:e.string,disabledInstructionsLabel:e.string,filterString:e.string.isRequired,getVisibleColumnsCount:e.func.isRequired,instructionsLabel:e.string,onSelectColumn:e.func.isRequired,selectAllLabel:e.string,setColumnStatus:e.func,setColumnsObject:e.func.isRequired};G.__docgenInfo={description:"",methods:[],displayName:"Columns",props:{assistiveTextDisabledInstructionsLabel:{description:"",type:{name:"string"},required:!1},assistiveTextInstructionsLabel:{description:"",type:{name:"string"},required:!1},columns:{description:"",type:{name:"array"},required:!0},customizeTearsheetHeadingLabel:{description:"",type:{name:"string"},required:!1},disabledInstructionsLabel:{description:"",type:{name:"string"},required:!1},filterString:{description:"",type:{name:"string"},required:!0},getVisibleColumnsCount:{description:"",type:{name:"func"},required:!0},instructionsLabel:{description:"",type:{name:"string"},required:!1},onSelectColumn:{description:"",type:{name:"func"},required:!0},selectAllLabel:{description:"",type:{name:"string"},required:!1},setColumnStatus:{description:"",type:{name:"func"},required:!1},setColumnsObject:{description:"",type:{name:"func"},required:!0}}};const xe=`${w.prefix}--datagrid`,Z=({searchText:s,setSearchText:a,findColumnPlaceholderLabel:l})=>g.createElement("div",{className:`${xe}__customize-columns-tearsheet--actions`},g.createElement(he,{placeholder:l,value:s,size:"lg",labelText:l,onChange:o=>{a(o.target.value)}}));Z.propTypes={columns:e.array.isRequired,findColumnPlaceholderLabel:e.string,originalColumnDefinitions:e.array.isRequired,resetToDefaultLabel:e.string,searchText:e.string.isRequired,setColumnsObject:e.func.isRequired,setSearchText:e.func.isRequired};Z.__docgenInfo={description:"",methods:[],displayName:"Actions",props:{columns:{description:"",type:{name:"array"},required:!0},findColumnPlaceholderLabel:{description:"",type:{name:"string"},required:!1},originalColumnDefinitions:{description:"",type:{name:"array"},required:!0},resetToDefaultLabel:{description:"",type:{name:"string"},required:!1},searchText:{description:"",type:{name:"string"},required:!0},setColumnsObject:{description:"",type:{name:"func"},required:!0},setSearchText:{description:"",type:{name:"func"},required:!0}}};const ve=`${w.prefix}--datagrid`,J=({isOpen:s,setIsTearsheetOpen:a,onSaveColumnPrefs:l,columnDefinitions:o,originalColumnDefinitions:f,customizeTearsheetHeadingLabel:d="Customize columns",primaryButtonTextLabel:C="Save",secondaryButtonTextLabel:b="Cancel",instructionsLabel:v="Select columns to display them. Click and drag the box to reorder the columns. These specifications will be saved and persist if you leave and return to the data table.",findColumnPlaceholderLabel:c="Find column",resetToDefaultLabel:h="Reset to default",assistiveTextInstructionsLabel:E="Press space bar to toggle drag drop mode, use arrow keys to move selected elements.",assistiveTextDisabledInstructionsLabel:I="Reordering columns are disabled because they are filtered currently.",selectAllLabel:R="Column name"})=>{const[k,L]=g.useState(""),[H,t]=g.useState(""),[i,u]=g.useState(""),[n,m]=g.useState(o),[z,T]=g.useState(!1),q=g.useRef(void 0),A=()=>{m(o),a(!1)},j=()=>{a(!1);const y=n.map($=>({id:$.id,isVisible:$.isVisible}));l(y)},_=(y,$)=>{const D=n.map(p=>Array.isArray(y)?y.includes(p)&&p.canFilter&&!p.disabled?{...p,isVisible:$}:p:y.id===p.id?{...p,isVisible:$}:p),X=D.filter(p=>p.isVisible&&!["datagridSelection","actions"].includes(p.id)).length,se=D.map(p=>X>0?["datagridSelection","actions"].includes(p.id)?{...p,isVisible:!0}:p:["datagridSelection","actions"].includes(p.id)?{...p,isVisible:!1}:p);m(se),T(X!==0)},B=g.useCallback(()=>n.filter(y=>y.isVisible).length,[n]),te=i.trim().toLowerCase();return g.useEffect(()=>{q.current!==o&&m(o);const y=n.filter(D=>D.id==="actions").length,$=n.filter(D=>D.id==="datagridSelection").length;L(B()-y-$<0?0:B()-y-$),t(n.length-y-$),q.current=o},[B,n,o]),r.createElement(Te,{className:`${ve}__customize-columns-tearsheet`,open:s,title:`${d} (${k}/${H})`,description:v,actions:[{kind:"secondary",label:b,onClick:A},{kind:"primary",label:C,onClick:j,disabled:!z}]},r.createElement(Z,{columns:n,originalColumnDefinitions:f,searchText:i,setColumnsObject:y=>{m(y),T(!0)},setSearchText:u,findColumnPlaceholderLabel:c,resetToDefaultLabel:h}),s&&r.createElement(G,{assistiveTextInstructionsLabel:E,assistiveTextDisabledInstructionsLabel:I,getVisibleColumnsCount:B,columns:n,filterString:te,onSelectColumn:_,setColumnsObject:y=>{m(y),T(B()!==0)},selectAllLabel:R,customizeTearsheetHeadingLabel:d}))};J.propTypes={assistiveTextDisabledInstructionsLabel:e.string,assistiveTextInstructionsLabel:e.string,columnDefinitions:e.array.isRequired,customizeTearsheetHeadingLabel:e.string,findColumnPlaceholderLabel:e.string,instructionsLabel:e.string,isOpen:e.bool.isRequired,onSaveColumnPrefs:e.func.isRequired,originalColumnDefinitions:e.array.isRequired,primaryButtonTextLabel:e.string,resetToDefaultLabel:e.string,secondaryButtonTextLabel:e.string,selectAllLabel:e.string,setIsTearsheetOpen:e.func.isRequired};J.__docgenInfo={description:"",methods:[],displayName:"CustomizeColumnsTearsheet",props:{customizeTearsheetHeadingLabel:{defaultValue:{value:"'Customize columns'",computed:!1},description:"",type:{name:"string"},required:!1},primaryButtonTextLabel:{defaultValue:{value:"'Save'",computed:!1},description:"",type:{name:"string"},required:!1},secondaryButtonTextLabel:{defaultValue:{value:"'Cancel'",computed:!1},description:"",type:{name:"string"},required:!1},instructionsLabel:{defaultValue:{value:"'Select columns to display them. Click and drag the box to reorder the columns. These specifications will be saved and persist if you leave and return to the data table.'",computed:!1},description:"",type:{name:"string"},required:!1},findColumnPlaceholderLabel:{defaultValue:{value:"'Find column'",computed:!1},description:"",type:{name:"string"},required:!1},resetToDefaultLabel:{defaultValue:{value:"'Reset to default'",computed:!1},description:"",type:{name:"string"},required:!1},assistiveTextInstructionsLabel:{defaultValue:{value:"'Press space bar to toggle drag drop mode, use arrow keys to move selected elements.'",computed:!1},description:"",type:{name:"string"},required:!1},assistiveTextDisabledInstructionsLabel:{defaultValue:{value:"'Reordering columns are disabled because they are filtered currently.'",computed:!1},description:"",type:{name:"string"},required:!1},selectAllLabel:{defaultValue:{value:"'Column name'",computed:!1},description:"",type:{name:"string"},required:!1},columnDefinitions:{description:"",type:{name:"array"},required:!0},isOpen:{description:"",type:{name:"bool"},required:!0},onSaveColumnPrefs:{description:"",type:{name:"func"},required:!0},originalColumnDefinitions:{description:"",type:{name:"array"},required:!0},setIsTearsheetOpen:{description:"",type:{name:"func"},required:!0}}};const Q=({instance:s})=>{const{onSaveColumnPrefs:a,isTearsheetOpen:l,setIsTearsheetOpen:o,labels:f,...d}=s.customizeColumnsProps,{state:C}=g.useContext(qe),{featureFlags:b}=C||{};return g.useEffect(()=>{b&&!(b!=null&&b["enable-datagrid-useCustomizeColumns"])&&console.error("Datagrid useCustomizeColumns extension has not been enabled via feature flag.")},[b]),r.createElement(J,{...d,...f,isOpen:l,setIsTearsheetOpen:o,columnDefinitions:s.allColumns,originalColumnDefinitions:s.columns,onSaveColumnPrefs:v=>{setTimeout(()=>{const c=v.filter(h=>!h.isVisible).map(h=>h.id);s.setHiddenColumns(c),typeof s.setColumnOrder=="function"?s.setColumnOrder(v.map(h=>h.id)):console.warn("Column order can not be updated. Did you forget to add 'useColumnOrder' in 'useDatagrid'")},0),typeof a=="function"&&a(v)}})};Q.propTypes={instance:e.object.isRequired};Q.__docgenInfo={description:"",methods:[],displayName:"TearsheetWrapper",props:{instance:{description:"",type:{name:"object"},required:!0}}};const $e=`${w.prefix}--datagrid`,W=({onClick:s,setIsTearsheetOpen:a,isTearsheetOpen:l,iconTooltipLabel:o="Customize columns",...f})=>g.createElement(ne,{...f,renderIcon:d=>g.createElement(re,{size:16,...d}),iconDescription:o,tooltipPosition:"bottom",kind:"ghost",hasIconOnly:!0,"test-id":`${$e}__customize-columns-trigger`,onClick:()=>{a(!l),typeof s=="function"&&s()}});W.defaultProps={onClick:()=>{}};W.propTypes={iconTooltipLabel:e.string,isTearsheetOpen:e.bool.isRequired,onClick:e.func.isRequired,setIsTearsheetOpen:e.func.isRequired};W.__docgenInfo={description:"",methods:[],displayName:"ButtonWrapper",props:{iconTooltipLabel:{defaultValue:{value:"'Customize columns'",computed:!1},description:"",type:{name:"string"},required:!1},onClick:{defaultValue:{value:"() => {}",computed:!1},description:"",type:{name:"func"},required:!1},isTearsheetOpen:{description:"",type:{name:"bool"},required:!0},setIsTearsheetOpen:{description:"",type:{name:"func"},required:!0}}};const Ae=s=>{const[a,l]=g.useState(!1);s.useInstance.push(o=>{const{customizeColumnsProps:f}=o,{labels:d}=f||{};Object.assign(o,{customizeColumnsProps:{...f,isTearsheetOpen:a,setIsTearsheetOpen:l},CustomizeColumnsButton:C=>g.createElement(W,{iconTooltipLabel:d==null?void 0:d.iconTooltipLabel,isTearsheetOpen:a,setIsTearsheetOpen:l,...C}),CustomizeColumnsTearsheet:Q})})},Be=_e.useColumnOrder;export{Ae as a,Be as u};
