{"version":3,"file":"RemoveModal-C7Fj2Pfi.js","sources":["../../src/components/RemoveModal/RemoveModal.tsx"],"sourcesContent":["//\n// Copyright IBM Corp. 2020, 2024\n//\n// This source code is licensed under the Apache-2.0 license found in the\n// LICENSE file in the root directory of this source tree.\n//\n\nimport {\n  Button,\n  ComposedModal,\n  ModalBody,\n  ModalFooter,\n  ModalHeader,\n  TextInput,\n} from '@carbon/react';\nimport React, {\n  ReactNode,\n  forwardRef,\n  useEffect,\n  useRef,\n  useState,\n} from 'react';\n\nimport PropTypes from 'prop-types';\nimport cx from 'classnames';\nimport { getDevtoolsProps } from '../../global/js/utils/devtools';\nimport { pkg } from '../../settings';\nimport { usePortalTarget } from '../../global/js/hooks/usePortalTarget';\nimport { usePreviousValue } from '../../global/js/hooks';\nimport uuidv4 from '../../global/js/utils/uuidv4';\n\nconst componentName = 'RemoveModal';\nexport interface RemoveModalProps\n  extends React.ComponentProps<typeof ComposedModal> {\n  /**\n   * The content to be displayed in the body of the modal\n   */\n  body: ReactNode;\n  /**\n   * Optional classname\n   */\n  className?: string;\n  /**\n   * Provide a description for \"close\" icon that can be read by screen readers\n   */\n  iconDescription: string;\n  /**\n   * Message showed when user input fails validation\n   */\n  inputInvalidText?: string;\n  /**\n   * Label for text box\n   */\n  inputLabelText?: ReactNode;\n  /**\n   * Placeholder for text box\n   */\n  inputPlaceholderText?: string;\n  /**\n   * Specify the modal label texts\n   */\n  label?: string;\n  /**\n   * Callback function that runs when user closes the modal\n   */\n  onClose?: () => void;\n  /**\n   * Callback function that runs when user submits the modal\n   */\n  onRequestSubmit?: () => void;\n  /**\n   * Specify whether the Modal is currently open\n   */\n  open: boolean;\n  /**\n   * The DOM node the tearsheet should be rendered within. Defaults to document.body.\n   */\n  portalTarget?: HTMLElement;\n  /**\n   * Prevent closing on click outside of modal\n   */\n  preventCloseOnClickOutside?: boolean;\n  /**\n   * Specify whether the primary button should be disabled. This value will override textConfirmation\n   */\n  primaryButtonDisabled?: boolean;\n  /**\n   * Specify the text for the primary button\n   */\n  primaryButtonText?: string;\n\n  /**\n   * Specify the danger description on the primary button\n   */\n  primaryDangerDescription?: string;\n\n  /**\n   * The name of the resource being acted upon\n   */\n  resourceName: string;\n  /**\n   * Specify the text for the secondary button\n   */\n  secondaryButtonText?: string;\n  /**\n   * Specify whether or not to show the text confirmation input\n   */\n  textConfirmation?: boolean;\n  /**\n   * The text displayed at the top of the modal\n   */\n  title: string;\n}\n/**\nThe `RemoveModal` covers what is known as high impact and medium impact deleting.\nEnabling `textConfirmation` enables what would be considered the high impact state of the modal.\nFor additional information on differentiating between delete / remove and low / medium / high impact please refer to the usage guidelines.\n */\ninterface PrevType {\n  open: boolean;\n}\nexport const RemoveModal = forwardRef(\n  (\n    {\n      body,\n      className,\n      iconDescription,\n      inputInvalidText,\n      inputLabelText,\n      inputPlaceholderText,\n      label,\n      onClose,\n      onRequestSubmit,\n      open,\n      portalTarget: portalTargetIn,\n      preventCloseOnClickOutside,\n      primaryButtonDisabled,\n      primaryButtonText,\n      primaryDangerDescription,\n      resourceName,\n      secondaryButtonText,\n      textConfirmation,\n      title,\n      ...rest\n    }: React.PropsWithChildren<RemoveModalProps>,\n    ref\n  ) => {\n    const previousState = usePreviousValue({ open }) as PrevType | undefined;\n    const [userInput, setUserInput] = useState('');\n    const idRef = useRef(uuidv4());\n    const renderPortalUse = usePortalTarget(portalTargetIn);\n    const onChangeHandler = (e) => {\n      setUserInput(e.target.value);\n    };\n    const checkPrimaryButtonDisabled = () => {\n      // user control should be used primarily\n      if (primaryButtonDisabled) {\n        return true;\n      } else if (textConfirmation && userInput !== resourceName) {\n        return true;\n      }\n      return false;\n    };\n    const primaryButtonStatus = checkPrimaryButtonDisabled();\n    const blockClass = `${pkg.prefix}--remove-modal`;\n\n    // Clear the user input this way so that if the onRequestSubmit handler fails for some reason\n    // the value of the input will still remain: we only want to empty the input value\n    // when open actually changes to false.\n    useEffect(() => {\n      if (!open && previousState?.open) {\n        setUserInput('');\n      }\n    }, [open, previousState?.open]);\n\n    return renderPortalUse(\n      <ComposedModal\n        {...rest}\n        className={cx(blockClass, className)}\n        size=\"sm\"\n        aria-label={title}\n        {...{\n          open,\n          ref,\n          preventCloseOnClickOutside,\n          onClose,\n          ...getDevtoolsProps(componentName),\n        }}\n      >\n        <ModalHeader\n          title={title}\n          label={label}\n          iconDescription={iconDescription}\n        />\n        <ModalBody>\n          {typeof body === 'string' ? (\n            <p className={`${blockClass}__body`}>{body}</p>\n          ) : (\n            body\n          )}\n          {textConfirmation && (\n            <TextInput\n              id={`${idRef.current}-confirmation-input`}\n              className={`${blockClass}__input`}\n              invalidText={inputInvalidText}\n              labelText={inputLabelText}\n              placeholder={inputPlaceholderText}\n              onChange={onChangeHandler}\n              value={userInput}\n              data-modal-primary-focus\n            />\n          )}\n        </ModalBody>\n        <ModalFooter>\n          <Button\n            type=\"button\"\n            kind=\"secondary\"\n            onClick={onClose}\n            data-modal-primary-focus={!textConfirmation}\n          >\n            {secondaryButtonText}\n          </Button>\n          <Button\n            type=\"submit\"\n            kind=\"danger\"\n            dangerDescription={primaryDangerDescription}\n            onClick={onRequestSubmit}\n            disabled={primaryButtonStatus}\n          >\n            {primaryButtonText}\n          </Button>\n        </ModalFooter>\n      </ComposedModal>\n    );\n  }\n);\n\n// Return a placeholder if not released and not enabled by feature flag\n\nRemoveModal.propTypes = {\n  /**\n   * The content to be displayed in the body of the modal\n   */\n  body: PropTypes.node.isRequired,\n  /**\n   * Optional classname\n   */\n  className: PropTypes.string,\n  /**\n   * Provide a description for \"close\" icon that can be read by screen readers\n   */\n  iconDescription: PropTypes.string.isRequired,\n  /**\n   * Message showed when user input fails validation\n   */\n  inputInvalidText: PropTypes.string,\n  /**\n   * Label for text box\n   */\n  inputLabelText: PropTypes.node,\n  /**\n   * Placeholder for text box\n   */\n  inputPlaceholderText: PropTypes.string,\n  /**\n   * Specify the modal label texts\n   */\n  label: PropTypes.string,\n  /**\n   * Callback function that runs when user closes the modal\n   */\n  onClose: PropTypes.func,\n  /**\n   * Callback function that runs when user submits the modal\n   */\n  onRequestSubmit: PropTypes.func,\n  /**\n   * Specify whether the Modal is currently open\n   */\n  open: PropTypes.bool.isRequired,\n  /**\n   * The DOM node the tearsheet should be rendered within. Defaults to document.body.\n   */\n  portalTarget: PropTypes.node,\n  /**\n   * Prevent closing on click outside of modal\n   */\n  preventCloseOnClickOutside: PropTypes.bool,\n  /**\n   * Specify whether the primary button should be disabled. This value will override textConfirmation\n   */\n  primaryButtonDisabled: PropTypes.bool,\n  /**\n   * Specify the text for the primary button\n   */\n  primaryButtonText: PropTypes.string,\n\n  /**\n   * Specify the danger description on the primary button\n   */\n  primaryDangerDescription: PropTypes.string,\n\n  /**\n   * The name of the resource being acted upon\n   */\n  resourceName: PropTypes.string.isRequired,\n  /**\n   * Specify the text for the secondary button\n   */\n  secondaryButtonText: PropTypes.string,\n  /**\n   * Specify whether or not to show the text confirmation input\n   */\n  textConfirmation: PropTypes.bool,\n  /**\n   * The text displayed at the top of the modal\n   */\n  title: PropTypes.string.isRequired,\n};\n\nRemoveModal.displayName = componentName;\n"],"names":["componentName","RemoveModal","forwardRef","body","className","iconDescription","inputInvalidText","inputLabelText","inputPlaceholderText","label","onClose","onRequestSubmit","open","portalTargetIn","preventCloseOnClickOutside","primaryButtonDisabled","primaryButtonText","primaryDangerDescription","resourceName","secondaryButtonText","textConfirmation","title","rest","ref","previousState","usePreviousValue","userInput","setUserInput","useState","idRef","useRef","uuidv4","renderPortalUse","usePortalTarget","onChangeHandler","e","primaryButtonStatus","blockClass","pkg","useEffect","React","ComposedModal","cx","getDevtoolsProps","ModalHeader","ModalBody","TextInput","ModalFooter","Button","PropTypes"],"mappings":"sXA+BA,MAAMA,EAAgB,cA0FTC,EAAcC,EAAAA,WACzB,CACE,CACE,KAAAC,EACA,UAAAC,EACA,gBAAAC,EACA,iBAAAC,EACA,eAAAC,EACA,qBAAAC,EACA,MAAAC,EACA,QAAAC,EACA,gBAAAC,EACA,KAAAC,EACA,aAAcC,EACd,2BAAAC,EACA,sBAAAC,EACA,kBAAAC,EACA,yBAAAC,EACA,aAAAC,EACA,oBAAAC,EACA,iBAAAC,EACA,MAAAC,EACA,GAAGC,CAAA,EAELC,IACG,CACH,MAAMC,EAAgBC,EAAiB,CAAE,KAAAb,EAAM,EACzC,CAACc,EAAWC,CAAY,EAAIC,EAAAA,SAAS,EAAE,EACvCC,EAAQC,SAAOC,GAAQ,EACvBC,EAAkBC,EAAgBpB,CAAc,EAChDqB,EAAmBC,GAAM,CAC7BR,EAAaQ,EAAE,OAAO,KAAK,CAC7B,EAUMC,EAPArB,EACK,GACE,GAAAK,GAAoBM,IAAcR,GAMzCmB,EAAa,GAAGC,EAAI,MAAM,iBAKhCC,OAAAA,EAAAA,UAAU,IAAM,CACV,CAAC3B,GAAQY,GAAe,MAC1BG,EAAa,EAAE,CAEnB,EAAG,CAACf,EAAMY,GAAe,IAAI,CAAC,EAEvBQ,EACLQ,EAAA,cAACC,EAAA,CACE,GAAGnB,EACJ,UAAWoB,EAAGL,EAAYjC,CAAS,EACnC,KAAK,KACL,aAAYiB,EAEV,KAAAT,EACA,IAAAW,EACA,2BAAAT,EACA,QAAAJ,EACA,GAAGiC,EAAiB3C,CAAa,CACnC,EAEAwC,EAAA,cAACI,EAAA,CACC,MAAAvB,EACA,MAAAZ,EACA,gBAAAJ,CAAA,CAAA,EAEFmC,EAAA,cAACK,EAAA,KACE,OAAO1C,GAAS,SACfqC,EAAA,cAAC,IAAA,CAAE,UAAW,GAAGH,CAAU,QAAA,EAAWlC,CAAK,EAE3CA,EAEDiB,GACCoB,EAAA,cAACM,EAAA,CACC,GAAI,GAAGjB,EAAM,OAAO,sBACpB,UAAW,GAAGQ,CAAU,UACxB,YAAa/B,EACb,UAAWC,EACX,YAAaC,EACb,SAAU0B,EACV,MAAOR,EACP,2BAAuB,EAAA,CAAA,CAG7B,kBACCqB,EAAA,KACCP,EAAA,cAACQ,EAAA,CACC,KAAK,SACL,KAAK,YACL,QAAStC,EACT,2BAA0B,CAACU,CAAA,EAE1BD,CAAA,EAEHqB,EAAA,cAACQ,EAAA,CACC,KAAK,SACL,KAAK,SACL,kBAAmB/B,EACnB,QAASN,EACT,SAAUyB,CAAA,EAETpB,CAAA,CAEL,CAAA,CACF,CAEJ,CACF,EAIAf,EAAY,UAAY,CAItB,KAAMgD,EAAU,KAAK,WAIrB,UAAWA,EAAU,OAIrB,gBAAiBA,EAAU,OAAO,WAIlC,iBAAkBA,EAAU,OAI5B,eAAgBA,EAAU,KAI1B,qBAAsBA,EAAU,OAIhC,MAAOA,EAAU,OAIjB,QAASA,EAAU,KAInB,gBAAiBA,EAAU,KAI3B,KAAMA,EAAU,KAAK,WAIrB,aAAcA,EAAU,KAIxB,2BAA4BA,EAAU,KAItC,sBAAuBA,EAAU,KAIjC,kBAAmBA,EAAU,OAK7B,yBAA0BA,EAAU,OAKpC,aAAcA,EAAU,OAAO,WAI/B,oBAAqBA,EAAU,OAI/B,iBAAkBA,EAAU,KAI5B,MAAOA,EAAU,OAAO,UAC1B,EAEAhD,EAAY,YAAcD"}