{"version":3,"file":"useDisableSelectRows-CUqmyeRS.js","sources":["../../src/components/Datagrid/useDisableSelectRows.ts"],"sourcesContent":["/**\n * Copyright IBM Corp. 2020, 2024\n *\n * This source code is licensed under the Apache-2.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport { Hooks, Row, RowPropGetter, TableRowProps } from 'react-table';\nimport { DatagridRow, PropGetterMeta, DatagridRowProps } from './types';\n\nconst nonselectablerowsList = (instance) => {\n  const nonselectablerows: number[] =\n    instance?.rows\n      ?.filter(\n        (row) =>\n          instance.shouldDisableSelectRow &&\n          instance.shouldDisableSelectRow(row)\n      )\n      .map((row) => row.id) || [];\n  return nonselectablerows;\n};\n\nconst useDisableSelectRows = (hooks: Hooks) => {\n  updateSelectAll(hooks);\n  updatePageSelectAll(hooks);\n\n  let nonselectablerows: number[] = [];\n  const useInstance = (instance) => {\n    nonselectablerows = nonselectablerowsList(instance);\n  };\n  hooks.useInstance.push(useInstance);\n\n  const getRowProps: RowPropGetter<any> = (\n    props: Partial<TableRowProps>,\n    { row, instance }: PropGetterMeta\n  ) => {\n    return [\n      props,\n      {\n        disabled: instance?.shouldDisableSelectRow?.(row),\n        nonselectablerows,\n      },\n    ] as Partial<DatagridRowProps>[];\n  };\n  hooks.getRowProps.push(getRowProps);\n};\n\nconst updateSelectAll = (hooks: Hooks) => {\n  const getToggleAllRowsSelectedProps: RowPropGetter<any> = (\n    props: Partial<TableRowProps>,\n    { instance }: PropGetterMeta\n  ) => {\n    const selectableRows: Row<any>[] =\n      instance?.rows?.filter(\n        (row) =>\n          !(\n            instance.shouldDisableSelectRow &&\n            instance.shouldDisableSelectRow(row)\n          )\n      ) || [];\n    const isAllRowsSelected: boolean =\n      selectableRows?.length > 0 &&\n      selectableRows.every(({ id }) => instance?.state?.selectedRowIds?.[id]);\n    return [\n      props,\n      {\n        onChange: (e) => {\n          selectableRows.forEach((row) =>\n            (row as DatagridRow)?.toggleRowSelected?.(e.target.checked)\n          );\n        },\n        style: { cursor: 'pointer' },\n        checked: isAllRowsSelected,\n        disabled: instance?.disableSelectAll,\n        title:\n          instance?.disableSelectRowsProps?.labels?.toggleAllRowsLabel ||\n          'Toggle All Rows Selected',\n        indeterminate: Boolean(\n          !isAllRowsSelected &&\n            Object.keys(instance?.state?.selectedRowIds || {}).length\n        ),\n      },\n    ];\n  };\n  hooks.getToggleAllRowsSelectedProps.push(getToggleAllRowsSelectedProps);\n};\n\nconst updatePageSelectAll = (hooks: Hooks) => {\n  const getToggleAllPageRowsSelectedProps = (\n    props: Partial<TableRowProps>,\n    { instance }: PropGetterMeta\n  ) => {\n    const selectableRows =\n      instance?.page?.filter(\n        (row) =>\n          !(\n            instance.shouldDisableSelectRow &&\n            instance.shouldDisableSelectRow(row)\n          )\n      ) || [];\n    const isAllRowsSelected =\n      selectableRows?.length > 0 &&\n      selectableRows.every(({ id }) => instance?.state?.selectedRowIds?.[id]);\n    return [\n      props,\n      {\n        onChange: (e) => {\n          selectableRows.forEach((row) =>\n            (row as DatagridRow).toggleRowSelected(e.target.checked)\n          );\n        },\n        style: { cursor: 'pointer' },\n        checked: isAllRowsSelected,\n        disabled: instance?.disableSelectAll,\n        title:\n          instance?.disableSelectRowsProps?.labels?.toggleAllRowsLabel ||\n          'Toggle All Rows Selected',\n        indeterminate: Boolean(\n          !isAllRowsSelected &&\n            instance?.page?.some(\n              ({ id }) => instance?.state?.selectedRowIds?.[id]\n            )\n        ),\n      },\n    ];\n  };\n  hooks.getToggleAllPageRowsSelectedProps.push(\n    getToggleAllPageRowsSelectedProps\n  );\n};\n\nexport default useDisableSelectRows;\n"],"names":["nonselectablerowsList","instance","row","useDisableSelectRows","hooks","updateSelectAll","updatePageSelectAll","nonselectablerows","useInstance","getRowProps","props","getToggleAllRowsSelectedProps","selectableRows","isAllRowsSelected","id","e","getToggleAllPageRowsSelectedProps"],"mappings":"AASA,MAAMA,EAAyBC,GAE3BA,GAAU,MACN,OACCC,GACCD,EAAS,wBACTA,EAAS,uBAAuBC,CAAG,CAAA,EAEtC,IAAKA,GAAQA,EAAI,EAAE,GAAK,CAAA,EAIzBC,EAAwBC,GAAiB,CAC7CC,EAAgBD,CAAK,EACrBE,EAAoBF,CAAK,EAEzB,IAAIG,EAA8B,CAAA,EAClC,MAAMC,EAAeP,GAAa,CAChCM,EAAoBP,EAAsBC,CAAQ,CACpD,EACAG,EAAM,YAAY,KAAKI,CAAW,EAElC,MAAMC,EAAkC,CACtCC,EACA,CAAE,IAAAR,EAAK,SAAAD,KAEA,CACLS,EACA,CACE,SAAUT,GAAU,yBAAyBC,CAAG,EAChD,kBAAAK,CAAA,CACF,EAGJH,EAAM,YAAY,KAAKK,CAAW,CACpC,EAEMJ,EAAmBD,GAAiB,CACxC,MAAMO,EAAoD,CACxDD,EACA,CAAE,SAAAT,KACC,CACH,MAAMW,EACJX,GAAU,MAAM,OACbC,GACC,EACED,EAAS,wBACTA,EAAS,uBAAuBC,CAAG,EAAA,GAEpC,CAAA,EACDW,EACJD,GAAgB,OAAS,GACzBA,EAAe,MAAM,CAAC,CAAE,GAAAE,CAAA,IAASb,GAAU,OAAO,iBAAiBa,CAAE,CAAC,EACxE,MAAO,CACLJ,EACA,CACE,SAAWK,GAAM,CACfH,EAAe,QAASV,GACrBA,GAAqB,oBAAoBa,EAAE,OAAO,OAAO,CAAA,CAE9D,EACA,MAAO,CAAE,OAAQ,SAAA,EACjB,QAASF,EACT,SAAUZ,GAAU,iBACpB,MACEA,GAAU,wBAAwB,QAAQ,oBAC1C,2BACF,cAAe,GACb,CAACY,GACC,OAAO,KAAKZ,GAAU,OAAO,gBAAkB,CAAA,CAAE,EAAE,OACvD,CACF,CAEJ,EACAG,EAAM,8BAA8B,KAAKO,CAA6B,CACxE,EAEML,EAAuBF,GAAiB,CAC5C,MAAMY,EAAoC,CACxCN,EACA,CAAE,SAAAT,KACC,CACH,MAAMW,EACJX,GAAU,MAAM,OACbC,GACC,EACED,EAAS,wBACTA,EAAS,uBAAuBC,CAAG,EAAA,GAEpC,CAAA,EACDW,EACJD,GAAgB,OAAS,GACzBA,EAAe,MAAM,CAAC,CAAE,GAAAE,CAAA,IAASb,GAAU,OAAO,iBAAiBa,CAAE,CAAC,EACxE,MAAO,CACLJ,EACA,CACE,SAAWK,GAAM,CACfH,EAAe,QAASV,GACrBA,EAAoB,kBAAkBa,EAAE,OAAO,OAAO,CAAA,CAE3D,EACA,MAAO,CAAE,OAAQ,SAAA,EACjB,QAASF,EACT,SAAUZ,GAAU,iBACpB,MACEA,GAAU,wBAAwB,QAAQ,oBAC1C,2BACF,cAAe,GACb,CAACY,GACCZ,GAAU,MAAM,KACd,CAAC,CAAE,GAAAa,CAAA,IAASb,GAAU,OAAO,iBAAiBa,CAAE,CAAA,EAEtD,CACF,CAEJ,EACAV,EAAM,kCAAkC,KACtCY,CAAA,CAEJ"}