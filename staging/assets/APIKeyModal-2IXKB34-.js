import{r,e as t}from"./index-DtHxqM--.js";import{P as e,F as We,d as Xe,v as Qe}from"./index-C360Eztx.js";import{p as g,B as pe,C as Ye}from"./settings-CFkY3W_8.js";import{C as Ze,M as Ge,a as et,b as tt}from"./ComposedModal-CJn3uPYK.js";import{F as st}from"./Form-Bke3lSBz.js";import{I as rt}from"./InlineLoading-DwO_qCAY.js";import{P as at}from"./codePreviewer-DRSklQgQ.js";import{T as ce}from"./TextInput-DJpFdpZP.js";import{u as nt}from"./usePortalTarget-CutnQ3UR.js";import{g as it}from"./devtools-XPxnGn1y.js";import{i as j}from"./props-helper-CSyPWdyB.js";import{u as ue}from"./uuidv4-BN2rGLQG.js";import{u as ot}from"./useFocus-qurYX6CL.js";import{u as lt}from"./usePreviousValue-CuNkkQo9.js";import{a as dt}from"./bucket-6-BjeV6rPm.js";import{c as pt}from"./bucket-9-BxEcmZXg.js";const ct="APIKeyDownloader",P=({apiKey:s,body:i,fileName:b,fileType:c,linkText:T,downloadLinkLabel:q})=>{const[E,N]=r.useState({});return r.useEffect(()=>{(async()=>{const o=c==="txt"?s:JSON.stringify({apiKey:s}),_=new Blob([o],{type:c==="txt"?"text/plain":"application/json"}),R=await URL.createObjectURL(_),L=`${b||"apikey"}.${c}`;N({href:R,download:L})})()},[s,b,c]),t.createElement("div",{className:`${g.prefix}--apikey-modal__download-container`},t.createElement("p",{className:`${g.prefix}--apikey-modal__messaging-text`},i," ",t.createElement("a",{...E,className:`${g.prefix}--apikey-modal__download-link`,"aria-label":q??T,role:"button"},q??T)))};P.displayName=ct;P.propTypes={apiKey:e.string.isRequired,body:e.string,downloadLinkLabel:e.string,fileName:e.string.isRequired,fileType:e.oneOf(["txt","json"]).isRequired,linkText:e.string.isRequired};P.__docgenInfo={description:"",methods:[],displayName:"APIKeyDownloader",props:{apiKey:{description:"the api key that's displayed to the user when a request to create is fulfilled.",type:{name:"string"},required:!0},body:{description:"body content for the downloader",type:{name:"string"},required:!1},downloadLinkLabel:{description:"aria-label for the download link",type:{name:"string"},required:!1},fileName:{description:"designates the name of downloadable json file with the key. if not specified will default to 'apikey'",type:{name:"string"},required:!0},fileType:{description:"designates the file type for the downloadable key",type:{name:"enum",value:[{value:"'txt'",computed:!1},{value:"'json'",computed:!1}]},required:!0},linkText:{description:"anchor text for the download link",type:{name:"string"},required:!0}}};const H="APIKeyModal",me={apiKeyName:"",customSteps:[]};let h=r.forwardRef(({apiKey:s,apiKeyLabel:i,apiKeyName:b=me.apiKeyName,body:c,className:T,closeButtonText:q,copyButtonText:E,copyErrorText:N,copyIconDescription:z,customSteps:o=me.customSteps,downloadBodyText:_,downloadFileName:R,downloadFileType:L,downloadLinkText:B,downloadLinkLabel:fe=B,editButtonText:ge,editSuccess:S,editSuccessTitle:V,editSuccessMessage:U,editing:u,error:he,errorText:be,generateButtonText:Te,generateSuccessBody:qe,generateSuccessTitle:J,generateSuccessMessage:W,generateTitle:w,hasAPIKeyVisibilityToggle:X,hasDownloadLink:we,hideAPIKeyLabel:xe,launcherButtonRef:I,loading:f,loadingText:ke,modalLabel:Q,nameHelperText:ve,nameLabel:Pe,namePlaceholder:Ee,nameRequired:$,nextStepButtonText:Ne,onClose:F,onCopy:Y,onRequestEdit:A,onRequestGenerate:C,open:p,portalTarget:_e,previousStepButtonText:Re,showAPIKeyLabel:Le,helperText:Be,...Se},Ie)=>{var de;const[Z,x]=r.useState(null),[G,ee]=r.useState(null),[te,$e]=r.useState(!1),[k,se]=r.useState(b),[d,O]=r.useState(0),D=r.useRef(void 0),re=r.useRef(ue()),Fe=r.useRef(ue()),Ae=nt(_e),m=!!o.length,n=s&&!f,ae=m&&d<o.length-1,ne=m&&d!==0,Ce={renderIcon:l=>t.createElement(Ye,{size:16,...l}),iconDescription:z,ref:D},a=`${g.prefix}--apikey-modal`,Oe=r.useRef(void 0),y=r.useRef(null),K=Ie||Oe,{firstElement:De,keyDownListener:Ke,claimFocus:Me}=ot(K),ie=lt(p);r.useEffect(()=>{D.current&&p&&n&&D.current.focus(),y!=null&&y.current&&(y==null||y.current.setAttribute("readOnly","true"))},[p,n]),r.useEffect(()=>{p&&Me()},[K,p,De]),r.useEffect(()=>{ie&&!p&&I&&setTimeout(()=>{I.current.focus()},0)},[I,p,ie]);const je=()=>{var l;return f?!0:m&&"valid"in((o==null?void 0:o[d])||[])?!((l=o[d])!=null&&l.valid):!!(!m&&$&&!k)},He=()=>ae?Ne:n?E:u?ge:Te,ze=()=>ne&&!n?Re:q;r.useEffect(()=>{var l;u&&S?(x(w),ee(U??V)):n?(x(w),ee(W??J)):x(m?(l=o[d])==null?void 0:l.title:w)},[n,f,u,S,V,U,m,J,W,w,d,o]);const Ve=l=>{se(l.target.value)},oe=()=>{se(""),O(0),F==null||F()},le=async l=>{if(l.preventDefault(),ae)O(d+1);else if(n)if(Y)Y(s);else try{await navigator.clipboard.writeText(s)}catch(Je){console.error(Je),$e(!0)}else u?A==null||A(k):C==null||C(k)},Ue=()=>{ne&&!n?O(d-1):oe()};return Ae(t.createElement(We,{enableExperimentalFocusWrapWithoutSentinels:!0},t.createElement(Ze,{...Se,open:p,...it(H),ref:K,onKeyDown:Ke,className:Xe(T,a),onClose:oe,size:"sm","aria-label":Q,preventCloseOnClickOutside:!0},t.createElement(Ge,{className:`${a}__header`,title:Z,label:Q}),t.createElement(et,{className:`${a}__body-container`},m&&!n?(de=o[d])==null?void 0:de.content:t.createElement(t.Fragment,null,c&&t.createElement("p",{className:`${a}__body`},c),!u&&s&&X&&t.createElement(at,{value:s,labelText:i,id:re.current,showPasswordLabel:Le,hidePasswordLabel:xe,tooltipPosition:"left",helperText:Be,ref:y}),!u&&s&&!X&&t.createElement(ce,{value:s,labelText:i,id:re.current}),(u||!n&&$)&&t.createElement(st,{onSubmit:le,"aria-label":Z??void 0},t.createElement(ce,{helperText:ve,placeholder:Ee,labelText:Pe,onChange:Ve,value:k,id:Fe.current,disabled:f,required:$,"data-modal-primary-focus":!0})),f&&t.createElement(rt,{description:ke,className:`${a}__loader`}),(te||he)&&t.createElement("div",{className:`${a}__messaging`},t.createElement("div",{className:`${a}__error-icon`},t.createElement(dt,{size:16})),t.createElement("p",{className:`${a}__messaging-text`,role:"alert","aria-live":"assertive"},te?N:be)),n&&t.createElement("div",{className:`${a}__messaging`},t.createElement(pt,{size:16}),we?t.createElement(P,{apiKey:s,body:_,fileName:R,linkText:B,fileType:L,downloadLinkLabel:fe}):t.createElement("div",{className:`${a}__messaging-text`,role:"alert","aria-live":"assertive"},qe)),(S||n&&G)&&t.createElement("div",{className:`${a}__messaging`},t.createElement(Qe,{size:16,className:`${a}__checkmark-icon`}),t.createElement("p",{className:`${a}__messaging-text`,role:"alert","aria-live":"assertive"},G)))),t.createElement(tt,{className:`${a}__footer`},t.createElement(pe,{type:"button",kind:"secondary",onClick:Ue},ze()),t.createElement(pe,{...n&&Ce,type:"submit",kind:"primary",onClick:le,disabled:je()},He())))))});const ye=s=>j(s,({customSteps:i})=>i&&i.length>1),M=s=>j(s,({editing:i})=>i),v=s=>j(s,({hasDownloadLink:i})=>i);h=g.checkComponentEnabled(h,H);const ut={editSuccessTitle:e.string,generateSuccessTitle:e.string};h.propTypes={apiKey:e.string,apiKeyLabel:e.string,apiKeyName:e.string,body:e.string,className:e.string,closeButtonText:e.string,copyButtonText:e.string,copyErrorText:e.string,copyIconDescription:e.string,customSteps:e.arrayOf(e.shape({valid:e.bool,content:e.node,title:e.string})),downloadBodyText:e.string,downloadFileName:v(e.string),downloadFileType:v(e.oneOf(["txt","json"])),downloadLinkLabel:v(e.string),downloadLinkText:v(e.string),editButtonText:M(e.string),editSuccess:M(e.bool),editSuccessMessage:M(e.string),editing:e.bool,error:e.bool,errorText:e.string,generateButtonText:e.string,generateSuccessBody:e.node,generateSuccessMessage:e.string,generateTitle:e.string,hasAPIKeyVisibilityToggle:e.bool,hasDownloadLink:e.bool,helperText:e.string,hideAPIKeyLabel:e.string,launcherButtonRef:e.any,loading:e.bool,loadingText:e.string,modalLabel:e.string,nameHelperText:e.string,nameLabel:e.string,namePlaceholder:e.string,nameRequired:e.bool,nextStepButtonText:ye(e.string),onClose:e.func,onCopy:e.func,onRequestEdit:e.func,onRequestGenerate:e.func,open:e.bool.isRequired,portalTarget:e.node,previousStepButtonText:ye(e.string),showAPIKeyLabel:e.string,...ut};h.displayName=H;h.__docgenInfo={description:"",methods:[],displayName:"APIKeyModal",props:{apiKey:{required:!1,tsType:{name:"string"},description:"the api key that's displayed to the user when a request to create is fulfilled.",type:{name:"string"}},apiKeyLabel:{required:!1,tsType:{name:"string"},description:"label for the text input that holds the api key.",type:{name:"string"}},apiKeyName:{required:!1,tsType:{name:"string"},description:"the name of the api key. should only be supplied in edit mode.",defaultValue:{value:"''",computed:!1},type:{name:"string"}},body:{required:!1,tsType:{name:"string"},description:"body content for the modal",type:{name:"string"}},className:{required:!1,tsType:{name:"string"},description:"optional class name",type:{name:"string"}},closeButtonText:{required:!1,tsType:{name:"string"},description:"text for the close button",type:{name:"string"}},copyButtonText:{required:!1,tsType:{name:"string"},description:"text for the copy button",type:{name:"string"}},copyErrorText:{required:!1,tsType:{name:"string"},description:"Error message for when the copy function fails",type:{name:"string"}},copyIconDescription:{required:!1,tsType:{name:"string"},description:"text description for the copy button icon",type:{name:"string"}},customSteps:{required:!1,tsType:{name:"Array",elements:[{name:"signature",type:"object",raw:`{
  valid?: boolean;
  content?: ReactNode;
  title?: string;
}`,signature:{properties:[{key:"valid",value:{name:"boolean",required:!1}},{key:"content",value:{name:"ReactNode",required:!1}},{key:"title",value:{name:"string",required:!1}}]}}],raw:`Array<{
  valid?: boolean;
  content?: ReactNode;
  title?: string;
}>`},description:"if you need more options for key creation beyond just the name use custom steps to obtain whatever data is required.",defaultValue:{value:"[]",computed:!1},type:{name:"arrayOf",value:{name:"shape",value:{valid:{name:"bool",description:"designates if the step has passed whatever validation rules are in place.",required:!1},content:{name:"node",description:"designates content is the JSX that holds whatever inputs you need",required:!1},title:{name:"string",description:"designates the title that's displayed at the top of the modal for each step",required:!1}}}}},editing:{required:!1,tsType:{name:"boolean"},description:"designates if the modal is in the edit mode",type:{name:"bool"}},error:{required:!1,tsType:{name:"boolean"},description:"designates if an error has occurred in a request",type:{name:"bool"}},errorText:{required:!1,tsType:{name:"string"},description:"text to display if an error has occurred",type:{name:"string"}},generateButtonText:{required:!1,tsType:{name:"string"},description:`default primary button text for modal in assumed default mode create or generate.
in create mode this is the button text prior to supplying an api key, which then
uses copyButtonText`,type:{name:"string"}},generateSuccessBody:{required:!1,tsType:{name:"ReactNode"},description:"content to display if generate request was successful",type:{name:"node"}},generateSuccessTitle:{required:!1,tsType:{name:"string"},description:"* @deprecated use `generateSuccessMessage` instead\ntitle for a successful key generation",type:{name:"string"}},generateSuccessMessage:{required:!1,tsType:{name:"string"},description:"success message for a successful key generation",type:{name:"string"}},generateTitle:{required:!1,tsType:{name:"string"},description:"default title for the modal in generate key mode",type:{name:"string"}},hasAPIKeyVisibilityToggle:{required:!1,tsType:{name:"boolean"},description:"designates if the api input has the visibility toggle enabled",type:{name:"bool"}},hasDownloadLink:{required:!1,tsType:{name:"boolean"},description:"designates if user is able to download the api key",type:{name:"bool"}},hideAPIKeyLabel:{required:!1,tsType:{name:"string"},description:"label text that's displayed when hovering over visibility toggler to hide key",type:{name:"string"}},launcherButtonRef:{required:!1,tsType:{name:"RefObject",elements:[{name:"any"}],raw:"RefObject<any>"},description:"Provide a ref to return focus to once the tearsheet is closed.",type:{name:"any"}},loading:{required:!1,tsType:{name:"boolean"},description:"designates if the modal is in a loading state via a request or some other in progress operation",type:{name:"bool"}},loadingText:{required:!1,tsType:{name:"string"},description:"text that displays while modal is in the loading state",type:{name:"string"}},modalLabel:{required:!1,tsType:{name:"string"},description:"general label text for modal",type:{name:"string"}},nameHelperText:{required:!1,tsType:{name:"string"},description:"helper text for name input",type:{name:"string"}},nameLabel:{required:!1,tsType:{name:"string"},description:"label for api key name input",type:{name:"string"}},namePlaceholder:{required:!1,tsType:{name:"string"},description:"placeholder text for api key name input",type:{name:"string"}},nameRequired:{required:!1,tsType:{name:"boolean"},description:"designates if a name is required or not for key generation. NOTE- if using custom steps set this to false since you will be using your own validation",type:{name:"bool"}},open:{required:!0,tsType:{name:"boolean"},description:"designates if modal is open or closed",type:{name:"bool"}},portalTarget:{required:!1,tsType:{name:"ReactNode"},description:"The DOM node the tearsheet should be rendered within. Defaults to document.body.",type:{name:"node"}},showAPIKeyLabel:{required:!1,tsType:{name:"string"},description:"label text that's displayed when hovering over visibility toggler to show key",type:{name:"string"}},helperText:{required:!1,tsType:{name:"string"},description:"helper text for password input",type:{name:"string"}},previousStepButtonText:{required:!1,tsType:{name:"string"},description:"text that displays in the secondary button when using custom steps to indicate to the user that there is a previous step",type:{name:"custom",raw:"customStepsRequiredProps(PropTypes.string)"}},nextStepButtonText:{required:!1,tsType:{name:"string"},description:"text that displays in the primary button when using custom steps to indicate to the user that there is a next step",type:{name:"custom",raw:"customStepsRequiredProps(PropTypes.string)"}},editButtonText:{required:!1,tsType:{name:"string"},description:"text for the edit button",type:{name:"custom",raw:"editRequiredProps(PropTypes.string)"}},editSuccess:{required:!1,tsType:{name:"boolean"},description:"designates if the edit request was successful",type:{name:"custom",raw:"editRequiredProps(PropTypes.bool)"}},editSuccessTitle:{required:!1,tsType:{name:"string"},description:"* @deprecated use `editSuccessMessage` instead\ntitle for a successful edit",type:{name:"string"}},editSuccessMessage:{required:!1,tsType:{name:"string"},description:"success message for edit",type:{name:"custom",raw:"editRequiredProps(PropTypes.string)"}},downloadBodyText:{required:!1,tsType:{name:"string"},description:"the content that appears that indicates the key is downloadable",type:{name:"string"}},downloadFileName:{required:!1,tsType:{name:"string"},description:"designates the name of downloadable json file with the key. if not specified will default to 'apikey'",type:{name:"custom",raw:"downloadRequiredProps(PropTypes.string)"}},downloadFileType:{required:!1,tsType:{name:"union",raw:"'txt' | 'json'",elements:[{name:"literal",value:"'txt'"},{name:"literal",value:"'json'"}]},description:"designates the file type for the downloadable key",type:{name:"custom",raw:"downloadRequiredProps(PropTypes.oneOf(['txt', 'json']))"}},downloadLinkText:{required:!1,tsType:{name:"string"},description:"anchor text for the download link",type:{name:"custom",raw:"downloadRequiredProps(PropTypes.string)"}},downloadLinkLabel:{required:!1,tsType:{name:"string"},description:"Aria-label for the download link",defaultValue:{value:"downloadLinkText",computed:!1},type:{name:"custom",raw:"downloadRequiredProps(PropTypes.string)"}},onClose:{description:"handler for on modal close",type:{name:"func"},required:!1},onCopy:{description:`Optional callback if you want to use your own copy function instead of the build in one
onCopy(apiKey)`,type:{name:"func"},required:!1},onRequestEdit:{description:"handler for api key edit",type:{name:"func"},required:!1},onRequestGenerate:{description:"handler for api key generation",type:{name:"func"},required:!1}}};export{h as A};
