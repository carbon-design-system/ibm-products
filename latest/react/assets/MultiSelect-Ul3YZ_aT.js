import{P as l,b as ht,c as mt,u as It,a as yt,k as A,d as R,_ as V,e as xt,f as St,s as bt,h as wt,bZ as _e,l as Ee,S as vt,Y as $e,E as Ae,g as Ce}from"./index-4poXP75K.js";import{u as Te,L as z,a as _t,b as Et}from"./index-CK_d43HR.js";import{g as $t}from"./_commonjsHelpers-Cpj98o6Y.js";import{r as i,e as u}from"./index-DtHxqM--.js";import{m as At}from"./mergeRefs-91-mP8KM.js";import{F as Ct}from"./FormContext-C4Nuixum.js";import{C as Ft}from"./Checkbox-BrqLuRFj.js";import{n as Ot}from"./events-CdfZZS3f.js";import{A as Tt}from"./index-CVEmjZFv.js";import{i as Pt}from"./utils--12iVJsW.js";import{W as Bt,a as Dt}from"./bucket-19-D8xKEiK4.js";var se,Fe;function Mt(){if(Fe)return se;Fe=1;var o=typeof Element<"u",p=typeof Map=="function",f=typeof Set=="function",_=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function m(t,s){if(t===s)return!0;if(t&&s&&typeof t=="object"&&typeof s=="object"){if(t.constructor!==s.constructor)return!1;var c,r,g;if(Array.isArray(t)){if(c=t.length,c!=s.length)return!1;for(r=c;r--!==0;)if(!m(t[r],s[r]))return!1;return!0}var h;if(p&&t instanceof Map&&s instanceof Map){if(t.size!==s.size)return!1;for(h=t.entries();!(r=h.next()).done;)if(!s.has(r.value[0]))return!1;for(h=t.entries();!(r=h.next()).done;)if(!m(r.value[1],s.get(r.value[0])))return!1;return!0}if(f&&t instanceof Set&&s instanceof Set){if(t.size!==s.size)return!1;for(h=t.entries();!(r=h.next()).done;)if(!s.has(r.value[0]))return!1;return!0}if(_&&ArrayBuffer.isView(t)&&ArrayBuffer.isView(s)){if(c=t.length,c!=s.length)return!1;for(r=c;r--!==0;)if(t[r]!==s[r])return!1;return!0}if(t.constructor===RegExp)return t.source===s.source&&t.flags===s.flags;if(t.valueOf!==Object.prototype.valueOf&&typeof t.valueOf=="function"&&typeof s.valueOf=="function")return t.valueOf()===s.valueOf();if(t.toString!==Object.prototype.toString&&typeof t.toString=="function"&&typeof s.toString=="function")return t.toString()===s.toString();if(g=Object.keys(t),c=g.length,c!==Object.keys(s).length)return!1;for(r=c;r--!==0;)if(!Object.prototype.hasOwnProperty.call(s,g[r]))return!1;if(o&&t instanceof Element)return!1;for(r=c;r--!==0;)if(!((g[r]==="_owner"||g[r]==="__v"||g[r]==="__o")&&t.$$typeof)&&!m(t[g[r]],s[g[r]]))return!1;return!0}return t!==t&&s!==s}return se=function(s,c){try{return m(s,c)}catch(r){if((r.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw r}},se}var kt=Mt();const Pe=$t(kt),Lt={compareItems:l.func,sortItems:l.func},jt=(o,p,{locale:f})=>o.localeCompare(p,f,{numeric:!0}),Nt=(o,{selectedItems:p=[],itemToString:f,compareItems:_,locale:m="en"})=>o.sort((t,s)=>{if(t.isSelectAll)return-1;if(s.isSelectAll)return 1;const c=p.includes(t),r=p.includes(s);return c&&!r?-1:r&&!c?1:_(f(t),f(s),{locale:m})}),Oe=({isControlled:o,isMounted:p,onChangeHandlerControlled:f,onChangeHandlerUncontrolled:_,selectedItems:m})=>{o?p&&f&&setTimeout(()=>{f({selectedItems:m})},0):_(m)},Rt=({disabled:o,onChange:p,initialSelectedItems:f=[],selectedItems:_,selectAll:m=!1,filteredItems:t=[]})=>{const s=i.useRef(!1),c=i.useRef(p),[r,g]=i.useState(f),h=!!_,x=h?_:r,Y=i.useCallback(E=>{if(o)return;const K=t.filter(b=>!(b!=null&&b.disabled)),Z=t.filter(b=>b==null?void 0:b.disabled).length;let w;if(E!=null&&E.isSelectAll&&x.length>0)w=[];else if(E!=null&&E.isSelectAll&&x.length===0)w=K;else{const b=x.findLastIndex(C=>Pe(C,E));b===-1?(w=x.concat(E),m&&t.length-1===w.length+Z&&(w=K)):(w=zt(x,b),w=w.filter(C=>!(C!=null&&C.isSelectAll)))}Oe({isControlled:h,isMounted:s.current,onChangeHandlerControlled:c.current,onChangeHandlerUncontrolled:g,selectedItems:w})},[o,x,t,m,h]),S=i.useCallback(()=>{o||Oe({isControlled:h,isMounted:s.current,onChangeHandlerControlled:c.current,onChangeHandlerUncontrolled:g,selectedItems:[]})},[o,h]);return i.useEffect(()=>{c.current=p},[p]),i.useEffect(()=>{s.current&&c.current&&!h&&c.current({selectedItems:x})},[h,x]),i.useEffect(()=>(s.current=!0,()=>{s.current=!1}),[]),{clearSelection:S,onItemChange:Y,selectedItems:x}},zt=(o,p)=>{const f=o.slice();return f.splice(p,1),f},{ItemClick:Kt,ToggleButtonBlur:qt,ToggleButtonKeyDownArrowDown:Ht,ToggleButtonKeyDownArrowUp:Ut,ToggleButtonKeyDownEnter:Wt,ToggleButtonKeyDownEscape:Vt,ToggleButtonKeyDownSpaceButton:Yt,ItemMouseMove:Zt,MenuMouseLeave:Gt,ToggleButtonClick:Jt,ToggleButtonKeyDownPageDown:Qt,ToggleButtonKeyDownPageUp:Xt,FunctionSetHighlightedIndex:es}=Te.stateChangeTypes,ts=o=>typeof o=="string"?o:typeof o=="number"?`${o}`:o!==null&&typeof o=="object"&&"label"in o&&typeof o.label=="string"?o.label:"",Be=u.forwardRef(({autoAlign:o=!1,className:p,decorator:f,id:_,items:m,itemToElement:t,itemToString:s=ts,titleText:c=!1,hideLabel:r,helperText:g,label:h,type:x="default",size:Y,disabled:S=!1,initialSelectedItems:E=[],sortItems:K=Nt,compareItems:Z=jt,clearSelectionText:w="To clear selection, press Delete or Backspace",clearAnnouncement:b="all items have been cleared",clearSelectionDescription:C="Total items selected: ",light:De,invalid:$,invalidText:Me,warn:q,warnText:ke,useTitleInItem:Le,translateWithId:ne,downshiftProps:je,open:P=!1,selectionFeedback:le="top-after-reopen",onChange:Ne,onMenuChange:re,direction:oe="bottom",selectedItems:ae,readOnly:D,locale:Re="en",slug:G},ze)=>{const F=i.useMemo(()=>m.filter(e=>{if(typeof e=="object"&&e!==null){for(const d in e)if(Object.hasOwn(e,d)&&e[d]===void 0)return!1}return!0}),[m]);let M=F.some(e=>e.isSelectAll);(ae??[]).length>0&&M&&(console.warn("Warning: `selectAll` should not be used when `selectedItems` is provided. Please pass either `selectAll` or `selectedItems`, not both."),M=!1);const n=ht(),{isFluid:J}=i.useContext(Ct),ce=mt(),[ss,Q]=i.useState(!1),[ie,k]=i.useState(!1),[v,Ke]=i.useState(P||!1),[qe,He]=i.useState(P),[Ue,We]=i.useState([]),[Ve,ue]=i.useState(!1),O=It("enable-v12-dynamic-floating-styles")||o,{refs:B,floatingStyles:fe,middlewareData:de}=yt(O?{placement:oe,strategy:"fixed",middleware:[o&&St({crossAxis:!1}),bt({apply({rects:e,elements:d}){Object.assign(d.floating.style,{width:`${e.reference.width}px`})}}),o&&wt()],whileElementsMounted:xt}:{});i.useLayoutEffect(()=>{var e;if(O){const d={...fe,visibility:(e=de.hide)!=null&&e.referenceHidden?"hidden":"visible"};Object.keys(d).forEach(a=>{B.floating.current&&(B.floating.current.style[a]=d[a])})}},[O,fe,B.floating,de,P]);const{selectedItems:H,onItemChange:pe,clearSelection:ge}=Rt({disabled:S,initialSelectedItems:E,onChange:Ne,selectedItems:ae,selectAll:M,filteredItems:F}),X={selectedItems:H,itemToString:s,compareItems:Z,locale:Re},Ye={stateReducer:ot,isOpen:v,itemToString:e=>Array.isArray(e)&&e.map(function(d){return s(d)}).join(", ")||"",selectedItem:H,items:F,isItemDisabled(e,d){return e==null?void 0:e.disabled},...je},{getToggleButtonProps:Ze,getLabelProps:Ge,getMenuProps:he,getItemProps:Je,selectedItem:Qe,highlightedIndex:Xe,setHighlightedIndex:me}=Te(Ye),Ie=Ze({onFocus:()=>{k(!0)},onBlur:()=>{k(!1)},onKeyDown:e=>{S||((A(e,_e)||A(e,Ee))&&!v&&(ge(),e.stopPropagation()),!v&&A(e,_e)&&I.length>0&&ue(!0),(A(e,vt)||A(e,$e)||A(e,Ae))&&!v&&(me(0),ue(!1),U(!0)),A(e,$e)&&I.length===0&&(k(!1),Q(!1)),A(e,Ee)&&v&&k(!0),A(e,Ae)&&v&&k(!0))}}),ee=At(Ie.ref,ze),I=Qe,U=e=>{Ke(e),re&&re(e)};qe!==P&&(U(P),He(P));const T=x==="inline",ye=!$&&q,et=R(`${n}--multi-select__wrapper`,`${n}--list-box__wrapper`,p,{[`${n}--multi-select__wrapper--inline`]:T,[`${n}--list-box__wrapper--inline`]:T,[`${n}--multi-select__wrapper--inline--invalid`]:T&&$,[`${n}--list-box__wrapper--inline--invalid`]:T&&$,[`${n}--list-box__wrapper--fluid--invalid`]:J&&$,[`${n}--list-box__wrapper--slug`]:G,[`${n}--list-box__wrapper--decorator`]:f}),tt=R(`${n}--label`,{[`${n}--label--disabled`]:S,[`${n}--visually-hidden`]:r}),xe=g?`multiselect-helper-text-${ce}`:void 0,st=`multiselect-field-label-${ce}`,nt=R(`${n}--form__helper-text`,{[`${n}--form__helper-text--disabled`]:S}),lt=R(`${n}--multi-select`,{[`${n}--multi-select--invalid`]:$,[`${n}--multi-select--invalid--focused`]:$&&ie,[`${n}--multi-select--warning`]:ye,[`${n}--multi-select--inline`]:T,[`${n}--multi-select--selected`]:I&&I.length>0,[`${n}--list-box--up`]:oe==="top",[`${n}--multi-select--readonly`]:D,[`${n}--autoalign`]:O,[`${n}--multi-select--selectall`]:M}),rt=t;le==="fixed"?X.selectedItems=[]:le==="top-after-reopen"&&(X.selectedItems=Ue);function ot(e,d){const{changes:a,props:L,type:j}=d,{highlightedIndex:y}=a;switch(a.isOpen&&!v&&We(H),j){case Yt:case Wt:if(a.selectedItem===void 0||Array.isArray(a.selectedItem))break;return pe(a.selectedItem),{...a,highlightedIndex:e.highlightedIndex};case qt:case Vt:U(!1);break;case Jt:return U(a.isOpen||!1),{...a,highlightedIndex:H.length>0?0:void 0};case Kt:return me(a.selectedItem),pe(a.selectedItem),{...a,highlightedIndex:e.highlightedIndex};case Gt:return{...a,highlightedIndex:e.highlightedIndex};case es:return v?{...a,highlightedIndex:F.indexOf(y)}:{...a,highlightedIndex:0};case Ht:case Ut:case Qt:case Xt:if(y>-1){const te=document.querySelectorAll(`li.${n}--list-box__menu-item[role="option"]`);L.scrollIntoView(te[y])}return y===-1?{...a,highlightedIndex:0}:a;case Zt:return{...a,highlightedIndex:e.highlightedIndex}}return a}const at=R(`${n}--list-box__field--wrapper`,{[`${n}--list-box__field--wrapper--input-focused`]:ie}),Se=e=>{e.target.classList.contains(`${n}--tag__close-icon`)?Q(!1):Q(e.type==="focus")},ct=D?{onClick:e=>{e.preventDefault(),ee.current!==void 0&&ee.current.focus()},onKeyDown:e=>{["ArrowDown","ArrowUp"," ","Enter"].includes(e.key)&&e.preventDefault()}}:{},be=G??f,we=Pt(be,Tt)?i.cloneElement(be,{size:"mini"}):null,it=I.length>0&&I.map(e=>e==null?void 0:e.text),ut=M?I.filter(e=>!e.isSelectAll).length:I.length,ft=i.useMemo(()=>he({ref:O?B.setFloating:null}),[O,he,B.setFloating]),ve=Ge(),dt=i.isValidElement(c)?{id:ve.id}:ve,pt=i.useCallback((e,d)=>{const a=e.some(y=>!y.isSelectAll),L=e.filter(y=>!y.isSelectAll).length,j=d.filter(y=>!y.isSelectAll&&!y.disabled).length;return{hasIndividualSelections:a,nonSelectAllSelectedCount:L,totalSelectableCount:j}},[I,F]);return u.createElement("div",{className:et},u.createElement("label",V({className:tt},dt),c&&c,I.length>0&&u.createElement("span",{className:`${n}--visually-hidden`},C," ",I.length," ",it,",",w)),u.createElement(z,{onFocus:J?Se:void 0,onBlur:J?Se:void 0,type:x,size:Y,className:lt,disabled:S,light:De,invalid:$,invalidText:Me,warn:q,warnText:ke,isOpen:v,id:_},$&&u.createElement(Bt,{className:`${n}--list-box__invalid-icon`}),ye&&u.createElement(Dt,{className:`${n}--list-box__invalid-icon ${n}--list-box__invalid-icon--warning`}),u.createElement("div",{className:at,ref:O?B.setReference:null},I.length>0&&u.createElement(z.Selection,{readOnly:D,clearSelection:!S&&!D?ge:Ot,selectionCount:ut,translateWithId:ne,disabled:S}),u.createElement("button",V({type:"button",className:`${n}--list-box__field`,disabled:S,"aria-disabled":S||D,"aria-describedby":!T&&!$&&!q&&g?xe:void 0},Ie,{ref:ee},ct),u.createElement("span",{id:st,className:`${n}--list-box__label`},h),u.createElement(z.MenuIcon,{isOpen:v,translateWithId:ne})),G?we:f?u.createElement("div",{className:`${n}--list-box__inner-wrapper--decorator`},we):""),u.createElement(z.Menu,ft,v&&K(F,X).map((e,d)=>{const a=I.filter(gt=>Pe(gt,e)).length>0,{hasIndividualSelections:L,nonSelectAllSelectedCount:j,totalSelectableCount:y}=pt(I,F),te=e.isSelectAll&&L&&j<y,N=Je({item:e,"aria-selected":a}),W=s(e);return u.createElement(z.MenuItem,V({key:N.id,isActive:a&&!e.isSelectAll,"aria-label":W,isHighlighted:Xe===d,title:W,disabled:N["aria-disabled"]},N),u.createElement("div",{className:`${n}--checkbox-wrapper`},u.createElement(Ft,{id:`${N.id}__checkbox`,labelText:t?u.createElement(rt,V({key:N.id},e)):W,checked:a,title:Le?W:void 0,indeterminate:te,disabled:S})))})),Ve&&u.createElement("span",{"aria-live":"assertive","aria-label":b})),!T&&!$&&!q&&g&&u.createElement("div",{id:xe,className:nt},g))});Be.displayName="MultiSelect";Be.propTypes={...Lt,autoAlign:l.bool,className:l.string,clearSelectionDescription:l.string,clearSelectionText:l.string,compareItems:l.func,decorator:l.node,direction:l.oneOf(["top","bottom"]),disabled:l.bool,downshiftProps:l.object,helperText:l.node,hideLabel:l.bool,id:l.string.isRequired,initialSelectedItems:l.array,invalid:l.bool,invalidText:l.node,itemToElement:l.func,itemToString:l.func,items:l.array.isRequired,label:l.node.isRequired,light:Ce(l.bool),locale:l.string,onChange:l.func,onMenuChange:l.func,open:l.bool,readOnly:l.bool,selectedItems:l.array,selectionFeedback:l.oneOf(["top","fixed","top-after-reopen"]),size:Et,slug:Ce(l.node),sortItems:l.func,titleText:l.node,translateWithId:l.func,type:_t,useTitleInItem:l.bool,warn:l.bool,warnText:l.node};export{Be as M,jt as a,Nt as d,Pe as i,Lt as s,Rt as u};
