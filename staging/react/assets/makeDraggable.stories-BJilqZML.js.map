{"version":3,"file":"makeDraggable.stories-BJilqZML.js","sources":["../../src/global/js/utils/makeDraggable/makeDraggable.mdx","../../src/global/js/utils/makeDraggable/makeDraggable.stories.tsx"],"sourcesContent":["import { Story, Canvas } from '@storybook/addon-docs/blocks';\nimport { makeDraggable } from '.';\nimport * as makeDraggableStories from './makeDraggable.stories';\n\n# makeDraggable\n\n## Table of Contents\n\n- [Overview](#overview)\n- [Example usage](#example-usage)\n- [Example implementation](#example-implementation)\n\n## Overview\n\nThe `makeDraggable` utility enables an HTML element to be draggable using either\nmouse or keyboard interactions. It allows developers to specify an HTML element\nas a required attribute to be moved, optional HTML element to initiate the\ndrag(e.g., a header), optional HTML element to focus on drag for keyboard\ninteraction (e.g., an icon) and an optional pixel value that defines the\ndistance to move when dragging with arrow keys (default: 8px) and shift arrow\nkeys (default: 32px).\n\n## Example usage\n\n```jsx\nmakeDraggable({\n  el: dialogRef.current,\n  handle: headerRef.current,\n  focusableInHandle: dragRef.current,\n});\n```\n\n```jsx\n<Popover open={isOpen} ref={dialogRef} className=\"popover\">\n  <Button\n    aria-expanded={isOpen}\n    onClick={() => {\n      setIsOpen(!isOpen);\n    }}\n  >\n    Toggle\n  </Button>\n\n  <PopoverContent className=\"popover-content\">\n    <header ref={headerRef} className={`popover-header popover-title`}>\n      <Button\n        kind=\"ghost\"\n        ref={dragRef}\n        className=\"drag-icon\"\n        onClick={() => console.log('clicked')}\n      >\n        <Draggable />\n      </Button>\n      <Button\n        kind=\"ghost\"\n        onClick={() => setIsOpen(false)}\n        className=\"close-icon\"\n      >\n        <Close />\n      </Button>\n    </header>\n    <p className=\"heading\"> Available storage</p>\n    <p className=\"popover-details\">\n      This server has 150 GB of block storage remaining.\n    </p>\n  </PopoverContent>\n</Popover>\n```\n\n## Example implementation\n\n<Canvas>\n  <Story of={makeDraggableStories.DraggablePopover} />\n</Canvas>\n","/**\n * Copyright IBM Corp. 2025, 2025\n *\n * This source code is licensed under the Apache-2.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React, { useEffect, useRef, useState } from 'react';\nimport { makeDraggable } from './makeDraggable';\nimport './_storybook-styles.scss';\nimport mdx from './makeDraggable.mdx';\nimport { Button, Popover, PopoverContent } from '@carbon/react';\nimport { Close, Draggable } from '@carbon/react/icons';\n\n// Note: This story is referenced in Core Carbon. Please ensure that any alterations or removals are reflected in Core Carbon as well.\n\nexport default {\n  title: 'Utilities/makeDraggable',\n  parameters: {\n    layout: 'padded',\n    docs: {\n      page: mdx,\n    },\n  },\n  tags: ['autodocs'],\n};\n\nconst DraggableDiv = () => {\n  const dialogRef = useRef<HTMLDivElement | null>(null);\n  const headerRef = useRef<HTMLDivElement | null>(null);\n  const dragRef = useRef<HTMLButtonElement | null>(null);\n  useEffect(() => {\n    const dialogElement = dialogRef.current;\n    if (dialogElement && headerRef.current && dragRef.current) {\n      const draggable = makeDraggable({\n        el: dialogElement,\n        dragHandle: headerRef.current,\n        focusableDragHandle: dragRef.current,\n      });\n\n      const onDragStart = () => {\n        if (dialogElement) {\n          dialogElement.classList.add('is-dragging');\n          dialogElement.setAttribute(\n            'aria-label',\n            'Picked up the draggable Dialog'\n          );\n        }\n      };\n\n      const onDragEnd = () => {\n        if (dialogElement) {\n          dialogElement.classList.remove('is-dragging');\n          dialogElement.setAttribute(\n            'aria-label',\n            'draggable Dialog was dropped'\n          );\n        }\n      };\n\n      dialogElement.addEventListener('dragstart', onDragStart);\n      dialogElement.addEventListener('dragend', onDragEnd);\n\n      // Clean up attached event listeners\n      return () => {\n        if (dialogElement) {\n          dialogElement.removeEventListener('dragstart', onDragStart);\n          dialogElement.removeEventListener('dragend', onDragEnd);\n        }\n        draggable.cleanup(); // Call the cleanup function from makeDraggable\n      };\n    }\n    //eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [dialogRef.current, headerRef.current, dragRef.current]);\n\n  return (\n    <div className=\"mt-10 flex justify-center\">\n      <div ref={dialogRef} className=\"draggable__div\">\n        <div ref={headerRef} className=\"draggable__div-header\">\n          <header ref={headerRef} className={`div-header`}>\n            <Button\n              kind=\"ghost\"\n              ref={dragRef}\n              className=\"drag-icon-div\"\n              aria-describedby=\"drag-instructions\"\n            >\n              <Draggable />\n            </Button>\n            <span id=\"drag-instructions\" className=\"sr-only\">\n              To pick up the draggable item, press Enter. While dragging, use\n              the arrow keys to move the item. Press Enter again to leave the\n              item in its new position.\n            </span>\n          </header>\n        </div>\n        <div className=\"draggable__div-body\">\n          <p>This server has 150 GB of block storage remaining.</p>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nconst DraggablePopoverTemplate = () => {\n  const [isOpen, setIsOpen] = useState(true);\n  const dialogRef = useRef<HTMLDivElement | null>(null);\n  const headerRef = useRef<HTMLDivElement | null>(null);\n  const dragRef = useRef<HTMLButtonElement | null>(null);\n\n  useEffect(() => {\n    if (isOpen && dialogRef.current && headerRef.current && dragRef.current) {\n      const dragContainer = dialogRef.current.querySelector('.cds--popover');\n      const dragStyleContainer = dialogRef.current.querySelector(\n        '.cds--popover-content'\n      );\n      if (dragContainer instanceof HTMLElement) {\n        dragContainer.style.transform = 'none';\n        dragContainer.style.left = '0px';\n        dragContainer.style.top = '0px';\n        const draggable = makeDraggable({\n          el: dragContainer,\n          dragHandle: headerRef.current,\n          focusableDragHandle: dragRef.current,\n        });\n\n        const onDragStart = () => {\n          if (dragContainer && dragStyleContainer) {\n            dragStyleContainer.classList.add('is-dragging');\n            dragStyleContainer.setAttribute(\n              'aria-label',\n              'Picked up the draggable popover'\n            );\n          }\n        };\n\n        const onDragEnd = () => {\n          if (dragContainer && dragStyleContainer) {\n            dragStyleContainer.classList.remove('is-dragging');\n            dragStyleContainer.setAttribute(\n              'aria-label',\n              'draggable popover was dropped'\n            );\n          }\n        };\n\n        dragContainer.addEventListener('dragstart', onDragStart);\n        dragContainer.addEventListener('dragend', onDragEnd);\n\n        //Clean up attached event listeners\n        return () => {\n          dragContainer.removeEventListener('dragstart', onDragStart);\n          dragContainer.removeEventListener('dragend', onDragEnd);\n          draggable.cleanup(); // Call the cleanup function from makeDraggable\n        };\n      }\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [isOpen, dialogRef.current, dragRef.current]);\n  return (\n    <div className=\"mt-10 flex justify-center\">\n      <Popover open={isOpen} caret={false} ref={dialogRef} className=\"popover\">\n        <Button\n          aria-expanded={isOpen}\n          onClick={() => {\n            setIsOpen(!isOpen);\n          }}\n        >\n          Toggle\n        </Button>\n\n        <PopoverContent className=\"popover-content\">\n          <header ref={headerRef} className={`popover-header popover-title`}>\n            <Button\n              kind=\"ghost\"\n              ref={dragRef}\n              className=\"drag-icon\"\n              onClick={() => console.log('clicked')}\n              aria-describedby=\"drag-instructions\"\n            >\n              <Draggable />\n            </Button>\n            <span id=\"drag-instructions\" className=\"sr-only\">\n              To pick up the draggable item, press Enter. While dragging, use\n              the arrow keys to move the item. Press Enter again to leave the\n              item in its new position.\n            </span>\n            <Button\n              kind=\"ghost\"\n              onClick={() => setIsOpen(false)}\n              className=\"close-icon\"\n            >\n              <Close />\n            </Button>\n          </header>\n          <p className=\"heading\"> Available storage</p>\n          <p className=\"popover-details\">\n            This server has 150 GB of block storage remaining.\n          </p>\n        </PopoverContent>\n      </Popover>\n    </div>\n  );\n};\n\nexport const DraggableCustomDiv = DraggableDiv.bind({});\n\nexport const DraggablePopover = DraggablePopoverTemplate.bind({});\n"],"names":["_createMdxContent","props","_components","_provideComponents","_jsxs","_Fragment","_jsx","Canvas","Story","makeDraggableStories.DraggablePopover","MDXContent","MDXLayout","makeDraggable_stories","title","parameters","layout","docs","page","mdx","tags","DraggableDiv","dialogRef","useRef","headerRef","dragRef","useEffect","dialogElement","current","draggable","makeDraggable","el","dragHandle","focusableDragHandle","onDragStart","classList","add","setAttribute","onDragEnd","remove","addEventListener","removeEventListener","cleanup","React","Button","Draggable","DraggablePopoverTemplate","isOpen","setIsOpen","useState","dragContainer","querySelector","dragStyleContainer","HTMLElement","style","transform","left","top","Popover","PopoverContent","console","log","Close","DraggableCustomDiv","bind","DraggablePopover","source","originalSource"],"mappings":"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"}