import{r as c,n as W,u as Te,k as ye,i as Ce,N as Ee,c as w,e as l,_ as Ne,P as t,g as U}from"./iframe-BBf3bqTv.js";import{F as Re}from"./FormContext-CW3fTVyM.js";import{g as Ie}from"./TextInput-McvUY1bW.js";import{T as v}from"./Text-CaNb5F2n.js";import{A as Ae}from"./index-DOwP6x5e.js";import{i as We}from"./utils-BgfmaY2S.js";import{W as X,a as Y}from"./bucket-19-zmdOpOwk.js";const Le=c.forwardRef,Z=Le((ee,te)=>{const{className:ae,decorator:C,disabled:u=!1,id:b,labelText:L,hideLabel:re,onChange:D=W,onClick:O=W,onKeyDown:F=W,invalid:o=!1,invalidText:ne="",helperText:_="",light:le,placeholder:se="",enableCounter:p=!1,maxCount:n,counterMode:s="character",warn:m=!1,warnText:oe="",rows:ie=4,slug:E,...f}=ee,e=Te(),{isFluid:i}=c.useContext(Re),{defaultValue:k,value:P}=f,ce=ye(),N=c.useRef(null),d=c.useRef(null),z=c.useRef(null),V=c.useRef(null),q=c.useRef(null),de=Ce([te,d]);function K(){const r=(k||P||d.current?.value||"").toString();return s==="character"?r.length:r.match(new RegExp("\\p{L}+","gu"))?.length||0}const[$,x]=c.useState(K());c.useEffect(()=>{x(K())},[P,k,s]),Ee(()=>{if(f.cols&&d.current?(d.current.style.width="",d.current.style.resize="none"):d.current&&(d.current.style.width="100%"),!N.current)return;const a=g=>{[z,V,q].forEach(y=>{y.current&&(y.current.style.maxWidth=`${g}px`,y.current.style.overflowWrap="break-word")})},r=new ResizeObserver(([g])=>{a(g.contentRect.width)});return r.observe(N.current),()=>r&&r.disconnect()},[f.cols,o,m]);const M={id:b,onKeyDown:a=>{if(!u&&p&&s==="word"){const r=a.which;(n&&$>=n&&r===32||n&&$>=n&&r===13)&&a.preventDefault()}!u&&F&&F(a)},onPaste:a=>{if(!u&&s==="word"&&p&&typeof n<"u"&&d.current!==null){const r=d.current.value.match(new RegExp("\\p{L}+","gu"))||[],g=a.clipboardData.getData("Text").match(new RegExp("\\p{L}+","gu"))||[];if(r.length+g.length>n){a.preventDefault();const $e=r.concat(g).slice(0,n);setTimeout(()=>{x(n)},0),d.current.value=$e.join(" ")}}},onChange:a=>{if(!u){if(s=="character")a?.persist?.(),setTimeout(()=>{x(a.target?.value?.length)},0);else if(s=="word"){if(!a.target.value)setTimeout(()=>{x(0)},0);else if(p&&typeof n<"u"&&d.current!==null){const r=a.target?.value?.match(new RegExp("\\p{L}+","gu"));r&&r.length<=n?(d.current.removeAttribute("maxLength"),setTimeout(()=>{x(r.length)},0)):r&&r.length>n&&setTimeout(()=>{x(r.length)},0)}}D&&D(a)}},onClick:a=>{!u&&O&&O(a)}},ue=w(`${e}--form-item`,ae),me=w(`${e}--text-area__wrapper`,{[`${e}--text-area__wrapper--cols`]:f.cols,[`${e}--text-area__wrapper--readonly`]:f.readOnly,[`${e}--text-area__wrapper--warn`]:m,[`${e}--text-area__wrapper--slug`]:E,[`${e}--text-area__wrapper--decorator`]:C}),fe=w(`${e}--label`,{[`${e}--visually-hidden`]:re&&!i,[`${e}--label--disabled`]:u}),pe=w(`${e}--text-area`,{[`${e}--text-area--light`]:le,[`${e}--text-area--invalid`]:o,[`${e}--text-area--warn`]:m}),xe=w(`${e}--label`,{[`${e}--label--disabled`]:u,[`${e}--text-area__label-counter`]:!0}),he=w(`${e}--form__helper-text`,{[`${e}--form__helper-text--disabled`]:u}),ge=L?l.createElement(v,{as:"label",htmlFor:b,className:fe},L):null,we=p&&n&&(s==="character"||s==="word")?l.createElement(v,{as:"div",className:xe,"aria-hidden":"true"},`${$}/${n}`):null,R=p&&n?`${b}-counter-desc`:void 0,I=_?`text-area-helper-text-${ce}`:void 0,be=_?l.createElement(v,{as:"div",id:I,className:he,ref:z},_):null,S=b+"-error-msg",j=o?l.createElement(v,{as:"div",role:"alert",className:`${e}--form-requirement`,id:S,ref:V},ne,i&&l.createElement(X,{className:`${e}--text-area__invalid-icon`})):null,B=b+"-warn-msg",G=m?l.createElement(v,{as:"div",role:"alert",className:`${e}--form-requirement`,id:B,ref:q},oe,i&&l.createElement(Y,{className:`${e}--text-area__invalid-icon ${e}--text-area__invalid-icon--warning`})):null;let T;if(o)T=S;else if(m&&!i)T=B;else{const a=[];!i&&_&&I&&a.push(I),R&&a.push(R),T=a.length>0?a.join(" "):void 0}p&&s=="character"&&(M.maxLength=n);const H=c.useRef(null),[J,ve]=c.useState(""),h=Ie($,n,s==="word"?"word":void 0,s==="word"?"words":void 0);c.useEffect(()=>{if(h&&h!==J){const a=H.current;if(a){a.textContent="";const r=setTimeout(()=>{a&&(a.textContent=h,ve(h))},s==="word"?2e3:1e3);return()=>{r&&clearTimeout(r)}}}},[h,J,s]);const _e=l.createElement("textarea",Ne({},f,M,{placeholder:se,"aria-readonly":!!f.readOnly,className:pe,"aria-invalid":o,"aria-describedby":T,disabled:u,rows:ie,readOnly:f.readOnly,ref:de})),A=E??C,Q=We(A,Ae)?c.cloneElement(A,{size:"mini"}):A;return l.createElement("div",{className:ue},l.createElement("div",{className:`${e}--text-area__label-wrapper`},ge,we),p&&n&&l.createElement("span",{id:R,className:`${e}--visually-hidden`},s==="word"?`Word limit ${n}`:`Character limit ${n}`),l.createElement("div",{ref:N,className:me,"data-invalid":o||null},o&&!i&&l.createElement(X,{className:`${e}--text-area__invalid-icon`}),m&&!o&&!i&&l.createElement(Y,{className:`${e}--text-area__invalid-icon ${e}--text-area__invalid-icon--warning`}),_e,E?Q:C?l.createElement("div",{className:`${e}--text-area__inner-wrapper--decorator`},Q):"",l.createElement("span",{className:`${e}--text-area__counter-alert`,role:"alert","aria-live":"assertive","aria-atomic":"true",ref:H},h),i&&l.createElement("hr",{className:`${e}--text-area__divider`}),i&&o?j:null,i&&m&&!o?G:null),!o&&!m&&!i?be:null,o&&!i?j:null,m&&!o&&!i?G:null)});Z.displayName="TextArea";Z.propTypes={className:t.string,cols:t.number,counterMode:t.oneOf(["character","word"]),decorator:t.node,defaultValue:t.oneOfType([t.string,t.number]),disabled:t.bool,enableCounter:t.bool,helperText:t.node,hideLabel:t.bool,id:t.string,invalid:t.bool,invalidText:t.node,labelText:t.node.isRequired,light:U(t.bool),maxCount:t.number,onChange:t.func,onClick:t.func,onKeyDown:t.func,placeholder:t.string,readOnly:t.bool,rows:t.number,slug:U(t.node),value:t.oneOfType([t.string,t.number]),warn:t.bool,warnText:t.node};export{Z as T};
//# sourceMappingURL=TextArea-B0JebsSx.js.map
