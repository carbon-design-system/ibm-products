import{u as De,a as Ne,b as Oe,c as _,_ as g,d as J,s as Pe,f as Fe,h as Le,e as Re}from"./floating-ui.dom.mjs-BB6krl5l.js";import{R as l,r as m}from"./index-BwDkhjyp.js";import{u as X,L as $,a as ke,b as Me}from"./index-w543ERq7.js";import{P as t}from"./index-Dk74W0Oi.js";import{m as ze}from"./mergeRefs-CTUecegF.js";import{F as Be}from"./FormContext-C7kRVu4t.js";import{W as Ke,a as We}from"./bucket-18-D0nV4up4.js";import{C as qe}from"./events-b0qlIvq_.js";const{ItemMouseMove:He,MenuMouseLeave:Ue}=X.stateChangeTypes,Q=i=>typeof i=="string"?i:typeof i=="number"?`${i}`:i!==null&&typeof i=="object"&&"label"in i&&typeof i.label=="string"?i.label:"",Y=l.forwardRef((i,Z)=>{var G;let{autoAlign:d=!1,className:ee,disabled:h=!1,direction:C="bottom",items:j,label:D,["aria-label"]:te,ariaLabel:ne,itemToString:u=Q,itemToElement:N=null,renderSelectedItem:O,type:oe="default",size:I,onChange:P,id:le,titleText:F="",hideLabel:ie,helperText:T="",translateWithId:se,light:L,invalid:a,invalidText:re,warn:w,warnText:ae,initialSelectedItem:de,selectedItem:R,downshiftProps:ce,readOnly:v,slug:y,...pe}=i;const{refs:f,floatingStyles:k,middlewareData:ue}=De(d?{placement:C,strategy:"fixed",middleware:[Pe({apply(e){let{rects:o,elements:s}=e;Object.assign(s.floating.style,{width:`${o.reference.width}px`})}}),Fe(),Le()],whileElementsMounted:Re}:{});m.useEffect(()=>{var e;if(d){const o={...k,visibility:(e=ue.hide)!=null&&e.referenceHidden?"hidden":"visible"};Object.keys(o).forEach(s=>{f.floating.current&&(f.floating.current.style[s]=o[s])})}},[k,d,f.floating]);const n=Ne(),{isFluid:E}=m.useContext(Be),M={items:j,itemToString:u,initialSelectedItem:de,onSelectedItemChange:ve,stateReducer:me,isItemDisabled(e,o){return e!==null&&typeof e=="object"&&"disabled"in e&&e.disabled===!0},onHighlightedIndexChange:e=>{let{highlightedIndex:o}=e;if(o>-1&&typeof window!==void 0){const r=document.querySelectorAll(`li.${n}--list-box__menu-item[role="option"]`)[o];r&&r.scrollIntoView({behavior:"smooth",block:"nearest"})}},...ce},fe=Oe();function me(e,o){const{changes:s,type:r}=o;switch(r){case He:case Ue:return{...s,highlightedIndex:e.highlightedIndex}}return s}R!==void 0&&(M.selectedItem=R);const{isOpen:b,getToggleButtonProps:be,getLabelProps:ge,getMenuProps:z,getItemProps:he,selectedItem:c,highlightedIndex:we}=X(M),p=oe==="inline",B=!a&&w,[ye,xe]=m.useState(!1),_e=_(`${n}--dropdown`,{[`${n}--dropdown--invalid`]:a,[`${n}--dropdown--warning`]:B,[`${n}--dropdown--open`]:b,[`${n}--dropdown--inline`]:p,[`${n}--dropdown--disabled`]:h,[`${n}--dropdown--light`]:L,[`${n}--dropdown--readonly`]:v,[`${n}--dropdown--${I}`]:I,[`${n}--list-box--up`]:C==="top",[`${n}--autoalign`]:d}),$e=_(`${n}--label`,{[`${n}--label--disabled`]:h,[`${n}--visually-hidden`]:ie}),Ie=_(`${n}--form__helper-text`,{[`${n}--form__helper-text--disabled`]:h}),Te=_(`${n}--dropdown__wrapper`,`${n}--list-box__wrapper`,ee,{[`${n}--dropdown__wrapper--inline`]:p,[`${n}--list-box__wrapper--inline`]:p,[`${n}--dropdown__wrapper--inline--invalid`]:p&&a,[`${n}--list-box__wrapper--inline--invalid`]:p&&a,[`${n}--list-box__wrapper--fluid--invalid`]:E&&a,[`${n}--list-box__wrapper--fluid--focus`]:E&&ye&&!b,[`${n}--list-box__wrapper--slug`]:y}),K=T?`dropdown-helper-text-${fe}`:void 0,S=N,x=be({"aria-label":te||ne}),W=T&&!E?l.createElement("div",{id:K,className:Ie},T):null;function ve(e){let{selectedItem:o}=e;P&&P({selectedItem:o??null})}const q=e=>{xe(e.type==="focus")},A=ze(x.ref,Z),[H,Ee]=m.useState();let[Se,U]=m.useState(!1);const Ae=v?{onClick:e=>{e.preventDefault(),A.current!==void 0&&A.current.focus()},onKeyDown:e=>{["ArrowDown","ArrowUp"," ","Enter"].includes(e.key)&&e.preventDefault()}}:{onKeyDown:e=>{(e.code!=="Space"||!["ArrowDown","ArrowUp"," ","Enter"].includes(e.key))&&U(!0),(Se&&e.code==="Space"||!["ArrowDown","ArrowUp"," ","Enter"].includes(e.key))&&(H&&clearTimeout(H),Ee(setTimeout(()=>{U(!1)},3e3))),x.onKeyDown&&x.onKeyDown(e)}},Ce=m.useMemo(()=>z({ref:d?f.setFloating:null}),[d,z,f.setFloating]);let V;return y&&((G=y.type)==null?void 0:G.displayName)==="AILabel"&&(V=l.cloneElement(y,{size:"mini"})),l.createElement("div",g({className:Te},pe),F&&l.createElement("label",g({className:$e},ge()),F),l.createElement($,{onFocus:q,onBlur:q,size:I,className:_e,invalid:a,invalidText:re,warn:w,warnText:ae,light:L,isOpen:b,ref:d?f.setReference:null,id:le},a&&l.createElement(Ke,{className:`${n}--list-box__invalid-icon`}),B&&l.createElement(We,{className:`${n}--list-box__invalid-icon ${n}--list-box__invalid-icon--warning`}),l.createElement("button",g({type:"button",className:`${n}--list-box__field`,disabled:h,"aria-disabled":v?!0:void 0,"aria-describedby":!p&&!a&&!w&&W?K:void 0,title:c&&u!==void 0?u(c):Q(D)},x,Ae,{ref:A}),l.createElement("span",{className:`${n}--list-box__label`},c?O?O(c):u(c):D),l.createElement($.MenuIcon,{isOpen:b,translateWithId:se})),V,l.createElement($.Menu,Ce,b&&j.map((e,o)=>{const s=e!==null&&typeof e=="object",r=he({item:e,index:o});e!==null&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"id")&&(r.id=e.id);const je=s&&"text"in e&&N?e.text:u(e);return l.createElement($.MenuItem,g({key:r.id,isActive:c===e,isHighlighted:we===o,title:je,disabled:r["aria-disabled"]},r),typeof e=="object"&&S!==void 0&&S!==null?l.createElement(S,g({key:r.id},e)):u(e),c===e&&l.createElement(qe,{className:`${n}--list-box__menu-item__selected-icon`}))}))),!p&&!a&&!w&&W)});Y.displayName="Dropdown";Y.propTypes={"aria-label":t.string,ariaLabel:J(t.string),autoAlign:t.bool,className:t.string,direction:t.oneOf(["top","bottom"]),disabled:t.bool,downshiftProps:t.object,helperText:t.node,hideLabel:t.bool,id:t.string.isRequired,initialSelectedItem:t.oneOfType([t.object,t.string,t.number]),invalid:t.bool,invalidText:t.node,itemToElement:t.func,itemToString:t.func,items:t.array.isRequired,label:t.node.isRequired,light:J(t.bool),onChange:t.func,readOnly:t.bool,renderSelectedItem:t.func,selectedItem:t.oneOfType([t.object,t.string,t.number]),size:ke,slug:t.node,titleText:t.node.isRequired,translateWithId:t.func,type:Me,warn:t.bool,warnText:t.node};export{Y as D};
