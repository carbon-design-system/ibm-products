import{b as ce,d as me,P as e}from"./index-CMVdkQrl.js";import{p as $,B as T}from"./settings-C3kz8lqM.js";import{C as ue,M as ye,a as fe,b as ge}from"./ComposedModal-DK_gDe0c.js";import{F as be,a as he}from"./FileUploaderItem-FDE893jx.js";import{T as Te}from"./TextInput-CixU1YEY.js";import{r as q,e as i}from"./index-DtHxqM--.js";import{g as qe}from"./devtools-CJD9WatR.js";import{u as Ee}from"./usePortalTarget-BpuhspP7.js";import{u as z}from"./uuidv4-BN2rGLQG.js";import{b as Fe}from"./bucket-0-CHtg8bFp.js";const E="ImportModal";let c=q.forwardRef(({accept:y=[],className:C,defaultErrorBody:f,defaultErrorHeader:g,description:F,fetchErrorBody:w,fetchErrorHeader:H,fileDropHeader:v,fileDropLabel:O,fileUploadLabel:R,inputButtonIcon:k,inputButtonText:P,inputId:M,inputLabel:b,inputPlaceholder:U,invalidFileTypeErrorBody:L,invalidFileTypeErrorHeader:j,invalidIconDescription:A,maxFileSize:x,maxFileSizeErrorBody:V,maxFileSizeErrorHeader:G,onClose:S,onRequestSubmit:J,open:K,portalTarget:Q,primaryButtonText:W,secondaryButtonText:X,title:B,...Y},Z)=>{const ee=ce(),[l,m]=q.useState([]),[d,_]=q.useState(""),te=Ee(Q),re=t=>{const s=new Set(y),o=t.name,n=t.type,r=`.${o.split(".").pop()}`;return!(s.has(n)||s.has(r)||y.length===0)},h=t=>{const o=[...t.map(n=>{const r={uuid:n.uuid||z(),status:"edit",iconDescription:A,name:n.name,fileSize:n.size,invalidFileType:n.invalidFileType,fileData:n,fetchError:n.fetchError};return r.fetchError?(r.errorBody=w||f,r.errorSubject=H||g,r.invalid=!0):r.invalidFileType?(r.errorBody=L||f,r.errorSubject=j||g,r.invalid=!0):x&&((r==null?void 0:r.fileSize)??0)>x&&(r.errorBody=V||f,r.errorSubject=G||g,r.invalid=!0),r})];m(o)},ie=async t=>{t.preventDefault();const s=d.substring(d.lastIndexOf("/")+1).split("?")[0],o={name:s,status:"uploading",uuid:z()};m([o]);try{const n=await fetch(d);if(!n.ok||n.status!==200)throw new Error(`${n.status}`);const r=await n.blob(),u=new File([r],s,{type:r.type});u.invalidFileType=re(u),u.uuid=o.uuid,h([u])}catch{const r={...o,fetchError:!0};h([r])}},ne=(t,{addedFiles:s})=>{t.stopPropagation(),h(s)},ae=t=>{const s=l.filter(o=>o.uuid!==t);m(s)},se=()=>{J(l)},oe=t=>{_(t.target.value)},D=()=>{m([]),_(""),S&&S()},I=l.length,N=l.filter(t=>!t.invalid).length,p=I>0,le=!p||!(N>0),de=!d||p,pe=`${N} / ${I} ${R}`,a=`${$.prefix}--import-modal`;return te(i.createElement(ue,{...Y,open:K,ref:Z,...qe(E),"aria-label":B,className:me(a,C),size:"sm",preventCloseOnClickOutside:!0,onClose:D},i.createElement(ye,{className:`${a}__header`,title:B}),i.createElement(fe,{className:`${a}__body-container`},F&&i.createElement("p",{className:`${a}__body`},F),v&&i.createElement("p",{className:`${a}__file-drop-header`},v),i.createElement(be,{accept:y,labelText:O,onAddFiles:ne,disabled:p,"data-modal-primary-focus":!0}),b&&i.createElement("p",{className:`${a}__label`},b),i.createElement("div",{className:`${a}__input-group`},i.createElement(Te,{labelText:"",id:M||"",onChange:oe,placeholder:U,value:d,disabled:p,"aria-label":b}),i.createElement(T,{onClick:ie,className:`${a}__import-button`,size:"md",disabled:de,renderIcon:k?t=>i.createElement(Fe,{size:20,...t}):void 0},P)),i.createElement("div",{className:`${ee}--file-container ${a}__file-container`},p&&i.createElement("p",{className:`${a}__helper-text`},pe),l.map(t=>i.createElement(he,{key:t.uuid,onDelete:()=>ae(t.uuid),name:t.name,status:t.status,size:"lg",uuid:t.uuid,iconDescription:t.iconDescription,invalid:t.invalid,errorBody:t.errorBody,errorSubject:t.errorSubject,filesize:t.fileSize})))),i.createElement(ge,{className:`${a}__footer`},i.createElement(T,{type:"button",kind:"secondary",onClick:D},X),i.createElement(T,{type:"submit",kind:"primary",onClick:se,disabled:le},W))))});c=$.checkComponentEnabled(c,E);c.propTypes={accept:e.array,className:e.string,defaultErrorBody:e.string.isRequired,defaultErrorHeader:e.string.isRequired,description:e.string,fetchErrorBody:e.string,fetchErrorHeader:e.string,fileDropHeader:e.string,fileDropLabel:e.string,fileUploadLabel:e.string,inputButtonIcon:e.bool,inputButtonText:e.string.isRequired,inputId:e.string,inputLabel:e.string,inputPlaceholder:e.string,invalidFileTypeErrorBody:e.string,invalidFileTypeErrorHeader:e.string,invalidIconDescription:e.string,maxFileSize:e.number,maxFileSizeErrorBody:e.string,maxFileSizeErrorHeader:e.string,onClose:e.func,onRequestSubmit:e.func.isRequired,open:e.bool.isRequired,portalTarget:e.node,primaryButtonText:e.string.isRequired,secondaryButtonText:e.string.isRequired,title:e.string.isRequired};c.displayName=E;c.__docgenInfo={description:"",methods:[],displayName:"ImportModal",props:{accept:{required:!1,tsType:{name:"Array",elements:[{name:"string"}],raw:"string[]"},description:"Specifies the file types that are valid for importing",defaultValue:{value:"[]",computed:!1},type:{name:"array"}},className:{required:!1,tsType:{name:"string"},description:"Optional class name",type:{name:"string"}},defaultErrorBody:{required:!0,tsType:{name:"string"},description:"The default message shown for an import error",type:{name:"string"}},defaultErrorHeader:{required:!0,tsType:{name:"string"},description:"The default header that is displayed to show an error message",type:{name:"string"}},description:{required:!1,tsType:{name:"string"},description:"Content that is displayed inside the modal",type:{name:"string"}},fetchErrorBody:{required:!1,tsType:{name:"string"},description:"Optional error body to display specifically for a fetch error",type:{name:"string"}},fetchErrorHeader:{required:!1,tsType:{name:"string"},description:"Optional error header to display specifically for a fetch error",type:{name:"string"}},fileDropHeader:{required:!1,tsType:{name:"string"},description:"Header for the drag and drop box",type:{name:"string"}},fileDropLabel:{required:!1,tsType:{name:"string"},description:"Label for the drag and drop box",type:{name:"string"}},fileUploadLabel:{required:!1,tsType:{name:"string"},description:"Label that appears when a file is uploaded to show number of files (1 / 1)",type:{name:"string"}},inputButtonIcon:{required:!1,tsType:{name:"boolean"},description:"Button icon for import by url button",type:{name:"bool"}},inputButtonText:{required:!0,tsType:{name:"string"},description:"Button text for import by url button",type:{name:"string"}},inputId:{required:!1,tsType:{name:"string"},description:"ID for text input",type:{name:"string"}},inputLabel:{required:!1,tsType:{name:"string"},description:"Header to display above import by url",type:{name:"string"}},inputPlaceholder:{required:!1,tsType:{name:"string"},description:"Placeholder for text input",type:{name:"string"}},invalidFileTypeErrorBody:{required:!1,tsType:{name:"string"},description:"Optional error message to display specifically for a invalid file type error",type:{name:"string"}},invalidFileTypeErrorHeader:{required:!1,tsType:{name:"string"},description:"Optional error header to display specifically for a invalid file type error",type:{name:"string"}},invalidIconDescription:{required:!1,tsType:{name:"string"},description:"Description for delete file icon",type:{name:"string"}},maxFileSize:{required:!1,tsType:{name:"number"},description:"File size limit in bytes",type:{name:"number"}},maxFileSizeErrorBody:{required:!1,tsType:{name:"string"},description:"Optional error message to display specifically for a max file size error",type:{name:"string"}},maxFileSizeErrorHeader:{required:!1,tsType:{name:"string"},description:"Optional error header to display specifically for a max file size error",type:{name:"string"}},open:{required:!0,tsType:{name:"boolean"},description:"Specify whether the Modal is currently open",type:{name:"bool"}},portalTarget:{required:!1,tsType:{name:"ReactNode"},description:"The DOM node the tearsheet should be rendered within. Defaults to document.body.",type:{name:"node"}},primaryButtonText:{required:!0,tsType:{name:"string"},description:"Specify the text for the primary button",type:{name:"string"}},secondaryButtonText:{required:!0,tsType:{name:"string"},description:"Specify the text for the secondary button",type:{name:"string"}},title:{required:!0,tsType:{name:"string"},description:"The text displayed at the top of the modal",type:{name:"string"}},onClose:{description:"Specify a handler for closing modal",type:{name:"func"},required:!1},onRequestSubmit:{description:'Specify a handler for "submitting" modal. Access the imported file via `file => {}`',type:{name:"func"},required:!0}}};export{c as I};
