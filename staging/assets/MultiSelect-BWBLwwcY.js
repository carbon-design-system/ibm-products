import{P as l,b as ht,c as mt,u as It,a as yt,m as A,d as z,_ as G,e as xt,f as St,s as bt,h as wt,bJ as _e,k as Ee,S as vt,H as $e,E as Ae,g as Ce}from"./index-C360Eztx.js";import{u as Te,L as K,a as _t,b as Et}from"./index-CydRNFts.js";import{g as $t}from"./_commonjsHelpers-Cpj98o6Y.js";import{r as u,e as i}from"./index-DtHxqM--.js";import{m as At}from"./mergeRefs-91-mP8KM.js";import{F as Ct}from"./FormContext-C4Nuixum.js";import{C as Ft}from"./Checkbox-Cj4UPcOj.js";import{n as Ot}from"./events-CdfZZS3f.js";import{W as Tt,a as Pt}from"./bucket-19-D7HYZr93.js";var ne,Fe;function Bt(){if(Fe)return ne;Fe=1;var o=typeof Element<"u",p=typeof Map=="function",f=typeof Set=="function",_=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function m(t,s){if(t===s)return!0;if(t&&s&&typeof t=="object"&&typeof s=="object"){if(t.constructor!==s.constructor)return!1;var c,r,g;if(Array.isArray(t)){if(c=t.length,c!=s.length)return!1;for(r=c;r--!==0;)if(!m(t[r],s[r]))return!1;return!0}var h;if(p&&t instanceof Map&&s instanceof Map){if(t.size!==s.size)return!1;for(h=t.entries();!(r=h.next()).done;)if(!s.has(r.value[0]))return!1;for(h=t.entries();!(r=h.next()).done;)if(!m(r.value[1],s.get(r.value[0])))return!1;return!0}if(f&&t instanceof Set&&s instanceof Set){if(t.size!==s.size)return!1;for(h=t.entries();!(r=h.next()).done;)if(!s.has(r.value[0]))return!1;return!0}if(_&&ArrayBuffer.isView(t)&&ArrayBuffer.isView(s)){if(c=t.length,c!=s.length)return!1;for(r=c;r--!==0;)if(t[r]!==s[r])return!1;return!0}if(t.constructor===RegExp)return t.source===s.source&&t.flags===s.flags;if(t.valueOf!==Object.prototype.valueOf&&typeof t.valueOf=="function"&&typeof s.valueOf=="function")return t.valueOf()===s.valueOf();if(t.toString!==Object.prototype.toString&&typeof t.toString=="function"&&typeof s.toString=="function")return t.toString()===s.toString();if(g=Object.keys(t),c=g.length,c!==Object.keys(s).length)return!1;for(r=c;r--!==0;)if(!Object.prototype.hasOwnProperty.call(s,g[r]))return!1;if(o&&t instanceof Element)return!1;for(r=c;r--!==0;)if(!((g[r]==="_owner"||g[r]==="__v"||g[r]==="__o")&&t.$$typeof)&&!m(t[g[r]],s[g[r]]))return!1;return!0}return t!==t&&s!==s}return ne=function(s,c){try{return m(s,c)}catch(r){if((r.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw r}},ne}var Dt=Bt();const Pe=$t(Dt),Mt={compareItems:l.func,sortItems:l.func},kt=(o,p,{locale:f})=>o.localeCompare(p,f,{numeric:!0}),Nt=(o,{selectedItems:p=[],itemToString:f,compareItems:_,locale:m="en"})=>o.sort((t,s)=>{if(t.isSelectAll)return-1;if(s.isSelectAll)return 1;const c=p.includes(t),r=p.includes(s);return c&&!r?-1:r&&!c?1:_(f(t),f(s),{locale:m})}),Oe=({isControlled:o,isMounted:p,onChangeHandlerControlled:f,onChangeHandlerUncontrolled:_,selectedItems:m})=>{o?p&&f&&f({selectedItems:m}):_(m)},jt=({disabled:o,onChange:p,initialSelectedItems:f=[],selectedItems:_,selectAll:m=!1,filteredItems:t=[]})=>{const s=u.useRef(!1),c=u.useRef(p),[r,g]=u.useState(f),h=!!_,x=h?_:r,Q=u.useCallback(E=>{if(o)return;const H=t.filter(b=>!(b!=null&&b.disabled)),X=t.filter(b=>b==null?void 0:b.disabled).length;let w;if(E!=null&&E.isSelectAll&&x.length>0)w=[];else if(E!=null&&E.isSelectAll&&x.length===0)w=H;else{const b=x.findLastIndex(C=>Pe(C,E));b===-1?(w=x.concat(E),m&&t.length-1===w.length+X&&(w=H)):(w=Lt(x,b),w=w.filter(C=>!(C!=null&&C.isSelectAll)))}Oe({isControlled:h,isMounted:s.current,onChangeHandlerControlled:c.current,onChangeHandlerUncontrolled:g,selectedItems:w})},[o,x,t,m,h]),S=u.useCallback(()=>{o||Oe({isControlled:h,isMounted:s.current,onChangeHandlerControlled:c.current,onChangeHandlerUncontrolled:g,selectedItems:[]})},[o,h]);return u.useEffect(()=>{c.current=p},[p]),u.useEffect(()=>{s.current&&c.current&&!h&&c.current({selectedItems:x})},[h,x]),u.useEffect(()=>(s.current=!0,()=>{s.current=!1}),[]),{clearSelection:S,onItemChange:Q,selectedItems:x}},Lt=(o,p)=>{const f=o.slice();return f.splice(p,1),f},{ItemClick:Rt,ToggleButtonBlur:zt,ToggleButtonKeyDownArrowDown:Kt,ToggleButtonKeyDownArrowUp:Ht,ToggleButtonKeyDownEnter:qt,ToggleButtonKeyDownEscape:Ut,ToggleButtonKeyDownSpaceButton:Wt,ItemMouseMove:Vt,MenuMouseLeave:Jt,ToggleButtonClick:Gt,ToggleButtonKeyDownPageDown:Qt,ToggleButtonKeyDownPageUp:Xt,FunctionSetHighlightedIndex:Yt}=Te.stateChangeTypes,Zt=o=>typeof o=="string"?o:typeof o=="number"?`${o}`:o!==null&&typeof o=="object"&&"label"in o&&typeof o.label=="string"?o.label:"",Be=i.forwardRef(({autoAlign:o=!1,className:p,decorator:f,id:_,items:m,itemToElement:t,itemToString:s=Zt,titleText:c=!1,hideLabel:r,helperText:g,label:h,type:x="default",size:Q,disabled:S=!1,initialSelectedItems:E=[],sortItems:H=Nt,compareItems:X=kt,clearSelectionText:w="To clear selection, press Delete or Backspace",clearAnnouncement:b="all items have been cleared",clearSelectionDescription:C="Total items selected: ",light:De,invalid:$,invalidText:Me,warn:q,warnText:ke,useTitleInItem:Ne,translateWithId:le,downshiftProps:je,open:P=!1,selectionFeedback:re="top-after-reopen",onChange:Le,onMenuChange:oe,direction:ae="bottom",selectedItems:ce,readOnly:M,locale:Re="en",slug:U},ze)=>{var ve;const F=u.useMemo(()=>m.filter(e=>{if(typeof e=="object"&&e!==null){for(const d in e)if(Object.hasOwn(e,d)&&e[d]===void 0)return!1}return!0}),[m]);let k=F.some(e=>e.isSelectAll);(ce??[]).length>0&&k&&(console.warn("Warning: `selectAll` should not be used when `selectedItems` is provided. Please pass either `selectAll` or `selectedItems`, not both."),k=!1);const n=ht(),{isFluid:Y}=u.useContext(Ct),ie=mt(),[es,Z]=u.useState(!1),[ue,N]=u.useState(!1),[v,Ke]=u.useState(P||!1),[He,qe]=u.useState(P),[Ue,We]=u.useState([]),[Ve,fe]=u.useState(!1),O=It("enable-v12-dynamic-floating-styles")||o,{refs:B,floatingStyles:de,middlewareData:pe}=yt(O?{placement:ae,strategy:"fixed",middleware:[o&&St({crossAxis:!1}),bt({apply({rects:e,elements:d}){Object.assign(d.floating.style,{width:`${e.reference.width}px`})}}),o&&wt()],whileElementsMounted:xt}:{});u.useLayoutEffect(()=>{var e;if(O){const d={...de,visibility:(e=pe.hide)!=null&&e.referenceHidden?"hidden":"visible"};Object.keys(d).forEach(a=>{B.floating.current&&(B.floating.current.style[a]=d[a])})}},[O,de,B.floating,pe,P]);const{selectedItems:W,onItemChange:ge,clearSelection:he}=jt({disabled:S,initialSelectedItems:E,onChange:Le,selectedItems:ce,selectAll:k,filteredItems:F}),ee={selectedItems:W,itemToString:s,compareItems:X,locale:Re},Je={stateReducer:ot,isOpen:v,itemToString:e=>Array.isArray(e)&&e.map(function(d){return s(d)}).join(", ")||"",selectedItem:W,items:F,isItemDisabled(e,d){return e==null?void 0:e.disabled},...je},{getToggleButtonProps:Ge,getLabelProps:Qe,getMenuProps:me,getItemProps:Xe,selectedItem:Ye,highlightedIndex:Ze,setHighlightedIndex:Ie}=Te(Je),ye=Ge({onFocus:()=>{N(!0)},onBlur:()=>{N(!1)},onKeyDown:e=>{S||((A(e,_e)||A(e,Ee))&&!v&&(he(),e.stopPropagation()),!v&&A(e,_e)&&I.length>0&&fe(!0),(A(e,vt)||A(e,$e)||A(e,Ae))&&!v&&(Ie(0),fe(!1),V(!0)),A(e,$e)&&I.length===0&&(N(!1),Z(!1)),A(e,Ee)&&v&&N(!0),A(e,Ae)&&v&&N(!0))}}),te=At(ye.ref,ze),I=Ye,V=e=>{Ke(e),oe&&oe(e)};He!==P&&(V(P),qe(P));const T=x==="inline",xe=!$&&q,et=z(`${n}--multi-select__wrapper`,`${n}--list-box__wrapper`,p,{[`${n}--multi-select__wrapper--inline`]:T,[`${n}--list-box__wrapper--inline`]:T,[`${n}--multi-select__wrapper--inline--invalid`]:T&&$,[`${n}--list-box__wrapper--inline--invalid`]:T&&$,[`${n}--list-box__wrapper--fluid--invalid`]:Y&&$,[`${n}--list-box__wrapper--slug`]:U,[`${n}--list-box__wrapper--decorator`]:f}),tt=z(`${n}--label`,{[`${n}--label--disabled`]:S,[`${n}--visually-hidden`]:r}),Se=g?`multiselect-helper-text-${ie}`:void 0,st=`multiselect-field-label-${ie}`,nt=z(`${n}--form__helper-text`,{[`${n}--form__helper-text--disabled`]:S}),lt=z(`${n}--multi-select`,{[`${n}--multi-select--invalid`]:$,[`${n}--multi-select--invalid--focused`]:$&&ue,[`${n}--multi-select--warning`]:xe,[`${n}--multi-select--inline`]:T,[`${n}--multi-select--selected`]:I&&I.length>0,[`${n}--list-box--up`]:ae==="top",[`${n}--multi-select--readonly`]:M,[`${n}--autoalign`]:O,[`${n}--multi-select--selectall`]:k}),rt=t;re==="fixed"?ee.selectedItems=[]:re==="top-after-reopen"&&(ee.selectedItems=Ue);function ot(e,d){const{changes:a,props:j,type:L}=d,{highlightedIndex:y}=a;switch(a.isOpen&&!v&&We(W),L){case Wt:case qt:if(a.selectedItem===void 0||Array.isArray(a.selectedItem))break;return ge(a.selectedItem),{...a,highlightedIndex:e.highlightedIndex};case zt:case Ut:V(!1);break;case Gt:return V(a.isOpen||!1),{...a,highlightedIndex:W.length>0?0:void 0};case Rt:return Ie(a.selectedItem),ge(a.selectedItem),{...a,highlightedIndex:e.highlightedIndex};case Jt:return{...a,highlightedIndex:e.highlightedIndex};case Yt:return v?{...a,highlightedIndex:F.indexOf(y)}:{...a,highlightedIndex:0};case Kt:case Ht:case Qt:case Xt:if(y>-1){const se=document.querySelectorAll(`li.${n}--list-box__menu-item[role="option"]`);j.scrollIntoView(se[y])}return y===-1?{...a,highlightedIndex:0}:a;case Vt:return{...a,highlightedIndex:e.highlightedIndex}}return a}const at=z(`${n}--list-box__field--wrapper`,{[`${n}--list-box__field--wrapper--input-focused`]:ue}),be=e=>{e.target.classList.contains(`${n}--tag__close-icon`)?Z(!1):Z(e.type==="focus")},ct=M?{onClick:e=>{e.preventDefault(),te.current!==void 0&&te.current.focus()},onKeyDown:e=>{["ArrowDown","ArrowUp"," ","Enter"].includes(e.key)&&e.preventDefault()}}:{};let D=i.isValidElement(U??f)?U??f:null;D&&((ve=D.type)==null?void 0:ve.displayName)==="AILabel"&&(D=i.cloneElement(D,{size:"mini"}));const it=I.length>0&&I.map(e=>e==null?void 0:e.text),ut=k?I.filter(e=>!e.isSelectAll).length:I.length,ft=u.useMemo(()=>me({ref:O?B.setFloating:null}),[O,me,B.setFloating]),we=Qe(),dt=u.isValidElement(c)?{id:we.id}:we,pt=u.useCallback((e,d)=>{const a=e.some(y=>!y.isSelectAll),j=e.filter(y=>!y.isSelectAll).length,L=d.filter(y=>!y.isSelectAll&&!y.disabled).length;return{hasIndividualSelections:a,nonSelectAllSelectedCount:j,totalSelectableCount:L}},[I,F]);return i.createElement("div",{className:et},i.createElement("label",G({className:tt},dt),c&&c,I.length>0&&i.createElement("span",{className:`${n}--visually-hidden`},C," ",I.length," ",it,",",w)),i.createElement(K,{onFocus:Y?be:void 0,onBlur:Y?be:void 0,type:x,size:Q,className:lt,disabled:S,light:De,invalid:$,invalidText:Me,warn:q,warnText:ke,isOpen:v,id:_},$&&i.createElement(Tt,{className:`${n}--list-box__invalid-icon`}),xe&&i.createElement(Pt,{className:`${n}--list-box__invalid-icon ${n}--list-box__invalid-icon--warning`}),i.createElement("div",{className:at,ref:O?B.setReference:null},I.length>0&&i.createElement(K.Selection,{readOnly:M,clearSelection:!S&&!M?he:Ot,selectionCount:ut,translateWithId:le,disabled:S}),i.createElement("button",G({type:"button",className:`${n}--list-box__field`,disabled:S,"aria-disabled":S||M,"aria-describedby":!T&&!$&&!q&&g?Se:void 0},ye,{ref:te},ct),i.createElement("span",{id:st,className:`${n}--list-box__label`},h),i.createElement(K.MenuIcon,{isOpen:v,translateWithId:le})),U?D:f?i.createElement("div",{className:`${n}--list-box__inner-wrapper--decorator`},D):""),i.createElement(K.Menu,ft,v&&H(F,ee).map((e,d)=>{const a=I.filter(gt=>Pe(gt,e)).length>0,{hasIndividualSelections:j,nonSelectAllSelectedCount:L,totalSelectableCount:y}=pt(I,F),se=e.isSelectAll&&j&&L<y,R=Xe({item:e,"aria-selected":a}),J=s(e);return i.createElement(K.MenuItem,G({key:R.id,isActive:a&&!e.isSelectAll,"aria-label":J,isHighlighted:Ze===d,title:J,disabled:R["aria-disabled"]},R),i.createElement("div",{className:`${n}--checkbox-wrapper`},i.createElement(Ft,{id:`${R.id}__checkbox`,labelText:t?i.createElement(rt,G({key:R.id},e)):J,checked:a,title:Ne?J:void 0,indeterminate:se,disabled:S})))})),Ve&&i.createElement("span",{"aria-live":"assertive","aria-label":b})),!T&&!$&&!q&&g&&i.createElement("div",{id:Se,className:nt},g))});Be.displayName="MultiSelect";Be.propTypes={...Mt,autoAlign:l.bool,className:l.string,clearSelectionDescription:l.string,clearSelectionText:l.string,compareItems:l.func,decorator:l.node,direction:l.oneOf(["top","bottom"]),disabled:l.bool,downshiftProps:l.object,helperText:l.node,hideLabel:l.bool,id:l.string.isRequired,initialSelectedItems:l.array,invalid:l.bool,invalidText:l.node,itemToElement:l.func,itemToString:l.func,items:l.array.isRequired,label:l.node.isRequired,light:Ce(l.bool),locale:l.string,onChange:l.func,onMenuChange:l.func,open:l.bool,readOnly:l.bool,selectedItems:l.array,selectionFeedback:l.oneOf(["top","fixed","top-after-reopen"]),size:Et,slug:Ce(l.node),sortItems:l.func,titleText:l.node,translateWithId:l.func,type:_t,useTitleInItem:l.bool,warn:l.bool,warnText:l.node};export{Be as M,kt as a,Nt as d,Pe as i,Mt as s,jt as u};
