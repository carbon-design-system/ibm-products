import{u as Ke,a as Re,b as Se,c as Be,d as I,_ as h,C as Ue,e as qe,s as ze,f as He,h as We,P as o,g as j}from"./index-4poXP75K.js";import{e as r,r as l}from"./index-DtHxqM--.js";import{u as de,L as E,a as Ve,b as Ge}from"./index-CK_d43HR.js";import{m as Je}from"./mergeRefs-91-mP8KM.js";import{F as Qe}from"./FormContext-C4Nuixum.js";import{A as Xe}from"./index-CVEmjZFv.js";import{i as Ye}from"./utils--12iVJsW.js";import{W as Ze,a as es}from"./bucket-19-D8xKEiK4.js";const{ItemMouseMove:ss,MenuMouseLeave:os}=de.stateChangeTypes,ie=t=>typeof t=="string"?t:typeof t=="number"?`${t}`:t!==null&&typeof t=="object"&&"label"in t&&typeof t.label=="string"?t.label:"";function ce(t,k){const{changes:c,type:f}=k;switch(f){case ss:case os:return c.highlightedIndex===t.highlightedIndex?t:c;default:return c}}const pe=r.forwardRef(({autoAlign:t=!1,className:k,decorator:c,disabled:f=!1,direction:T="bottom",items:O,label:K,["aria-label"]:ue,ariaLabel:fe,itemToString:d=ie,itemToElement:R=null,renderSelectedItem:S,type:be="default",size:D,onChange:C,id:me,titleText:F="",hideLabel:we,helperText:v="",translateWithId:ye,light:B,invalid:a,invalidText:ge,warn:_,warnText:he,initialSelectedItem:U,selectedItem:q,downshiftProps:z,readOnly:x,slug:P,..._e},xe)=>{const y=Ke("enable-v12-dynamic-floating-styles"),{refs:b,floatingStyles:H,middlewareData:$e}=Re(y||t?{placement:T,strategy:"fixed",middleware:[ze({apply({rects:e,elements:n}){Object.assign(n.floating.style,{width:`${e.reference.width}px`})}}),t&&He(),t&&We()],whileElementsMounted:qe}:{});l.useEffect(()=>{var e;if(y||t){const n={...H,visibility:(e=$e.hide)!=null&&e.referenceHidden?"hidden":"visible"};Object.keys(n).forEach(w=>{b.floating.current&&(b.floating.current.style[w]=n[w])})}},[H,t,b.floating]);const s=Se(),{isFluid:W}=l.useContext(Qe),V=l.useCallback(({selectedItem:e})=>{C&&C({selectedItem:e??null})},[C]),G=l.useCallback((e,n)=>e!==null&&typeof e=="object"&&"disabled"in e&&e.disabled===!0,[]),J=l.useCallback(e=>{const{highlightedIndex:n}=e;if(n!==void 0&&n>-1&&typeof window!==void 0){const u=document.querySelectorAll(`li.${s}--list-box__menu-item[role="option"]`)[n];u&&u.scrollIntoView({behavior:"smooth",block:"nearest"})}},[s]),A=l.useMemo(()=>O,[O]),Q=l.useMemo(()=>({items:A,itemToString:d,initialSelectedItem:U,onSelectedItemChange:V,stateReducer:ce,isItemDisabled:G,onHighlightedIndexChange:J,...z}),[A,d,U,V,ce,G,J,z]),Ie=Be();q!==void 0&&(Q.selectedItem=q);const{isOpen:m,getToggleButtonProps:Ee,getLabelProps:ke,getMenuProps:X,getItemProps:De,selectedItem:i,highlightedIndex:Ce}=de(Q),p=be==="inline",Y=!a&&_,[Fe,L]=l.useState(!1),ve=I(`${s}--dropdown`,{[`${s}--dropdown--invalid`]:a,[`${s}--dropdown--warning`]:Y,[`${s}--dropdown--open`]:m,[`${s}--dropdown--focus`]:Fe,[`${s}--dropdown--inline`]:p,[`${s}--dropdown--disabled`]:f,[`${s}--dropdown--light`]:B,[`${s}--dropdown--readonly`]:x,[`${s}--dropdown--${D}`]:D,[`${s}--list-box--up`]:T==="top",[`${s}--autoalign`]:t}),Pe=I(`${s}--label`,{[`${s}--label--disabled`]:f,[`${s}--visually-hidden`]:we}),Ae=I(`${s}--form__helper-text`,{[`${s}--form__helper-text--disabled`]:f}),Le=I(`${s}--dropdown__wrapper`,`${s}--list-box__wrapper`,k,{[`${s}--dropdown__wrapper--inline`]:p,[`${s}--list-box__wrapper--inline`]:p,[`${s}--dropdown__wrapper--inline--invalid`]:p&&a,[`${s}--list-box__wrapper--inline--invalid`]:p&&a,[`${s}--list-box__wrapper--fluid--invalid`]:W&&a,[`${s}--list-box__wrapper--slug`]:P,[`${s}--list-box__wrapper--decorator`]:c}),Z=v?`dropdown-helper-text-${Ie}`:void 0,M=R,g=Ee({"aria-label":ue||fe}),ee=v&&!W?r.createElement("div",{id:Z,className:Ae},v):null,se=e=>{L(e.type==="focus"&&!i)},$=Je(g.ref,xe),[N,Me]=l.useState(),[oe,te]=l.useState(!1),ne=l.useCallback(e=>{(e.code!=="Space"||!["ArrowDown","ArrowUp"," ","Enter"].includes(e.key))&&te(!0),(oe&&e.code==="Space"||!["ArrowDown","ArrowUp"," ","Enter"].includes(e.key))&&(N&&clearTimeout(N),Me(setTimeout(()=>{te(!1)},3e3))),["ArrowDown"].includes(e.key)&&L(!1),["Enter"].includes(e.key)&&!i&&!m&&L(!0),g.onKeyDown&&(e.key!=="ArrowUp"||m&&e.key==="ArrowUp")&&g.onKeyDown(e)},[oe,N,g]),Ne=l.useMemo(()=>x?{onClick:e=>{var n;e.preventDefault(),(n=$==null?void 0:$.current)==null||n.focus()},onKeyDown:e=>{["ArrowDown","ArrowUp"," ","Enter"].includes(e.key)&&e.preventDefault()}}:{onKeyDown:ne},[x,ne]),je=l.useMemo(()=>X({ref:y||t?b.setFloating:null}),[t,X,b.setFloating,y]),re=P??c,le=Ye(re,Xe)?l.cloneElement(re,{size:"mini"}):null,ae=ke(),Te=l.isValidElement(F)?{id:ae.id}:ae;return r.createElement("div",h({className:Le},_e),F&&r.createElement("label",h({className:Pe},Te),F),r.createElement(E,{onFocus:se,onBlur:se,size:D,className:ve,invalid:a,invalidText:ge,warn:_,warnText:he,light:B,isOpen:m,ref:y||t?b.setReference:null,id:me},a&&r.createElement(Ze,{className:`${s}--list-box__invalid-icon`}),Y&&r.createElement(es,{className:`${s}--list-box__invalid-icon ${s}--list-box__invalid-icon--warning`}),r.createElement("button",h({type:"button",className:`${s}--list-box__field`,disabled:f,"aria-disabled":x?!0:void 0,"aria-describedby":!p&&!a&&!_&&ee?Z:void 0,title:i&&d!==void 0?d(i):ie(K)},g,Ne,{ref:$}),r.createElement("span",{className:`${s}--list-box__label`},i?S?S(i):d(i):K),r.createElement(E.MenuIcon,{isOpen:m,translateWithId:ye})),P?le:c?r.createElement("div",{className:`${s}--list-box__inner-wrapper--decorator`},le):"",r.createElement(E.Menu,je,m&&A.map((e,n)=>{const w=e!==null&&typeof e=="object",u=De({item:e,index:n}),Oe=w&&"text"in e&&R?e.text:d(e);return r.createElement(E.MenuItem,h({key:u.id,isActive:i===e,isHighlighted:Ce===n,title:Oe,disabled:u["aria-disabled"]},u),typeof e=="object"&&M!==void 0&&M!==null?r.createElement(M,h({key:u.id},e)):d(e),i===e&&r.createElement(Ue,{className:`${s}--list-box__menu-item__selected-icon`}))}))),!p&&!a&&!_&&ee)});pe.displayName="Dropdown";pe.propTypes={"aria-label":o.string,ariaLabel:j(o.string),autoAlign:o.bool,className:o.string,decorator:o.node,direction:o.oneOf(["top","bottom"]),disabled:o.bool,downshiftProps:o.object,helperText:o.node,hideLabel:o.bool,id:o.string.isRequired,initialSelectedItem:o.oneOfType([o.object,o.string,o.number]),invalid:o.bool,invalidText:o.node,itemToElement:o.func,itemToString:o.func,items:o.array.isRequired,label:o.node.isRequired,light:j(o.bool),onChange:o.func,readOnly:o.bool,renderSelectedItem:o.func,selectedItem:o.oneOfType([o.object,o.string,o.number]),size:Ge,slug:j(o.node),titleText:o.node.isRequired,translateWithId:o.func,type:Ve,warn:o.bool,warnText:o.node};export{pe as D};
