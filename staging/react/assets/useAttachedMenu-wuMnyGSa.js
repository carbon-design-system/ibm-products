import{r as o,e as A,u as de,i as he,c as me,_ as pe,a3 as xe,Z as be,o as O,t as ye,an as we,a2 as Ie,a1 as ge,P as t,g as Re}from"./iframe-BbTYfv9-.js";const ze={isRoot:!0,hasIcons:!1,hasSelectableItems:!1,size:null,items:[],requestCloseRoot:()=>{}};function Ce(u,m){switch(m.type){case"enableIcons":return{...u,hasIcons:!0};case"enableSelectableItems":return{...u,hasSelectableItems:!0};case"registerItem":{const p=m.payload,l=u.items.filter(h=>h.ref.current),R=p.ref.current?.nextElementSibling,x=l.findIndex(h=>h.ref.current===R);return l.splice(x<0?l.length:x,0,p),{...u,items:l}}}}const X=o.createContext({state:ze,dispatch:u=>{}}),Ee=A.createContext({direction:"ltr"});function Se(){return o.useContext(Ee)}const P=8,$e=o.forwardRef(function({backgroundToken:m="layer",border:p=!1,children:l,className:R,containerRef:x,label:h,menuAlignment:r,onClose:w,onOpen:b,open:i,size:E="sm",legacyAutoalign:z="true",target:S=xe&&document.body,x:Y=0,y:ee=0,...L},te){const a=de(),T=o.useRef(null),$=o.useContext(X),y=$.state.isRoot,ne=y?E:$.state.size,[N,K]=o.useReducer(Ce,{...$.state,isRoot:!1,size:E,requestCloseRoot:y?k:$.state.requestCloseRoot}),v=o.useMemo(()=>({state:N,dispatch:K}),[N,K]),s=o.useRef(null),oe=he([te,s]),[U,W]=o.useState([-1,-1]),M=v.state.items.filter(e=>!e.disabled&&e.ref.current);let I;if(x?.current){const{width:e}=x.current.getBoundingClientRect();I=e}const{direction:se}=Se();function re(){T.current&&T.current.focus()}function ce(){if(s.current){if(T.current=document.activeElement,z){const e=le();(document?.dir==="rtl"||se==="rtl")&&!L?.id?.includes("MenuButton")?(s.current.style.insetInlineStart="initial",s.current.style.insetInlineEnd=`${e[0]}px`):(s.current.style.insetInlineStart=`${e[0]}px`,s.current.style.insetInlineEnd="initial"),s.current.style.insetBlockStart=`${e[1]}px`,W(e)}s.current.focus(),b&&b()}}function k(){re(),w&&w()}function ie(e){e.stopPropagation(),(O(e,ye)||!y&&O(e,we))&&w?k():j(e)}function j(e){const c=M?.filter(f=>f?.ref?.current);if(!c?.length)return;const C=M.findIndex(f=>f.ref?.current?.contains(document.activeElement));let n=C;C===-1?n=0:e&&(O(e,Ie)&&(n=n-1),O(e,ge)&&(n=n+1)),n<0&&(n=c.length-1),n>=c.length&&(n=0),n!==C&&(c[n]?.ref?.current?.focus(),e?.preventDefault())}function ae(e){i&&w&&y&&e.relatedTarget&&!s.current?.contains(e.relatedTarget)&&k()}function H(e,c){if(!s.current)return;const{width:C,height:n}=s.current.getBoundingClientRect(),f=y?"vertical":"horizontal",d={x:{max:window.innerWidth,size:C,anchor:f==="horizontal"?e[1]:e[0],reversedAnchor:f==="horizontal"?e[0]:e[1],offset:0},y:{max:window.innerHeight,size:n,anchor:f==="horizontal"?e[0]:e[1],reversedAnchor:f==="horizontal"?e[1]:e[0],offset:y?0:4}};if(I&&I<d.x.size&&(r==="bottom"||r==="top")&&(d.x.size=I),I&&(r==="bottom-end"||r==="top-end")&&d.x.anchor>=87&&I<d.x.size){const q=d.x.anchor+d.x.reversedAnchor;d.x.anchor=d.x.anchor+q}const{max:Z,size:D,anchor:F,reversedAnchor:G,offset:_}=d[c],g=[Z-P-D-F>=0?F-_:!1,G-D>=0?G-D+_:!1,Z-P-D],J=r==="top"||r==="top-end"||r==="top-start";typeof g[0]=="number"&&J&&g[0]>=0&&!g[1]&&c==="y"?s.current.style.transform="translate(0)":J&&!g[0]&&c==="y"&&(g[0]=F-_);const Q=g.find(q=>q!==!1);return Q>=P?Q:P}function ue(e){return e!=null}function V(e){if(Array.isArray(e)){const c=e.filter(ue);return c.length===2?c:void 0}else return[e,e]}function le(){const e={x:V(Y),y:V(ee)};return!e.x||!e.y?[-1,-1]:[H(e.x,"x")??-1,H(e.y,"y")??-1]}o.useEffect(()=>{if(i){const e=requestAnimationFrame(()=>{M.length>0&&j()});return()=>cancelAnimationFrame(e)}},[i,M]),o.useEffect(()=>{i?ce():W([-1,-1])},[i]);const fe=me(R,`${a}--menu`,`${a}--menu--${ne}`,{[`${a}--menu--box-shadow-top`]:r&&r.slice(0,3)==="top",[`${a}--menu--open`]:i,[`${a}--menu--shown`]:i&&!z||U[0]>=0&&U[1]>=0,[`${a}--menu--with-icons`]:v.state.hasIcons,[`${a}--menu--with-selectable-items`]:v.state.hasSelectableItems,[`${a}--autoalign`]:!z,[`${a}--menu--border`]:p,[`${a}--menu--background-token__background`]:m==="background"}),B=A.createElement(X.Provider,{value:v},A.createElement("ul",pe({},L,{className:fe,role:"menu",ref:oe,"aria-label":h,tabIndex:-1,onKeyDown:ie,onBlur:ae}),l));return S&&y?i&&be.createPortal(B,S)||null:B});$e.propTypes={backgroundToken:t.oneOf(["layer","background"]),border:t.bool,children:t.node,className:t.string,label:t.string,menuAlignment:t.string,mode:Re(t.oneOf(["full","basic"])),onClose:t.func,onOpen:t.func,open:t.bool,size:t.oneOf(["xs","sm","md","lg"]),target:t.object,x:t.oneOfType([t.number,t.arrayOf(t.number)]),y:t.oneOfType([t.number,t.arrayOf(t.number)])};function Me(u){const[m,p]=o.useState(!1),[l,R]=o.useState([[-1,-1],[-1,-1]]);function x(){const b=u?.current||u;if(b){const{left:i,top:E,right:z,bottom:S}=b.getBoundingClientRect();R([[i,z],[E,S]])}p(!0)}function h(){p(!1)}function r(){m?h():x()}function w(b){b.preventDefault()}return{open:m,x:l[0],y:l[1],handleClick:r,handleMousedown:w,handleClose:h}}export{Ee as L,X as M,$e as a,Me as b,Se as u};
//# sourceMappingURL=useAttachedMenu-wuMnyGSa.js.map
