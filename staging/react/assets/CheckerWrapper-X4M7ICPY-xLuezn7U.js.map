{"version":3,"mappings":"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","names":["_CheckerWrapper","config","retVal","CheckerPackage","Checker","guideline","checkpoint","rule","ruleIter","ruleConfig","cfgRule","htmlElement","report","selRules","issue","skipCount","skipWalk","results","err","xpath","issues","issueMap","key","nextIssue","nextCollection","pathParts","selector","impact","tkLevel","selectorSections","idx","parents","selectedElement","__name","CheckerWrapper"],"ignoreList":[0],"sources":["../../../../node_modules/storybook-addon-accessibility-checker/dist/_browser-chunks/CheckerWrapper-X4M7ICPY.js"],"sourcesContent":["import {\n  __name\n} from \"./chunk-JFJ5UJ7Q.js\";\n\n// src/CheckerWrapper.ts\nvar _CheckerWrapper = class _CheckerWrapper {\n  /**\n   * Instantiate this wrapper using the given config\n   *\n   * @param config\n   */\n  constructor(config) {\n    this.config = config;\n    // Mapping of rules to toolkit level (used to map to 'impact')\n    this.ruleTKLevel = {};\n  }\n  static async getWrapper(config) {\n    const retVal = new _CheckerWrapper();\n    await retVal.initialize();\n    return retVal;\n  }\n  async initialize() {\n    await import(\"accessibility-checker-engine/ace-window.js\");\n    const CheckerPackage = window.ace_ibma;\n    const { Checker } = CheckerPackage;\n    this.checker = new Checker();\n    this.guidelines = this.checker.getGuidelines().filter(\n      (guideline) => (!this.config?.guidelines || this.config.guidelines.length === 0) && guideline.id === \"IBM_Accessibility\" || this.config?.guidelines && this.config.guidelines.length > 0 && this.config?.guidelines?.includes(guideline.id)\n    );\n    this.guidelines.forEach((guideline) => {\n      guideline.checkpoints.forEach((checkpoint) => {\n        checkpoint.rules?.forEach((rule) => {\n          this.ruleTKLevel[rule.id] = rule.toolkitLevel;\n        });\n      });\n    });\n  }\n  /** Enable / disable rules in the guidelines based on the configuration */\n  configureEngine() {\n    this.guidelines.forEach((guideline) => {\n      guideline.checkpoints.forEach((checkpoint) => {\n        (checkpoint.rules || []).forEach((ruleIter) => {\n          const rule = ruleIter;\n          const ruleConfig = this.config?.rules?.find((cfgRule) => cfgRule.id === rule.id);\n          if (ruleConfig) {\n            rule.enabled = ruleConfig.enabled !== false;\n          } else if (this.config?.disableOtherRules === true) {\n            rule.enabled = false;\n          }\n        });\n      });\n      this.checker.addGuideline(guideline);\n    });\n  }\n  /**\n   * Run the engine on the specified subtree\n   *\n   * @param htmlElement\n   * @returns\n   */\n  async run(htmlElement) {\n    this.configureEngine();\n    const report = await this.checker.check(\n      htmlElement,\n      this.guidelines.map((guideline) => guideline.id)\n    );\n    if (this.config?.rules) {\n      const selRules = this.config.rules.filter((rule) => rule.selector);\n      if (selRules.length > 0) {\n        report.results = report.results.filter((issue) => {\n          const ruleConfig = selRules.find((rule) => rule.id === issue.ruleId);\n          return !ruleConfig || !ruleConfig.selector || issue.node.nodeType !== 1 || issue.node.matches(ruleConfig.selector);\n        });\n      }\n    }\n    let skipCount = 1;\n    let skipWalk = htmlElement;\n    while (skipWalk.nodeName !== \"html\" && skipWalk.parentElement) {\n      skipWalk = skipWalk.parentElement;\n      skipCount += 1;\n    }\n    return this.convertResult(htmlElement, report, skipCount);\n  }\n  /**\n   * Convert checker result to storybook report format\n   *\n   * @param htmlElement\n   * @param report\n   * @param skipCount\n   * @returns\n   */\n  convertResult(htmlElement, report, skipCount) {\n    try {\n      const { results } = report;\n      return {\n        testEngine: {\n          name: \"accessibility-checker-engine\",\n          version: \"3.1.62\"\n        },\n        testRunner: {\n          name: \"accessibility-checker\"\n        },\n        timestamp: (/* @__PURE__ */ new Date()).toISOString(),\n        url: document.location.href,\n        toolOptions: {},\n        inapplicable: [],\n        passes: this.convertCollection(\n          htmlElement,\n          report,\n          results.filter((issue) => issue.value[1] === \"PASS\"),\n          skipCount\n        ),\n        incomplete: this.convertCollection(\n          htmlElement,\n          report,\n          results.filter(\n            (issue) => issue.value[0] === \"VIOLATION\" && (issue.value[1] === \"POTENTIAL\" || issue.value[1] === \"MANUAL\")\n          ),\n          skipCount\n        ),\n        violations: this.convertCollection(\n          htmlElement,\n          report,\n          results.filter(\n            (issue) => issue.value[0] === \"VIOLATION\" && issue.value[1] === \"FAIL\"\n          ),\n          skipCount\n        )\n      };\n    } catch (err) {\n      console.error(err);\n      return {};\n    }\n  }\n  /**\n   * Convert an accessibility-checker-engine DOM path to a CSS selector\n   *\n   * @param xpath\n   * @returns\n   */\n  xpathToCSS(xpath) {\n    return xpath.substring(1).replace(/\\//g, \" > \").replace(/\\[(\\d+)\\]/g, \":nth-of-type($1)\");\n  }\n  convertCollection(htmlElement, report, issues, skipCount) {\n    const issueMap = {};\n    issues.forEach((issue) => {\n      issueMap[issue.ruleId] = issueMap[issue.ruleId] || [];\n      issueMap[issue.ruleId].push(issue);\n    });\n    const retVal = [];\n    Object.keys(issueMap).forEach((key) => {\n      const nextIssue = issueMap[key][0];\n      const nextCollection = {\n        id: key,\n        impact: \"\",\n        tags: [],\n        description: \"\",\n        help: report.nls ? report.nls[key][0] : \"\",\n        helpUrl: this.getHelpUrl(nextIssue),\n        nodes: issueMap[key].map((issue) => this.convertIssue(htmlElement, issue, skipCount)).filter((issue) => !!issue)\n      };\n      if (nextCollection.nodes.length > 0) {\n        retVal.push(nextCollection);\n      }\n    });\n    return retVal;\n  }\n  convertIssue(htmlElement, issue, skipCount) {\n    const pathParts = issue.path.dom.substring(1).split(\"/\");\n    if (skipCount >= pathParts.length) {\n      return void 0;\n    }\n    let selector = this.xpathToCSS(`/${pathParts.slice(skipCount).join(\"/\")}`);\n    selector = this.simplifySelector(htmlElement, selector);\n    let impact = \"serious\";\n    if (issue.ruleId in this.ruleTKLevel) {\n      const tkLevel = this.ruleTKLevel[issue.ruleId];\n      if (tkLevel === \"1\") {\n        impact = \"critical\";\n      }\n      if (tkLevel === \"2\") {\n        impact = \"serious\";\n      }\n      if (tkLevel === \"3\") {\n        impact = \"minor\";\n      }\n    }\n    return {\n      any: [\n        {\n          impact,\n          message: issue.message\n        }\n      ],\n      all: [],\n      none: [],\n      target: [selector]\n    };\n  }\n  /**\n   * Simplify the CSS selector\n   *\n   * The selector generated by xpathToCSS is very specific, but not necssarily the most human\n   * friendly\n   *\n   * @param htmlElement\n   * @param selector\n   * @returns\n   */\n  simplifySelector(htmlElement, selector) {\n    let selectorSections = selector.split(\" > \");\n    for (let idx = 0; idx < selectorSections.length; idx += 1) {\n      let parents = \"\";\n      if (idx > 0) {\n        parents = `${selectorSections.slice(0, idx).join(\" > \")} > `;\n      }\n      const selectedElement = htmlElement.querySelector(parents + selectorSections[idx]);\n      if (selectedElement) {\n        if (selectedElement?.hasAttribute(\"id\") && htmlElement.querySelector(\n          `${parents}#${CSS.escape(selectedElement.getAttribute(\"id\"))}`\n        ) === selectedElement && htmlElement.querySelectorAll(\n          `${parents}#${CSS.escape(selectedElement.getAttribute(\"id\"))}`\n        ).length === 1) {\n          selectorSections[idx] = `#${CSS.escape(selectedElement.getAttribute(\"id\"))}`;\n        } else if (selectedElement?.hasAttribute(\"class\") && htmlElement.querySelector(\n          `${parents}.${CSS.escape(selectedElement.getAttribute(\"class\"))}`\n        ) === selectedElement && htmlElement.querySelectorAll(\n          `${parents}.${CSS.escape(selectedElement.getAttribute(\"class\"))}`\n        ).length === 1) {\n          selectorSections[idx] = `.${CSS.escape(selectedElement.getAttribute(\"class\"))}`;\n        } else if (htmlElement.querySelector(parents + selectedElement.nodeName) === selectedElement && htmlElement.querySelectorAll(parents + selectedElement.nodeName).length === 1) {\n          selectorSections[idx] = selectedElement.nodeName.toLowerCase();\n        }\n      }\n    }\n    while (selectorSections.length > 1 && htmlElement.querySelector(selectorSections.slice(1).join(\" > \")) === htmlElement.querySelector(selectorSections.join(\" > \")) && htmlElement.querySelectorAll(selectorSections.slice(1).join(\" > \")).length === 1) {\n      selectorSections = selectorSections.slice(1);\n    }\n    if (htmlElement.querySelector(selectorSections.join(\" \")) !== htmlElement.querySelector(selectorSections.join(\" > \")) || htmlElement.querySelectorAll(selectorSections.join(\" \")).length > 1) {\n      return selectorSections.join(\" > \");\n    }\n    return selectorSections.join(\" \");\n  }\n  /**\n   * Get a help url for this issue\n   *\n   * @param issue\n   * @returns\n   */\n  getHelpUrl(issue) {\n    if (issue.help) {\n      return issue.help;\n    }\n    const helpUrl = this.checker.engine.getHelp(issue.ruleId, issue.reasonId);\n    return `${helpUrl}`;\n  }\n};\n__name(_CheckerWrapper, \"CheckerWrapper\");\nvar CheckerWrapper = _CheckerWrapper;\nexport {\n  CheckerWrapper\n};\n"],"file":"assets/CheckerWrapper-X4M7ICPY-xLuezn7U.js"}