import{r as u,e as M}from"./index-CPiZ6Cnx.js";import{j as re}from"./jsx-runtime-Dc-z7RWI.js";import{useMDXComponents as Ft}from"./index-CUO_02de.js";import"./chunk-NUUEMKO5-DAfSjhFL.js";import{al as cn,aw as ln,ak as un}from"./index-B_DdD064.js";import{c as be,P as o}from"./index-CXyjPnaX.js";import{O as mn}from"./index-Bnm8yalQ.js";import{O as dn}from"./OverflowMenuItem-B5Kp6Vn3.js";import{a as xe,d as de,i as wt,h as hn,b as pn,F as fn,s as Rt,u as gn,r as Ce}from"./index.esm-DL6tv-Mo.js";import{p as we,v as ae,t as wn,by as yt,bz as yn,bA as bn,bB as Sn}from"./settings-iwZeeh4T.js";import{u as Ke}from"./uuidv4-BQrI85uz.js";import{p as Je}from"./props-helper-Dlg0HCIz.js";import{u as Ye}from"./usePreviousValue-CSEZflXC.js";import{g as xn}from"./devtools-CjVY-wQW.js";import{g as Dn}from"./getNodeTextContent-C8IeKkUQ.js";import"./_commonjsHelpers-BosuxZz1.js";import"./iframe-BFx4DPzL.js";import"../sb-preview/runtime.js";import"./react-18-C6q_qjn2.js";import"./index-Bsyy8W_U.js";import"./index-BSHYryQu.js";import"./index-Df9so8jS.js";import"./index-DMCuvgYY.js";import"./index-DrFu-skq.js";import"./useAttachedMenu-MiCadXk0.js";import"./mergeRefs-CTUecegF.js";import"./index-DJK44odq.js";import"./bucket-12-Oh5ngpb2.js";import"./wrapFocus-i_P_nIQh.js";import"./Text-vNWzJqus.js";import"./events-OVwOsPzJ.js";const An=()=>{const[e,t]=u.useState(document.activeElement),r=()=>{t(document.activeElement)};return u.useEffect(()=>(document.addEventListener("focusin",r),()=>{document.removeEventListener("focusin",r)}),[]),e},_n=({spreadsheetRef:e,activeCellCoordinates:t,containerHasFocus:r,createActiveCell:a,activeCellContent:s,isActiveHeaderCellChanged:d})=>{let c;u.useEffect(()=>{c()},[s,c,d]),c=u.useCallback(()=>{const m=e==null?void 0:e.current.querySelector(`[data-row-index="${t==null?void 0:t.row}"][data-column-index="${t==null?void 0:t.column}"]`),l=(t==null?void 0:t.row)==="header"&&!0,h=e==null?void 0:e.current.querySelector('[data-row-index="header"][data-column-index="header"]');r&&a({placementElement:t?m:h,coords:t,addToHeader:l})},[e,t,r,a])},Hn=({blockClass:e=`${we.prefix}--data-spreadsheet`,focusedElement:t,removeActiveCell:r,setContainerHasFocus:a})=>{u.useEffect(()=>{t.classList.contains(`${e}--interactive-cell-element`)||(a(!1),r()),(t.classList.contains(e)||t.classList.contains(`${e}--interactive-cell-element`))&&a(!0)},[t,r,e,a])},Tn=({isBlurSpreadsheet:e,spreadsheetRef:t,blockClass:r=`${we.prefix}--data-spreadsheet`,setActiveCellCoordinates:a,setSelectionAreas:s,removeActiveCell:d,setContainerHasFocus:c,removeCellEditor:m})=>{u.useEffect(()=>{const l=h=>{!t.current||t.current.contains(h.target)||h.target.classList.contains(`${r}__active-cell--highlight`)||h.target.classList.contains(`${r}--interactive-cell-element`)||(e.current=!0,a(null),s([]),d(),xe({spreadsheetRef:t}),c(!1))};return document.addEventListener("click",l),()=>{document.removeEventListener("click",l)}},[e,t,d,r,a,c,s,m])},In=({isEditing:e,rows:t,activeCellCoordinates:r,activeCellRef:a,cellEditorRef:s,cellEditorRulerRef:d,visibleColumns:c,defaultColumn:m,cellEditorValue:l,blockClass:h=`${we.prefix}--data-spreadsheet`})=>{const[x,A]=u.useState(null),p=Ye({nextIndex:x});u.useEffect(()=>{p!=null&&p.nextIndex||A(r==null?void 0:r.column)},[p==null?void 0:p.nextIndex,r]),u.useEffect(()=>{var b,D,k,$,E;const f=d.current.offsetWidth,i=parseInt(s.current.style.width);if(e){const T=(b=t[r==null?void 0:r.row])==null?void 0:b.cells[r==null?void 0:r.column],V=a==null?void 0:a.current.style.left,w=a==null?void 0:a.current.style.top;if(s.current.style.left=V,s.current.style.top=w,s.current.style.display="block",s.current.style.height=a==null?void 0:a.current.style.height,s.current.style.paddingTop=`${(parseInt(a==null?void 0:a.current.style.height)-16)/2-1}px`,s.current.style.textAlign=((D=T==null?void 0:T.column)==null?void 0:D.placement)==="right"?"right":"left",(k=s.current)==null||k.focus(),f<i){const H=(($=c[x])==null?void 0:$.width)||(m==null?void 0:m.width);f<i-H&&(s.current.style.width=ae(parseInt(s.current.style.width)-H),A(N=>N===0?N:N-1))}if(f>=i){A(U=>U===c.length-1?U:U+1);const N=x+1===c.length?0:((E=c[x+1])==null?void 0:E.width)||(m==null?void 0:m.width),q=r==null?void 0:r.row,J=(t.length-q)*m.rowHeight;s.current.style.maxHeight=ae(J),s.current.style.width=ae(N+i),s.current.style.height=ae(s.current.scrollHeight),s.current.clientHeight===J-1?s.current.style.overflow="auto":s.current.style.overflow="hidden"}}e||(s.current.style.overflow="hidden",s.current.style.display="none",s.current.blur(),a.current.focus(),A(r==null?void 0:r.column))},[e,r,t,l,m,a,s,d,c,h,p==null?void 0:p.cellEditorValue,x])},$n=({currentMatcher:e,setSelectionAreas:t,selectedHeaderReorderActive:r,setSelectedHeaderReorderActive:a,setClickAndHoldActive:s,setValidStartingPoint:d,validStartingPoint:c,blockClass:m=`${we.prefix}--data-spreadsheet`,ref:l,setHeaderCellHoldActive:h,setColumnOrder:x,visibleColumns:A,setActiveCellCoordinates:p,activeCellCoordinates:f,rows:i,defaultColumn:b,selectionAreas:D})=>{u.useEffect(()=>{const k=$=>{var T,V;let E=!1;if((T=D==null?void 0:D[0])!=null&&T.header&&D[0].header.type==="column"&&(E=!0),!c&&E){h(!1);const w=l.current.querySelector(`.${m}__selection-area--element`),H=l.current.querySelector(`.${m}__selection-area--element-cloned`);if(!H)return;if(H){const N=$.target.closest(`.${m}--interactive-cell-element`),q=parseInt==null?void 0:parseInt(N==null?void 0:N.getAttribute("data-column-index")),z=parseInt==null?void 0:parseInt(H==null?void 0:H.getAttribute("data-column-index-original")),U=D.filter(K=>(K==null?void 0:K.matcher)===e)[0].header.selectedIndexList;if(!l.current.querySelector(`[data-row-index="header"][data-column-index="${q}"]`))return;const n=l.current.querySelector(`[data-matcher-id="${e}"]`),I=l.current.getBoundingClientRect(),P=l.current.querySelector(`.${m}__list--container`).scrollLeft,B=q<z,O=q>z,ie=O?q-z:z-q;if(t(K=>{const L=de(K);if(z===q)return K;const Q=L.findIndex(ee=>ee.matcher===e);if(Q===-1)return K;if(!U.includes(q)){const ee=O?U.map(se=>se+ie):U.map(se=>se-ie);L[Q].header.selectedIndexList=ee,L[Q].point1.column=Math.min(...ee),L[Q].point2.column=Math.max(...ee)}return L[Q].areaCreated=!1,L}),!U.includes(q)){const K=U.length,L=Math.min(...U),Q=A.map(j=>j.id),ee=[...Q],se=()=>{const j=[];return U.map(W=>j.push(Q[W])),j};ee.splice(L,K);const he=U.findIndex(j=>j===z),ye=q-he;ee.splice(ye,0,...se()),x(ee);const Se={...f,column:O?f.column+ie:f.column-ie};p(Se);const le=Array.from(l.current.querySelectorAll(`.${m}__th--selected-header`))[0].getBoundingClientRect().left-I.left+P,S=B?le:q===z?n.style.left:le;n.style.left=ae(S)}const me=l.current.querySelector(`.${m}__reorder-indicator-line`);me==null||me.remove(),H==null||H.remove(),(V=w==null?void 0:w.classList)==null||V.remove(`${m}__selection-area--element`),a(!1)}}if(c||$.type==="mouseup"){s(!1),d(!1);const w=$.target.closest(`.${m}__body--td`);if(w){const H={row:Number(w.getAttribute("data-row-index")),column:Number(w.getAttribute("data-column-index"))};t(N=>{const q=de(N),z=q.findIndex(J=>J.matcher===e);return z===-1?N:(q[z].point2=H,q[z].areaCreated=!1,q)})}}};return document.addEventListener("mouseup",k),()=>{document.removeEventListener("mouseup",k)}},[m,e,t,s,d,c,r,a,l,h,x,A,p,f,i,b,D])},qn=({blockClass:e=`${we.prefix}--data-spreadsheet`,clonedSelectionElement:t,ref:r,spreadsheetCoords:a,leftScrollAmount:s})=>{const d=event.target.closest(`.${e}--interactive-cell-element`),c=d==null?void 0:d.getAttribute("data-column-index"),m=t==null?void 0:t.getAttribute("data-column-index-original"),l=d.getBoundingClientRect(),h=r.current.querySelector(`.${e}__reorder-indicator-line`),x=t==null?void 0:t.getAttribute("data-matcher-id"),A=r.current.querySelector(`[data-matcher-id="${x}"]`),p=r.current.querySelector(`.${e}__list--container`),f=10,i=120,b=100,{clientX:D}=event,{left:k,right:$}=p.getBoundingClientRect();if(D<i&&window.scrollBy(-f,0),D>window.innerWidth-b&&window.scrollBy(f,0),D>k&&D<k+i&&p.scrollBy(-f,0),D<$&&D>$-b&&p.scrollBy(f,0),Number(c)>Number(m)){const E=l.left-a.left+d.offsetWidth-2+s;h.style.left=ae(E)}if(Number(c)<Number(m)){const E=l.left-a.left+s;h.style.left=ae(E)}Number(c)===Number(m)&&(h.style.left=A.style.left)},Mn=({ref:e,blockClass:t=`${we.prefix}--data-spreadsheet`,headerCellHoldActive:r,defaultColumn:a})=>{u.useEffect(()=>{const s=c=>{const m=e.current.querySelector(`.${t}__selection-area--element-cloned`);m&&e.current.addEventListener("mousemove",s);const l=e.current.getBoundingClientRect(),h=e.current.querySelector(`.${t}__list--container`),x=h.scrollLeft;qn({clonedSelectionElement:m,ref:e,spreadsheetCoords:l,leftScrollAmount:x}),e.current.getBoundingClientRect();const p=c.clientX-l.left,f=m==null?void 0:m.getAttribute("data-clone-offset-x"),i=h.scrollWidth,b=m.offsetWidth,D=Math.max(p-f,a==null?void 0:a.rowHeaderWidth),k=i-b>=D?D+x:i-b;k<l.right-40&&(m.style.left=ae(k))};r&&e.current.addEventListener("mousemove",s);const d=e.current;return r||d==null||d.removeEventListener("mousemove",s),()=>{d==null||d.removeEventListener("mousemove",s)}})},Me=e=>{const t=Math.max(e.point1.row,e.point2.row),r=Math.max(e.point1.column,e.point2.column),a=Math.min(e.point1.row,e.point2.row),s=Math.min(e.point1.column,e.point2.column);return{greatestRowIndex:t,greatestColumnIndex:r,lowestColumnIndex:s,lowestRowIndex:a}},bt=({ref:e,area:t,blockClass:r,defaultColumn:a,selectionAreas:s,setSelectionAreas:d,setActiveCellInsideSelectionArea:c,visibleColumns:m})=>{const{lowestColumnIndex:l,lowestRowIndex:h,greatestColumnIndex:x,greatestRowIndex:A}=Me(t);(A-h>0||x-l>0)&&(c(!0),e.current.querySelector(`.${r}__active-cell--highlight`).setAttribute("data-selection-id",t.matcher));let p=0;m.forEach((w,H)=>{H>=l&&H<=x&&(p+=(w==null?void 0:w.width)||(a==null?void 0:a.width))});const i=(document.querySelector(`[data-row-index="${t.point1.row}"][data-column-index="${t.point1.column}"]`)||document.querySelector(`.${r}__body--td`)).offsetHeight,b=i*(A-h+1),D=document.querySelector(`.${r}__list--container`).firstElementChild,k=D.querySelector(`[data-row-index="${h}"][data-column-index="${l}"]`),$={top:k?k.getBoundingClientRect().top-D.getBoundingClientRect().top:h===0?0:i*h,left:k?k.getBoundingClientRect().left-D.getBoundingClientRect().left:l===0?0+(a.rowHeaderWidth-4):a.width*l+(a.rowHeaderWidth-4)},E=document.querySelector(`[data-matcher-id="${t.matcher}"]`)||document.createElement("div");E.classList.add(`${r}__selection-area--element`),E.setAttribute("data-matcher-id",t.matcher),E.style.width=ae(p),E.style.height=ae(b),E.style.left=ae($.left),E.style.top=ae($.top),D.appendChild(E);const T=de(s),V=T.findIndex(w=>w.matcher===t.matcher);T[V].areaCreated=!0,d(T)},et=(e,t,r)=>{const a=de(t),s=[];a.forEach(c=>{var h,x,A,p;const m=Math.max((h=c.point1)==null?void 0:h[r],(x=c.point2)==null?void 0:x[r]),l=Math.min((A=c.point1)==null?void 0:A[r],(p=c.point2)==null?void 0:p[r]);for(let f=l;f<=m;f++)s.push(f)});const d=[...new Set(s)];return!!(a!=null&&a.length&&d.includes(e))},Xt=(e,t,r,a)=>de(t).some(c=>{var f,i,b,D,k,$,E,T;const m=r==="column"?"row":"column",l=Math.min((f=c==null?void 0:c.point1)==null?void 0:f[m],(i=c==null?void 0:c.point2)==null?void 0:i[m]),h=Math.max((b=c==null?void 0:c.point1)==null?void 0:b[m],(D=c==null?void 0:c.point2)==null?void 0:D[m]),x=Math.min((k=c==null?void 0:c.point1)==null?void 0:k[r],($=c==null?void 0:c.point2)==null?void 0:$[r]),A=Math.max((E=c==null?void 0:c.point1)==null?void 0:E[r],(T=c==null?void 0:c.point2)==null?void 0:T[r]),p=(a==null?void 0:a.length)-1===h&&l===0;for(let V=x;V<=A;V++)if(e===V&&p)return!0;return!1}),vt=({type:e,headerGroup:t,scrollBarSizeValue:r,totalVisibleColumns:a,defaultColumn:s,totalColumnsWidth:d,visibleColumns:c})=>{const m=r+s.rowHeaderWidth;if(!a){if(e==="header")return ae(parseInt(t.getHeaderGroupProps().style.width)+m);if(e!=="header")return d+m}if(a)return c.map((h,x)=>x<=a-1&&((h==null?void 0:h.width)||(s==null?void 0:s.width))).reduce((h,x)=>h+x,0)+m},Fe=(e,t)=>t=="cmd"?e.metaKey||e.ctrlKey:e[t],On=({indexList:e,newIndex:t,activeCellIndex:r})=>{const a=t>r?r:Math.min(...e,t),s=t<r?r:Math.max(...e,t),d=[];for(let c=a;c<=s;c++)d.push(c);return[...d]},Qe=({type:e,activeCellCoordinates:t,rows:r,columns:a,currentMatcher:s,setActiveCellCoordinates:d,setCurrentMatcher:c,setSelectionAreas:m,spreadsheetRef:l,index:h,isKeyboard:x,setSelectionAreaData:A,isHoldingCommandKey:p,isHoldingShiftKey:f})=>{p||(A([]),xe({spreadsheetRef:l}));const i=x?t==null?void 0:t.row:h,b=x?t==null?void 0:t.column:h,D={row:e==="column"?0:i,column:e==="column"?b:0},k={row:e==="column"?r.length-1:i,column:e==="column"?b:a.length-1},$=Ke();f||(d({row:e==="column"?0:i,column:e==="column"?b:0}),c($));const E={point1:D,point2:k,areaCreated:!1,matcher:$,header:{type:e,selectedIndexList:[e==="column"?b:i]}};m(T=>{var w,H;const V=de(T);if(p){const q=V.filter(J=>{var U;return(U=J.header)==null?void 0:U.type}).filter(J=>{var U;return((U=J.header)==null?void 0:U.type)===e}),z=et(h,q,e);return q.length&&z?T:[...T,E]}if(f){const q=V.filter(B=>{var O;return(O=B.header)==null?void 0:O.type}).filter(B=>B.matcher===s)[0],z=Math.max(q==null?void 0:q.point1[e],q==null?void 0:q.point2[e],t==null?void 0:t[e]),J=e==="column"?b:i,U={row:z<J?r.length-1:0,column:b},C=de(T),n=C.findIndex(B=>B.matcher===s),I=On({indexList:((H=(w=C[n])==null?void 0:w.header)==null?void 0:H.selectedIndexList)||[e==="column"?b:i],newIndex:J,activeCellIndex:t==null?void 0:t[e]}),X=B=>B<J?{row:e==="column"?0:Math.min(...I),column:e==="column"?Math.min(...I):0}:U,P=B=>B<J?U:{row:e==="column"?r.length-1:Math.max(...I),column:e==="column"?Math.max(...I):a.length-1};if(!t||typeof t>"u"){c($);const B={point1:X(e==="column"?b:i),point2:P(e==="column"?b:i),areaCreated:!1,matcher:$,header:{type:e,selectedIndexList:[e==="column"?b:i]}};return d({row:e==="column"?0:i,column:e==="column"?b:0}),[B]}return C[n].point1=X(t==null?void 0:t[e]),C[n].point2=P(t==null?void 0:t[e]),C[n].areaCreated=!1,C[n].header.selectedIndexList=I,C}return[E]})},kn=({activeCellInsideSelectionArea:e,activeCellCoordinates:t,activeCellRef:r,selectionAreas:a,updateActiveCellCoordinates:s})=>{if(!e)return;const d=r.current.getAttribute("data-selection-id"),c=a.findIndex(f=>f.matcher===d),m=a[c],{lowestColumnIndex:l,lowestRowIndex:h,greatestColumnIndex:x,greatestRowIndex:A}=Me(m),p={...t};if((t==null?void 0:t.row)<A&&s({coords:p,updatedValue:{row:(p==null?void 0:p.row)+1},optOutOfSelectionAreaUpdate:!0}),(t==null?void 0:t.row)===A&&((t==null?void 0:t.column)<x&&s({coords:p,updatedValue:{column:(p==null?void 0:p.column)+1,row:h},optOutOfSelectionAreaUpdate:!0}),(t==null?void 0:t.column)===x)){if(a.length>1)if(a[c+1]){r.current.setAttribute("data-selection-id",a[c+1].matcher);const f=a[c+1],{lowestColumnIndex:i,lowestRowIndex:b}=Me(f);s({coords:p,updatedValue:{column:i,row:b},optOutOfSelectionAreaUpdate:!0});return}else{r.current.setAttribute("data-selection-id",a[0].matcher);const f=a[0],{lowestColumnIndex:i,lowestRowIndex:b}=Me(f);s({coords:p,updatedValue:{column:i,row:b},optOutOfSelectionAreaUpdate:!0})}if(a.length===1)return s({coords:p,updatedValue:{column:l,row:h},optOutOfSelectionAreaUpdate:!0})}},Ln=({activeCellInsideSelectionArea:e,activeCellCoordinates:t,activeCellRef:r,selectionAreas:a,updateActiveCellCoordinates:s})=>{if(!e)return;const d=r.current.getAttribute("data-selection-id"),c=a.findIndex(p=>p.matcher===d),m=a[c],{lowestColumnIndex:l,lowestRowIndex:h,greatestColumnIndex:x,greatestRowIndex:A}=Me(m);if((t==null?void 0:t.column)<x&&s({updatedValue:{column:(t==null?void 0:t.column)+1},optOutOfSelectionAreaUpdate:!0}),(t==null?void 0:t.column)===x&&((t==null?void 0:t.row)<A&&s({updatedValue:{column:l,row:(t==null?void 0:t.row)+1},optOutOfSelectionAreaUpdate:!0}),(t==null?void 0:t.row)===A)){if(a.length>1)if(a[c+1]){r.current.setAttribute("data-selection-id",a[c+1].matcher);const p=a[c+1],{lowestColumnIndex:f,lowestRowIndex:i}=Me(p);s({updatedValue:{column:f,row:i},optOutOfSelectionAreaUpdate:!0});return}else{r.current.setAttribute("data-selection-id",a[0].matcher);const p=a[0],{lowestColumnIndex:f,lowestRowIndex:i}=Me(p);s({updatedValue:{column:f,row:i},optOutOfSelectionAreaUpdate:!0})}if(a.length===1)return s({updatedValue:{column:l,row:h},optOutOfSelectionAreaUpdate:!0})}},St=(e,t,r)=>{for(let a=e;a<=t;a++)r(a)},jn=({activeCellCoordinates:e,selectionAreas:t,currentMatcher:r,rows:a,setActiveCellContent:s,updateData:d})=>{var f,i,b,D,k,$,E,T;if((e==null?void 0:e.column)==="header"||(e==null?void 0:e.row)==="header")return;const c=de(t),m=c.findIndex(V=>V.matcher===r),l=c[m],h=Math.min((f=l==null?void 0:l.point1)==null?void 0:f.column,(i=l==null?void 0:l.point2)==null?void 0:i.column),x=Math.max((b=l==null?void 0:l.point1)==null?void 0:b.column,(D=l==null?void 0:l.point2)==null?void 0:D.column),A=Math.min((k=l==null?void 0:l.point1)==null?void 0:k.row,($=l==null?void 0:l.point2)==null?void 0:$.row),p=Math.max((E=l==null?void 0:l.point1)==null?void 0:E.row,(T=l==null?void 0:l.point2)==null?void 0:T.row);St(h,x,V=>{St(A,p,w=>{const H=a[w].cells[V];d(w,H==null?void 0:H.column.id,"")})}),s(null)},ve=`${we.prefix}--data-spreadsheet`,En=(e,t,r,...a)=>{const[s,d,c,m,l,h,x,A,p,f,i,b,D]=a;r.preventDefault();const $=r.target.closest(`.${ve}__body--td`).classList.contains(`${ve}__body--td`);D($);const E=Fe(r,"cmd"),T=Fe(r,"shiftKey");h(!0);const V={row:e.row.index,column:t},w=Ke();if(x(!0),E)p.current.querySelector(`.${ve}__active-cell--highlight`).setAttribute("data-selection-id",w),i(!0),m(V),A(w),l(N=>[...N,{point1:V,matcher:w}]);else if(T){h(!0);const H=de(c),N=H.findIndex(q=>q.matcher===s);if(N===-1)return;H[N].point1=d,H[N].point2=V,H[N].areaCreated=!1,H[N].matcher=s,l(H)}else b.current.style.display="none",i(!1),m(V),xe({spreadsheetRef:p}),l([{point1:V,matcher:w}]),A(w),f([])},Nn=(e,t,...r)=>{const[a,s,d]=r;if(a){const c={row:e.row.index,column:t};d(m=>{var x,A;const l=de(m),h=l.findIndex(p=>p.matcher===s);return h===-1||((x=l[h].point2)==null?void 0:x.row)===c.row&&((A=l[h].point2)==null?void 0:A.column)===c.column?m:(l[h].point2=c,l[h].areaCreated=!1,l)})}},Pn=(e,t,...r)=>{const[a,s,d,c,m,l,h,x]=r,A=Fe(t,"cmd");Qe({type:"row",activeCellCoordinates:l,rows:h,columns:a,setActiveCellCoordinates:m,setCurrentMatcher:c,setSelectionAreas:d,spreadsheetRef:s,index:e,setSelectionAreaData:x,isHoldingCommandKey:A})},Wn=(e,...t)=>{const[r,a,s,d,c,m,l,h,x,A,p,f,i,b,D,k,$,E,T,V,w,H,N]=t,{key:q}=e;if(!D(q)&&(["ArrowLeft","ArrowUp","ArrowRight","ArrowDown"].indexOf(q)>-1&&A!=null&&A.length&&f.length<2&&!wt(f)&&($([]),E([]),xe({spreadsheetRef:l})),(f==null?void 0:f.length)>1&&hn({activeCellCoordinates:s,event:e,keysPressedList:f,selectionAreas:A,currentMatcher:h,rows:m,setSelectionAreas:$,columns:c,updateActiveCellCoordinates:a,spreadsheetRef:l,removeCellSelections:xe,blockClass:ve,setCurrentMatcher:T,usingMac:i}),f.length<2&&!wt(f)||s.row==="header"||s.column==="header"))switch(q){case"Backspace":case"Delete":{jn({selectionAreas:A,currentMatcher:h,rows:m,setActiveCellContent:N,updateData:b,activeCellCoordinates:s});break}case"Enter":{kn({activeCellInsideSelectionArea:r,activeCellCoordinates:s,activeCellRef:V,selectionAreas:A,updateActiveCellCoordinates:a});break}case"Home":case"End":{if(e.preventDefault(),pn(f,i))return;p({type:q});break}case"Tab":{if(r)return e.preventDefault(),Ln({activeCellInsideSelectionArea:r,activeCellCoordinates:s,activeCellRef:V,selectionAreas:A,updateActiveCellCoordinates:a});$([]),d(),x(),H(!1),w(null);break}case"ArrowLeft":case"ArrowUp":case"ArrowRight":case"ArrowDown":k(q)}},v=`${we.prefix}--data-spreadsheet`,tt=u.forwardRef(({activeCellRef:e,columns:t,activeCellCoordinates:r,defaultColumn:a,defaultEmptyRowCount:s,getTableBodyProps:d,headerGroups:c,setCurrentColumns:m,id:l,onDataUpdate:h,renderRowHeader:x,renderRowHeaderDirection:A,hasCustomRowHeader:p,prepareRow:f,rows:i,selectionAreaData:b,setSelectionAreaData:D,setActiveCellCoordinates:k,selectedHeaderReorderActive:$,setSelectedHeaderReorderActive:E,selectionAreas:T,setContainerHasFocus:V,setSelectionAreas:w,scrollBarSize:H,totalColumnsWidth:N,clickAndHoldActive:q,setClickAndHoldActive:z,currentMatcher:J,setCurrentMatcher:U,onSelectionAreaChange:C,setActiveCellInsideSelectionArea:n,totalVisibleColumns:I,setHeaderCellHoldActive:X,setColumnOrder:P,visibleColumns:B},O)=>{const[ie,me]=u.useState(!1),K=u.useRef(void 0),L=Ye({selectionAreaData:b,clickAndHoldActive:q,rowHeight:a==null?void 0:a.rowHeight})||{};u.useEffect(()=>{O==null||O.current.style.setProperty(`--${v}--total-width`,ae((N||0)+(H||0)))},[O,H,N]),u.useEffect(()=>{var S,j,W,Y;if(b!=null&&b.length){let _=!1;(((S=L==null?void 0:L.selectionAreaData)==null?void 0:S.length)!==(b==null?void 0:b.length)||((j=b==null?void 0:b[0])==null?void 0:j.cells.length)!==((Y=(W=L==null?void 0:L.selectionAreaData)==null?void 0:W[0])==null?void 0:Y.cells.length))&&(_=!0),(!q&&(L!=null&&L.clickAndHoldActive)||_)&&(C==null||C(b))}},[L==null?void 0:L.selectionAreaData,b,C,q,L==null?void 0:L.clickAndHoldActive]),u.useEffect(()=>{T&&T.length&&T.map(S=>{if(S.areaCreated){const j=Math.min(S.point1.row,S.point2.row),W=Math.max(S.point1.row,S.point2.row),Y=Math.min(S.point1.column,S.point2.column),_=Math.max(S.point1.column,S.point2.column),Z={rows:{start:j,end:W},columns:{start:Y,end:_},cells:Q({rowStart:j,rowEnd:W,columnStart:Y,columnEnd:_}),selectionId:S.matcher};D==null||D(R=>[...de(R).filter(pe=>pe.selectionId!==S.matcher),Z])}!S.areaCreated&&S.point1&&S.point2&&S.matcher&&bt({ref:O,area:S,blockClass:v,defaultColumn:a,selectionAreas:T,setSelectionAreas:w,setActiveCellInsideSelectionArea:n,visibleColumns:B})})},[T,w,a,C,D,O,r,n,B,p]);const Q=({rowStart:S,rowEnd:j,columnStart:W,columnEnd:Y})=>{const _=[];for(let Z=S;Z<=j;Z++)for(let R=W;R<=Y;R++)_.push([Z,R,`${v}__cell--${Z}--${R}`]);return _};$n({currentMatcher:J,setClickAndHoldActive:z,setSelectionAreas:w,setValidStartingPoint:me,selectedHeaderReorderActive:$,setSelectedHeaderReorderActive:E,validStartingPoint:ie,ref:O,setHeaderCellHoldActive:X,setColumnOrder:P,visibleColumns:B,setActiveCellCoordinates:k,rows:i,activeCellCoordinates:r,defaultColumn:a,selectionAreas:T}),u.useEffect(()=>{let S,j;if(le!=null&&le.current&&(S=le==null?void 0:le.current,j=S==null?void 0:S.querySelector(`.${v}__active-cell--highlight`)),j&&(a==null?void 0:a.rowHeight)!==L.rowHeight&&(j.style.height=`${a==null?void 0:a.rowHeight}px`,r)){const W=O==null?void 0:O.current.querySelector(`[data-row-index="${r.row}"][data-column-index="${r.column}"]`),Y=O==null?void 0:O.current.querySelector(`.${v}__list--container`);let _;W&&Y&&(_=(W==null?void 0:W.getBoundingClientRect().top)-Y.getBoundingClientRect().top),j.style.top=ae(_),xe({matcher:void 0,spreadsheetRef:O}),T==null||T.map(Z=>{if(!Z.areaCreated&&Z.point1&&Z.point2&&Z.matcher)return bt({ref:O,area:Z,blockClass:v,defaultColumn:a,selectionAreas:T,setSelectionAreas:w,setActiveCellInsideSelectionArea:n,visibleColumns:B})})}},[a,O,r,L==null?void 0:L.rowHeight,T,n,w,B,p]);const ee=u.useCallback(()=>{const S=[],j=[];O==null||O.current.querySelectorAll(`.${v}__selection-area--element`).forEach(W=>{const{top:Y,left:_,height:Z,width:R}=W.style,ge=`${Y}${_}${Z}${R}`;S.indexOf(ge)==-1?S.push(ge):(W.remove(),j.push(W.getAttribute("data-matcher-id")))}),j.length&&(w==null||w(W=>de(W).filter(_=>!j.includes(_.matcher))),D==null||D(W=>de(W).filter(_=>!j.includes(_.selectionId))))},[O,w,D]);u.useEffect(()=>{ee()},[T,ee]);const se=u.useCallback((S,j)=>W=>{En(S,j,W,J,r,T,k,w,V,z,U,O,D,n,e,me)},[J,r,T,k,w,V,z,U,O,D,n,e]),he=()=>{const S=O.current.querySelector(`
        .${v}__header--container .${v}__tr`)||new HTMLDivElement;S.scrollLeft=K==null?void 0:K.current.scrollLeft};u.useEffect(()=>{K.current.addEventListener("scroll",()=>he());const S=K.current||new HTMLElement;return()=>{S.removeEventListener("scroll",he)}});const ye=u.useCallback((S,j)=>()=>{Nn(S,j,q,J,w)},[q,J,w]),Se=u.useCallback(S=>j=>{Pn(S,j,t,O,w,U,k,r,i,D)},[t,O,w,U,k,r,i,D]);u.useEffect(()=>{if(i!=null&&i.length||(()=>{const j=[];[...Array(s)].map(()=>{var Y;const W={};(Y=c==null?void 0:c[0])==null||Y.headers.map(_=>{W[_.id]=null}),j.push(W)}),h==null||h(j)})(),c!=null&&c[0]&&typeof m=="function"){const S=c[0].headers;m(S)}},[i,c,s,h,m]);const De=()=>M.createElement("div",null),_e=u.useCallback(({index:S,style:j})=>{const W=i==null?void 0:i[S];if(i&&i.length){f==null||f(W);const Y=Je(W.getRowProps({style:j}),"key");return M.createElement("div",{key:{...W.getRowProps().key},...Y,className:be(`${v}__tr`),"data-row-index":S,"aria-rowindex":S+1,"aria-owns":`${v}__cell-editor-text-area`},M.createElement("div",{role:"rowheader",className:`${v}__td-th--cell-container`},M.createElement("button",{id:`${v}__cell--${S}--header`,tabIndex:-1,"data-row-index":S,"data-column-index":"header",type:"button",onClick:Se(S),className:be(`${v}__td`,`${v}__td-th`,`${v}--interactive-cell-element`,{[`${v}__td_custom`]:!!p,[`${v}__td-th--active-header`]:!p&&((r==null?void 0:r.row)===S||et(S,T,"row")),[`${v}__td-th--selected-header`]:!p&&Xt(S,T,"row",t)}),style:{width:a==null?void 0:a.rowHeaderWidth,flexDirection:p?A==="Left"?"row-reverse":W:void 0}},S+1,p&&typeof x=="function"&&x(S))),W.cells.map((_,Z)=>{var ge;const R=Je(_.getCellProps(),"key");return M.createElement("div",{key:`cell_${Z}`,"aria-colindex":Z+1,...R,role:"gridcell",style:{..._.getCellProps().style,display:"grid",minWidth:((ge=_==null?void 0:_.column)==null?void 0:ge.width)||(a==null?void 0:a.width)}},M.createElement("button",{id:`${v}__cell--${_.row.index}--${Z}`,tabIndex:-1,"data-row-index":_.row.index,"data-column-index":Z,className:be(`${v}__td`,`${v}__body--td`,`${v}--interactive-cell-element`),onMouseDown:se(_,Z),onMouseOver:ye(_,Z),onFocus:()=>{},type:"button"},_.render("Cell")))}))}},[f,x,A,i,p,r==null?void 0:r.row,T,Se,se,ye,a,t]),le=u.useRef(void 0);return M.createElement("div",{ref:le,className:be(`${v}__body--container`),...d==null?void 0:d()},M.createElement(fn,{className:be(`${v}__list--container`,`${v}__list--container--${l}`),height:400,itemCount:(i==null?void 0:i.length)||s,itemSize:a==null?void 0:a.rowHeight,width:vt({headerGroup:void 0,type:void 0,scrollBarSizeValue:H,totalVisibleColumns:I,defaultColumn:a,totalColumnsWidth:N,visibleColumns:B}),outerRef:K},i!=null&&i.length?_e:De))});tt.propTypes={activeCellCoordinates:o.shape({row:o.oneOfType([o.string,o.number]),column:o.oneOfType([o.string,o.number])}),activeCellRef:o.object,clickAndHoldActive:o.bool,columns:o.array,currentMatcher:o.string,defaultColumn:o.shape({rowHeight:o.number,rowHeaderWidth:o.number,width:o.number}),defaultEmptyRowCount:o.number,getTableBodyProps:o.func,hasCustomRowHeader:o.bool,headerGroups:o.arrayOf(o.object),id:o.oneOfType([o.number,o.string]),onActiveCellChange:o.func,onDataUpdate:o.func,onSelectionAreaChange:o.func,prepareRow:o.func,renderRowHeader:o.func,renderRowHeaderDirection:o.string,rows:o.arrayOf(o.object),scrollBarSize:o.number,selectedHeaderReorderActive:o.bool,selectionAreaData:o.array,selectionAreas:o.array,setActiveCellCoordinates:o.func,setActiveCellInsideSelectionArea:o.func,setClickAndHoldActive:o.func,setColumnOrder:o.func,setContainerHasFocus:o.func,setCurrentColumns:o.func,setCurrentMatcher:o.func,setHeaderCellHoldActive:o.func,setSelectedHeaderReorderActive:o.func,setSelectionAreaData:o.func,setSelectionAreas:o.func,totalColumnsWidth:o.number,totalVisibleColumns:o.number,visibleColumns:o.array};tt.__docgenInfo={description:"",methods:[],displayName:"DataSpreadsheetBody",props:{activeCellCoordinates:{required:!1,tsType:{name:"union",raw:"ActiveCellCoordinates | null",elements:[{name:"ActiveCellCoordinates"},{name:"null"}]},description:"Object containing the active cell coordinates",type:{name:"shape",value:{row:{name:"union",value:[{name:"string"},{name:"number"}],required:!1},column:{name:"union",value:[{name:"string"},{name:"number"}],required:!1}}}},activeCellRef:{required:!1,tsType:{name:"MutableRefObject",elements:[{name:"union",raw:"HTMLElement | undefined",elements:[{name:"HTMLElement"},{name:"undefined"}]}],raw:"MutableRefObject<HTMLElement | undefined>"},description:"This is the ref of the button input, which is the active cell element",type:{name:"object"}},clickAndHoldActive:{required:!1,tsType:{name:"boolean"},description:"Is the user clicking and holding in the data spreadsheet body",type:{name:"bool"}},columns:{required:!1,tsType:{name:"unknown"},description:"All of the spreadsheet columns",type:{name:"array"}},currentMatcher:{required:!1,tsType:{name:"string"},description:"This represents the id of the current cell selection area",type:{name:"string"}},defaultColumn:{required:!1,tsType:{name:"SpreadsheetColumn"},description:"Default spreadsheet sizing values",type:{name:"shape",value:{rowHeight:{name:"number",required:!1},rowHeaderWidth:{name:"number",required:!1},width:{name:"number",required:!1}}}},defaultEmptyRowCount:{required:!1,tsType:{name:"number"},description:"Sets the number of empty rows to be created when there is no data provided",type:{name:"number"}},getTableBodyProps:{required:!1,tsType:{name:"signature",type:"function",raw:"(propGetter?: TableBodyPropGetter<any>) => TableBodyProps",signature:{arguments:[{type:{name:"TableBodyPropGetter",elements:[{name:"any"}],raw:"TableBodyPropGetter<any>"},name:"propGetter"}],return:{name:"TableBodyProps"}}},description:"Function to set table body prop values",type:{name:"func"}},headerGroups:{required:!1,tsType:{name:"Array",elements:[{name:"any"}],raw:"any[]"},description:"Headers provided from useTable hook",type:{name:"arrayOf",value:{name:"object"}}},id:{required:!1,tsType:{name:"union",raw:"number | string",elements:[{name:"number"},{name:"string"}]},description:"The spreadsheet id",type:{name:"union",value:[{name:"number"},{name:"string"}]}},setCurrentColumns:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"Array",elements:[{name:"object"}],raw:"object[]"}],raw:"SetStateAction<object[]>"}],raw:"Dispatch<SetStateAction<object[]>>"},description:"Set current columns after drag drop",type:{name:"func"}},onActiveCellChange:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"The event handler that is called when the active cell changes",type:{name:"func"}},hasCustomRowHeader:{required:!1,tsType:{name:"boolean"},description:"Check if user is using custom component",type:{name:"bool"}},renderRowHeader:{required:!1,tsType:{name:"signature",type:"function",raw:"(index: number) => any[]",signature:{arguments:[{type:{name:"number"},name:"index"}],return:{name:"Array",elements:[{name:"any"}],raw:"any[]"}}},description:"Component next to numbering rows",type:{name:"func"}},renderRowHeaderDirection:{required:!1,tsType:{name:"string"},description:"Component next to numbering rows",type:{name:"string"}},onDataUpdate:{required:!1,tsType:{name:"signature",type:"function",raw:"({ ...args }) => void",signature:{arguments:[{name:""}],return:{name:"void"}}},description:"The event handler that is called to set the rows for the empty spreadsheet",type:{name:"func"}},onSelectionAreaChange:{required:!1,tsType:{name:"signature",type:"function",raw:"({ ...args }) => void",signature:{arguments:[{name:""}],return:{name:"void"}}},description:"The event handler that is called when the selection areas change",type:{name:"func"}},prepareRow:{required:!1,tsType:{name:"signature",type:"function",raw:"(...args) => void",signature:{arguments:[{name:"args",rest:!0}],return:{name:"void"}}},description:"Prepare row function from react-table",type:{name:"func"}},rows:{required:!1,tsType:{name:"Array",elements:[{name:"any"}],raw:"any[]"},description:"All of the spreadsheet row data",type:{name:"arrayOf",value:{name:"object"}}},scrollBarSize:{required:!1,tsType:{name:"number"},description:"The scrollbar width",type:{name:"number"}},selectionAreaData:{required:!1,tsType:{name:"Array",elements:[{name:"any"}],raw:"any[]"},description:"Array of selection area data",type:{name:"array"}},selectedHeaderReorderActive:{required:!1,tsType:{name:"boolean"},description:"Header reordering is active",type:{name:"bool"}},setSelectedHeaderReorderActive:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"boolean"}],raw:"SetStateAction<boolean>"}],raw:"Dispatch<SetStateAction<boolean>>"},description:"Set header reordering active or not",type:{name:"func"}},selectionAreas:{required:!1,tsType:{name:"Array",elements:[{name:"any"}],raw:"any[]"},description:"Array of selection areas",type:{name:"array"}},setActiveCellCoordinates:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"union",raw:"ActiveCellCoordinates | null",elements:[{name:"ActiveCellCoordinates"},{name:"null"}]}],raw:"SetStateAction<ActiveCellCoordinates | null>"}],raw:`Dispatch<
  SetStateAction<ActiveCellCoordinates | null>
>`},description:"Setter fn for activeCellCoordinates state value",type:{name:"func"}},setActiveCellInsideSelectionArea:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"boolean"}],raw:"SetStateAction<boolean>"}],raw:"Dispatch<SetStateAction<boolean>>"},description:"Setter fn for active cell inside of selection area",type:{name:"func"}},setClickAndHoldActive:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"boolean"}],raw:"SetStateAction<boolean>"}],raw:"Dispatch<SetStateAction<boolean>>"},description:"Setter fn for clickAndHold state value",type:{name:"func"}},setColumnOrder:{required:!1,tsType:{name:"signature",type:"function",raw:`(
  updater:
    | ((columnOrder: Array<IdType<any>>) => Array<IdType<any>>)
    | Array<IdType<any>>
) => void`,signature:{arguments:[{type:{name:"union",raw:`| ((columnOrder: Array<IdType<any>>) => Array<IdType<any>>)
| Array<IdType<any>>`,elements:[{name:"unknown"},{name:"Array",elements:[{name:"IdType",elements:[{name:"any"}],raw:"IdType<any>"}],raw:"Array<IdType<any>>"}]},name:"updater"}],return:{name:"void"}}},description:"Setter fn for column ordering, provided from react-table",type:{name:"func"}},setContainerHasFocus:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"boolean"}],raw:"SetStateAction<boolean>"}],raw:"Dispatch<SetStateAction<boolean>>"},description:"Setter fn for containerHasFocus state value",type:{name:"func"}},setCurrentMatcher:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"string"}],raw:"SetStateAction<string>"}],raw:"Dispatch<SetStateAction<string>>"},description:"Setter fn for currentMatcher state value",type:{name:"func"}},setHeaderCellHoldActive:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"boolean"}],raw:"SetStateAction<boolean>"}],raw:"Dispatch<SetStateAction<boolean>>"},description:"Setter fn for header cell hold active value",type:{name:"func"}},setSelectionAreaData:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"Array",elements:[{name:"object"}],raw:"object[]"}],raw:"SetStateAction<object[]>"}],raw:"Dispatch<SetStateAction<object[]>>"},description:"Setter fn for selectionAreaData state value",type:{name:"func"}},setSelectionAreas:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"Array",elements:[{name:"object"}],raw:"object[]"}],raw:"SetStateAction<object[]>"}],raw:"Dispatch<SetStateAction<object[]>>"},description:"Setter fn for selectionAreas state value",type:{name:"func"}},totalColumnsWidth:{required:!1,tsType:{name:"number"},description:"The total columns width",type:{name:"number"}},totalVisibleColumns:{required:!1,tsType:{name:"number"},description:`The total number of columns to be initially visible, additional columns will be rendered and
visible via horizontal scrollbar`,type:{name:"number"}},visibleColumns:{required:!1,tsType:{name:"Array",elements:[{name:"Column",elements:[{name:"object"}],raw:"Column<object>"}],raw:"Column<object>[]"},description:"Prop from react-table used to reorder columns",type:{name:"array"}}}};const ne=`${we.prefix}--data-spreadsheet`,nt=u.forwardRef(({activeCellCoordinates:e,cellSize:t,columns:r,currentMatcher:a,defaultColumn:s,headerGroups:d,scrollBarSize:c,selectionAreas:m,selectedHeaderReorderActive:l,setSelectedHeaderReorderActive:h,setActiveCellCoordinates:x,setCurrentMatcher:A,setSelectionAreas:p,readOnlyTable:f,disableColumnSwapping:i,setSelectionAreaData:b,rows:D,totalVisibleColumns:k,updateActiveCellCoordinates:$,setHeaderCellHoldActive:E,headerCellHoldActive:T,selectAllAriaLabel:V,visibleColumns:w},H)=>{const[N,q]=u.useState(0),z=Ye({cellSize:t})||{};u.useEffect(()=>{var n;if((z==null?void 0:z.cellSize)!==t){const I=(n=H==null?void 0:H.current)==null?void 0:n.querySelector(`.${ne}__list--container`),P=(I==null?void 0:I.scrollHeight)&&(I==null?void 0:I.clientHeight)&&(I==null?void 0:I.scrollHeight)>(I==null?void 0:I.clientHeight)?0:c;I!=null&&I.getAttribute("tabIndex")||I==null||I.setAttribute("tabIndex","0"),q(P)}},[t,H,c,z==null?void 0:z.cellSize]);const J=n=>I=>{const X=Fe(I,"cmd"),P=Fe(I,"shiftKey");Qe({type:"column",activeCellCoordinates:e,rows:D,columns:r,currentMatcher:a,setActiveCellCoordinates:x,setCurrentMatcher:A,setSelectionAreas:p,spreadsheetRef:H,index:n,isKeyboard:void 0,setSelectionAreaData:b,isHoldingCommandKey:X,isHoldingShiftKey:P})},U=()=>{Rt({ref:H,setCurrentMatcher:A,setSelectionAreas:p,rows:D,columns:r,activeCellCoordinates:e,updateActiveCellCoordinates:$})},C=n=>I=>{var ye,Se,De,_e,le,S;if(I.shiftKey)return;const X=m==null?void 0:m.filter(j=>(j==null?void 0:j.matcher)===a),P=H.current.querySelector(`[data-matcher-id="${(ye=X==null?void 0:X[0])==null?void 0:ye.matcher}"]`);P&&P.classList.add(`${ne}__selection-area--element`),typeof h=="function"&&h(!0);const B=I.clientX,O=I.target.getBoundingClientRect(),ie=I.target.getAttribute("data-column-index"),me=B-O.left,K=Math.min(((De=(Se=X==null?void 0:X[0])==null?void 0:Se.point1)==null?void 0:De.column)||0,((le=(_e=X==null?void 0:X[0])==null?void 0:_e.point2)==null?void 0:le.column)||0),L=(P==null?void 0:P.getBoundingClientRect())||new DOMRect,Q=K<parseInt(ie)?me+(O.left-(L==null?void 0:L.left)):me,ee=(S=document==null?void 0:document.querySelector(`.${ne}__list--container`))==null?void 0:S.firstElementChild,se=P==null?void 0:P.cloneNode(),he=P==null?void 0:P.cloneNode();he&&(he.className=`${ne}__reorder-indicator-line`,he.style.width=ae(2)),se.classList.add(`${ne}__selection-area--element-cloned`),se.setAttribute("data-clone-offset-x",`${Q}`),se.setAttribute("data-column-index-original",n),ee==null||ee.appendChild(se),ee==null||ee.appendChild(he),E==null||E(!0)};return Mn({ref:H,headerCellHoldActive:T,defaultColumn:s}),M.createElement("div",{className:be(`${ne}__header--container`),role:"rowgroup"},d==null?void 0:d.map((n,I)=>{const X=Je(n.getHeaderGroupProps(),"key");return M.createElement("div",{key:`header_${I}`,...X,style:{...n.getHeaderGroupProps().style,width:vt({type:"header",headerGroup:n,scrollBarSizeValue:N,totalVisibleColumns:k,defaultColumn:s,totalColumnsWidth:void 0,visibleColumns:w}),overflow:"hidden"},className:`${ne}__tr`},M.createElement("div",{role:"columnheader",className:`${ne}__select-all-cell-container`,style:{width:s==null?void 0:s.rowHeaderWidth,height:s==null?void 0:s.rowHeight}},M.createElement("button",{id:`${ne}__cell--header--header`,"data-row-index":"header","data-column-index":"header",type:"button",style:{width:s==null?void 0:s.rowHeaderWidth},tabIndex:-1,"aria-label":V,onClick:U,className:be(`${ne}__th`,`${ne}--interactive-cell-element`,`${ne}__th--select-all`,{[`${ne}__th--active-header`]:(e==null?void 0:e.column)==="header"&&(e==null?void 0:e.row)==="header"})},"Â ")),n.headers.map((P,B)=>{const O=Je(P.getHeaderProps(),"key"),ie=Xt(B,m,"column",D);return M.createElement("div",{key:`column_${B}`,role:"columnheader",className:`${ne}__columnheader`,...O},M.createElement("button",{id:`${ne}__cell--header--${B}`,"data-row-index":"header","data-column-index":B,tabIndex:-1,onMouseDown:ie&&!f&&!i?C(B):void 0,onMouseUp:ie&&!f&&!i&&typeof h=="function"?()=>h(!1):void 0,onClick:ie?void 0:J(B),style:{height:s==null?void 0:s.rowHeight,width:(P==null?void 0:P.width)||(s==null?void 0:s.width)},className:be(`${ne}__th`,`${ne}--interactive-cell-element`,{[`${ne}__th--active-header`]:(e==null?void 0:e.column)===B||et(B,m,"column"),[`${ne}__th--active-header-disabledSwapping`]:i||f,[`${ne}__th--selected-header`]:ie,[`${ne}__th--selected-header-reorder-active`]:l}),type:"button"},P.render("Header")))}))}))});nt.propTypes={activeCellCoordinates:o.shape({row:o.oneOfType([o.number,o.string]),column:o.oneOfType([o.number,o.string])}),cellSize:o.oneOf(["xs","sm","md","lg"]),columns:o.array,currentMatcher:o.string,defaultColumn:o.shape({rowHeight:o.number,rowHeaderWidth:o.number,width:o.number}),disableColumnSwapping:o.bool,headerCellHoldActive:o.bool,headerGroups:o.arrayOf(o.object),readOnlyTable:o.bool,rows:o.arrayOf(o.object),scrollBarSize:o.number,selectAllAriaLabel:o.string.isRequired,selectedHeaderReorderActive:o.bool,selectionAreas:o.arrayOf(o.object),setActiveCellCoordinates:o.func,setCurrentMatcher:o.func,setHeaderCellHoldActive:o.func,setSelectedHeaderReorderActive:o.func,setSelectionAreaData:o.func,setSelectionAreas:o.func,totalVisibleColumns:o.number,updateActiveCellCoordinates:o.func,visibleColumns:o.array};nt.__docgenInfo={description:"",methods:[],displayName:"DataSpreadsheetHeader",props:{activeCellCoordinates:{required:!1,tsType:{name:"union",raw:"ActiveCellCoordinates | null",elements:[{name:"ActiveCellCoordinates"},{name:"null"}]},description:"Object containing the active cell coordinates",type:{name:"shape",value:{row:{name:"union",value:[{name:"number"},{name:"string"}],required:!1},column:{name:"union",value:[{name:"number"},{name:"string"}],required:!1}}}},cellSize:{required:!1,tsType:{name:"union",raw:"'xs' | 'sm' | 'md' | 'lg'",elements:[{name:"literal",value:"'xs'"},{name:"literal",value:"'sm'"},{name:"literal",value:"'md'"},{name:"literal",value:"'lg'"}]},description:"Specifies the cell height",type:{name:"enum",value:[{value:"'xs'",computed:!1},{value:"'sm'",computed:!1},{value:"'md'",computed:!1},{value:"'lg'",computed:!1}]}},disableColumnSwapping:{required:!1,tsType:{name:"boolean"},description:"Disable column swapping, default false",type:{name:"bool"}},columns:{required:!1,tsType:{name:"unknown"},description:"All of the spreadsheet columns",type:{name:"array"}},currentMatcher:{required:!1,tsType:{name:"string"},description:"uuid that corresponds to the current selection area",type:{name:"string"}},defaultColumn:{required:!1,tsType:{name:"SpreadsheetColumn"},description:"Default spreadsheet sizing values",type:{name:"shape",value:{rowHeight:{name:"number",required:!1},rowHeaderWidth:{name:"number",required:!1},width:{name:"number",required:!1}}}},headerCellHoldActive:{required:!1,tsType:{name:"boolean"},description:"Whether or not a click/hold is active on a header cell",type:{name:"bool"}},headerGroups:{required:!1,tsType:{name:"Array",elements:[{name:"any"}],raw:"any[]"},description:"Headers provided from useTable hook",type:{name:"arrayOf",value:{name:"object"}}},readOnlyTable:{required:!1,tsType:{name:"boolean"},description:"Read-only table",type:{name:"bool"}},rows:{required:!1,tsType:{name:"Array",elements:[{name:"object"}],raw:"object[]"},description:"All of the spreadsheet row data",type:{name:"arrayOf",value:{name:"object"}}},scrollBarSize:{required:!1,tsType:{name:"number"},description:"The scrollbar width",type:{name:"number"}},selectAllAriaLabel:{required:!0,tsType:{name:"string"},description:"The aria label applied to the Select all button",type:{name:"string"}},selectionAreas:{required:!1,tsType:{name:"Array",elements:[{name:"ItemType"}],raw:"ItemType[]"},description:"All of the cell selection area items",type:{name:"arrayOf",value:{name:"object"}}},setActiveCellCoordinates:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"union",raw:"ActiveCellCoordinates | null",elements:[{name:"ActiveCellCoordinates"},{name:"null"}]}],raw:"SetStateAction<ActiveCellCoordinates | null>"}],raw:`Dispatch<
  SetStateAction<ActiveCellCoordinates | null>
>`},description:"Setter fn for activeCellCoordinates value",type:{name:"func"}},selectedHeaderReorderActive:{required:!1,tsType:{name:"boolean"},description:"Header reordering is active",type:{name:"bool"}},setSelectedHeaderReorderActive:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"boolean"}],raw:"SetStateAction<boolean>"}],raw:"Dispatch<SetStateAction<boolean>>"},description:"Set header reordering active or not",type:{name:"func"}},setCurrentMatcher:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"string"}],raw:"SetStateAction<string>"}],raw:"Dispatch<SetStateAction<string>>"},description:"Setter fn for currentMatcher value",type:{name:"func"}},setHeaderCellHoldActive:{required:!1,tsType:{name:"signature",type:"function",raw:"(arg: boolean) => void",signature:{arguments:[{type:{name:"boolean"},name:"arg"}],return:{name:"void"}}},description:"Setter fn for header cell hold active value",type:{name:"func"}},setSelectionAreaData:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"Array",elements:[{name:"object"}],raw:"object[]"}],raw:"SetStateAction<object[]>"}],raw:"Dispatch<SetStateAction<object[]>>"},description:"Setter fn for selectionAreaData state value",type:{name:"func"}},setSelectionAreas:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"Array",elements:[{name:"object"}],raw:"object[]"}],raw:"SetStateAction<object[]>"}],raw:"Dispatch<SetStateAction<object[]>>"},description:"Setter fn for selectionAreas value",type:{name:"func"}},totalVisibleColumns:{required:!1,tsType:{name:"number"},description:`The total number of columns to be initially visible, additional columns will be rendered and
visible via horizontal scrollbar`,type:{name:"number"}},updateActiveCellCoordinates:{required:!1,tsType:{name:"signature",type:"function",raw:"(arg) => void",signature:{arguments:[{name:"arg"}],return:{name:"void"}}},description:"Function used to update the active cell coordinates",type:{name:"func"}},visibleColumns:{required:!1,tsType:{name:"Array",elements:[{name:"Column",elements:[{name:"object"}],raw:"Column<object>"}],raw:"Column<object>[]"},description:"Array of visible columns provided by react-table useTable hook",type:{name:"array"}}}};const Vn=({placementElement:e,coords:t,addToHeader:r=!1,contextRef:a,blockClass:s=`${we.prefix}--data-spreadsheet`,onActiveCellChange:d,activeCellValue:c,activeCellRef:m,cellEditorRef:l,defaultColumn:h})=>{if(!t)return;const x=document.querySelector(`[data-row-index="${t.row}"][data-column-index="${t.column}"]`)||document.querySelector(`.${s}__body--td`),A=x.offsetWidth,p=x.offsetHeight,f=r?a==null?void 0:a.current.querySelector(`.${s}__header--container`):a==null?void 0:a.current.querySelector(`.${s}__list--container`).firstElementChild,i={top:e?e.getBoundingClientRect().top-f.getBoundingClientRect().top:t.row===0?0:p*t.row,left:e?e.getBoundingClientRect().left-f.getBoundingClientRect().left:t.column===0?0+(h.rowHeaderWidth-4):A*t.column+(h.rowHeaderWidth-4)},b=m==null?void 0:m.current;b.style.width=ae(e?e==null?void 0:e.offsetWidth:A),b.style.height=ae(e?e==null?void 0:e.offsetHeight:p),b.style.left=ae(i.left),b.style.top=ae(i.top),b.style.display="block",b.setAttribute("data-active-row-index",typeof(t==null?void 0:t.row)=="number"?t.row:"header"),b.setAttribute("data-active-column-index",typeof(t==null?void 0:t.column)=="number"?t.column:"header"),f.appendChild(b),b.focus(),r||f.appendChild(l.current),typeof(t==null?void 0:t.column)=="number"&&typeof(t==null?void 0:t.row)=="number"&&(d==null||d(c))},Ue=e=>Number(e.replace("rem","")*wn),Bn=e=>{switch(e){case"xs":return Ue(Sn);case"sm":return Ue(yt);case"md":return Ue(bn);case"lg":return Ue(yn);default:return Ue(yt)}},zn=()=>{const e=document.createElement("div");e.setAttribute("style","width: 100px; height: 100px; overflow: scroll; position:absolute; top:-9999px;"),document.body.appendChild(e);const t=e.offsetWidth-e.clientWidth;return document.body.removeChild(e),t},Un=({activeCellCoordinates:e,cellEditorRulerRef:t,columns:r,previousState:a,removeCellEditor:s,rows:d,setActiveCellCoordinates:c,setCurrentMatcher:m,setSelectionAreas:l,spreadsheetRef:h,updateData:x})=>A=>{const{key:p}=A,f=({type:i})=>{const b=()=>{const $=a==null?void 0:a.activeCellCoordinates,E=d[$==null?void 0:$.row].cells[$==null?void 0:$.column];s(),x($==null?void 0:$.row,E.column.id)};xe({spreadsheetRef:h}),b();const D=Ke(),k={row:i==="Enter"?e.row===d.length-1?e.row:e.row+1:e.row,column:i==="Tab"?e.column===r.length-1?e.column:e.column+1:e.column};l([{point1:k,point2:k,matcher:D,areaCreated:!1}]),m(D),t.current.textContent=""};p==="Enter"&&(f({type:"Enter"}),c(i=>({...i,row:i.row===d.length-1?i.row:i.row+1}))),p==="Tab"&&(A.preventDefault(),f({type:"Tab"}),c(i=>({...i,column:i.column===r.length-1?i.column:i.column+1})))},ue=`${we.prefix}--data-spreadsheet`,rt="DataSpreadsheet",$e={columns:Object.freeze([]),data:Object.freeze([]),defaultEmptyRowCount:16,onDataUpdate:Object.freeze(()=>{}),onColDrag:Object.freeze(()=>{}),onActiveCellChange:Object.freeze(()=>{}),onSelectionAreaChange:Object.freeze(()=>{}),theme:"light"};let fe=M.forwardRef(({cellSize:e="sm",className:t,columns:r=$e.columns,data:a=$e.data,defaultEmptyRowCount:s=$e.defaultEmptyRowCount,onDataUpdate:d=$e.onDataUpdate,onColDrag:c=$e.onColDrag,id:m,onActiveCellChange:l=$e.onActiveCellChange,onSelectionAreaChange:h=$e.onSelectionAreaChange,renderRowHeader:x,renderRowHeaderDirection:A,disableColumnSwapping:p=!1,readOnlyTable:f=!1,selectAllAriaLabel:i,spreadsheetAriaLabel:b,theme:D,totalVisibleColumns:k,...$},E)=>{const T=u.useRef(null),V=u.useRef(void 0),w=E||V,H=An(),[N,q]=u.useState(r),[z,J]=u.useState([]),[U,C]=u.useState(!1),[n,I]=u.useState(null),[X,P]=u.useState([]),[B,O]=u.useState([]),[ie,me]=u.useState(!1),[K,L]=u.useState(""),[Q,ee]=u.useState(!1),[se,he]=u.useState(""),[ye,Se]=u.useState(!1),[De,_e]=u.useState(!1),le=u.useRef(!1),[S,j]=u.useState(!1),[W,Y]=u.useState(!1),_=Ye({activeCellCoordinates:n,isEditing:Q,cellEditorValue:se,selectedHeaderReorderActive:De})||{},Z=Bn(e),R=u.useRef(void 0),[ge,Oe]=u.useState(),pe=u.useRef(void 0),te=u.useRef(void 0),Ze=typeof x=="function",at=a.length.toString().length,ke=u.useMemo(()=>({width:150,rowHeaderWidth:Ze?40+at*8.56:64,rowHeight:Z}),[Z,Ze,at]),{keysPressedList:st,usingMac:ot}=gn({ref:T,containerHasFocus:U,isEditing:Q}),ct=u.useMemo(()=>zn(),[]),{getTableProps:Jt,getTableBodyProps:Qt,headerGroups:lt,rows:oe,totalColumnsWidth:Yt,prepareRow:Zt,setColumnOrder:Gt,visibleColumns:Ge}=Ce.useTable({columns:r,data:a,defaultColumn:ke},Ce.useBlockLayout,Ce.useColumnOrder),ze=u.useCallback((g,y,F)=>{d(G=>G.map((ce,Ae)=>Ae===g?{...G[g],[y]:se||F}:ce))},[se,d]);u.useEffect(()=>{const g=[];Object.keys(N).length>0&&Object.keys(N).forEach(y=>{typeof N[y].Header=="object"?N[y].column_name?g.push(N[y].column_name):g.push(Dn(N[y].Header)):N[y].Header&&g.push(N[y].Header)}),_.selectedHeaderReorderActive&&J(g),!_.selectedHeaderReorderActive&&z.length>0&&!ye&&JSON.stringify(g)!==JSON.stringify(z)&&(c({headers:g,data:ge.props.data}),g.length===0&&J([]))},[_==null?void 0:_.selectedHeaderReorderActive,N,ye,r,ge,c,z]);const Re=u.useCallback(()=>{var y;const g=(y=w==null?void 0:w.current)==null?void 0:y.querySelector(`.${ue}__active-cell--highlight`);g&&(g.style.display="none")},[w]),Ie=u.useCallback(()=>{he(""),ee(!1),R!=null&&R.current&&(R.current.style.display="none")},[]);u.useEffect(()=>{const g=_==null?void 0:_.activeCellCoordinates;if(((g==null?void 0:g.row)!==(n==null?void 0:n.row)||(g==null?void 0:g.column)!==(n==null?void 0:n.column))&&Q){const y=oe[Number(g==null?void 0:g.row)].cells[Number(g==null?void 0:g.column)];Ie(),ze(g==null?void 0:g.row,y.column.id,void 0),te!=null&&te.current&&(te.current.textContent="")}if((g==null?void 0:g.row)!==(n==null?void 0:n.row)||(g==null?void 0:g.column)!==(n==null?void 0:n.column)){if(n&&(n==null?void 0:n.row)!=="header"&&(n==null?void 0:n.column)!=="header"){const y=typeof(n==null?void 0:n.column)=="number"&&typeof(n==null?void 0:n.row)=="number"?oe[n==null?void 0:n.row].cells[n==null?void 0:n.column]:null;Oe(y?y.render("Cell"):null)}(n&&(n==null?void 0:n.row)==="header"||(n==null?void 0:n.column)==="header")&&(Oe(null),j(y=>!y))}Q&&_.activeCellCoordinates&&le.current&&(Oe(_.cellEditorValue),le.current=!1,Ie())},[le,n,_==null?void 0:_.activeCellCoordinates,_==null?void 0:_.cellEditorValue,ze,oe,Q,Ie,ge]);const Ct=u.useCallback(({placementElement:g,coords:y,addToHeader:F=!1})=>{const G=typeof(y==null?void 0:y.column)=="number"&&typeof(y==null?void 0:y.row)=="number"?oe[y==null?void 0:y.row].cells[y==null?void 0:y.column]:null,ce=G?Object.values(G.row.values)[y==null?void 0:y.column]:null;Vn({placementElement:g,coords:y,addToHeader:F,contextRef:w,blockClass:ue,onActiveCellChange:l,activeCellValue:ce,activeCellRef:pe,cellEditorRef:R,defaultColumn:ke})},[w,oe,l,ke]);Hn({focusedElement:H,removeActiveCell:Re,setContainerHasFocus:C}),Tn({isBlurSpreadsheet:le,spreadsheetRef:w,setActiveCellCoordinates:I,setSelectionAreas:P,removeActiveCell:Re,setContainerHasFocus:C,removeCellEditor:Ie}),_n({spreadsheetRef:w,activeCellCoordinates:n,containerHasFocus:U,createActiveCell:Ct,activeCellContent:ge,isActiveHeaderCellChanged:S});const it=u.useCallback(()=>{Y(!1),n||I({column:"header",row:"header"})},[n]),He=u.useCallback(({coords:g={...n},updatedValue:y,optOutOfSelectionAreaUpdate:F=!1})=>{const G={...g,...y};if(I(G),G.row!=="header"&&G.column!=="header"&&!F){const ce=Ke();P([{point1:G,matcher:ce}]),L(ce)}},[n]),ut=u.useCallback(({type:g})=>{const y={...n};He({coords:y,updatedValue:{column:g==="Home"?0:r.length-1}}),xe({matcher:void 0,spreadsheetRef:w})},[n,He,w,r.length]),mt=u.useCallback(g=>Q||g==="Meta"||g==="Control",[Q]),dt=u.useCallback(g=>{event==null||event.preventDefault(),it();const y={...n};let F;switch(g){case"ArrowLeft":{if(y.column==="header")return;typeof y.column=="number"&&(y.column===0?F={column:"header"}:F={column:y.column-1});break}case"ArrowUp":{if(y.row==="header")return;typeof y.row=="number"&&(y.row===0?F={row:"header"}:F={row:y.row-1});break}case"ArrowRight":{if(y.column==="header"&&(F={column:0}),typeof y.column=="number"){if(r.length-1===y.column)return;F={column:y.column+1}}break}case"ArrowDown":{if(y.row==="header"&&(F={row:0}),typeof y.row=="number"){if(oe.length-1===y.row)return;F={row:y.row+1}}break}}F&&He({coords:y,updatedValue:F})},[it,He,n,r,oe]),en=u.useCallback(g=>{Wn(g,W,He,n,Re,r,oe,w,K,Ie,X,ut,st,ot,ze,mt,dt,P,O,L,pe,I,C,Oe,f)},[W,He,n,Re,r,oe,w,K,Ie,X,ut,st,ot,ze,mt,dt,f]),ht=()=>{var F,G,ce,Ae,gt;ee(!0),me(!1);const g=typeof(n==null?void 0:n.column)=="number"&&typeof(n==null?void 0:n.row)=="number"?oe[n==null?void 0:n.row].cells[n==null?void 0:n.column]:null,y=(ce=(G=(F=g==null?void 0:g.row)==null?void 0:F.cells)==null?void 0:G[Number(n==null?void 0:n.column)])==null?void 0:ce.value;he(y||""),te!=null&&te.current&&(te.current.textContent=y),R!=null&&R.current&&(pe!=null&&pe.current)&&(R.current.style.width=(gt=(Ae=pe==null?void 0:pe.current)==null?void 0:Ae.style)==null?void 0:gt.width)};u.useEffect(()=>{var g,y,F,G,ce,Ae;Q&&!(_!=null&&_.isEditing)&&((ce=R==null?void 0:R.current)==null||ce.setSelectionRange(Number((y=(g=te==null?void 0:te.current)==null?void 0:g.textContent)==null?void 0:y.length),Number((G=(F=te==null?void 0:te.current)==null?void 0:F.textContent)==null?void 0:G.length)),(Ae=R==null?void 0:R.current)==null||Ae.focus())},[Q,_==null?void 0:_.isEditing]);const tn=()=>{if((n==null?void 0:n.row)==="header"||(n==null?void 0:n.column)==="header"){const g=(n==null?void 0:n.row)==="header"?n==null?void 0:n.column:n==null?void 0:n.row;if((n==null?void 0:n.row)==="header"&&(n==null?void 0:n.column)==="header")return;pt({isKeyboard:!1,index:Number(g)})}},nn=()=>{me(!1)},rn=()=>{if((n==null?void 0:n.row)!=="header"||(n==null?void 0:n.column)!=="header"){const g=Ke();me(!0),xe({matcher:null,spreadsheetRef:w}),P([{point1:n,matcher:g}]),L(g),O([]),Y(!1)}},an=g=>{const{key:y}=g;y==="Enter"&&!W&&!f&&((n==null?void 0:n.column)!=="header"&&(n==null?void 0:n.row)!=="header"&&ht(),((n==null?void 0:n.row)==="header"||(n==null?void 0:n.column)==="header")&&pt({isKeyboard:!0}))},pt=({isKeyboard:g,index:y=-1})=>{const F={activeCellCoordinates:n,rows:oe,columns:r,currentMatcher:K,setActiveCellCoordinates:I,setCurrentMatcher:L,setSelectionAreas:P,spreadsheetRef:w,index:y,isKeyboard:g,setSelectionAreaData:O,isHoldingCommandKey:null,isHoldingShiftKey:null};(n==null?void 0:n.row)==="header"&&(n==null?void 0:n.column)!=="header"&&Qe({type:"column",...F}),(n==null?void 0:n.column)==="header"&&(n==null?void 0:n.row)!=="header"&&Qe({type:"row",...F}),(n==null?void 0:n.column)==="header"&&(n==null?void 0:n.row)==="header"&&Rt({ref:w,setCurrentMatcher:L,setSelectionAreas:P,rows:oe,columns:r,activeCellCoordinates:n,updateActiveCellCoordinates:He})},sn=g=>{g||ht()};In({isEditing:Q,rows:oe,activeCellCoordinates:n,activeCellRef:pe,cellEditorRef:R,cellEditorRulerRef:te,visibleColumns:Ge,defaultColumn:ke,cellEditorValue:se});const ft=u.useCallback((g,y)=>{K&&g&&g.length&&y&&K&&P(F=>{const G=de(F),ce=G.findIndex(Ae=>Ae.matcher===K);return ce===-1?F:typeof G[ce].point2=="object"&&G[ce].areaCreated?(G[ce].point2=G[ce].point1,G[ce].areaCreated=!1,Y(!1),xe({matcher:K,spreadsheetRef:w}),G):F})},[w,K]),on=u.useCallback(()=>{ft(X,ie)},[ie,X,ft]);return M.createElement("div",{...$,...Jt(),...xn(rt),className:be(ue,t,`${ue}--interactive-cell-element`,{[`${ue}__container-has-focus`]:U,[`${ue}__${D}`]:D==="dark"}),ref:w,role:"grid",tabIndex:0,"aria-rowcount":(oe==null?void 0:oe.length)||0,"aria-colcount":(r==null?void 0:r.length)||0,"aria-label":b,onKeyDown:en,onFocus:()=>C(!0)},M.createElement("div",{ref:T},M.createElement(nt,{ref:w,activeCellCoordinates:n,cellSize:e,columns:r,currentMatcher:K,defaultColumn:ke,selectedHeaderReorderActive:De,setSelectedHeaderReorderActive:_e,headerGroups:lt,rows:oe,scrollBarSize:ct,selectionAreas:X,setActiveCellCoordinates:I,setSelectionAreas:P,setCurrentMatcher:L,setSelectionAreaData:O,disableColumnSwapping:p,readOnlyTable:f,totalVisibleColumns:k,updateActiveCellCoordinates:He,setHeaderCellHoldActive:Se,headerCellHoldActive:ye,visibleColumns:Ge,selectAllAriaLabel:i}),M.createElement(tt,{activeCellRef:pe,activeCellCoordinates:n,setCurrentColumns:q,ref:w,clickAndHoldActive:ie,setClickAndHoldActive:me,currentMatcher:K,setCurrentMatcher:L,setContainerHasFocus:C,selectedHeaderReorderActive:De,setSelectedHeaderReorderActive:_e,selectionAreas:X,setSelectionAreas:P,headerGroups:lt,defaultColumn:ke,getTableBodyProps:Qt,hasCustomRowHeader:Ze,onDataUpdate:d,renderRowHeaderDirection:A,renderRowHeader:x,onActiveCellChange:l,onSelectionAreaChange:h,prepareRow:Zt,rows:oe,selectionAreaData:B,setSelectionAreaData:O,setActiveCellCoordinates:I,scrollBarSize:ct,totalColumnsWidth:Yt,id:m,columns:r,defaultEmptyRowCount:s,setActiveCellInsideSelectionArea:Y,totalVisibleColumns:k,setHeaderCellHoldActive:Se,setColumnOrder:Gt,visibleColumns:Ge}),M.createElement("button",{onMouseDown:rn,onMouseUp:nn,onClick:tn,onKeyDown:an,onDoubleClick:()=>sn(f),onMouseEnter:on,ref:pe,className:be(`${ue}--interactive-cell-element`,`${ue}__active-cell--highlight`,{[`${ue}__active-cell--with-selection`]:W}),type:"button"},ge),M.createElement("textarea",{id:`${ue}__cell-editor-text-area`,value:se,onKeyDown:Un({activeCellCoordinates:n,cellEditorRulerRef:te,columns:r,previousState:_,removeCellEditor:Ie,rows:oe,setActiveCellCoordinates:I,setCurrentMatcher:L,setSelectionAreas:P,spreadsheetRef:w,updateData:ze}),onChange:g=>{_.isEditing&&(he(g.target.value),te!=null&&te.current&&(te.current.textContent=g.target.value))},ref:R,"aria-labelledby":n?`${ue}__cell--${n==null?void 0:n.row}--${n==null?void 0:n.column}`:"",className:be(`${ue}__cell-editor`,`${ue}--interactive-cell-element`,`${ue}__cell-editor--${e}`,{[`${ue}__cell-editor--active`]:Q})}),M.createElement("pre",{"aria-hidden":!0,ref:te,className:`${ue}__cell-editor-ruler`})))});fe=we.checkComponentEnabled(fe,rt);fe.displayName=rt;fe.propTypes={cellSize:o.oneOf(["xs","sm","md","lg"]),className:o.string,columns:o.arrayOf(o.shape({Header:o.string,accessor:o.oneOfType([o.string,o.func]),Cell:o.func})),data:o.arrayOf(o.shape),defaultEmptyRowCount:o.number,disableColumnSwapping:o.bool,hasCustomRowHeader:o.bool,id:o.oneOfType([o.number,o.string]),onActiveCellChange:o.func,onColDrag:o.func,onDataUpdate:o.func,onSelectionAreaChange:o.func,readOnlyTable:o.bool,renderRowHeader:o.func,renderRowHeaderDirection:o.oneOf(["left","right"]),selectAllAriaLabel:o.string.isRequired,spreadsheetAriaLabel:o.string.isRequired,theme:o.oneOf(["light","dark"]),totalVisibleColumns:o.number};fe.__docgenInfo={description:"DataSpreadsheet: used to organize and display large amounts of structured data, separated by columns and rows in a grid-like format.",methods:[],displayName:"DataSpreadsheet",props:{cellSize:{required:!1,tsType:{name:"union",raw:"'xs' | 'sm' | 'md' | 'lg'",elements:[{name:"literal",value:"'xs'"},{name:"literal",value:"'sm'"},{name:"literal",value:"'md'"},{name:"literal",value:"'lg'"}]},description:"Specifies the cell height",defaultValue:{value:"'sm'",computed:!1},type:{name:"enum",value:[{value:"'xs'",computed:!1},{value:"'sm'",computed:!1},{value:"'md'",computed:!1},{value:"'lg'",computed:!1}]}},className:{required:!1,tsType:{name:"string"},description:"Provide an optional class to be applied to the containing node.",type:{name:"string"}},columns:{required:!1,tsType:{name:"unknown"},description:"The data that will build the column headers",defaultValue:{value:"Object.freeze([])",computed:!0},type:{name:"arrayOf",value:{name:"shape",value:{Header:{name:"string",required:!1},accessor:{name:"union",value:[{name:"string"},{name:"func"}],required:!1},Cell:{name:"func",required:!1}}}}},disableColumnSwapping:{required:!1,tsType:{name:"boolean"},description:"Disable column swapping, default false",defaultValue:{value:"false",computed:!1},type:{name:"bool"}},data:{required:!1,tsType:{name:"unknown"},description:"The spreadsheet data that will be rendered in the body of the spreadsheet component",defaultValue:{value:"Object.freeze([])",computed:!0},type:{name:"arrayOf",value:{name:"shape",value:"",computed:!0}}},defaultEmptyRowCount:{required:!1,tsType:{name:"number"},description:"Sets the number of empty rows to be created when there is no data provided",defaultValue:{value:"16",computed:!1},type:{name:"number"}},hasCustomRowHeader:{required:!1,tsType:{name:"boolean"},description:"Check if has custom row header component attached",type:{name:"bool"}},id:{required:!1,tsType:{name:"union",raw:"number | string",elements:[{name:"number"},{name:"string"}]},description:"The spreadsheet id",type:{name:"union",value:[{name:"number"},{name:"string"}]}},onActiveCellChange:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"The event handler that is called when the active cell changes",defaultValue:{value:"Object.freeze(() => {})",computed:!0},type:{name:"func"}},onColDrag:{required:!1,tsType:{name:"signature",type:"function",raw:"({ ...args }) => void",signature:{arguments:[{name:""}],return:{name:"void"}}},description:"Callback for columns after being dragged",defaultValue:{value:"Object.freeze(() => {})",computed:!0},type:{name:"func"}},onDataUpdate:{required:!1,tsType:{name:"signature",type:"function",raw:"({ ...args }) => void",signature:{arguments:[{name:""}],return:{name:"void"}}},description:"The setter fn for the data prop",defaultValue:{value:"Object.freeze(() => {})",computed:!0},type:{name:"func"}},onSelectionAreaChange:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"The event handler that is called when the selection area values change",defaultValue:{value:"Object.freeze(() => {})",computed:!0},type:{name:"func"}},readOnlyTable:{required:!1,tsType:{name:"boolean"},description:"Read-only table",defaultValue:{value:"false",computed:!1},type:{name:"bool"}},renderRowHeaderDirection:{required:!1,tsType:{name:"union",raw:"'left' | 'right'",elements:[{name:"literal",value:"'left'"},{name:"literal",value:"'right'"}]},description:"Position of the custom row numbering component",type:{name:"enum",value:[{value:"'left'",computed:!1},{value:"'right'",computed:!1}]}},renderRowHeader:{required:!1,tsType:{name:"signature",type:"function",raw:"(index: number) => any[]",signature:{arguments:[{type:{name:"number"},name:"index"}],return:{name:"Array",elements:[{name:"any"}],raw:"any[]"}}},description:"Component next to numbering rows",type:{name:"func"}},selectAllAriaLabel:{required:!0,tsType:{name:"string"},description:"The aria label applied to the Select all button",type:{name:"string"}},spreadsheetAriaLabel:{required:!0,tsType:{name:"string"},description:"The aria label applied to the Data spreadsheet component",type:{name:"string"}},theme:{required:!1,tsType:{name:"union",raw:"'light' | 'dark'",elements:[{name:"literal",value:"'light'"},{name:"literal",value:"'dark'"}]},description:"The theme the DataSpreadsheet should use (only used to render active cell/selection area colors on dark theme)",type:{name:"enum",value:[{value:"'light'",computed:!1},{value:"'dark'",computed:!1}]}},totalVisibleColumns:{required:!1,tsType:{name:"number"},description:`The total number of columns to be initially visible, additional columns will be rendered and
visible via horizontal scrollbar`,type:{name:"number"}}}};const xt=["dog","cat","bird","lizard","frog","hamster","fish","rabbit","snake"],Xe=["Bruno","Willow","Kona","Heidi","Rusty","Bonnie","Cash","Gucci","Brody","Emma","Loki","Angel","Astro","Sherman","Layla","Peanut","Grace","Mickey","Sasha","Finn","Tucker","Bear","Mocha","Roscoe"],Kn=e=>{const t=[];for(let r=0;r<e;r++)t.push(r);return t},Fn=e=>{const t=e&&{ownerName:Xe[Math.floor(Math.random()*Xe.length)],weight:Math.floor(Math.random()*40)},r={petType:xt[Math.floor(Math.random()*xt.length)],firstName:Xe[Math.floor(Math.random()*Xe.length)],age:Math.floor(Math.random()*30),visits:Math.floor(Math.random()*40),health:Math.floor(Math.random()*100)};return e?{...r,...t}:r},Ve=({rows:e,extraColumns:t})=>((a=0)=>{const d=[e][a];return Kn(d).map(()=>({...Fn(t)}))})();function Dt(e){const t={a:"a",h1:"h1",h2:"h2",li:"li",ul:"ul",...Ft(),...e.components};return re.jsxs(re.Fragment,{children:[re.jsx(t.h1,{id:"dataspreadsheet",children:"DataSpreadsheet"}),`
`,re.jsx(t.h2,{id:"table-of-contents",children:"Table of Contents"}),`
`,re.jsxs(t.ul,{children:[`
`,re.jsx(t.li,{children:re.jsx(t.a,{href:"#overview",children:"Overview"})}),`
`,re.jsx(t.li,{children:re.jsx(t.a,{href:"#example-usage",children:"Example usage"})}),`
`,re.jsx(t.li,{children:re.jsx(t.a,{href:"#component-api",children:"Component API"})}),`
`]}),`
`,re.jsx(t.h2,{id:"overview",children:"Overview"}),`
`,`
`,re.jsx(t.h2,{id:"example-usage",children:"Example usage"}),`
`,`
`,re.jsx(cn,{children:re.jsx(ln,{of:qe})}),`
`,re.jsx(t.h2,{id:"code-sample",children:"Code sample"}),`
`,`
`,re.jsx(t.h2,{id:"component-api",children:"Component API"}),`
`,re.jsx(un,{})]})}function Rn(e={}){const{wrapper:t}={...Ft(),...e.components};return t?re.jsx(t,{...e,children:re.jsx(Dt,{...e})}):Dt(e)}const Xn="div[data-story-title*=DataSpreadsheet] .docs-story>div:first-child>div:first-child{overflow:auto;width:100%}",kr={title:"Experimental/Components/Data spreadsheet/DataSpreadsheet",component:fe,tags:["autodocs"],argTypes:{onActiveCellChange:{action:"active cell change"},onColDrag:{action:"on column drag"},onSelectionAreaChange:{action:"selection area change"}},parameters:{styles:Xn,docs:{page:Rn}}},Te=({value:e})=>M.createElement("span",{style:{display:"flex",justifyContent:"flex-end"}},e),vn=[{Header:"Row Index",accessor:(e,t)=>t,Cell:({cell:{value:e}})=>M.createElement(Te,{value:e}),placement:"right",width:275},{Header:"Pet type",accessor:"petType"},{Header:M.createElement("div",null,M.createElement("div",null,M.createElement("span",null,"First Name"),"Â ",M.createElement("span",null,"(Pets)"))),accessor:"firstName",column_name:"First Name"},{Header:"Age",accessor:"age",Cell:({cell:{value:e}})=>M.createElement(Te,{value:e}),placement:"right"},{Header:"Vet visits",accessor:"visits",Cell:({cell:{value:e}})=>M.createElement(Te,{value:e}),placement:"right"},{Header:"Health",accessor:"health",Cell:({cell:{value:e}})=>M.createElement(Te,{value:e}),placement:"right"}],Be=[{Header:"Row index",accessor:(e,t)=>t,Cell:({cell:{value:e}})=>M.createElement(Te,{value:e}),placement:"right",width:275},{Header:"Pet Type",accessor:"petType"},{Header:"First Name",accessor:"firstName"},{Header:"Age",accessor:"age",Cell:({cell:{value:e}})=>M.createElement(Te,{value:e}),placement:"right"},{Header:"Vet visits",accessor:"visits",Cell:({cell:{value:e}})=>M.createElement(Te,{value:e}),placement:"right"},{Header:"Health",accessor:"health",Cell:({cell:{value:e}})=>M.createElement(Te,{value:e}),placement:"right"}],Jn=({...e})=>{const[t,r]=u.useState(()=>Ve({rows:16})),a=u.useMemo(()=>Be,[]);return M.createElement(fe,{columns:a,data:t,onDataUpdate:r,id:"spreadsheet--id",...e})},Qn=({...e})=>{const[t,r]=u.useState(()=>Ve({rows:1e5})),a=u.useMemo(()=>Be,[]),s=d=>M.createElement(mn,{style:{width:"32px",height:"32px",minWidth:"32px",minHeight:"32px"}},M.createElement(dn,{itemText:`Test item ${d}`}));return M.createElement(fe,{columns:a,data:t,onDataUpdate:r,renderRowHeaderDirection:"Left",renderRowHeader:s,id:"spreadsheet--id",...e})},Yn=({...e})=>{const[t,r]=u.useState(()=>Ve({rows:1e3})),a=u.useMemo(()=>Be,[]);return M.createElement(fe,{columns:a,data:t,onDataUpdate:r,id:"spreadsheet--id",...e})},Zn=({...e})=>{const[t,r]=u.useState([]),a=u.useMemo(()=>[...Be.filter(d=>d.Header!=="Row Index")],[]),s=u.useMemo(()=>a,[a]);return M.createElement(fe,{columns:s,data:t,onDataUpdate:r,id:"spreadsheet--id",...e})},Gn=({...e})=>{const[t,r]=u.useState(()=>Ve({rows:24,extraColumns:!0})),a=u.useMemo(()=>[...Be,{Header:"Owner name",accessor:"ownerName"},{Header:"Weight",accessor:"weight"}],[]),s=u.useMemo(()=>a,[a]);return M.createElement(fe,{columns:s,data:t,onDataUpdate:r,id:"spreadsheet--id",...e})},Cn=({...e})=>{const[t,r]=u.useState(()=>Ve({rows:24,extraColumns:!0})),a=u.useMemo(()=>[...Be,{Header:"Owner name",accessor:"ownerName"},{Header:"Weight",accessor:"weight"}],[]),s=u.useMemo(()=>a,[a]);return M.createElement(fe,{columns:s,data:t,onDataUpdate:r,id:"spreadsheet--id",...e})},er=({...e})=>{const[t,r]=u.useState(()=>Ve({rows:24,extraColumns:!0})),a=c=>{},s=u.useMemo(()=>[...vn,{Header:"Owner name",accessor:"ownerName"},{Header:"Weight",accessor:"weight"}],[]),d=u.useMemo(()=>s,[s]);return M.createElement(fe,{columns:d,data:t,onDataUpdate:r,onColDrag:a,id:"spreadsheet--id",...e})},qe=Jn.bind({});qe.storyName="Basic spreadsheet";qe.args={selectAllAriaLabel:"Select all",spreadsheetAriaLabel:"Example data spreadsheet"};const Le=Yn.bind({});Le.storyName="Large dataset";Le.args={cellSize:"lg",selectAllAriaLabel:"Select all",spreadsheetAriaLabel:"Example data spreadsheet"};const je=Qn.bind({});je.storyName="Large dataset with optional component";je.args={cellSize:"lg",selectAllAriaLabel:"Select all",spreadsheetAriaLabel:"Example data spreadsheet"};const Ee=Zn.bind({});Ee.storyName="Empty with cells";Ee.args={defaultEmptyRowCount:24,selectAllAriaLabel:"Select all",spreadsheetAriaLabel:"Example data spreadsheet"};const Ne=Gn.bind({});Ne.storyName="With many columns";Ne.args={selectAllAriaLabel:"Select all",spreadsheetAriaLabel:"Example data spreadsheet",totalVisibleColumns:5};const Pe=Cn.bind({});Pe.storyName="With different options";Pe.args={readOnlyTable:!1,disableColumnSwapping:!1,selectAllAriaLabel:"Select all",spreadsheetAriaLabel:"Example data spreadsheet",totalVisibleColumns:5};const We=er.bind({});We.storyName="With drag drop  callback";We.args={selectAllAriaLabel:"Select all",spreadsheetAriaLabel:"Example data spreadsheet",totalVisibleColumns:5};var At,_t,Ht;qe.parameters={...qe.parameters,docs:{...(At=qe.parameters)==null?void 0:At.docs,source:{originalSource:`({
  ...args
}) => {
  const [data, setData] = useState(() => generateData({
    rows: 16
  }));
  const columns = useMemo(() => columnData, []);
  return <DataSpreadsheet columns={columns} data={data} onDataUpdate={setData} id="spreadsheet--id" {...args} />;
}`,...(Ht=(_t=qe.parameters)==null?void 0:_t.docs)==null?void 0:Ht.source}}};var Tt,It,$t;Le.parameters={...Le.parameters,docs:{...(Tt=Le.parameters)==null?void 0:Tt.docs,source:{originalSource:`({
  ...args
}) => {
  const [data, setData] = useState(() => generateData({
    rows: 1000
  }));
  const columns = useMemo(() => columnData, []);
  return <DataSpreadsheet columns={columns} data={data} onDataUpdate={setData} id="spreadsheet--id" {...args} />;
}`,...($t=(It=Le.parameters)==null?void 0:It.docs)==null?void 0:$t.source}}};var qt,Mt,Ot;je.parameters={...je.parameters,docs:{...(qt=je.parameters)==null?void 0:qt.docs,source:{originalSource:`({
  ...args
}) => {
  const [data, setData] = useState(() => generateData({
    rows: 100000
  }));
  const columns = useMemo(() => columnData, []);
  const buildComponent = index => <OverflowMenu style={{
    width: '32px',
    height: '32px',
    minWidth: '32px',
    minHeight: '32px'
  }}>
      <OverflowMenuItem itemText={\`Test item \${index}\`} />
    </OverflowMenu>;
  return <DataSpreadsheet columns={columns} data={data} onDataUpdate={setData} renderRowHeaderDirection="Left" renderRowHeader={buildComponent} id="spreadsheet--id" {...args} />;
}`,...(Ot=(Mt=je.parameters)==null?void 0:Mt.docs)==null?void 0:Ot.source}}};var kt,Lt,jt;Ee.parameters={...Ee.parameters,docs:{...(kt=Ee.parameters)==null?void 0:kt.docs,source:{originalSource:`({
  ...args
}) => {
  const [data, setData] = useState([]);
  const columnDataClone = useMemo(() => [...columnData.filter(item => item.Header !== 'Row Index')], []);
  const columns = useMemo(() => columnDataClone, [columnDataClone]);
  return <DataSpreadsheet columns={columns} data={data} onDataUpdate={setData} id="spreadsheet--id" {...args} />;
}`,...(jt=(Lt=Ee.parameters)==null?void 0:Lt.docs)==null?void 0:jt.source}}};var Et,Nt,Pt;Ne.parameters={...Ne.parameters,docs:{...(Et=Ne.parameters)==null?void 0:Et.docs,source:{originalSource:`({
  ...args
}) => {
  const [data, setData] = useState(() => generateData({
    rows: 24,
    extraColumns: true
  }));
  const columnDataClone = useMemo(() => [...columnData, {
    Header: 'Owner name',
    accessor: 'ownerName'
  }, {
    Header: 'Weight',
    accessor: 'weight'
  }], []);
  const columns = useMemo(() => columnDataClone, [columnDataClone]);
  return <DataSpreadsheet columns={columns} data={data} onDataUpdate={setData} id="spreadsheet--id" {...args} />;
}`,...(Pt=(Nt=Ne.parameters)==null?void 0:Nt.docs)==null?void 0:Pt.source}}};var Wt,Vt,Bt;Pe.parameters={...Pe.parameters,docs:{...(Wt=Pe.parameters)==null?void 0:Wt.docs,source:{originalSource:`({
  ...args
}) => {
  const [data, setData] = useState(() => generateData({
    rows: 24,
    extraColumns: true
  }));
  const columnDataClone = useMemo(() => [...columnData, {
    Header: 'Owner name',
    accessor: 'ownerName'
  }, {
    Header: 'Weight',
    accessor: 'weight'
  }], []);
  const columns = useMemo(() => columnDataClone, [columnDataClone]);
  return <DataSpreadsheet columns={columns} data={data} onDataUpdate={setData} id="spreadsheet--id" {...args} />;
}`,...(Bt=(Vt=Pe.parameters)==null?void 0:Vt.docs)==null?void 0:Bt.source}}};var zt,Ut,Kt;We.parameters={...We.parameters,docs:{...(zt=We.parameters)==null?void 0:zt.docs,source:{originalSource:`({
  ...args
}) => {
  const [data, setData] = useState(() => generateData({
    rows: 24,
    extraColumns: true
  }));
  const onColumnDragDrop = tableData => {
    // Dev can debug here
  };
  const columnDataClone = useMemo(() => [...customColumnData, {
    Header: 'Owner name',
    accessor: 'ownerName'
  }, {
    Header: 'Weight',
    accessor: 'weight'
  }], []);
  const columns = useMemo(() => columnDataClone, [columnDataClone]);
  return <DataSpreadsheet columns={columns} data={data} onDataUpdate={setData} onColDrag={onColumnDragDrop} id="spreadsheet--id" {...args} />;
}`,...(Kt=(Ut=We.parameters)==null?void 0:Ut.docs)==null?void 0:Kt.source}}};const Lr=["dataSpreadsheet","largeDatasetSpreadsheet","largeDatasetSpreadsheetCustom","emptyWithCells","withManyColumns","withDifferentOptions","withDragDropCallback"];export{Lr as __namedExportsOrder,qe as dataSpreadsheet,kr as default,Ee as emptyWithCells,Le as largeDatasetSpreadsheet,je as largeDatasetSpreadsheetCustom,Pe as withDifferentOptions,We as withDragDropCallback,Ne as withManyColumns};
