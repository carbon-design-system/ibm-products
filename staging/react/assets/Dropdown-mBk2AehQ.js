import{e as n,a as Oe,b as Ke,r,u as Se,d as Be,c as x,_ as g,C as Ue,f as qe,s as ze,g as He,h as We,P as t,i as N}from"./iframe-DKsKIeO_.js";import{u as de,L as $,a as Ve,b as Ge}from"./index-CQX_odjL.js";import{m as Je}from"./mergeRefs-D4pwfk3t.js";import{F as Qe}from"./FormContext-DnXssUoQ.js";import{A as Xe}from"./index-zH3n7d5W.js";import{i as Ye}from"./utils-BNH49ZRR.js";import{W as Ze,a as es}from"./bucket-19-CjGrDCAa.js";const{ItemMouseMove:ss,MenuMouseLeave:ts}=de.stateChangeTypes,ie=o=>typeof o=="string"?o:typeof o=="number"?`${o}`:o!==null&&typeof o=="object"&&"label"in o&&typeof o.label=="string"?o.label:"";function ce(o,I){const{changes:c,type:f}=I;switch(f){case ss:case ts:return c.highlightedIndex===o.highlightedIndex?o:c;default:return c}}const pe=n.forwardRef(({autoAlign:o=!1,className:I,decorator:c,disabled:f=!1,direction:j="bottom",items:T,label:R,["aria-label"]:ue,ariaLabel:fe,itemToString:d=ie,itemToElement:O=null,renderSelectedItem:K,type:be="default",size:E,onChange:k,id:me,titleText:D="",hideLabel:we,helperText:C="",translateWithId:ye,light:S,invalid:a,invalidText:ge,warn:h,warnText:he,initialSelectedItem:B,selectedItem:U,downshiftProps:q,readOnly:_,slug:F,..._e},xe)=>{const w=Oe("enable-v12-dynamic-floating-styles"),{refs:b,floatingStyles:z,middlewareData:$e}=Ke(w||o?{placement:j,strategy:"fixed",middleware:[ze({apply({rects:e,elements:l}){Object.assign(l.floating.style,{width:`${e.reference.width}px`})}}),o&&He(),o&&We()],whileElementsMounted:qe}:{});r.useEffect(()=>{if(w||o){const e={...z,visibility:$e.hide?.referenceHidden?"hidden":"visible"};Object.keys(e).forEach(l=>{b.floating.current&&(b.floating.current.style[l]=e[l])})}},[z,o,b.floating]);const s=Se(),{isFluid:H}=r.useContext(Qe),W=r.useCallback(({selectedItem:e})=>{k&&k({selectedItem:e??null})},[k]),V=r.useCallback((e,l)=>e!==null&&typeof e=="object"&&"disabled"in e&&e.disabled===!0,[]),G=r.useCallback(e=>{const{highlightedIndex:l}=e;if(l!==void 0&&l>-1&&typeof window!==void 0){const u=document.querySelectorAll(`li.${s}--list-box__menu-item[role="option"]`)[l];u&&u.scrollIntoView({behavior:"smooth",block:"nearest"})}},[s]),v=r.useMemo(()=>T,[T]),J=r.useMemo(()=>({items:v,itemToString:d,initialSelectedItem:B,onSelectedItemChange:W,stateReducer:ce,isItemDisabled:V,onHighlightedIndexChange:G,...q}),[v,d,B,W,ce,V,G,q]),Ie=Be();U!==void 0&&(J.selectedItem=U);const{isOpen:m,getToggleButtonProps:Ee,getLabelProps:ke,getMenuProps:Q,getItemProps:De,selectedItem:i,highlightedIndex:Ce}=de(J),p=be==="inline",X=!a&&h,[Fe,P]=r.useState(!1),ve=x(`${s}--dropdown`,{[`${s}--dropdown--invalid`]:a,[`${s}--dropdown--warning`]:X,[`${s}--dropdown--open`]:m,[`${s}--dropdown--focus`]:Fe,[`${s}--dropdown--inline`]:p,[`${s}--dropdown--disabled`]:f,[`${s}--dropdown--light`]:S,[`${s}--dropdown--readonly`]:_,[`${s}--dropdown--${E}`]:E,[`${s}--list-box--up`]:j==="top",[`${s}--autoalign`]:o}),Pe=x(`${s}--label`,{[`${s}--label--disabled`]:f,[`${s}--visually-hidden`]:we}),Ae=x(`${s}--form__helper-text`,{[`${s}--form__helper-text--disabled`]:f}),Le=x(`${s}--dropdown__wrapper`,`${s}--list-box__wrapper`,I,{[`${s}--dropdown__wrapper--inline`]:p,[`${s}--list-box__wrapper--inline`]:p,[`${s}--dropdown__wrapper--inline--invalid`]:p&&a,[`${s}--list-box__wrapper--inline--invalid`]:p&&a,[`${s}--list-box__wrapper--fluid--invalid`]:H&&a,[`${s}--list-box__wrapper--slug`]:F,[`${s}--list-box__wrapper--decorator`]:c}),Y=C?`dropdown-helper-text-${Ie}`:void 0,A=O,y=Ee({"aria-label":ue||fe}),Z=C&&!H?n.createElement("div",{id:Y,className:Ae},C):null,ee=e=>{P(e.type==="focus"&&!i)},se=Je(y.ref,xe),[L,Me]=r.useState(),[te,oe]=r.useState(!1),ne=r.useCallback(e=>{(e.code!=="Space"||!["ArrowDown","ArrowUp"," ","Enter"].includes(e.key))&&oe(!0),(te&&e.code==="Space"||!["ArrowDown","ArrowUp"," ","Enter"].includes(e.key))&&(L&&clearTimeout(L),Me(setTimeout(()=>{oe(!1)},3e3))),["ArrowDown"].includes(e.key)&&P(!1),["Enter"].includes(e.key)&&!i&&!m&&P(!0),y.onKeyDown&&(e.key!=="ArrowUp"||m&&e.key==="ArrowUp")&&y.onKeyDown(e)},[te,L,y]),Ne=r.useMemo(()=>_?{onClick:e=>{e.preventDefault(),se?.current?.focus()},onKeyDown:e=>{["ArrowDown","ArrowUp"," ","Enter"].includes(e.key)&&e.preventDefault()}}:{onKeyDown:ne},[_,ne]),je=r.useMemo(()=>Q({ref:w||o?b.setFloating:null}),[o,Q,b.setFloating,w]),re=F??c,le=Ye(re,Xe)?r.cloneElement(re,{size:"mini"}):null,ae=ke(),Te=r.isValidElement(D)?{id:ae.id}:ae;return n.createElement("div",g({className:Le},_e),D&&n.createElement("label",g({className:Pe},Te),D),n.createElement($,{onFocus:ee,onBlur:ee,size:E,className:ve,invalid:a,invalidText:ge,warn:h,warnText:he,light:S,isOpen:m,ref:w||o?b.setReference:null,id:me},a&&n.createElement(Ze,{className:`${s}--list-box__invalid-icon`}),X&&n.createElement(es,{className:`${s}--list-box__invalid-icon ${s}--list-box__invalid-icon--warning`}),n.createElement("button",g({type:"button",className:`${s}--list-box__field`,disabled:f,"aria-disabled":_?!0:void 0,"aria-describedby":!p&&!a&&!h&&Z?Y:void 0,title:i&&d!==void 0?d(i):ie(R)},y,Ne,{ref:se}),n.createElement("span",{className:`${s}--list-box__label`},i?K?K(i):d(i):R),n.createElement($.MenuIcon,{isOpen:m,translateWithId:ye})),F?le:c?n.createElement("div",{className:`${s}--list-box__inner-wrapper--decorator`},le):"",n.createElement($.Menu,je,m&&v.map((e,l)=>{const M=e!==null&&typeof e=="object",u=De({item:e,index:l}),Re=M&&"text"in e&&O?e.text:d(e);return n.createElement($.MenuItem,g({key:u.id,isActive:i===e,isHighlighted:Ce===l,title:Re,disabled:u["aria-disabled"]},u),typeof e=="object"&&A!==void 0&&A!==null?n.createElement(A,g({key:u.id},e)):d(e),i===e&&n.createElement(Ue,{className:`${s}--list-box__menu-item__selected-icon`}))}))),!p&&!a&&!h&&Z)});pe.displayName="Dropdown";pe.propTypes={"aria-label":t.string,ariaLabel:N(t.string),autoAlign:t.bool,className:t.string,decorator:t.node,direction:t.oneOf(["top","bottom"]),disabled:t.bool,downshiftProps:t.object,helperText:t.node,hideLabel:t.bool,id:t.string.isRequired,initialSelectedItem:t.oneOfType([t.object,t.string,t.number]),invalid:t.bool,invalidText:t.node,itemToElement:t.func,itemToString:t.func,items:t.array.isRequired,label:t.node.isRequired,light:N(t.bool),onChange:t.func,readOnly:t.bool,renderSelectedItem:t.func,selectedItem:t.oneOfType([t.object,t.string,t.number]),size:Ge,slug:N(t.node),titleText:t.node.isRequired,translateWithId:t.func,type:Ve,warn:t.bool,warnText:t.node};export{pe as D};
