import{r as b,u as pe,e as i,c as ce,p as me,B as T,P as e}from"./iframe-DKsKIeO_.js";import{C as ue,M as ye,a as fe,b as ge}from"./ComposedModal-B2ovIMVM.js";import{F as he,a as be}from"./codePreviewer-C1hLMeOy.js";import{T as Te}from"./TextInput-C2qeH2Wa.js";import{g as qe}from"./devtools-Bn3omVKL.js";import{u as Fe}from"./usePortalTarget-Dftb10Sg.js";import{u as N}from"./uuidv4-BN2rGLQG.js";import{A as Ee}from"./bucket-0-Bkg56oSG.js";const z="ImportModal",q=b.forwardRef(({accept:u=[],className:$,defaultErrorBody:y,defaultErrorHeader:f,description:F,fetchErrorBody:w,fetchErrorHeader:C,fileDropHeader:E,fileDropLabel:H,fileUploadLabel:O,inputButtonIcon:R,inputButtonText:P,inputId:k,inputLabel:g,inputPlaceholder:M,invalidFileTypeErrorBody:U,invalidFileTypeErrorHeader:A,invalidIconDescription:L,maxFileSize:v,maxFileSizeErrorBody:j,maxFileSizeErrorHeader:V,onClose:x,onRequestSubmit:G,open:J,portalTarget:K,primaryButtonText:Q,secondaryButtonText:W,title:S,...X},Y)=>{const Z=pe(),[l,c]=b.useState([]),[d,B]=b.useState(""),ee=Fe(K),te=t=>{const s=new Set(u),o=t.name,n=t.type,r=`.${o.split(".").pop()}`;return!(s.has(n)||s.has(r)||u.length===0)},h=t=>{const o=[...t.map(n=>{const r={uuid:n.uuid||N(),status:"edit",iconDescription:L,name:n.name,fileSize:n.size,invalidFileType:n.invalidFileType,fileData:n,fetchError:n.fetchError};return r.fetchError?(r.errorBody=w||y,r.errorSubject=C||f,r.invalid=!0):r.invalidFileType?(r.errorBody=U||y,r.errorSubject=A||f,r.invalid=!0):v&&(r?.fileSize??0)>v&&(r.errorBody=j||y,r.errorSubject=V||f,r.invalid=!0),r})];c(o)},re=async t=>{t.preventDefault();const s=d.substring(d.lastIndexOf("/")+1).split("?")[0],o={name:s,status:"uploading",uuid:N()};c([o]);try{const n=await fetch(d);if(!n.ok||n.status!==200)throw new Error(`${n.status}`);const r=await n.blob(),m=new File([r],s,{type:r.type});m.invalidFileType=te(m),m.uuid=o.uuid,h([m])}catch{const r={...o,fetchError:!0};h([r])}},ie=(t,{addedFiles:s})=>{t.stopPropagation(),h(s)},ne=t=>{const s=l.filter(o=>o.uuid!==t);c(s)},ae=()=>{G(l)},se=t=>{B(t.target.value)},_=()=>{c([]),B(""),x&&x()},D=l.length,I=l.filter(t=>!t.invalid).length,p=D>0,oe=!p||!(I>0),le=!d||p,de=`${I} / ${D} ${O}`,a=`${me.prefix}--import-modal`;return ee(i.createElement(ue,{...X,open:J,ref:Y,...qe(z),"aria-label":S,className:ce(a,$),size:"sm",preventCloseOnClickOutside:!0,onClose:_},i.createElement(ye,{className:`${a}__header`,title:S}),i.createElement(fe,{className:`${a}__body-container`},F&&i.createElement("p",{className:`${a}__body`},F),E&&i.createElement("p",{className:`${a}__file-drop-header`},E),i.createElement(he,{accept:u,labelText:H,onAddFiles:ie,disabled:p,"data-modal-primary-focus":!0}),g&&i.createElement("p",{className:`${a}__label`},g),i.createElement("div",{className:`${a}__input-group`},i.createElement(Te,{labelText:"",id:k||"",onChange:se,placeholder:M,value:d,disabled:p,"aria-label":g}),i.createElement(T,{onClick:re,className:`${a}__import-button`,size:"md",disabled:le,renderIcon:R?t=>i.createElement(Ee,{size:20,...t}):void 0},P)),i.createElement("div",{className:`${Z}--file-container ${a}__file-container`},p&&i.createElement("p",{className:`${a}__helper-text`},de),l.map(t=>i.createElement(be,{key:t.uuid,onDelete:()=>ne(t.uuid),name:t.name,status:t.status,size:"lg",uuid:t.uuid,iconDescription:t.iconDescription,invalid:t.invalid,errorBody:t.errorBody,errorSubject:t.errorSubject,filesize:t.fileSize})))),i.createElement(ge,{className:`${a}__footer`},i.createElement(T,{type:"button",kind:"secondary",onClick:_},W),i.createElement(T,{type:"submit",kind:"primary",onClick:ae,disabled:oe},Q))))});q.propTypes={accept:e.array,className:e.string,defaultErrorBody:e.string.isRequired,defaultErrorHeader:e.string.isRequired,description:e.string,fetchErrorBody:e.string,fetchErrorHeader:e.string,fileDropHeader:e.string,fileDropLabel:e.string,fileUploadLabel:e.string,inputButtonIcon:e.bool,inputButtonText:e.string.isRequired,inputId:e.string,inputLabel:e.string,inputPlaceholder:e.string,invalidFileTypeErrorBody:e.string,invalidFileTypeErrorHeader:e.string,invalidIconDescription:e.string,maxFileSize:e.number,maxFileSizeErrorBody:e.string,maxFileSizeErrorHeader:e.string,onClose:e.func,onRequestSubmit:e.func.isRequired,open:e.bool.isRequired,portalTarget:e.node,primaryButtonText:e.string.isRequired,secondaryButtonText:e.string.isRequired,title:e.string.isRequired};q.displayName=z;q.__docgenInfo={description:"",methods:[],displayName:"ImportModal",props:{accept:{required:!1,tsType:{name:"Array",elements:[{name:"string"}],raw:"string[]"},description:"Specifies the file types that are valid for importing",defaultValue:{value:"[]",computed:!1},type:{name:"array"}},className:{required:!1,tsType:{name:"string"},description:"Optional class name",type:{name:"string"}},defaultErrorBody:{required:!0,tsType:{name:"string"},description:"The default message shown for an import error",type:{name:"string"}},defaultErrorHeader:{required:!0,tsType:{name:"string"},description:"The default header that is displayed to show an error message",type:{name:"string"}},description:{required:!1,tsType:{name:"string"},description:"Content that is displayed inside the modal",type:{name:"string"}},fetchErrorBody:{required:!1,tsType:{name:"string"},description:"Optional error body to display specifically for a fetch error",type:{name:"string"}},fetchErrorHeader:{required:!1,tsType:{name:"string"},description:"Optional error header to display specifically for a fetch error",type:{name:"string"}},fileDropHeader:{required:!1,tsType:{name:"string"},description:"Header for the drag and drop box",type:{name:"string"}},fileDropLabel:{required:!1,tsType:{name:"string"},description:"Label for the drag and drop box",type:{name:"string"}},fileUploadLabel:{required:!1,tsType:{name:"string"},description:"Label that appears when a file is uploaded to show number of files (1 / 1)",type:{name:"string"}},inputButtonIcon:{required:!1,tsType:{name:"boolean"},description:"Button icon for import by url button",type:{name:"bool"}},inputButtonText:{required:!0,tsType:{name:"string"},description:"Button text for import by url button",type:{name:"string"}},inputId:{required:!1,tsType:{name:"string"},description:"ID for text input",type:{name:"string"}},inputLabel:{required:!1,tsType:{name:"string"},description:"Header to display above import by url",type:{name:"string"}},inputPlaceholder:{required:!1,tsType:{name:"string"},description:"Placeholder for text input",type:{name:"string"}},invalidFileTypeErrorBody:{required:!1,tsType:{name:"string"},description:"Optional error message to display specifically for a invalid file type error",type:{name:"string"}},invalidFileTypeErrorHeader:{required:!1,tsType:{name:"string"},description:"Optional error header to display specifically for a invalid file type error",type:{name:"string"}},invalidIconDescription:{required:!1,tsType:{name:"string"},description:"Description for delete file icon",type:{name:"string"}},maxFileSize:{required:!1,tsType:{name:"number"},description:"File size limit in bytes",type:{name:"number"}},maxFileSizeErrorBody:{required:!1,tsType:{name:"string"},description:"Optional error message to display specifically for a max file size error",type:{name:"string"}},maxFileSizeErrorHeader:{required:!1,tsType:{name:"string"},description:"Optional error header to display specifically for a max file size error",type:{name:"string"}},open:{required:!0,tsType:{name:"boolean"},description:"Specify whether the Modal is currently open",type:{name:"bool"}},portalTarget:{required:!1,tsType:{name:"ReactNode"},description:"The DOM node the tearsheet should be rendered within. Defaults to document.body.",type:{name:"node"}},primaryButtonText:{required:!0,tsType:{name:"string"},description:"Specify the text for the primary button",type:{name:"string"}},secondaryButtonText:{required:!0,tsType:{name:"string"},description:"Specify the text for the secondary button",type:{name:"string"}},title:{required:!0,tsType:{name:"string"},description:"The text displayed at the top of the modal",type:{name:"string"}},onClose:{description:"Specify a handler for closing modal",type:{name:"func"},required:!1},onRequestSubmit:{description:'Specify a handler for "submitting" modal. Access the imported file via `file => {}`',type:{name:"func"},required:!0}}};export{q as I};
