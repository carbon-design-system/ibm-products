{"version":3,"file":"makeDraggable-DVDwDKbH.js","sources":["../../src/global/js/utils/makeDraggable/makeDraggable.ts"],"sourcesContent":["/**\n * Copyright IBM Corp. 2025, 2025\n *\n * This source code is licensed under the Apache-2.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n/* eslint-disable jsdoc/check-param-names */\ninterface DraggableProps {\n  /**\n   * HTML element to move.\n   */\n  el: HTMLElement;\n  /**\n   * HTML element to initiate the drag (e.g., header).\n   */\n  dragHandle?: HTMLElement;\n  /**\n   * HTML element to focus on drag for keyboard interaction (e.g., Drag Icon).\n   */\n  focusableDragHandle?: HTMLElement;\n  /**\n   * Pixel value that defines the distance to move when dragging with arrow\n   * keys.\n   */\n  dragStep?: number;\n  /**\n   * Pixel value that defines the distance to move when dragging with\n   * shift+arrow keys.\n   */\n  shiftDragStep?: number;\n}\n\ninterface EventDetail {\n  dragstart: { keyboard?: boolean; mouse?: boolean };\n  dragend: { keyboard?: boolean; mouse?: boolean };\n}\n\n/**\n * Makes a given element draggable using a handle element.\n *@param draggable - object which accepts el and optional attributes handle,focusableInHandle,dragStep and shiftDragStep\n */\nexport const makeDraggable = ({\n  el,\n  dragHandle,\n  focusableDragHandle,\n  dragStep,\n  shiftDragStep,\n}: DraggableProps) => {\n  if (dragHandle) {\n    dragHandle.style.cursor = 'move';\n    el.style.cursor = 'default';\n  } else {\n    el.style.cursor = 'move';\n  }\n\n  let isDragging = false;\n  let offsetX = 0;\n  let offsetY = 0;\n\n  const dispatch = <T extends keyof EventDetail>(\n    type: T,\n    detail: EventDetail[T]\n  ) => {\n    const eventInit: CustomEventInit<EventDetail[T]> = {\n      detail,\n      bubbles: true,\n    };\n    el.dispatchEvent(new CustomEvent(type, eventInit));\n  };\n\n  const onKeyDown = (e: KeyboardEvent) => {\n    if (e.key === 'Enter') {\n      isDragging = !isDragging;\n    }\n    if (isDragging) {\n      dispatch('dragstart', { keyboard: true });\n    } else {\n      dispatch('dragend', { keyboard: true });\n    }\n\n    if (!isDragging) {\n      return;\n    }\n    const distance = e.shiftKey ? (shiftDragStep ?? 32) : (dragStep ?? 8);\n    switch (e.key) {\n      case 'Enter':\n      case ' ':\n        e.preventDefault();\n        break;\n      case 'ArrowLeft':\n        el.style.left = `${el.offsetLeft - distance}px`;\n        break;\n      case 'ArrowRight':\n        el.style.left = `${el.offsetLeft + distance}px`;\n        break;\n      case 'ArrowUp':\n        el.style.top = `${el.offsetTop - distance}px`;\n        break;\n      case 'ArrowDown':\n        el.style.top = `${el.offsetTop + distance}px`;\n        break;\n    }\n  };\n\n  const onMouseDown = (e: MouseEvent) => {\n    const target = e.target;\n    if (!(target instanceof Node)) {\n      return;\n    }\n\n    const isTargetInHandle = dragHandle\n      ? dragHandle.contains(target)\n      : el.contains(target);\n\n    if (!isTargetInHandle) {\n      return;\n    }\n\n    offsetX = e.clientX - el.offsetLeft;\n    offsetY = e.clientY - el.offsetTop;\n    isDragging = true;\n    dispatch('dragstart', { mouse: true });\n\n    document.addEventListener('mousemove', onMouseMove);\n    document.addEventListener('mouseup', onMouseUp, { once: true });\n  };\n\n  const onMouseMove = (e: MouseEvent) => {\n    if (!isDragging) {\n      return;\n    }\n    el.style.left = `${e.clientX - offsetX}px`;\n    el.style.top = `${e.clientY - offsetY}px`;\n  };\n\n  const onMouseUp = () => {\n    if (!isDragging) {\n      return;\n    }\n    isDragging = false;\n    dispatch('dragend', { mouse: true });\n\n    document.removeEventListener('mousemove', onMouseMove);\n  };\n  if (dragHandle) {\n    dragHandle.addEventListener('mousedown', onMouseDown);\n  } else {\n    el.addEventListener('mousedown', onMouseDown);\n  }\n  focusableDragHandle?.addEventListener('keydown', onKeyDown);\n\n  const draggableCleanup = () => {\n    if (dragHandle) {\n      dragHandle.removeEventListener('mousedown', onMouseDown);\n    } else {\n      el.removeEventListener('mousedown', onMouseDown);\n    }\n    focusableDragHandle?.removeEventListener('keydown', onKeyDown);\n    document.removeEventListener('mousemove', onMouseMove);\n    document.removeEventListener('mouseup', onMouseUp);\n  };\n  return {\n    cleanup: draggableCleanup,\n  };\n};\n"],"names":["makeDraggable","el","dragHandle","focusableDragHandle","dragStep","shiftDragStep","isDragging","offsetX","offsetY","dispatch","type","detail","eventInit","onKeyDown","e","distance","onMouseDown","target","onMouseMove","onMouseUp"],"mappings":"AA0CO,MAAMA,EAAgB,CAAC,CAC5B,GAAAC,EACA,WAAAC,EACA,oBAAAC,EACA,SAAAC,EACA,cAAAC,CACF,IAAsB,CAChBH,GACFA,EAAW,MAAM,OAAS,OAC1BD,EAAG,MAAM,OAAS,WAElBA,EAAG,MAAM,OAAS,OAGpB,IAAIK,EAAa,GACbC,EAAU,EACVC,EAAU,EAEd,MAAMC,EAAW,CACfC,EACAC,IACG,CACH,MAAMC,EAA6C,CACjD,OAAAD,EACA,QAAS,EAAA,EAEXV,EAAG,cAAc,IAAI,YAAYS,EAAME,CAAS,CAAC,CACnD,EAEMC,EAAaC,GAAqB,CAUtC,GATIA,EAAE,MAAQ,UACZR,EAAa,CAACA,GAEZA,EACFG,EAAS,YAAa,CAAE,SAAU,EAAA,CAAM,EAExCA,EAAS,UAAW,CAAE,SAAU,EAAA,CAAM,EAGpC,CAACH,EACH,OAEF,MAAMS,EAAWD,EAAE,SAAYT,GAAiB,GAAOD,GAAY,EACnE,OAAQU,EAAE,IAAA,CACR,IAAK,QACL,IAAK,IACHA,EAAE,eAAA,EACF,MACF,IAAK,YACHb,EAAG,MAAM,KAAO,GAAGA,EAAG,WAAac,CAAQ,KAC3C,MACF,IAAK,aACHd,EAAG,MAAM,KAAO,GAAGA,EAAG,WAAac,CAAQ,KAC3C,MACF,IAAK,UACHd,EAAG,MAAM,IAAM,GAAGA,EAAG,UAAYc,CAAQ,KACzC,MACF,IAAK,YACHd,EAAG,MAAM,IAAM,GAAGA,EAAG,UAAYc,CAAQ,KACzC,KAAA,CAEN,EAEMC,EAAeF,GAAkB,CACrC,MAAMG,EAASH,EAAE,OACb,EAAEG,aAAkB,OAQpB,EAJqBf,EACrBA,EAAW,SAASe,CAAM,EAC1BhB,EAAG,SAASgB,CAAM,KAMtBV,EAAUO,EAAE,QAAUb,EAAG,WACzBO,EAAUM,EAAE,QAAUb,EAAG,UACzBK,EAAa,GACbG,EAAS,YAAa,CAAE,MAAO,EAAA,CAAM,EAErC,SAAS,iBAAiB,YAAaS,CAAW,EAClD,SAAS,iBAAiB,UAAWC,EAAW,CAAE,KAAM,GAAM,EAChE,EAEMD,EAAeJ,GAAkB,CAChCR,IAGLL,EAAG,MAAM,KAAO,GAAGa,EAAE,QAAUP,CAAO,KACtCN,EAAG,MAAM,IAAM,GAAGa,EAAE,QAAUN,CAAO,KACvC,EAEMW,EAAY,IAAM,CACjBb,IAGLA,EAAa,GACbG,EAAS,UAAW,CAAE,MAAO,EAAA,CAAM,EAEnC,SAAS,oBAAoB,YAAaS,CAAW,EACvD,EACA,OAAIhB,EACFA,EAAW,iBAAiB,YAAac,CAAW,EAEpDf,EAAG,iBAAiB,YAAae,CAAW,EAE9Cb,GAAqB,iBAAiB,UAAWU,CAAS,EAYnD,CACL,QAXuB,IAAM,CACzBX,EACFA,EAAW,oBAAoB,YAAac,CAAW,EAEvDf,EAAG,oBAAoB,YAAae,CAAW,EAEjDb,GAAqB,oBAAoB,UAAWU,CAAS,EAC7D,SAAS,oBAAoB,YAAaK,CAAW,EACrD,SAAS,oBAAoB,UAAWC,CAAS,CACnD,CAEW,CAEb"}