{"version":3,"file":"TruncatedText-C1WRpy-Y.js","sources":["../../src/global/js/utils/checkForOverflow.ts","../../src/components/TruncatedText/useTruncatedText.ts","../../src/components/TruncatedText/TruncatedText.tsx"],"sourcesContent":["//\n// Copyright IBM Corp. 2024, 2024\n//\n// This source code is licensed under the Apache-2.0 license found in the\n// LICENSE file in the root directory of this source tree.\n//\n\n/**\n * used to calculate if a element is overflowing the width or height of an area\n */\n\nexport const checkWidthOverflow = (el: HTMLElement | null): boolean => {\n  if (el) {\n    return el?.offsetWidth < el?.scrollWidth;\n  }\n  return false;\n};\n\nexport const checkHeightOverflow = (el: HTMLElement | null): boolean => {\n  if (el) {\n    return el?.offsetHeight < el?.scrollHeight;\n  }\n  return false;\n};\n","/**\n * Copyright IBM Corp. 2025\n *\n * This source code is licensed under the Apache-2.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport { useEffect, useRef, useState } from 'react';\nimport { checkHeightOverflow } from '../../global/js/utils/checkForOverflow';\n\ninterface Params {\n  lines?: number;\n  value?: string;\n  expanded?: boolean;\n}\n\nexport default function useTruncatedText({ lines, value, expanded }: Params) {\n  const [truncated, setTruncated] = useState(false);\n  const ref = useRef<HTMLElement>(null);\n\n  useEffect(() => {\n    const resizeObserver = new ResizeObserver(() => {\n      if (!expanded) {\n        const result = checkHeightOverflow(ref.current);\n        if (result !== truncated) {\n          setTruncated(result);\n        }\n      }\n    });\n\n    if (ref.current) {\n      resizeObserver.observe(ref.current);\n    }\n\n    return () => {\n      resizeObserver.disconnect();\n    };\n  }, [expanded, lines, value, truncated]);\n\n  return { ref, truncated };\n}\n","/**\n * Copyright IBM Corp. 2025\n *\n * This source code is licensed under the Apache-2.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React, { forwardRef, useState } from 'react';\nimport cx from 'classnames';\nimport { Tooltip, PopoverAlignment } from '@carbon/react';\nimport { pkg } from '../../settings';\nimport { getDevtoolsProps } from '../../global/js/utils/devtools';\nimport useTruncatedText from './useTruncatedText';\n\nexport interface TruncatedTextProps {\n  /**\n   * Specify how the tooltip should align with the content in tooltip variant. Refer to Carbon tooltip docs for additional information.\n   */\n  align?: PopoverAlignment;\n  /**\n   * Specify whether a auto align functionality should be applied in tooltip variant. Refer to Carbon tooltip docs for additional information.\n   */\n  autoAlign?: boolean;\n  /**\n   * Optional class.\n   */\n  className?: string;\n  /**\n   * The label on the collapse button.\n   */\n  collapseLabel?: string;\n  /**\n   * The label on expand button.\n   */\n  expandLabel?: string;\n  /**\n   * Unique identifier for the element.\n   */\n  id: string;\n  /**\n   * The maximum number of lines to display before truncation.\n   */\n  lines?: number;\n  /**\n   * The method to display the full text when truncated. Options are \"tooltip\" or \"expand\". if not passed, the text would just be truncated with ellipsis.\n   */\n  type?: 'tooltip' | 'expand'; // refactor in web-components. with is reserved\n  /**\n   * The string value to be truncated.\n   */\n  value?: string;\n}\n\nconst blockClass = `${pkg.prefix}--truncated-text`;\nconst componentName = 'TruncatedText';\n\nexport const TruncatedText = forwardRef<HTMLDivElement, TruncatedTextProps>(\n  (props, ref) => {\n    const {\n      align = 'top',\n      autoAlign = false,\n      className,\n      collapseLabel,\n      expandLabel,\n      id = `${blockClass}-default-id`,\n      lines = 2,\n      value,\n      type = 'tooltip',\n      ...rest\n    } = props;\n    const [expanded, setExpanded] = useState(false);\n    const { ref: contentRef, truncated } = useTruncatedText({\n      lines,\n      value,\n      expanded,\n    });\n\n    const textContentStyles = {\n      WebkitLineClamp:\n        (type === 'expand' && !expanded) || type === 'tooltip' ? lines : 'none',\n    };\n\n    const textContentClasses = cx(`${blockClass}__text-content`, {\n      [`${blockClass}__text-content--expanded`]: expanded,\n    });\n\n    const handleExpand = () => {\n      setExpanded(!expanded);\n    };\n\n    const handleExpandKey = (evt: React.KeyboardEvent) => {\n      const { key } = evt;\n      if (key === 'Enter' || key === ' ') {\n        handleExpand();\n      }\n    };\n\n    const valueBody = (\n      <span\n        {...(type === 'tooltip' ? { role: 'button' } : {})}\n        ref={contentRef}\n        className={textContentClasses}\n        id={id}\n        style={textContentStyles}\n      >\n        {value}\n      </span>\n    );\n\n    const tooltipVariant = (\n      <Tooltip align={align} autoAlign={autoAlign} label={value}>\n        {valueBody}\n      </Tooltip>\n    );\n\n    const expandVariant = (\n      <>\n        {valueBody}\n        <span\n          aria-controls={id}\n          aria-expanded={expanded}\n          className={`${blockClass}__expand-toggle`}\n          onClick={handleExpand}\n          onKeyDown={handleExpandKey}\n          role=\"button\"\n          tabIndex={0}\n        >\n          {expanded ? collapseLabel : expandLabel}\n        </span>\n      </>\n    );\n\n    const truncatedBody = type === 'expand' ? expandVariant : tooltipVariant;\n\n    return (\n      <div\n        {...rest}\n        className={cx(blockClass, className)}\n        ref={ref}\n        {...getDevtoolsProps(componentName)}\n      >\n        {truncated ? truncatedBody : valueBody}\n      </div>\n    );\n  }\n);\n\nTruncatedText.displayName = componentName;\n"],"names":["checkHeightOverflow","el","useTruncatedText","lines","value","expanded","truncated","setTruncated","useState","ref","useRef","useEffect","resizeObserver","result","blockClass","pkg","componentName","TruncatedText","forwardRef","props","align","autoAlign","className","collapseLabel","expandLabel","id","type","rest","setExpanded","contentRef","textContentStyles","textContentClasses","cx","handleExpand","handleExpandKey","evt","key","valueBody","React","tooltipVariant","Tooltip","expandVariant","truncatedBody","getDevtoolsProps"],"mappings":"gHAkBO,MAAMA,EAAuBC,GAC9BA,EACKA,GAAI,aAAeA,GAAI,aAEzB,GCNT,SAAwBC,EAAiB,CAAE,MAAAC,EAAO,MAAAC,EAAO,SAAAC,GAAoB,CAC3E,KAAM,CAACC,EAAWC,CAAY,EAAIC,EAAAA,SAAS,EAAK,EAC1CC,EAAMC,EAAAA,OAAoB,IAAI,EAEpCC,OAAAA,EAAAA,UAAU,IAAM,CACd,MAAMC,EAAiB,IAAI,eAAe,IAAM,CAC9C,GAAI,CAACP,EAAU,CACb,MAAMQ,EAASb,EAAoBS,EAAI,OAAO,EAC1CI,IAAWP,GACbC,EAAaM,CAAM,CAEvB,CACF,CAAC,EAED,OAAIJ,EAAI,SACNG,EAAe,QAAQH,EAAI,OAAO,EAG7B,IAAM,CACXG,EAAe,WAAA,CACjB,CACF,EAAG,CAACP,EAAUF,EAAOC,EAAOE,CAAS,CAAC,EAE/B,CAAE,IAAAG,EAAK,UAAAH,CAAA,CAChB,CCaA,MAAMQ,EAAa,GAAGC,EAAI,MAAM,mBAC1BC,EAAgB,gBAETC,EAAgBC,EAAAA,WAC3B,CAACC,EAAOV,IAAQ,CACd,KAAM,CACJ,MAAAW,EAAQ,MACR,UAAAC,EAAY,GACZ,UAAAC,EACA,cAAAC,EACA,YAAAC,EACA,GAAAC,EAAK,GAAGX,CAAU,cAClB,MAAAX,EAAQ,EACR,MAAAC,EACA,KAAAsB,EAAO,UACP,GAAGC,CAAA,EACDR,EACE,CAACd,EAAUuB,CAAW,EAAIpB,EAAAA,SAAS,EAAK,EACxC,CAAE,IAAKqB,EAAY,UAAAvB,CAAA,EAAcJ,EAAiB,CACtD,MAAAC,EACA,MAAAC,EACA,SAAAC,CAAA,CACD,EAEKyB,EAAoB,CACxB,gBACGJ,IAAS,UAAY,CAACrB,GAAaqB,IAAS,UAAYvB,EAAQ,MAAA,EAG/D4B,EAAqBC,EAAG,GAAGlB,CAAU,iBAAkB,CAC3D,CAAC,GAAGA,CAAU,0BAA0B,EAAGT,CAAA,CAC5C,EAEK4B,EAAe,IAAM,CACzBL,EAAY,CAACvB,CAAQ,CACvB,EAEM6B,EAAmBC,GAA6B,CACpD,KAAM,CAAE,IAAAC,GAAQD,GACZC,IAAQ,SAAWA,IAAQ,MAC7BH,EAAA,CAEJ,EAEMI,EACJC,EAAA,cAAC,OAAA,CACE,GAAIZ,IAAS,UAAY,CAAE,KAAM,QAAA,EAAa,CAAA,EAC/C,IAAKG,EACL,UAAWE,EACX,GAAAN,EACA,MAAOK,CAAA,EAEN1B,CAAA,EAICmC,EACJD,EAAA,cAACE,EAAA,CAAQ,MAAApB,EAAc,UAAAC,EAAsB,MAAOjB,GACjDiC,CACH,EAGII,kCAEDJ,EACDC,EAAA,cAAC,OAAA,CACC,gBAAeb,EACf,gBAAepB,EACf,UAAW,GAAGS,CAAU,kBACxB,QAASmB,EACT,UAAWC,EACX,KAAK,SACL,SAAU,CAAA,EAET7B,EAAWkB,EAAgBC,CAAA,CAEhC,EAGIkB,EAAgBhB,IAAS,SAAWe,EAAgBF,EAE1D,OACED,EAAA,cAAC,MAAA,CACE,GAAGX,EACJ,UAAWK,EAAGlB,EAAYQ,CAAS,EACnC,IAAAb,EACC,GAAGkC,EAAiB3B,CAAa,CAAA,EAEjCV,EAAYoC,EAAgBL,CAAA,CAGnC,CACF,EAEApB,EAAc,YAAcD"}