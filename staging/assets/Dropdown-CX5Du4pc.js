import{u as Oe,a as Ke,b as Re,c as Se,d as E,_ as g,C as Be,e as Ue,s as qe,f as ze,h as He,P as t,g as L}from"./index-C360Eztx.js";import{e as l,r}from"./index-DtHxqM--.js";import{u as ce,L as k,a as We,b as Ve}from"./index-CydRNFts.js";import{m as Ge}from"./mergeRefs-91-mP8KM.js";import{F as Je}from"./FormContext-C4Nuixum.js";import{W as Qe,a as Xe}from"./bucket-19-D7HYZr93.js";const{ItemMouseMove:Ye,MenuMouseLeave:Ze}=ce.stateChangeTypes,ae=o=>typeof o=="string"?o:typeof o=="number"?`${o}`:o!==null&&typeof o=="object"&&"label"in o&&typeof o.label=="string"?o.label:"";function ie(o,D){const{changes:c,type:f}=D;switch(f){case Ye:case Ze:return c.highlightedIndex===o.highlightedIndex?o:c;default:return c}}const de=l.forwardRef(({autoAlign:o=!1,className:D,decorator:c,disabled:f=!1,direction:A="bottom",items:O,label:K,["aria-label"]:pe,ariaLabel:ue,itemToString:d=ae,itemToElement:R=null,renderSelectedItem:S,type:fe="default",size:F,onChange:C,id:be,titleText:v="",hideLabel:me,helperText:M="",translateWithId:we,light:B,invalid:a,invalidText:ye,warn:_,warnText:he,initialSelectedItem:U,selectedItem:q,downshiftProps:z,readOnly:x,slug:$,...ge},_e)=>{const y=Oe("enable-v12-dynamic-floating-styles"),{refs:b,floatingStyles:H,middlewareData:xe}=Ke(y||o?{placement:A,strategy:"fixed",middleware:[qe({apply({rects:e,elements:n}){Object.assign(n.floating.style,{width:`${e.reference.width}px`})}}),o&&ze(),o&&He()],whileElementsMounted:Ue}:{});r.useEffect(()=>{var e;if(y||o){const n={...H,visibility:(e=xe.hide)!=null&&e.referenceHidden?"hidden":"visible"};Object.keys(n).forEach(w=>{b.floating.current&&(b.floating.current.style[w]=n[w])})}},[H,o,b.floating]);const s=Re(),{isFluid:W}=r.useContext(Je),V=r.useCallback(({selectedItem:e})=>{C&&C({selectedItem:e??null})},[C]),G=r.useCallback((e,n)=>e!==null&&typeof e=="object"&&"disabled"in e&&e.disabled===!0,[]),J=r.useCallback(e=>{const{highlightedIndex:n}=e;if(n!==void 0&&n>-1&&typeof window!==void 0){const u=document.querySelectorAll(`li.${s}--list-box__menu-item[role="option"]`)[n];u&&u.scrollIntoView({behavior:"smooth",block:"nearest"})}},[s]),N=r.useMemo(()=>O,[O]),Q=r.useMemo(()=>({items:N,itemToString:d,initialSelectedItem:U,onSelectedItemChange:V,stateReducer:ie,isItemDisabled:G,onHighlightedIndexChange:J,...z}),[N,d,U,V,ie,G,J,z]),$e=Se();q!==void 0&&(Q.selectedItem=q);const{isOpen:m,getToggleButtonProps:Ie,getLabelProps:Ee,getMenuProps:X,getItemProps:ke,selectedItem:i,highlightedIndex:De}=ce(Q),p=fe==="inline",Y=!a&&_,[Fe,P]=r.useState(!1),Ce=E(`${s}--dropdown`,{[`${s}--dropdown--invalid`]:a,[`${s}--dropdown--warning`]:Y,[`${s}--dropdown--open`]:m,[`${s}--dropdown--focus`]:Fe,[`${s}--dropdown--inline`]:p,[`${s}--dropdown--disabled`]:f,[`${s}--dropdown--light`]:B,[`${s}--dropdown--readonly`]:x,[`${s}--dropdown--${F}`]:F,[`${s}--list-box--up`]:A==="top",[`${s}--autoalign`]:o}),ve=E(`${s}--label`,{[`${s}--label--disabled`]:f,[`${s}--visually-hidden`]:me}),Me=E(`${s}--form__helper-text`,{[`${s}--form__helper-text--disabled`]:f}),Ne=E(`${s}--dropdown__wrapper`,`${s}--list-box__wrapper`,D,{[`${s}--dropdown__wrapper--inline`]:p,[`${s}--list-box__wrapper--inline`]:p,[`${s}--dropdown__wrapper--inline--invalid`]:p&&a,[`${s}--list-box__wrapper--inline--invalid`]:p&&a,[`${s}--list-box__wrapper--fluid--invalid`]:W&&a,[`${s}--list-box__wrapper--slug`]:$,[`${s}--list-box__wrapper--decorator`]:c}),Z=M?`dropdown-helper-text-${$e}`:void 0,j=R,h=Ie({"aria-label":pe||ue}),ee=M&&!W?l.createElement("div",{id:Z,className:Me},M):null,se=e=>{P(e.type==="focus"&&!i)},I=Ge(h.ref,_e),[T,Pe]=r.useState(),[te,oe]=r.useState(!1),ne=r.useCallback(e=>{(e.code!=="Space"||!["ArrowDown","ArrowUp"," ","Enter"].includes(e.key))&&oe(!0),(te&&e.code==="Space"||!["ArrowDown","ArrowUp"," ","Enter"].includes(e.key))&&(T&&clearTimeout(T),Pe(setTimeout(()=>{oe(!1)},3e3))),["ArrowDown"].includes(e.key)&&P(!1),["Enter"].includes(e.key)&&!i&&!m&&P(!0),h.onKeyDown&&(e.key!=="ArrowUp"||m&&e.key==="ArrowUp")&&h.onKeyDown(e)},[te,T,h]),je=r.useMemo(()=>x?{onClick:e=>{var n;e.preventDefault(),(n=I==null?void 0:I.current)==null||n.focus()},onKeyDown:e=>{["ArrowDown","ArrowUp"," ","Enter"].includes(e.key)&&e.preventDefault()}}:{onKeyDown:ne},[x,ne]),Te=r.useMemo(()=>X({ref:y||o?b.setFloating:null}),[o,X,b.setFloating,y]),le=r.useMemo(()=>{var n;let e=$??c;return e&&((n=e.type)==null?void 0:n.displayName)==="AILabel"?l.cloneElement(e,{size:"mini"}):l.isValidElement(e)?e:null},[$,c]),re=Ee(),Le=r.isValidElement(v)?{id:re.id}:re;return l.createElement("div",g({className:Ne},ge),v&&l.createElement("label",g({className:ve},Le),v),l.createElement(k,{onFocus:se,onBlur:se,size:F,className:Ce,invalid:a,invalidText:ye,warn:_,warnText:he,light:B,isOpen:m,ref:y||o?b.setReference:null,id:be},a&&l.createElement(Qe,{className:`${s}--list-box__invalid-icon`}),Y&&l.createElement(Xe,{className:`${s}--list-box__invalid-icon ${s}--list-box__invalid-icon--warning`}),l.createElement("button",g({type:"button",className:`${s}--list-box__field`,disabled:f,"aria-disabled":x?!0:void 0,"aria-describedby":!p&&!a&&!_&&ee?Z:void 0,title:i&&d!==void 0?d(i):ae(K)},h,je,{ref:I}),l.createElement("span",{className:`${s}--list-box__label`},i?S?S(i):d(i):K),l.createElement(k.MenuIcon,{isOpen:m,translateWithId:we})),$?le:c?l.createElement("div",{className:`${s}--list-box__inner-wrapper--decorator`},le):"",l.createElement(k.Menu,Te,m&&N.map((e,n)=>{const w=e!==null&&typeof e=="object",u=ke({item:e,index:n}),Ae=w&&"text"in e&&R?e.text:d(e);return l.createElement(k.MenuItem,g({key:u.id,isActive:i===e,isHighlighted:De===n,title:Ae,disabled:u["aria-disabled"]},u),typeof e=="object"&&j!==void 0&&j!==null?l.createElement(j,g({key:u.id},e)):d(e),i===e&&l.createElement(Be,{className:`${s}--list-box__menu-item__selected-icon`}))}))),!p&&!a&&!_&&ee)});de.displayName="Dropdown";de.propTypes={"aria-label":t.string,ariaLabel:L(t.string),autoAlign:t.bool,className:t.string,decorator:t.node,direction:t.oneOf(["top","bottom"]),disabled:t.bool,downshiftProps:t.object,helperText:t.node,hideLabel:t.bool,id:t.string.isRequired,initialSelectedItem:t.oneOfType([t.object,t.string,t.number]),invalid:t.bool,invalidText:t.node,itemToElement:t.func,itemToString:t.func,items:t.array.isRequired,label:t.node.isRequired,light:L(t.bool),onChange:t.func,readOnly:t.bool,renderSelectedItem:t.func,selectedItem:t.oneOfType([t.object,t.string,t.number]),size:Ve,slug:L(t.node),titleText:t.node.isRequired,translateWithId:t.func,type:We,warn:t.bool,warnText:t.node};export{de as D};
