import{aT as It,P as l,r as a,e as c,u as xt,k as vt,a as yt,b as St,o as A,c as N,_ as ne,n as wt,d as bt,f as _t,s as Ct,h as At,az as Ce,t as Ae,q as Et,a1 as Ee,E as $e,g as Te}from"./iframe-BBf3bqTv.js";import{u as Oe,L as R,a as $t,b as Tt}from"./index-C9bxGSfS.js";import{m as Ft}from"./mergeRefs-BZpmU3mx.js";import{F as Ot}from"./FormContext-CW3fTVyM.js";import{C as Pt}from"./Checkbox-CFWURQEX.js";import{A as Bt}from"./index-DOwP6x5e.js";import{d as Dt}from"./defaultItemToString-zSItMTD_.js";import{i as Mt}from"./utils-BgfmaY2S.js";import{u as kt}from"./useNormalizedInputProps-BgZ5uQfL.js";import{W as Lt,a as Nt}from"./bucket-19-zmdOpOwk.js";var se,Fe;function Rt(){if(Fe)return se;Fe=1;var u=typeof Element<"u",m=typeof Map=="function",f=typeof Set=="function",S=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function I(t,n){if(t===n)return!0;if(t&&n&&typeof t=="object"&&typeof n=="object"){if(t.constructor!==n.constructor)return!1;var o,r,g;if(Array.isArray(t)){if(o=t.length,o!=n.length)return!1;for(r=o;r--!==0;)if(!I(t[r],n[r]))return!1;return!0}var d;if(m&&t instanceof Map&&n instanceof Map){if(t.size!==n.size)return!1;for(d=t.entries();!(r=d.next()).done;)if(!n.has(r.value[0]))return!1;for(d=t.entries();!(r=d.next()).done;)if(!I(r.value[1],n.get(r.value[0])))return!1;return!0}if(f&&t instanceof Set&&n instanceof Set){if(t.size!==n.size)return!1;for(d=t.entries();!(r=d.next()).done;)if(!n.has(r.value[0]))return!1;return!0}if(S&&ArrayBuffer.isView(t)&&ArrayBuffer.isView(n)){if(o=t.length,o!=n.length)return!1;for(r=o;r--!==0;)if(t[r]!==n[r])return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf&&typeof t.valueOf=="function"&&typeof n.valueOf=="function")return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString&&typeof t.toString=="function"&&typeof n.toString=="function")return t.toString()===n.toString();if(g=Object.keys(t),o=g.length,o!==Object.keys(n).length)return!1;for(r=o;r--!==0;)if(!Object.prototype.hasOwnProperty.call(n,g[r]))return!1;if(u&&t instanceof Element)return!1;for(r=o;r--!==0;)if(!((g[r]==="_owner"||g[r]==="__v"||g[r]==="__o")&&t.$$typeof)&&!I(t[g[r]],n[g[r]]))return!1;return!0}return t!==t&&n!==n}return se=function(n,o){try{return I(n,o)}catch(r){if((r.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw r}},se}var jt=Rt();const Pe=It(jt),zt={compareItems:l.func,sortItems:l.func},Ht=(u,m,{locale:f})=>u.localeCompare(m,f,{numeric:!0}),Kt=(u,{selectedItems:m=[],itemToString:f,compareItems:S,locale:I="en"})=>u.sort((t,n)=>{if(t.isSelectAll)return-1;if(n.isSelectAll)return 1;const o=m.includes(t),r=m.includes(n);return o&&!r?-1:r&&!o?1:S(f(t),f(n),{locale:I})}),le=({isControlled:u,isMounted:m,onChangeHandlerControlled:f,onChangeHandlerUncontrolled:S,selectedItems:I})=>{u?m&&f&&setTimeout(()=>{f({selectedItems:I})},0):S(I)},qt=({disabled:u,onChange:m,initialSelectedItems:f=[],selectedItems:S,selectAll:I=!1,filteredItems:t=[]})=>{const n=a.useRef(!1),o=a.useRef(m),[r,g]=a.useState(f),d=!!S,y=d?S:r,W=a.useCallback(E=>{if(u)return;const j=t.filter(C=>!C?.disabled&&!C?.isSelectAll),G=t.filter(C=>C?.disabled).length;let w;if(E?.isSelectAll&&y.length>0)w=[];else if(E?.isSelectAll&&y.length===0)w=j;else{const C=y.findLastIndex(k=>Pe(k,E));C===-1?(w=y.concat(E),I&&t.length-1===w.length+G&&(w=j)):(w=Ut(y,C),w=w.filter(k=>!k?.isSelectAll))}le({isControlled:d,isMounted:n.current,onChangeHandlerControlled:o.current,onChangeHandlerUncontrolled:g,selectedItems:w})},[u,y,t,I,d]),v=a.useCallback(()=>{u||le({isControlled:d,isMounted:n.current,onChangeHandlerControlled:o.current,onChangeHandlerUncontrolled:g,selectedItems:[]})},[u,d]),V=a.useCallback(E=>{le({isControlled:d,isMounted:n.current,onChangeHandlerControlled:o.current,onChangeHandlerUncontrolled:g,selectedItems:E})},[d]);return a.useEffect(()=>{o.current=m},[m]),a.useEffect(()=>{n.current&&o.current&&!d&&o.current({selectedItems:y})},[d,y]),a.useEffect(()=>(n.current=!0,()=>{n.current=!1}),[]),{clearSelection:v,onItemChange:W,toggleAll:V,selectedItems:y}},Ut=(u,m)=>{const f=u.slice();return f.splice(m,1),f},{ItemClick:Wt,ToggleButtonBlur:Vt,ToggleButtonKeyDownArrowDown:Gt,ToggleButtonKeyDownArrowUp:Jt,ToggleButtonKeyDownEnter:Qt,ToggleButtonKeyDownEscape:Xt,ToggleButtonKeyDownSpaceButton:Yt,ItemMouseMove:Zt,MenuMouseLeave:en,ToggleButtonClick:tn,ToggleButtonKeyDownPageDown:nn,ToggleButtonKeyDownPageUp:sn,FunctionSetHighlightedIndex:ln}=Oe.stateChangeTypes,Be=c.forwardRef(({autoAlign:u=!1,className:m,decorator:f,id:S,items:I,itemToElement:t,itemToString:n=Dt,titleText:o=!1,hideLabel:r,helperText:g,label:d,type:y="default",size:W,disabled:v=!1,initialSelectedItems:V=[],sortItems:E=Kt,compareItems:j=Ht,clearSelectionText:G="To clear selection, press Delete or Backspace",clearAnnouncement:w="all items have been cleared",clearSelectionDescription:C="Total items selected: ",light:k,invalid:De=!1,invalidText:Me,warn:ke=!1,warnText:Le,useTitleInItem:Ne,translateWithId:re,downshiftProps:Re,open:P=!1,selectionFeedback:oe="top-after-reopen",onChange:je,onMenuChange:ae,direction:ie="bottom",selectedItems:ze,readOnly:B,locale:He="en",slug:J},Ke)=>{const $=a.useMemo(()=>I.filter(e=>{if(typeof e=="object"&&e!==null){for(const p in e)if(Object.hasOwn(e,p)&&e[p]===void 0)return!1}return!0}),[I]),Q=$.some(e=>e.isSelectAll),s=xt(),{isFluid:X}=a.useContext(Ot),ce=vt(),[rn,Y]=a.useState(!1),[ue,L]=a.useState(!1),[b,qe]=a.useState(P||!1),[Ue,We]=a.useState(P),[Ve,Ge]=a.useState([]),[Je,fe]=a.useState(!1),T=yt("enable-v12-dynamic-floating-styles")||u,{refs:D,floatingStyles:de,middlewareData:pe}=St(T?{placement:ie,strategy:"fixed",middleware:[u&&_t({crossAxis:!1}),Ct({apply({rects:e,elements:p}){Object.assign(p.floating.style,{width:`${e.reference.width}px`})}}),u&&At()],whileElementsMounted:bt}:{});a.useLayoutEffect(()=>{if(T){const e={...de,visibility:pe.hide?.referenceHidden?"hidden":"visible"};Object.keys(e).forEach(p=>{D.floating.current&&(D.floating.current.style[p]=e[p])})}},[T,de,D.floating,pe,P]);const{selectedItems:z,onItemChange:me,clearSelection:ge}=qt({disabled:v,initialSelectedItems:V,onChange:je,selectedItems:ze,selectAll:Q,filteredItems:$}),Z={selectedItems:z,itemToString:n,compareItems:j,locale:He},Qe={stateReducer:it,isOpen:b,itemToString:e=>Array.isArray(e)&&e.map(p=>n(p)).join(", ")||"",selectedItem:z,items:$,isItemDisabled(e,p){return e?.disabled},...Re},{getToggleButtonProps:Xe,getLabelProps:Ye,getMenuProps:he,getItemProps:Ze,selectedItem:et,highlightedIndex:tt,setHighlightedIndex:Ie}=Oe(Qe),xe=Xe({onFocus:()=>{L(!0)},onBlur:()=>{L(!1)},onKeyDown:e=>{v||((A(e,Ce)||A(e,Ae))&&!b&&(ge(),e.stopPropagation()),!b&&A(e,Ce)&&x.length>0&&fe(!0),(A(e,Et)||A(e,Ee)||A(e,$e))&&!b&&(Ie(0),fe(!1),H(!0)),A(e,Ee)&&x.length===0&&(L(!1),Y(!1)),A(e,Ae)&&b&&L(!0),A(e,$e)&&b&&L(!0))}}),ee=a.useRef(null),nt=Ft(xe.ref,Ke,ee),x=et,H=e=>{qe(e),ae&&ae(e)};Ue!==P&&(H(P),We(P));const _=kt({id:S,disabled:v,readOnly:B,invalid:De,warn:ke}),F=y==="inline",ve=_.warn,ye=!_.warn&&!_.invalid&&g,st=N(`${s}--multi-select__wrapper`,`${s}--list-box__wrapper`,m,{[`${s}--multi-select__wrapper--inline`]:F,[`${s}--list-box__wrapper--inline`]:F,[`${s}--multi-select__wrapper--inline--invalid`]:F&&_.invalid,[`${s}--list-box__wrapper--inline--invalid`]:F&&_.invalid,[`${s}--list-box__wrapper--fluid--invalid`]:X&&_.invalid,[`${s}--list-box__wrapper--slug`]:J,[`${s}--list-box__wrapper--decorator`]:f}),lt=N(`${s}--label`,{[`${s}--label--disabled`]:v,[`${s}--visually-hidden`]:r}),Se=g?`multiselect-helper-text-${ce}`:void 0,rt=`multiselect-field-label-${ce}`,ot=N(`${s}--form__helper-text`,{[`${s}--form__helper-text--disabled`]:v}),at=N(`${s}--multi-select`,{[`${s}--multi-select--invalid`]:_.invalid,[`${s}--multi-select--invalid--focused`]:ue&&_.invalid,[`${s}--multi-select--warning`]:ve,[`${s}--multi-select--inline`]:F,[`${s}--multi-select--selected`]:x&&x.length>0,[`${s}--list-box--up`]:ie==="top",[`${s}--multi-select--readonly`]:B,[`${s}--autoalign`]:T,[`${s}--multi-select--selectall`]:Q});oe==="fixed"?Z.selectedItems=[]:oe==="top-after-reopen"&&(Z.selectedItems=Ve);function it(e,p){const{changes:i,props:M,type:O}=p,{highlightedIndex:h}=i;switch(i.isOpen&&!b&&Ge(z),O){case Yt:case Qt:if(i.selectedItem===void 0||Array.isArray(i.selectedItem))break;return me(i.selectedItem),{...i,highlightedIndex:e.highlightedIndex};case Vt:case Xt:H(!1);break;case tn:return H(i.isOpen||!1),{...i,highlightedIndex:z.length>0?0:void 0};case Wt:return Ie(i.selectedItem),me(i.selectedItem),{...i,highlightedIndex:e.highlightedIndex};case en:return{...i,highlightedIndex:e.highlightedIndex};case ln:return b?{...i,highlightedIndex:$.indexOf(h)}:{...i,highlightedIndex:0};case Gt:case Jt:case nn:case sn:if(h>-1){const K=document.querySelectorAll(`li.${s}--list-box__menu-item[role="option"]`);M.scrollIntoView(K[h])}return h===-1?{...i,highlightedIndex:0}:i;case Zt:return{...i,highlightedIndex:e.highlightedIndex}}return i}const ct=N(`${s}--list-box__field--wrapper`,{[`${s}--list-box__field--wrapper--input-focused`]:ue}),we=e=>{e.target.classList.contains(`${s}--tag__close-icon`)?Y(!1):Y(e.type==="focus")},ut=B?{onClick:e=>{e.preventDefault(),ee.current&&ee.current.focus()},onKeyDown:e=>{["ArrowDown","ArrowUp"," ","Enter"].includes(e.key)&&e.preventDefault()}}:{},te=J??f,be=Mt(te,Bt)?a.cloneElement(te,{size:"mini"}):te,ft=x.length>0&&x.map(e=>e?.text),dt=Q?x.filter(e=>!e.isSelectAll).length:x.length,pt=a.useMemo(()=>he({ref:T?D.setFloating:null}),[T,he,D.setFloating]),_e=Ye(),mt=a.isValidElement(o)?{id:_e.id}:_e,gt=a.useCallback((e,p)=>{const i=e.some(h=>!h.isSelectAll),M=e.filter(h=>!h.isSelectAll).length,O=p.filter(h=>!h.isSelectAll&&!h.disabled).length;return{hasIndividualSelections:i,nonSelectAllSelectedCount:M,totalSelectableCount:O}},[x,$]);return c.createElement("div",{className:st},c.createElement("label",ne({className:lt},mt),o&&o,x.length>0&&c.createElement("span",{className:`${s}--visually-hidden`},C," ",x.length," ",ft,",",G)),c.createElement(R,{onFocus:X?we:void 0,onBlur:X?we:void 0,type:y,size:W,className:at,disabled:v,light:k,invalid:_.invalid,invalidText:Me,warn:_.warn,warnText:Le,isOpen:b,id:S},_.invalid&&c.createElement(Lt,{className:`${s}--list-box__invalid-icon`}),ve&&c.createElement(Nt,{className:`${s}--list-box__invalid-icon ${s}--list-box__invalid-icon--warning`}),c.createElement("div",{className:ct,ref:T?D.setReference:null},x.length>0&&c.createElement(R.Selection,{readOnly:B,clearSelection:!v&&!B?ge:wt,selectionCount:dt,translateWithId:re,disabled:v}),c.createElement("button",ne({type:"button",className:`${s}--list-box__field`,disabled:v,"aria-disabled":v||B,"aria-describedby":!F&&ye?Se:void 0},xe,{ref:nt},ut),c.createElement("span",{id:rt,className:`${s}--list-box__label`},d),c.createElement(R.MenuIcon,{isOpen:b,translateWithId:re})),J?be:f?c.createElement("div",{className:`${s}--list-box__inner-wrapper--decorator`},be):""),c.createElement(R.Menu,pt,b&&E($,Z).map((e,p)=>{const{hasIndividualSelections:i,nonSelectAllSelectedCount:M,totalSelectableCount:O}=gt(x,$),h=e.isSelectAll?M===O&&O>0:x.some(ht=>Pe(ht,e)),K=e.isSelectAll&&i&&M<O,q=Ze({item:e,"aria-selected":h}),U=n(e);return c.createElement(R.MenuItem,ne({key:q.id,isActive:h&&!e.isSelectAll,"aria-label":U,"aria-checked":K?"mixed":h,isHighlighted:tt===p,title:U,disabled:q["aria-disabled"]},q),c.createElement("div",{className:`${s}--checkbox-wrapper`},c.createElement(Pt,{id:`${q.id}__checkbox`,labelText:t?t(e):U,checked:h,title:Ne?U:void 0,indeterminate:K,disabled:v})))})),Je&&c.createElement("span",{"aria-live":"assertive","aria-label":w})),!F&&ye&&c.createElement("div",{id:Se,className:ot},g))});Be.displayName="MultiSelect";Be.propTypes={...zt,autoAlign:l.bool,className:l.string,clearSelectionDescription:l.string,clearSelectionText:l.string,compareItems:l.func,decorator:l.node,direction:l.oneOf(["top","bottom"]),disabled:l.bool,downshiftProps:l.object,helperText:l.node,hideLabel:l.bool,id:l.string.isRequired,initialSelectedItems:l.array,invalid:l.bool,invalidText:l.node,itemToElement:l.func,itemToString:l.func,items:l.array.isRequired,label:l.node.isRequired,light:Te(l.bool),locale:l.string,onChange:l.func,onMenuChange:l.func,open:l.bool,readOnly:l.bool,selectedItems:l.array,selectionFeedback:l.oneOf(["top","fixed","top-after-reopen"]),size:Tt,slug:Te(l.node),sortItems:l.func,titleText:l.node,translateWithId:l.func,type:$t,useTitleInItem:l.bool,warn:l.bool,warnText:l.node};export{Be as M,Ht as a,Kt as d,Pe as i,zt as s,qt as u};
//# sourceMappingURL=MultiSelect-Cw-UfjV_.js.map
