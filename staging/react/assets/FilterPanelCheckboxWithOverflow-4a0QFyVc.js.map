{"version":3,"file":"FilterPanelCheckboxWithOverflow-4a0QFyVc.js","sources":["../../src/components/FilterPanel/FilterPanelCheckboxWithOverflow/FilterPanelCheckboxWithOverflow.js"],"sourcesContent":["/**\n * Copyright IBM Corp. 2024, 2024\n *\n * This source code is licensed under the Apache-2.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React, { useEffect, useRef, useState } from 'react';\n\nimport PropTypes from 'prop-types';\nimport cx from 'classnames';\nimport { OverflowMenu } from '@carbon/react';\nimport { FilterPanelCheckbox } from '../FilterPanelCheckbox';\n\nimport { getDevtoolsProps } from '../../../global/js/utils/devtools';\nimport { pkg } from '../../../settings';\n\n// The block part of our conventional BEM class names (blockClass__E--M).\nconst blockClass = `${pkg.prefix}--filter-panel-checkbox-with-overflow`;\nconst componentName = 'FilterPanelCheckboxWithOverflow';\n\nconst defaults = {\n  overflowMenuProps: {},\n};\n\n/**\n * Provides a filter panel checkbox with an overflow menu.\n *\n * This component's props refer to the Carbon Checkbox,\n * just like FilterPanelCheckbox.\n *\n * Use `overflowMenuProps` for properties specific to the OverflowMenu.\n * @deprecated This component is deprecated\n */\nexport let FilterPanelCheckboxWithOverflow = React.forwardRef(\n  (\n    {\n      children,\n      className,\n      count,\n      id,\n      labelText,\n      overflowMenuProps = defaults.overflowMenuProps,\n      title,\n      ...rest\n    },\n    ref\n  ) => {\n    const [menuIsOpen, setMenuIsOpen] = useState(false);\n    const [showMenuButton, setShowMenuButton] = useState(false);\n    // Destructure overflow menu properties.\n    const { ...other } = overflowMenuProps;\n\n    const backupRef = useRef(undefined);\n    const localRef = ref || backupRef;\n\n    const setHideButton = (activeElement) => {\n      if (!menuIsOpen && !localRef.current.contains(activeElement)) {\n        setShowMenuButton(false);\n      }\n    };\n\n    useEffect(() => {\n      setShowMenuButton(menuIsOpen);\n    }, [menuIsOpen]);\n\n    return (\n      // eslint-disable-next-line jsx-a11y/no-static-element-interactions\n      <div\n        className={cx(blockClass, className, {\n          [`${blockClass}--open`]: menuIsOpen,\n        })}\n        onBlur={({ relatedTarget }) => setHideButton(relatedTarget)}\n        onFocus={() => setShowMenuButton(true)}\n        /**\n         * Desired behavior: onMouseEnter shows the menu, even when the user mouse-presses and -releases the checkbox/label.\n         * Issue: onMouseDown > checkbox/label triggers an onBlur event and hides the menu button.\n         *   Releasing the mouse button then shows the button again.\n         *   This behavior \"flickers\" the menu button.\n         * Solution: onMouseDown > preventDefault prevents onBlur from being called.\n         *   The menu button remains visible at all times.\n         *   This applies only when using the mouse; it is not an issue using the keyboard.\n         */\n        onMouseDown={(event) => event.preventDefault()}\n        onMouseEnter={() => setShowMenuButton(true)}\n        onMouseLeave={() => setHideButton(document.activeElement)}\n        ref={localRef}\n        {...getDevtoolsProps(componentName)}\n      >\n        <FilterPanelCheckbox\n          {...rest}\n          className={cx(`${blockClass}__checkbox`)}\n          count={count}\n          id={id}\n          labelText={labelText}\n          title={title}\n        />\n\n        {showMenuButton && (\n          <OverflowMenu\n            open={overflowMenuProps?.open}\n            className={cx(\n              `${blockClass}__overflow-button`,\n              overflowMenuProps?.menuClass\n            )}\n            menuOptionsClass={cx(\n              `${blockClass}__overflow-options`,\n              overflowMenuProps?.menuOptionsClass\n            )}\n            aria-label={overflowMenuProps?.['aria-label']}\n            iconDescription={overflowMenuProps?.['aria-label']}\n            onOpen={() => setMenuIsOpen(true)}\n            onClose={() => setMenuIsOpen(false)}\n            flipped={overflowMenuProps?.flipped || true}\n            selectorPrimaryFocus={overflowMenuProps?.selectorPrimaryFocus}\n            {...other}\n          >\n            {children}\n          </OverflowMenu>\n        )}\n      </div>\n    );\n  }\n);\n\nFilterPanelCheckboxWithOverflow.deprecated = {\n  level: 'warn',\n  details: `This component is deprecated`,\n};\n\n// Return a placeholder if not released and not enabled by feature flag\nFilterPanelCheckboxWithOverflow = pkg.checkComponentEnabled(\n  FilterPanelCheckboxWithOverflow,\n  componentName\n);\n\nFilterPanelCheckboxWithOverflow.displayName = componentName;\n\nFilterPanelCheckboxWithOverflow.propTypes = {\n  /**\n   * Children containing `OverflowMenuItems`.\n   */\n  children: PropTypes.node.isRequired,\n\n  /**\n   * Optional class to be applied to the containing node.\n   */\n  className: PropTypes.string,\n\n  /**\n   * Number to be displayed with the checkbox.\n   */\n  count: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n\n  /**\n   * Unique identifier.\n   */\n  id: PropTypes.string.isRequired,\n\n  /**\n   * Label to be displayed with the checkbox.\n   */\n  labelText: PropTypes.node.isRequired,\n\n  /**\n   * Checkbox event handler.\n   */\n  onChange: PropTypes.func,\n\n  /**\n   * Props specific to the internal `OverflowMenu` component.\n   */\n  overflowMenuProps: PropTypes.shape({\n    ['aria-label']: PropTypes.string,\n    flipped: PropTypes.bool,\n    menuClass: PropTypes.string,\n    menuOptionsClass: PropTypes.string,\n    open: PropTypes.bool,\n    selectorPrimaryFocus: PropTypes.string,\n  }),\n\n  /**\n   * Optional title attribute for the label.\n   */\n  title: PropTypes.string,\n};\n"],"names":["blockClass","pkg","componentName","defaults","FilterPanelCheckboxWithOverflow","React","children","className","count","id","labelText","overflowMenuProps","title","rest","ref","menuIsOpen","setMenuIsOpen","useState","showMenuButton","setShowMenuButton","other","backupRef","useRef","localRef","setHideButton","activeElement","useEffect","cx","relatedTarget","event","getDevtoolsProps","FilterPanelCheckbox","OverflowMenu","PropTypes"],"mappings":"yMAkBA,MAAMA,EAAa,GAAGC,EAAI,MAAM,wCAC1BC,EAAgB,kCAEhBC,EAAW,CACf,kBAAmB,CAAA,CACrB,EAWO,IAAIC,EAAkCC,EAAM,WACjD,CACE,CACE,SAAAC,EACA,UAAAC,EACA,MAAAC,EACA,GAAAC,EACA,UAAAC,EACA,kBAAAC,EAAoBR,EAAS,kBAC7B,MAAAS,EACA,GAAGC,CAAA,EAELC,IACG,CACH,KAAM,CAACC,EAAYC,CAAa,EAAIC,EAAAA,SAAS,EAAK,EAC5C,CAACC,EAAgBC,CAAiB,EAAIF,EAAAA,SAAS,EAAK,EAEpD,CAAE,GAAGG,CAAA,EAAUT,EAEfU,EAAYC,EAAAA,OAAO,MAAS,EAC5BC,EAAWT,GAAOO,EAElBG,EAAiBC,GAAkB,CACnC,CAACV,GAAc,CAACQ,EAAS,QAAQ,SAASE,CAAa,GACzDN,EAAkB,EAAK,CAE3B,EAEAO,OAAAA,EAAAA,UAAU,IAAM,CACdP,EAAkBJ,CAAU,CAC9B,EAAG,CAACA,CAAU,CAAC,EAIbV,EAAA,cAAC,MAAA,CACC,UAAWsB,EAAG3B,EAAYO,EAAW,CACnC,CAAC,GAAGP,CAAU,QAAQ,EAAGe,CAAA,CAC1B,EACD,OAAQ,CAAC,CAAE,cAAAa,KAAoBJ,EAAcI,CAAa,EAC1D,QAAS,IAAMT,EAAkB,EAAI,EAUrC,YAAcU,GAAUA,EAAM,eAAA,EAC9B,aAAc,IAAMV,EAAkB,EAAI,EAC1C,aAAc,IAAMK,EAAc,SAAS,aAAa,EACxD,IAAKD,EACJ,GAAGO,EAAiB5B,CAAa,CAAA,EAElCG,EAAA,cAAC0B,EAAA,CACE,GAAGlB,EACJ,UAAWc,EAAG,GAAG3B,CAAU,YAAY,EACvC,MAAAQ,EACA,GAAAC,EACA,UAAAC,EACA,MAAAE,CAAA,CAAA,EAGDM,GACCb,EAAA,cAAC2B,EAAA,CACC,KAAMrB,GAAmB,KACzB,UAAWgB,EACT,GAAG3B,CAAU,oBACbW,GAAmB,SAAA,EAErB,iBAAkBgB,EAChB,GAAG3B,CAAU,qBACbW,GAAmB,gBAAA,EAErB,aAAYA,IAAoB,YAAY,EAC5C,gBAAiBA,IAAoB,YAAY,EACjD,OAAQ,IAAMK,EAAc,EAAI,EAChC,QAAS,IAAMA,EAAc,EAAK,EAClC,QAASL,GAAmB,SAAW,GACvC,qBAAsBA,GAAmB,qBACxC,GAAGS,CAAA,EAEHd,CAAA,CACH,CAIR,CACF,EAEAF,EAAgC,WAAa,CAC3C,MAAO,OACP,QAAS,8BACX,EAGAA,EAAkCH,EAAI,sBACpCG,EACAF,CACF,EAEAE,EAAgC,YAAcF,EAE9CE,EAAgC,UAAY,CAI1C,SAAU6B,EAAU,KAAK,WAKzB,UAAWA,EAAU,OAKrB,MAAOA,EAAU,UAAU,CAACA,EAAU,OAAQA,EAAU,MAAM,CAAC,EAK/D,GAAIA,EAAU,OAAO,WAKrB,UAAWA,EAAU,KAAK,WAK1B,SAAUA,EAAU,KAKpB,kBAAmBA,EAAU,MAAM,CAChC,aAAeA,EAAU,OAC1B,QAASA,EAAU,KACnB,UAAWA,EAAU,OACrB,iBAAkBA,EAAU,OAC5B,KAAMA,EAAU,KAChB,qBAAsBA,EAAU,MAAA,CACjC,EAKD,MAAOA,EAAU,MACnB;;;;;;"}