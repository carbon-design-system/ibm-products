import{r as c,n as I,u as $e,k as Te,i as ye,N as Ce,c as g,e as n,_ as Ee,P as t,g as J}from"./iframe-Bn5s87s4.js";import{F as Ne}from"./FormContext-C5gYs1Iz.js";import{g as Re}from"./TextInput-DKAT8fdL.js";import{T as b}from"./Text-DPxQhslY.js";import{A as Ie}from"./index-C9jChmFj.js";import{i as Ae}from"./utils-DQejB-zS.js";import{W as Q,a as U}from"./bucket-19-C9HfQtRN.js";const We=c.forwardRef,X=We((Y,Z)=>{const{className:ee,decorator:y,disabled:d=!1,id:_,labelText:A,hideLabel:te,onChange:W=I,onClick:L=I,onKeyDown:O=I,invalid:o=!1,invalidText:ae="",helperText:v="",light:re,placeholder:ne="",enableCounter:w=!1,maxCount:l,counterMode:s="character",warn:m=!1,warnText:le="",rows:oe=4,slug:C,...f}=Y,e=$e(),{isFluid:i}=c.useContext(Ne),{defaultValue:D,value:F}=f,se=Te(),E=c.useRef(null),u=c.useRef(null),k=c.useRef(null),P=c.useRef(null),z=c.useRef(null),ce=ye([Z,u]);function V(){const r=(D||F||u.current?.value||"").toString();return s==="character"?r.length:r.match(new RegExp("\\p{L}+","gu"))?.length||0}const[$,p]=c.useState(V());c.useEffect(()=>{p(V())},[F,D,s]),Ce(()=>{if(f.cols&&u.current?(u.current.style.width="",u.current.style.resize="none"):u.current&&(u.current.style.width="100%"),!E.current)return;const a=h=>{[k,P,z].forEach(T=>{T.current&&(T.current.style.maxWidth=`${h}px`,T.current.style.overflowWrap="break-word")})},r=new ResizeObserver(([h])=>{a(h.contentRect.width)});return r.observe(E.current),()=>r&&r.disconnect()},[f.cols,o,m]);const q={id:_,onKeyDown:a=>{if(!d&&w&&s==="word"){const r=a.which;(l&&$>=l&&r===32||l&&$>=l&&r===13)&&a.preventDefault()}!d&&O&&O(a)},onPaste:a=>{if(!d&&s==="word"&&w&&typeof l<"u"&&u.current!==null){const r=u.current.value.match(new RegExp("\\p{L}+","gu"))||[],h=a.clipboardData.getData("Text").match(new RegExp("\\p{L}+","gu"))||[];if(r.length+h.length>l){a.preventDefault();const ve=r.concat(h).slice(0,l);setTimeout(()=>{p(l)},0),u.current.value=ve.join(" ")}}},onChange:a=>{if(!d){if(s=="character")a?.persist?.(),setTimeout(()=>{p(a.target?.value?.length)},0);else if(s=="word"){if(!a.target.value){setTimeout(()=>{p(0)},0);return}if(w&&typeof l<"u"&&u.current!==null){const r=a.target?.value?.match(new RegExp("\\p{L}+","gu"));r&&r.length<=l?(u.current.removeAttribute("maxLength"),setTimeout(()=>{p(r.length)},0)):r&&r.length>l&&setTimeout(()=>{p(r.length)},0)}}W&&W(a)}},onClick:a=>{!d&&L&&L(a)}},ie=g(`${e}--form-item`,ee),ue=g(`${e}--text-area__wrapper`,{[`${e}--text-area__wrapper--cols`]:f.cols,[`${e}--text-area__wrapper--readonly`]:f.readOnly,[`${e}--text-area__wrapper--warn`]:m,[`${e}--text-area__wrapper--slug`]:C,[`${e}--text-area__wrapper--decorator`]:y}),de=g(`${e}--label`,{[`${e}--visually-hidden`]:te&&!i,[`${e}--label--disabled`]:d}),me=g(`${e}--text-area`,{[`${e}--text-area--light`]:re,[`${e}--text-area--invalid`]:o,[`${e}--text-area--warn`]:m}),fe=g(`${e}--label`,{[`${e}--label--disabled`]:d,[`${e}--text-area__label-counter`]:!0}),pe=g(`${e}--form__helper-text`,{[`${e}--form__helper-text--disabled`]:d}),xe=A?n.createElement(b,{as:"label",htmlFor:_,className:de},A):null,he=w&&l&&(s==="character"||s==="word")?n.createElement(b,{as:"div",className:fe},`${$}/${l}`):null,K=v?`text-area-helper-text-${se}`:void 0,ge=v?n.createElement(b,{as:"div",id:K,className:pe,ref:k},v):null,M=_+"-error-msg",S=o?n.createElement(b,{as:"div",role:"alert",className:`${e}--form-requirement`,id:M,ref:P},ae,i&&n.createElement(Q,{className:`${e}--text-area__invalid-icon`})):null,we=_+"-warn-msg",j=m?n.createElement(b,{as:"div",role:"alert",className:`${e}--form-requirement`,id:we,ref:z},le,i&&n.createElement(U,{className:`${e}--text-area__invalid-icon ${e}--text-area__invalid-icon--warning`})):null;let N;o?N=M:!o&&!m&&!i&&v&&(N=K),w&&s=="character"&&(q.maxLength=l);const B=c.useRef(null),[G,be]=c.useState(""),x=Re($,l,s==="word"?"word":void 0,s==="word"?"words":void 0);c.useEffect(()=>{if(x&&x!==G){const a=B.current;if(a){a.textContent="";const r=setTimeout(()=>{a&&(a.textContent=x,be(x))},s==="word"?2e3:1e3);return()=>{r&&clearTimeout(r)}}}},[x,G,s]);const _e=n.createElement("textarea",Ee({},f,q,{placeholder:ne,"aria-readonly":!!f.readOnly,className:me,"aria-invalid":o,"aria-describedby":N,disabled:d,rows:oe,readOnly:f.readOnly,ref:ce})),R=C??y,H=Ae(R,Ie)?c.cloneElement(R,{size:"mini"}):R;return n.createElement("div",{className:ie},n.createElement("div",{className:`${e}--text-area__label-wrapper`},xe,he),n.createElement("div",{ref:E,className:ue,"data-invalid":o||null},o&&!i&&n.createElement(Q,{className:`${e}--text-area__invalid-icon`}),m&&!o&&!i&&n.createElement(U,{className:`${e}--text-area__invalid-icon ${e}--text-area__invalid-icon--warning`}),_e,C?H:y?n.createElement("div",{className:`${e}--text-area__inner-wrapper--decorator`},H):"",n.createElement("span",{className:`${e}--text-area__counter-alert`,role:"alert","aria-live":"assertive","aria-atomic":"true",ref:B},x),i&&n.createElement("hr",{className:`${e}--text-area__divider`}),i&&o?S:null,i&&m&&!o?j:null),!o&&!m&&!i?ge:null,o&&!i?S:null,m&&!o&&!i?j:null)});X.displayName="TextArea";X.propTypes={className:t.string,cols:t.number,counterMode:t.oneOf(["character","word"]),decorator:t.node,defaultValue:t.oneOfType([t.string,t.number]),disabled:t.bool,enableCounter:t.bool,helperText:t.node,hideLabel:t.bool,id:t.string,invalid:t.bool,invalidText:t.node,labelText:t.node.isRequired,light:J(t.bool),maxCount:t.number,onChange:t.func,onClick:t.func,onKeyDown:t.func,placeholder:t.string,readOnly:t.bool,rows:t.number,slug:J(t.node),value:t.oneOfType([t.string,t.number]),warn:t.bool,warnText:t.node};export{X as T};
//# sourceMappingURL=TextArea-B64HB26U.js.map
