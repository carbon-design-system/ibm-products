import{j as t,aA as $,r as y,e as n,B as h}from"./iframe-M250dlZ7.js";import{C as D,M as O,a as N,b as T}from"./ComposedModal-NhzZSPcA.js";import{s as M,F as A,a as R}from"./codePreviewer-DD6JGwoq.js";import{T as L}from"./TextInput-Dra6ABgI.js";import{useMDXComponents as w}from"./index-WYgGephs.js";import"./preload-helper-PPVm8Dsz.js";import"./index-DIpZewyL.js";import"./LayerContext-yVVOGJcN.js";import"./clamp--00YEiB8.js";import"./ButtonSet-xXgFBzlD.js";import"./InlineLoading-BTbHugNz.js";import"./bucket-6-lgQV42Us.js";import"./mergeRefs-BZpmU3mx.js";import"./requiredIfGivenPropIsTruthy-C6rAip-Q.js";import"./wrapFocus-CKH4l4Wk.js";import"./Text-WGIoVIHq.js";import"./index-9vrWmNr9.js";import"./bucket-18-CvvInEBI.js";import"./utils-Cr2j69g5.js";import"./AccordionItem-BXjICIGf.js";import"./SkeletonText-DBp1MC2t.js";import"./AspectRatio-DgXwm3WR.js";import"./BreadcrumbItem-BBle1UCS.js";import"./Link-DWMytJHh.js";import"./bucket-13-Dpze7R2Q.js";import"./Checkbox-DS3cJcH0.js";import"./bucket-19-DknlKHKo.js";import"./index-Dty-NTvK.js";import"./inheritsLoose-DHKJTbHM.js";import"./FormContext-DAiGNY-F.js";import"./MultiSelect-DMdYwTxx.js";import"./defaultItemToString-zSItMTD_.js";import"./useAttachedMenu-BO_Sauze.js";import"./DataTable-BfDmdIzX.js";import"./TableRow-jnk_iZex.js";import"./wrapComponent-CksRYI9u.js";import"./bucket-0-CoRfPH3v.js";import"./bucket-1-CPtbOj2G.js";import"./TableToolbar-9eANy881.js";import"./index-BBPQGpGA.js";import"./TableSelectRow-CjSA3Rf7.js";import"./RadioButton-D0PFyiSS.js";import"./useNormalizedInputProps-C9dF-U5T.js";import"./OverflowMenuItem-C2SiIYIF.js";import"./TableToolbarSearch-Hykln28U.js";import"./Search-6U7RTJ9K.js";import"./bucket-15-it1l9wVj.js";import"./index-C5YnOgUR.js";import"./useOutsideClick-BG0etdOe.js";import"./DatePicker-CkmRA_kV.js";import"./bucket-2-DdFQ7vqK.js";import"./documentLang-E105Y72C.js";import"./Dropdown-YWHpcb_t.js";import"./Form-C8Awigu-.js";import"./FormGroup-YykFWvj4.js";import"./FormLabel-D6wWMmyd.js";import"./Grid-Ym8TenAp.js";import"./Row-CQnmn-kw.js";import"./Column-Bq8yhFy2.js";import"./Icon.Skeleton-JnClGNnw.js";import"./ListItem-BquLfS4F.js";import"./MenuItem-wc7p_7-F.js";import"./useControllableState-DI2oM-1V.js";import"./index-A2le3gOJ.js";import"./Notification-DrzXZA9R.js";import"./bucket-10-D9nYOKua.js";import"./NumberInput-DfaWyxjT.js";import"./bucket-17-C2cgme8y.js";import"./useMatchMedia-BmEPSA3S.js";import"./DefinitionTooltip-bvK4A7-l.js";import"./overflowHandler-6nRVSJRW.js";import"./Tag-D-twCAcA.js";import"./OperationalTag-CbgxlcEF.js";import"./Pagination-rY-OMqme.js";import"./Select-DU4lBOvX.js";import"./SelectItem-CFxOi87o.js";import"./ProgressIndicator-BwDEvy7k.js";import"./bucket-9-C3nnU8ie.js";import"./RadioButtonGroup-CbtBYzTv.js";import"./TileGroup-BgZhfiQ2.js";import"./bucket-14-BjdNefFw.js";import"./TimePickerSelect-4Snd9i_a.js";import"./Slider-rzen6ivL.js";import"./StructuredList-C8JH0FiP.js";import"./Tabs-a0WNavXK.js";import"./DismissibleTag-Bwbv5xbp.js";import"./SelectableTag-CyGQuCWv.js";import"./TextArea-C9MthH6g.js";import"./Tile-C-y_5fY_.js";import"./Toggle-Dko9y01G.js";import"./Content-kBNAJffe.js";import"./HeaderName-BJsIfTVk.js";import"./Link-Dr0ySK8X.js";import"./HeaderContainer-DIO6k2Hd.js";import"./HeaderGlobalBar-D9Ng6Evh.js";import"./AriaPropTypes-CMTt-iuh.js";import"./SideNavLink-BYnv8qFX.js";import"./bucket-11-CIC8I2dX.js";import"./SideNavLinkText-B-i3_1vq.js";import"./HeaderPanel-KEgFxJPy.js";import"./SideNavMenuItem-CFzYrX91.js";import"./UnorderedList-D4FOc3Wj.js";import"./bucket-5-BbVtjKk8.js";import"./index-BDrcHp37.js";import"./bucket-7-uQ_GaLvg.js";import"./bucket-8-CbFWt3UK.js";import"./bucket-12-C2QlG1UU.js";import"./bucket-16-du1ogLpJ.js";import"./bucket-20-CyaxLmho.js";const H=".import-and-upload-modal__body{margin-block-end:1.5rem;padding-inline-end:calc(20% - 1rem)}.import-and-upload-modal__body-container .import-and-upload-modal__file-drop-header,.import-and-upload-modal__body-container .import-and-upload-modal__label{margin-block-end:.5rem;font-size:var(--cds-heading-compact-01-font-size, .875rem);font-weight:var(--cds-heading-compact-01-font-weight, 600);line-height:var(--cds-heading-compact-01-line-height, 1.28572);letter-spacing:var(--cds-heading-compact-01-letter-spacing, .16px)}.import-and-upload-modal__body-container .import-and-upload-modal__helper-text{margin-block:1.5rem .5rem;font-size:var(--cds-helper-text-01-font-size, .75rem);line-height:var(--cds-helper-text-01-line-height, 1.33333);letter-spacing:var(--cds-helper-text-01-letter-spacing, .32px)}.import-and-upload-modal__label{margin-block-start:.5rem}.import-and-upload-modal__input-group{display:flex}.import-and-upload-modal__input-group>button{margin-inline-start:.5rem}.import-and-upload-modal__file-container{inline-size:100%}.import-and-upload-modal__file-container>span{max-inline-size:none}";function C(a){const e={a:"a",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",ul:"ul",...w(),...a.components};return t.jsxs(t.Fragment,{children:[t.jsx(e.h1,{id:"import-and-upload",children:"Import And Upload"}),`
`,t.jsxs(e.p,{children:[t.jsx(e.a,{href:"https://pages.github.ibm.com/carbon/ibm-products/patterns/export/usage/",rel:"nofollow",children:"Usage guidelines"}),`
|
`,t.jsx(e.a,{href:"https://www.carbondesignsystem.com/components/modal/usage",rel:"nofollow",children:"Carbon modal usage guidelines"}),`
|
`,t.jsx(e.a,{href:"https://react.carbondesignsystem.com/?path=/docs/components-modal",rel:"nofollow",children:"Carbon modal documentation"})]}),`
`,t.jsx(e.h2,{id:"table-of-contents",children:"Table of Contents"}),`
`,t.jsxs(e.ul,{children:[`
`,t.jsx(e.li,{children:t.jsx(e.a,{href:"#overview",children:"Overview"})}),`
`,t.jsxs(e.li,{children:[t.jsx(e.a,{href:"#example-usage",children:"Example usage"}),`
`,t.jsxs(e.ul,{children:[`
`,t.jsx(e.li,{children:t.jsx(e.a,{href:"#standard",children:"Standard"})}),`
`]}),`
`]}),`
`]}),`
`,t.jsx(e.h2,{id:"overview",children:"Overview"}),`
`,t.jsx(e.p,{children:`Modal dialog version of the Import and Upload pattern. The import action
transfers data or objects from an external source into a system.`}),`
`,t.jsx(e.p,{children:"To build this pattern, we recommend including the following ingredients:"}),`
`,t.jsxs(e.ul,{children:[`
`,t.jsx(e.li,{children:t.jsx(e.a,{href:"https://react.carbondesignsystem.com/?path=/docs/components-composedmodal",rel:"nofollow",children:"ComposedModal"})}),`
`,t.jsx(e.li,{children:t.jsx(e.a,{href:"https://react.carbondesignsystem.com/?path=/docs/components-button",rel:"nofollow",children:"cds-button"})}),`
`,t.jsx(e.li,{children:t.jsx(e.a,{href:"https://react.carbondesignsystem.com/?path=/docs/components-textinput",rel:"nofollow",children:"TextInput"})}),`
`,t.jsx(e.li,{children:t.jsx(e.a,{href:"https://react.carbondesignsystem.com/?path=/docs/components-fileuploader",rel:"nofollow",children:"FileUploader"})}),`
`]}),`
`,t.jsx(e.h3,{id:"standard",children:"Standard"}),`
`,t.jsx($,{of:m,additionalActions:[{title:"Open in Stackblitz",onClick:()=>M({story:m,styles:V.parameters.styles})}]})]})}function P(a={}){const{wrapper:e}={...w(),...a.components};return e?t.jsx(e,{...a,children:t.jsx(C,{...a})}):C(a)}const V={title:"Patterns/Import And Upload",component:()=>{},tags:["autodocs"],parameters:{styles:H,docs:{page:P}}},X=()=>{const[a,e]=y.useState(!1),[s,u]=y.useState([]),l="import-and-upload-modal",[c,_]=y.useState(""),j=i=>!(acceptSet.has(i.type)||acceptSet.has(`.${i.name.split(".").pop()}`)||accept.length===0),b=i=>{const p=[...i.map(r=>{const o={uuid:r.uuid||"test",status:"edit",iconDescription:"Delete",name:r.name,fileSize:r.size,invalidFileType:r.invalidFileType,fileData:r,fetchError:r.fetchError};return o.fetchError?(o.errorBody="Unable to fetch URL.",o.errorSubject="Import failed",o.invalid=!0):o.invalidFileType?(o.errorBody="Invalid file type.",o.errorSubject="Import failed",o.invalid=!0):(o?.fileSize??0)>5e5&&(o.errorBody="500kb max file size. Select a new file and try again.",o.errorSubject="Import failed",o.invalid=!0),o})];u(p)},S=async i=>{i.preventDefault();const d=c.substring(c.lastIndexOf("/")+1).split("?")[0],p={name:d,status:"uploading",uuid:"test"};u([p]);try{const r=await fetch(c);if(!r.ok||r.status!==200)throw new Error(`${r.status}`);const o=await r.blob(),f=new File([o],d,{type:o.type});f.invalidFileType=j(f),f.uuid=p.uuid,b([f])}catch{const o={...p,fetchError:!0};b([o])}},g=()=>{u([]),_(""),e(!1)},k=i=>{const d=s.filter(p=>p.uuid!==i);u(d)},U=()=>{onRequestSubmit(s)},E=(i,{addedFiles:d})=>{i.stopPropagation(),b(d)},v=s.length,x=s.filter(i=>!i.invalid).length,F=v>0,B=!F||!(x>0),I=!c||F,z=`${x} / ${v} file uploaded`;return n.createElement(n.Fragment,null,n.createElement(h,{onClick:()=>e(!0)},"Launch modal"),n.createElement(D,{open:a,size:"sm",preventCloseOnClickOutside:!0,onClose:g},n.createElement(O,{className:`${l}__header`,title:"Import",closeModal:g}),n.createElement(N,{className:`${l}__body-container`},n.createElement("p",{className:`${l}__body`},"You can specify a file to import by either dragging it into the drag and drop area or by specifying a URL. (Maximum file size of 500KB)"),n.createElement("p",{className:`${l}__file-drop-header`},"Add files using drag and drop"),n.createElement(A,{accept:["image/png","image/jpeg","image/gif"],labelText:"Drag and drop files here or click to upload",onAddFiles:E,disabled:s.length,"data-modal-primary-focus":!0}),n.createElement("p",{className:`${l}__label`},"Add a file by specifying a URL"),n.createElement("div",{className:`${l}__input-group`},n.createElement(L,{labelText:"",id:"test-id",onChange:i=>_(i.target.value),placeholder:"URL",value:c,disabled:s.length,"aria-label":"Add a file by specifying a URL"}),n.createElement(h,{onClick:S,className:`${l}__import-button`,size:"md",disabled:I},"Add file")),n.createElement("div",{className:`${l}__file-container`},F&&n.createElement("p",{className:`${l}__helper-text`},z),s.map(i=>n.createElement(R,{key:i.uuid,onDelete:()=>k(i.uuid),name:i.name,status:i.status,size:"lg",uuid:i.uuid,iconDescription:i.iconDescription,invalid:i.invalid,errorBody:i.errorBody,errorSubject:i.errorSubject,filesize:i.fileSize})))),n.createElement(T,{className:`${l}__footer`},n.createElement(h,{type:"button",kind:"secondary",onClick:g},"Cancel"),n.createElement(h,{type:"submit",kind:"primary",onClick:U,disabled:B},"Import"))))},m=X.bind({});m.args={};m.parameters={...m.parameters,docs:{...m.parameters?.docs,source:{originalSource:`() => {
  const [isOpen, setOpen] = useState(false);
  // prettier-ignore
  const [files, setFiles] = useState<Array<FileType>>([]);
  const blockClass = 'import-and-upload-modal';
  const [importUrl, setImportUrl] = useState('');
  const isInvalidFileType = file => {
    if (acceptSet.has(file.type) || acceptSet.has(\`.\${file.name.split('.').pop()}\`) || accept.length === 0) {
      return false;
    }
    return true;
  };
  const updateFiles = newFiles => {
    const updatedFiles = newFiles.map(file => {
      const newFile = {
        uuid: file.uuid || 'test',
        status: 'edit',
        iconDescription: 'Delete',
        name: file.name,
        fileSize: file.size,
        invalidFileType: file.invalidFileType,
        fileData: file,
        fetchError: file.fetchError
      };
      if (newFile.fetchError) {
        newFile.errorBody = 'Unable to fetch URL.';
        newFile.errorSubject = 'Import failed';
        newFile.invalid = true;
      } else if (newFile.invalidFileType) {
        newFile.errorBody = 'Invalid file type.';
        newFile.errorSubject = 'Import failed';
        newFile.invalid = true;
      } else if ((newFile?.fileSize ?? 0) > 500000) {
        newFile.errorBody = '500kb max file size. Select a new file and try again.';
        newFile.errorSubject = 'Import failed';
        newFile.invalid = true;
      }
      return newFile;
    });
    const finalFiles = [...updatedFiles];
    setFiles(finalFiles);
  };
  const fetchFile = async evt => {
    evt.preventDefault();
    const fileName = importUrl.substring(importUrl.lastIndexOf('/') + 1).split('?')[0];
    const pendingFile = {
      name: fileName,
      status: 'uploading',
      uuid: 'test'
    };
    setFiles([pendingFile]);
    try {
      const response = await fetch(importUrl);
      if (!response.ok || response.status !== 200) {
        throw new Error(\`\${response.status}\`);
      }
      const blob = await response.blob();
      const fetchedFile = new File([blob], fileName, {
        type: blob.type
      });
      fetchedFile.invalidFileType = isInvalidFileType(fetchedFile);
      fetchedFile.uuid = pendingFile.uuid;
      updateFiles([fetchedFile]);
    } catch (err) {
      const failedFile = {
        ...pendingFile,
        fetchError: true
      };
      updateFiles([failedFile]);
    }
  };
  const onCloseHandler = () => {
    setFiles([]);
    setImportUrl('');
    setOpen(false);
  };
  const onRemoveFile = uuid => {
    const updatedFiles = files.filter(f => f.uuid !== uuid);
    setFiles(updatedFiles);
  };
  const onSubmitHandler = () => {
    onRequestSubmit(files);
  };
  const onAddFile = (evt, {
    addedFiles
  }) => {
    evt.stopPropagation();
    updateFiles(addedFiles);
  };
  const numberOfFiles = files.length;
  const numberOfValidFiles = files.filter(f => !f.invalid).length;
  const hasFiles = numberOfFiles > 0;
  const primaryButtonDisabled = !hasFiles || !(numberOfValidFiles > 0);
  const importButtonDisabled = !importUrl || hasFiles;
  const fileStatusString = \`\${numberOfValidFiles} / \${numberOfFiles} file uploaded\`;
  return <>
      <Button onClick={() => setOpen(true)}>Launch modal</Button>
      <ComposedModal open={isOpen} size="sm" preventCloseOnClickOutside onClose={onCloseHandler}>
        <ModalHeader className={\`\${blockClass}__header\`} title="Import" closeModal={onCloseHandler} />
        <ModalBody className={\`\${blockClass}__body-container\`}>
          <p className={\`\${blockClass}__body\`}>
            You can specify a file to import by either dragging it into the drag
            and drop area or by specifying a URL. (Maximum file size of 500KB)
          </p>
          <p className={\`\${blockClass}__file-drop-header\`}>
            Add files using drag and drop
          </p>

          <FileUploaderDropContainer accept={['image/png', 'image/jpeg', 'image/gif']} labelText="Drag and drop files here or click to upload" onAddFiles={onAddFile} disabled={files.length} data-modal-primary-focus />
          <p className={\`\${blockClass}__label\`}>
            Add a file by specifying a URL
          </p>
          <div className={\`\${blockClass}__input-group\`}>
            <TextInput labelText="" id={'test-id'} onChange={evt => setImportUrl(evt.target.value)} placeholder="URL" value={importUrl} disabled={files.length} aria-label="Add a file by specifying a URL" />
            <Button onClick={fetchFile} className={\`\${blockClass}__import-button\`} size="md" disabled={importButtonDisabled}>
              Add file
            </Button>
          </div>
          <div className={\`\${blockClass}__file-container\`}>
            {hasFiles && <p className={\`\${blockClass}__helper-text\`}>{fileStatusString}</p>}
            {files.map(file => <FileUploaderItem key={file.uuid} onDelete={() => onRemoveFile(file.uuid)} name={file.name} status={file.status} size="lg" uuid={file.uuid} iconDescription={file.iconDescription} invalid={file.invalid} errorBody={file.errorBody} errorSubject={file.errorSubject} {...{
            filesize: file.fileSize
          }} />)}
          </div>
        </ModalBody>

        <ModalFooter className={\`\${blockClass}__footer\`}>
          <Button type="button" kind="secondary" onClick={onCloseHandler}>
            Cancel
          </Button>
          <Button type="submit" kind="primary" onClick={onSubmitHandler} disabled={primaryButtonDisabled}>
            Import
          </Button>
        </ModalFooter>
      </ComposedModal>
    </>;
}`,...m.parameters?.docs?.source}}};const Kt=["Standard"];export{m as Standard,Kt as __namedExportsOrder,V as default};
//# sourceMappingURL=ImportAndUpload.stories-bce8QZnj.js.map
