import{e as h,a as he,b as Ve,f as He,g as We,d as je,u as ze,r as o,c as V,_ as Q,V as we,P as t,a7 as ve,eL as Ee,eG as ye,eM as U,eB as Re,A as Ke,eN as Xe,n as Ye,a6 as Ge,eO as Ue,q as te,z as ue,a4 as Je,a0 as Qe,a3 as Ze,am as et,t as tt,i as de}from"./iframe-CoewCovk.js";import{b as ot,a as nt}from"./useAttachedMenu-DisMwIU8.js";import{m as ne}from"./mergeRefs-D4pwfk3t.js";import{b as Ce}from"./bucket-13-kEbwoQWW.js";import{s as st,b as rt,w as at,a as it}from"./wrapFocus-COQpSXAY.js";import{u as lt}from"./useOutsideClick-BjkaPmco.js";const pe="md",Oe=h.forwardRef(({autoAlign:r=!1,children:a,className:E,label:u="Options",renderIcon:m=Ce,size:i=pe,menuAlignment:s="bottom-start",tooltipAlignment:O,menuTarget:I,...l},T)=>{const f=he("enable-v12-dynamic-floating-styles")||r,{refs:R,floatingStyles:c,placement:$,middlewareData:g}=Ve(f?{placement:s,strategy:"fixed",middleware:[r&&We({fallbackPlacements:s.includes("bottom")?["bottom-start","bottom-end","top-start","top-end"]:["top-start","top-end","bottom-start","bottom-end"]})],whileElementsMounted:He}:{}),w=je("overflowmenu"),p=ze(),b=o.useRef(null),{open:y,x:A,y:N,handleClick:B,handleMousedown:H,handleClose:L}=ot(b);o.useEffect(()=>{f&&Object.keys(c).forEach(k=>{R.floating.current&&(R.floating.current.style[k]=c[k])})},[c,f,R.floating,y,$,g]);function d(){b.current&&B()}const e=V(E,`${p}--overflow-menu__container`,{[`${p}--autoalign`]:f}),v=V(`${p}--overflow-menu__${s}`),C=V(`${p}--overflow-menu`,{[`${p}--overflow-menu--open`]:y},i!==pe&&`${p}--overflow-menu--${i}`),M=ne(b,R.setReference);return h.createElement("div",Q({},l,{className:e,"aria-owns":y?w:void 0,ref:T}),h.createElement(we,{"aria-controls":y?w:void 0,"aria-haspopup":!0,"aria-expanded":y,className:C,onClick:d,onMouseDown:H,ref:M,label:u,align:O,kind:"ghost"},h.createElement(m,{className:`${p}--overflow-menu__icon`})),h.createElement(nt,{containerRef:b,ref:R.setFloating,menuAlignment:s,className:v,id:w,size:i,legacyAutoalign:!f,open:y,onClose:L,x:A,y:N,label:u,target:I},a))});Oe.propTypes={autoAlign:t.bool,children:t.node,className:t.string,label:t.string,menuAlignment:t.oneOf(["top-start","top-end","bottom-start","bottom-end"]),renderIcon:t.oneOfType([t.func,t.object]),size:t.oneOf(["sm","md","lg"]),tooltipAlignment:ve(t.oneOf(["top","top-left","top-right","bottom","bottom-left","bottom-right","left","left-bottom","left-top","right","right-bottom","right-top","top-start","top-end","bottom-start","bottom-end","left-end","left-start","right-end","right-start"]),["top","top-start","top-end","bottom","bottom-start","bottom-end","left","left-start","left-end","right","right-start","right-end"],Ee),menuTarget:t.instanceOf(typeof Element<"u"?Element:Object)};var oe,me;function ct(){if(me)return oe;me=1;var r=function(a,E,u,m,i,s,O,I){if(!a){var l;if(E===void 0)l=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var T=[u,m,i,s,O,I],f=0;l=new Error(E.replace(/%s/g,function(){return T[f++]})),l.name="Invariant Violation"}throw l.framesToPop=1,l}};return oe=r,oe}var ft=ct();const xt=ye(ft);var J,ge;function ut(){return ge||(ge=1,J=typeof self=="object"&&self.self===self&&self||typeof U=="object"&&U.global===U&&U||J),J}var dt=ut();const D=ye(dt),pt=(()=>{const r=[];let a=!1;const E=()=>{r.forEach(i=>{i()}),a=!1},u=()=>{a||(a=!0,D.requestAnimationFrame(E))},m=i=>{r.indexOf(i)<0&&r.push(i)};return{add:i=>(r.length||D.addEventListener("resize",u),m(i),{remove:()=>{const s=r.indexOf(i);s>=0&&r.splice(s,1)}})}})(),mt="left",se="top",gt="right",K="bottom",bt=({menuSize:r,refPosition:a,offset:E,direction:u,scrollX:m,scrollY:i,container:s})=>{const{left:O=0,top:I=0,right:l=0,bottom:T=0}=a,f=s.position!=="static"?0:m,R=s.position!=="static"?0:i,c={top:s.position!=="static"?s.rect.top:0,left:s.position!=="static"?s.rect.left:0},{width:$,height:g}=r,{top:w=0,left:p=0}=E,b=(O+l)/2,y=(I+T)/2;return{[mt]:()=>({left:O-$+f-p-c.left,top:y-g/2+R+w-9-c.top}),[se]:()=>({left:b-$/2+f+p-c.left,top:I-g+R-w-c.top}),[gt]:()=>({left:l+f+p-c.left,top:y-g/2+R+w+3-c.top}),[K]:()=>({left:b-$/2+f+p-c.left,top:T+R+w-c.top})}[u]()},ht=({children:r,flipped:a,focusTrap:E,menuDirection:u=K,menuOffset:m={top:0,left:0},menuRef:i,onPlace:s,selectorPrimaryFocus:O,styles:I,target:l=()=>document.body,triggerRef:T,updateOrientation:f})=>{const R=o.useContext(Re),[c,$]=o.useState(void 0),g=o.useRef(null),w=o.useRef(null),p=o.useRef(null),b=o.useRef(!1),y=o.useCallback(e=>{const v=g.current;if(!v)return;const C=T.current,M=v.getBoundingClientRect(),k=C?C.getBoundingClientRect():void 0,W=typeof m=="function"?m(v,u,C,a):m;if(f&&f({menuSize:M,refPosition:k,direction:u,offset:W,scrollX:D.pageXOffset,scrollY:D.pageYOffset,container:{rect:l().getBoundingClientRect(),position:getComputedStyle(l()).position}}),M.width>0&&M.height>0||!W){const S=bt({menuSize:M,refPosition:k??{left:0,top:0,right:0,bottom:0},offset:W,direction:u,scrollX:D.pageXOffset,scrollY:D.pageYOffset,container:{rect:l().getBoundingClientRect(),position:getComputedStyle(l()).position}});if((!c||c.left!==S.left||c.top!==S.top)&&$(S),!e){const X=v.getBoundingClientRect();(X.width!==M.width||X.height!==M.height)&&y(!0)}}},[T,m,u,a,l,f,c]),A=e=>{const v=O?e.querySelector(O):null,C=e.querySelector(st),M=e.querySelector(rt);(v||C||M||e).focus()},N=e=>{g.current=e,b.current=!!e,i&&i(e),e&&y()};o.useEffect(()=>{b.current&&c&&g.current&&(g.current.contains(document.activeElement)||A(g.current),typeof s=="function"&&s(g.current),b.current=!1)},[c,s]),o.useEffect(()=>{const e=pt.add(()=>{y()});return()=>{e.remove()}},[T,m,u,a,l,f]),o.useEffect(()=>{y()},[m,u,a,T,l,f]);const B=()=>{const e=c,v=e?{left:`${e.left}px`,top:`${e.top}px`,right:"auto"}:{visibility:"hidden",top:"0px"},C=r;return o.cloneElement(C,{ref:N,style:{...I,...v,position:"absolute",opacity:1}})},H=e=>{const{target:v,relatedTarget:C}=e;g.current&&w.current&&p.current&&v instanceof HTMLElement&&C instanceof HTMLElement&&it({bodyNode:g.current,startTrapNode:w.current,endTrapNode:p.current,currentActiveNode:C,oldActiveNode:v})},L=e=>{Ye(e,Ge)&&g.current&&e.target instanceof HTMLElement&&at({containerNode:g.current,currentActiveNode:e.target,event:e})},d=Ke("enable-experimental-focus-wrap-without-sentinels");if(typeof document<"u"){const e=l?l():document.body;return Xe.createPortal(h.createElement("div",{onBlur:E&&!d?H:void 0,onKeyDown:d?L:void 0},!d&&h.createElement("span",{ref:w,tabIndex:0,role:"link",className:`${R}--visually-hidden`},"Focus sentinel"),B(),!d&&h.createElement("span",{ref:p,tabIndex:0,role:"link",className:`${R}--visually-hidden`},"Focus sentinel")),e)}return null},wt=Ue(),vt=(r,...a)=>(r.addEventListener(...a),{release(){return r.removeEventListener(...a),null}}),Et={[se]:"bottom",[K]:"top"},be=(r,a,E,u)=>{const m=Et[a],{offsetWidth:i,offsetHeight:s}=r;switch(m){case"top":case"bottom":{const O=E?E.offsetWidth:0;return{left:(u?-1:1)*(i/2-O/2),top:0}}default:return{left:0,top:0}}},re=o.forwardRef(({align:r,["aria-label"]:a=null,ariaLabel:E,children:u,className:m,direction:i=K,flipped:s=!1,focusTrap:O=!0,iconClass:I,iconDescription:l="Options",id:T,light:f,menuOffset:R=be,menuOffsetFlip:c=be,menuOptionsClass:$,onClick:g=te,onClose:w=te,onOpen:p=te,open:b,renderIcon:y=Ce,selectorPrimaryFocus:A="[data-floating-menu-primary-focus]",size:N="md",innerRef:B,...H},L)=>{const d=o.useContext(Re),[e,v]=o.useState(b??!1),[C,M]=o.useState(!1),[k,W]=o.useState(!1),S=o.useRef(null),X=o.useRef(wt()),q=o.useRef(null),ae=o.useRef({}),ie=o.useRef(b),Z=o.useRef(e),P=o.useRef(null),le=o.useRef(null);o.useEffect(()=>{ie.current!==b&&(v(!!b),ie.current=b)},[b]),o.useEffect(()=>{P.current&&W(!0)},[]),o.useEffect(()=>{e&&!Z.current?p():!e&&Z.current&&w(),Z.current=e},[e,w,p]),lt(le,({target:n})=>{e&&(!q.current||n instanceof Node&&!q.current.contains(n))&&j()});const Y=o.useCallback(()=>{P.current&&P.current.focus()},[]),j=o.useCallback(n=>{v(!1),n&&n(),w()},[w]),ce=o.useCallback(()=>{const n=C,x=e;j(()=>{x&&!n&&Y()})},[C,e,j,Y]),Me=o.useCallback(()=>{const n=e;j(()=>{n&&Y()})},[e,j,Y]),xe=n=>{M(!0),(!q.current||!q.current.contains(n.target))&&(v(x=>!x),g(n))},Ie=n=>{e&&ue(n,[Je,Qe,Ze,et])&&n.preventDefault(),ue(n,[tt])&&(Me(),n.stopPropagation())},$e=({currentIndex:n=0,direction:x})=>{const F=o.Children.toArray(u).reduce((_,fe,De)=>(h.isValidElement(fe)&&!fe.props.disabled&&_.push(De),_),[]),z=(()=>{const _=F.indexOf(n)+x;switch(_){case-1:return F.length-1;case F.length:return 0;default:return _}})();ae.current[F[z]]?.focus()},Ne=n=>{n||(q.current=n),!n&&S.current&&(S.current=S.current.release())},Fe=n=>{if(!n)return;q.current=n;const x="onfocusin"in window,F=x?"focusin":"focus";S.current=vt(n.ownerDocument,F,z=>{const G=z.target,_=P.current;typeof G.matches=="function"&&!n.contains(G)&&_&&!G.matches(`.${d}--overflow-menu:first-child, .${d}--overflow-menu-options:first-child`)&&ce()},!x)},ke=()=>{const n=P.current;return n instanceof Element&&n.closest("[data-floating-menu-container]")||document.body},ee=`overflow-menu-${X.current}__menu-body`,Se=V(m,`${d}--overflow-menu`,{[`${d}--overflow-menu--open`]:e,[`${d}--overflow-menu--light`]:f,[`${d}--overflow-menu--${N}`]:N}),Pe=V($,`${d}--overflow-menu-options`,{[`${d}--overflow-menu--flip`]:s,[`${d}--overflow-menu-options--open`]:e,[`${d}--overflow-menu-options--light`]:f,[`${d}--overflow-menu-options--${N}`]:N}),_e=V(`${d}--overflow-menu__icon`,I),Ae=o.Children.toArray(u).map((n,x)=>{if(o.isValidElement(n)){const F=n;return o.cloneElement(F,{closeMenu:F.props.closeMenu||ce,handleOverflowMenuItemFocus:$e,ref:z=>{ae.current[x]=z},index:x})}return null}),Be=h.createElement("ul",{className:Pe,tabIndex:-1,role:"menu","aria-label":a||E,onKeyDown:Ie,id:ee},Ae),Le=h.createElement(ht,{focusTrap:O,triggerRef:P,menuDirection:i,menuOffset:s?c:R,menuRef:Ne,flipped:s,target:ke,onPlace:Fe,selectorPrimaryFocus:A},o.cloneElement(Be,{"data-floating-menu-direction":i})),qe=B?ne(P,B,L):ne(P,L);return h.createElement(h.Fragment,null,h.createElement("span",{className:`${d}--overflow-menu__wrapper`,"aria-owns":e?ee:void 0,ref:le},h.createElement(we,Q({},H,{align:r,type:"button","aria-haspopup":!0,"aria-expanded":e,"aria-controls":e?ee:void 0,className:Se,onClick:xe,id:T,ref:qe,size:N,label:l,kind:"ghost"}),h.createElement(y,{className:_e,"aria-label":l})),e&&k&&Le))});re.propTypes={align:ve(t.oneOf(["top","top-left","top-right","bottom","bottom-left","bottom-right","left","left-bottom","left-top","right","right-bottom","right-top","top-start","top-end","bottom-start","bottom-end","left-end","left-start","right-end","right-start"]),["top","top-start","top-end","bottom","bottom-start","bottom-end","left","left-start","left-end","right","right-start","right-end"],Ee),"aria-label":t.string,ariaLabel:de(t.string),children:t.node,className:t.string,direction:t.oneOf([se,K]),flipped:t.bool,focusTrap:t.bool,iconClass:t.string,iconDescription:t.string,id:t.string,light:de(t.bool),menuOffset:t.oneOfType([t.shape({top:t.number.isRequired,left:t.number.isRequired}),t.func]),menuOffsetFlip:t.oneOfType([t.shape({top:t.number.isRequired,left:t.number.isRequired}),t.func]),menuOptionsClass:t.string,onClick:t.func,onClose:t.func,onFocus:t.func,onKeyDown:t.func,onOpen:t.func,open:t.bool,renderIcon:t.oneOfType([t.func,t.object]),selectorPrimaryFocus:t.string,size:t.oneOf(["sm","md","lg"])};const Te=o.forwardRef((r,a)=>he("enable-v12-overflowmenu")?h.createElement(Oe,Q({},r,{ref:a})):h.createElement(re,Q({},r,{ref:a})));Te.displayName="OverflowMenu";Te.propTypes=re.propTypes;export{Te as O,xt as i};
