import{a as be,d as me,i as ot,h as $t,b as It,F as qt,s as it,u as Ht,r as ze}from"./index.esm-fQjxfktm.js";import{r as g,e as ee}from"./index-DtHxqM--.js";import{d as we,P as s}from"./index-4poXP75K.js";import{p as re,a as Ot,q as st,n as kt,o as Mt,t as Dt}from"./index-Bfrl1yb6.js";import{p as fe}from"./settings-Bzj6EGPa.js";import{u as Me}from"./uuidv4-BN2rGLQG.js";import{p as Ve}from"./props-helper-57MyEezq.js";import{u as Be}from"./usePreviousValue-CuNkkQo9.js";import{g as jt}from"./devtools-B69Kc3qg.js";import{g as Pt}from"./getNodeTextContent-C8IeKkUQ.js";const Lt=()=>{const[e,t]=g.useState(document.activeElement),a=()=>{t(document.activeElement)};return g.useEffect(()=>(document.addEventListener("focusin",a),()=>{document.removeEventListener("focusin",a)}),[]),e},Vt=({spreadsheetRef:e,activeCellCoordinates:t,containerHasFocus:a,createActiveCell:r,activeCellContent:o,isActiveHeaderCellChanged:f})=>{let c;g.useEffect(()=>{c()},[o,c,f]),c=g.useCallback(()=>{const l=e==null?void 0:e.current.querySelector(`[data-row-index="${t==null?void 0:t.row}"][data-column-index="${t==null?void 0:t.column}"]`),u=(t==null?void 0:t.row)==="header"&&!0,m=e==null?void 0:e.current.querySelector('[data-row-index="header"][data-column-index="header"]');a&&r({placementElement:t?l:m,coords:t,addToHeader:u})},[e,t,a,r])},Nt=({blockClass:e=`${fe.prefix}--data-spreadsheet`,focusedElement:t,removeActiveCell:a,setContainerHasFocus:r})=>{g.useEffect(()=>{t.classList.contains(`${e}--interactive-cell-element`)||(r(!1),a()),(t.classList.contains(e)||t.classList.contains(`${e}--interactive-cell-element`))&&r(!0)},[t,a,e,r])},Bt=({isBlurSpreadsheet:e,spreadsheetRef:t,blockClass:a=`${fe.prefix}--data-spreadsheet`,setActiveCellCoordinates:r,setSelectionAreas:o,removeActiveCell:f,setContainerHasFocus:c,removeCellEditor:l})=>{g.useEffect(()=>{const u=m=>{!t.current||t.current.contains(m.target)||m.target.classList.contains(`${a}__active-cell--highlight`)||m.target.classList.contains(`${a}--interactive-cell-element`)||(e.current=!0,r(null),o([]),f(),be({spreadsheetRef:t}),c(!1))};return document.addEventListener("click",u),()=>{document.removeEventListener("click",u)}},[e,t,f,a,r,c,o,l])},Et=({isEditing:e,rows:t,activeCellCoordinates:a,activeCellRef:r,cellEditorRef:o,cellEditorRulerRef:f,visibleColumns:c,defaultColumn:l,cellEditorValue:u,blockClass:m=`${fe.prefix}--data-spreadsheet`})=>{const[x,A]=g.useState(null),d=Be({nextIndex:x});g.useEffect(()=>{d!=null&&d.nextIndex||A(a==null?void 0:a.column)},[d==null?void 0:d.nextIndex,a]),g.useEffect(()=>{var b,_,M,H,P;const h=f.current.offsetWidth,i=parseInt(o.current.style.width);if(e){const I=(b=t[a==null?void 0:a.row])==null?void 0:b.cells[a==null?void 0:a.column],B=r==null?void 0:r.current.style.left,y=r==null?void 0:r.current.style.top;if(o.current.style.left=B,o.current.style.top=y,o.current.style.display="block",o.current.style.height=r==null?void 0:r.current.style.height,o.current.style.paddingTop=`${(parseInt(r==null?void 0:r.current.style.height)-16)/2-1}px`,o.current.style.textAlign=((_=I==null?void 0:I.column)==null?void 0:_.placement)==="right"?"right":"left",(M=o.current)==null||M.focus(),h<i){const $=((H=c[x])==null?void 0:H.width)||(l==null?void 0:l.width);h<i-$&&(o.current.style.width=re(parseInt(o.current.style.width)-$),A(L=>L===0?L:L-1))}if(h>=i){A(z=>z===c.length-1?z:z+1);const L=x+1===c.length?0:((P=c[x+1])==null?void 0:P.width)||(l==null?void 0:l.width),O=a==null?void 0:a.row,J=(t.length-O)*l.rowHeight;o.current.style.maxHeight=re(J),o.current.style.width=re(L+i),o.current.style.height=re(o.current.scrollHeight),o.current.clientHeight===J-1?o.current.style.overflow="auto":o.current.style.overflow="hidden"}}e||(o.current.style.overflow="hidden",o.current.style.display="none",o.current.blur(),r.current.focus(),A(a==null?void 0:a.column))},[e,a,t,u,l,r,o,f,c,m,d==null?void 0:d.cellEditorValue,x])},Wt=({currentMatcher:e,setSelectionAreas:t,selectedHeaderReorderActive:a,setSelectedHeaderReorderActive:r,setClickAndHoldActive:o,setValidStartingPoint:f,validStartingPoint:c,blockClass:l=`${fe.prefix}--data-spreadsheet`,ref:u,setHeaderCellHoldActive:m,setColumnOrder:x,visibleColumns:A,setActiveCellCoordinates:d,activeCellCoordinates:h,rows:i,defaultColumn:b,selectionAreas:_})=>{g.useEffect(()=>{const M=H=>{var I,B;let P=!1;if((I=_==null?void 0:_[0])!=null&&I.header&&_[0].header.type==="column"&&(P=!0),!c&&P){m(!1);const y=u.current.querySelector(`.${l}__selection-area--element`),$=u.current.querySelector(`.${l}__selection-area--element-cloned`);if(!$)return;if($){const L=H.target.closest(`.${l}--interactive-cell-element`),O=parseInt==null?void 0:parseInt(L==null?void 0:L.getAttribute("data-column-index")),W=parseInt==null?void 0:parseInt($==null?void 0:$.getAttribute("data-column-index-original")),z=_.filter(K=>(K==null?void 0:K.matcher)===e)[0].header.selectedIndexList;if(!u.current.querySelector(`[data-row-index="header"][data-column-index="${O}"]`))return;const n=u.current.querySelector(`[data-matcher-id="${e}"]`),q=u.current.getBoundingClientRect(),V=u.current.querySelector(`.${l}__list--container`).scrollLeft,E=O<W,k=O>W,ue=k?O-W:W-O;if(t(K=>{const D=me(K);if(W===O)return K;const Q=D.findIndex(C=>C.matcher===e);if(Q===-1)return K;if(!z.includes(O)){const C=k?z.map(ae=>ae+ue):z.map(ae=>ae-ue);D[Q].header.selectedIndexList=C,D[Q].point1.column=Math.min(...C),D[Q].point2.column=Math.max(...C)}return D[Q].areaCreated=!1,D}),!z.includes(O)){const K=z.length,D=Math.min(...z),Q=A.map(j=>j.id),C=[...Q],ae=()=>{const j=[];return z.map(N=>j.push(Q[N])),j};C.splice(D,K);const de=z.findIndex(j=>j===W),ye=O-de;C.splice(ye,0,...ae()),x(C);const ge={...h,column:k?h.column+ue:h.column-ue};d(ge);const ce=Array.from(u.current.querySelectorAll(`.${l}__th--selected-header`))[0].getBoundingClientRect().left-q.left+V,S=E?ce:O===W?n.style.left:ce;n.style.left=re(S)}const le=u.current.querySelector(`.${l}__reorder-indicator-line`);le==null||le.remove(),$==null||$.remove(),(B=y==null?void 0:y.classList)==null||B.remove(`${l}__selection-area--element`),r(!1)}}if(c||H.type==="mouseup"){o(!1),f(!1);const y=H.target.closest(`.${l}__body--td`);if(y){const $={row:Number(y.getAttribute("data-row-index")),column:Number(y.getAttribute("data-column-index"))};t(L=>{const O=me(L),W=O.findIndex(J=>J.matcher===e);return W===-1?L:(O[W].point2=$,O[W].areaCreated=!1,O)})}}};return document.addEventListener("mouseup",M),()=>{document.removeEventListener("mouseup",M)}},[l,e,t,o,f,c,a,r,u,m,x,A,d,h,i,b,_])},zt=({blockClass:e=`${fe.prefix}--data-spreadsheet`,clonedSelectionElement:t,ref:a,spreadsheetCoords:r,leftScrollAmount:o})=>{const f=event.target.closest(`.${e}--interactive-cell-element`),c=f==null?void 0:f.getAttribute("data-column-index"),l=t==null?void 0:t.getAttribute("data-column-index-original"),u=f.getBoundingClientRect(),m=a.current.querySelector(`.${e}__reorder-indicator-line`),x=t==null?void 0:t.getAttribute("data-matcher-id"),A=a.current.querySelector(`[data-matcher-id="${x}"]`),d=a.current.querySelector(`.${e}__list--container`),h=10,i=120,b=100,{clientX:_}=event,{left:M,right:H}=d.getBoundingClientRect();if(_<i&&window.scrollBy(-10,0),_>window.innerWidth-b&&window.scrollBy(h,0),_>M&&_<M+i&&d.scrollBy(-10,0),_<H&&_>H-b&&d.scrollBy(h,0),Number(c)>Number(l)){const P=u.left-r.left+f.offsetWidth-2+o;m.style.left=re(P)}if(Number(c)<Number(l)){const P=u.left-r.left+o;m.style.left=re(P)}Number(c)===Number(l)&&(m.style.left=A.style.left)},Kt=({ref:e,blockClass:t=`${fe.prefix}--data-spreadsheet`,headerCellHoldActive:a,defaultColumn:r})=>{g.useEffect(()=>{const o=c=>{const l=e.current.querySelector(`.${t}__selection-area--element-cloned`);l&&e.current.addEventListener("mousemove",o);const u=e.current.getBoundingClientRect(),m=e.current.querySelector(`.${t}__list--container`),x=m.scrollLeft;zt({clonedSelectionElement:l,ref:e,spreadsheetCoords:u,leftScrollAmount:x}),e.current.getBoundingClientRect();const d=c.clientX-u.left,h=l==null?void 0:l.getAttribute("data-clone-offset-x"),i=m.scrollWidth,b=l.offsetWidth,_=Math.max(d-h,r==null?void 0:r.rowHeaderWidth),M=i-b>=_?_+x:i-b;M<u.right-40&&(l.style.left=re(M))};a&&e.current.addEventListener("mousemove",o);const f=e.current;return a||f==null||f.removeEventListener("mousemove",o),()=>{f==null||f.removeEventListener("mousemove",o)}})},Ie=e=>{const t=Math.max(e.point1.row,e.point2.row),a=Math.max(e.point1.column,e.point2.column),r=Math.min(e.point1.row,e.point2.row),o=Math.min(e.point1.column,e.point2.column);return{greatestRowIndex:t,greatestColumnIndex:a,lowestColumnIndex:o,lowestRowIndex:r}},ct=({ref:e,area:t,blockClass:a,defaultColumn:r,selectionAreas:o,setSelectionAreas:f,setActiveCellInsideSelectionArea:c,visibleColumns:l})=>{const{lowestColumnIndex:u,lowestRowIndex:m,greatestColumnIndex:x,greatestRowIndex:A}=Ie(t);(A-m>0||x-u>0)&&(c(!0),e.current.querySelector(`.${a}__active-cell--highlight`).setAttribute("data-selection-id",t.matcher));let d=0;l.forEach((y,$)=>{$>=u&&$<=x&&(d+=(y==null?void 0:y.width)||(r==null?void 0:r.width))});const i=(document.querySelector(`[data-row-index="${t.point1.row}"][data-column-index="${t.point1.column}"]`)||document.querySelector(`.${a}__body--td`)).offsetHeight,b=i*(A-m+1),_=document.querySelector(`.${a}__list--container`).firstElementChild,M=_.querySelector(`[data-row-index="${m}"][data-column-index="${u}"]`),H={top:M?M.getBoundingClientRect().top-_.getBoundingClientRect().top:m===0?0:i*m,left:M?M.getBoundingClientRect().left-_.getBoundingClientRect().left:u===0?0+(r.rowHeaderWidth-4):r.width*u+(r.rowHeaderWidth-4)},P=document.querySelector(`[data-matcher-id="${t.matcher}"]`)||document.createElement("div");P.classList.add(`${a}__selection-area--element`),P.setAttribute("data-matcher-id",t.matcher),P.style.width=re(d),P.style.height=re(b),P.style.left=re(H.left),P.style.top=re(H.top),_.appendChild(P);const I=me(o),B=I.findIndex(y=>y.matcher===t.matcher);I[B].areaCreated=!0,f(I)},Ke=(e,t,a)=>{const r=me(t),o=[];r.forEach(c=>{var m,x,A,d;const l=Math.max((m=c.point1)==null?void 0:m[a],(x=c.point2)==null?void 0:x[a]),u=Math.min((A=c.point1)==null?void 0:A[a],(d=c.point2)==null?void 0:d[a]);for(let h=u;h<=l;h++)o.push(h)});const f=[...new Set(o)];return!!(r!=null&&r.length&&f.includes(e))},lt=(e,t,a,r)=>me(t).some(c=>{var h,i,b,_,M,H,P,I;const l=a==="column"?"row":"column",u=Math.min((h=c==null?void 0:c.point1)==null?void 0:h[l],(i=c==null?void 0:c.point2)==null?void 0:i[l]),m=Math.max((b=c==null?void 0:c.point1)==null?void 0:b[l],(_=c==null?void 0:c.point2)==null?void 0:_[l]),x=Math.min((M=c==null?void 0:c.point1)==null?void 0:M[a],(H=c==null?void 0:c.point2)==null?void 0:H[a]),A=Math.max((P=c==null?void 0:c.point1)==null?void 0:P[a],(I=c==null?void 0:c.point2)==null?void 0:I[a]),d=(r==null?void 0:r.length)-1===m&&u===0;for(let B=x;B<=A;B++)if(e===B&&d)return!0;return!1}),mt=({type:e,headerGroup:t,scrollBarSizeValue:a,totalVisibleColumns:r,defaultColumn:o,totalColumnsWidth:f,visibleColumns:c})=>{const l=a+o.rowHeaderWidth;if(!r){if(e==="header")return re(parseInt(t.getHeaderGroupProps().style.width)+l);if(e!=="header")return f+l}if(r)return c.map((m,x)=>x<=r-1&&((m==null?void 0:m.width)||(o==null?void 0:o.width))).reduce((m,x)=>m+x,0)+l},De=(e,t)=>t=="cmd"?e.metaKey||e.ctrlKey:e[t],Ut=({indexList:e,newIndex:t,activeCellIndex:a})=>{const r=t>a?a:Math.min(...e,t),o=t<a?a:Math.max(...e,t),f=[];for(let c=r;c<=o;c++)f.push(c);return[...f]},Ne=({type:e,activeCellCoordinates:t,rows:a,columns:r,currentMatcher:o,setActiveCellCoordinates:f,setCurrentMatcher:c,setSelectionAreas:l,spreadsheetRef:u,index:m,isKeyboard:x,setSelectionAreaData:A,isHoldingCommandKey:d,isHoldingShiftKey:h})=>{d||(A([]),be({spreadsheetRef:u}));const i=x?t==null?void 0:t.row:m,b=x?t==null?void 0:t.column:m,_={row:e==="column"?0:i,column:e==="column"?b:0},M={row:e==="column"?a.length-1:i,column:e==="column"?b:r.length-1},H=Me();h||(f({row:e==="column"?0:i,column:e==="column"?b:0}),c(H));const P={point1:_,point2:M,areaCreated:!1,matcher:H,header:{type:e,selectedIndexList:[e==="column"?b:i]}};l(I=>{var y,$;const B=me(I);if(d){const O=B.filter(J=>{var z;return(z=J.header)==null?void 0:z.type}).filter(J=>{var z;return((z=J.header)==null?void 0:z.type)===e}),W=Ke(m,O,e);return O.length&&W?I:[...I,P]}if(h){const O=B.filter(E=>{var k;return(k=E.header)==null?void 0:k.type}).filter(E=>E.matcher===o)[0],W=Math.max(O==null?void 0:O.point1[e],O==null?void 0:O.point2[e],t==null?void 0:t[e]),J=e==="column"?b:i,z={row:W<J?a.length-1:0,column:b},v=me(I),n=v.findIndex(E=>E.matcher===o),q=Ut({indexList:(($=(y=v[n])==null?void 0:y.header)==null?void 0:$.selectedIndexList)||[e==="column"?b:i],newIndex:J,activeCellIndex:t==null?void 0:t[e]}),X=E=>E<J?{row:e==="column"?0:Math.min(...q),column:e==="column"?Math.min(...q):0}:z,V=E=>E<J?z:{row:e==="column"?a.length-1:Math.max(...q),column:e==="column"?Math.max(...q):r.length-1};if(!t||typeof t>"u"){c(H);const E={point1:X(e==="column"?b:i),point2:V(e==="column"?b:i),areaCreated:!1,matcher:H,header:{type:e,selectedIndexList:[e==="column"?b:i]}};return f({row:e==="column"?0:i,column:e==="column"?b:0}),[E]}return v[n].point1=X(t==null?void 0:t[e]),v[n].point2=V(t==null?void 0:t[e]),v[n].areaCreated=!1,v[n].header.selectedIndexList=q,v}return[P]})},Ft=({activeCellInsideSelectionArea:e,activeCellCoordinates:t,activeCellRef:a,selectionAreas:r,updateActiveCellCoordinates:o})=>{if(!e)return;const f=a.current.getAttribute("data-selection-id"),c=r.findIndex(h=>h.matcher===f),l=r[c],{lowestColumnIndex:u,lowestRowIndex:m,greatestColumnIndex:x,greatestRowIndex:A}=Ie(l),d={...t};if((t==null?void 0:t.row)<A&&o({coords:d,updatedValue:{row:(d==null?void 0:d.row)+1},optOutOfSelectionAreaUpdate:!0}),(t==null?void 0:t.row)===A&&((t==null?void 0:t.column)<x&&o({coords:d,updatedValue:{column:(d==null?void 0:d.column)+1,row:m},optOutOfSelectionAreaUpdate:!0}),(t==null?void 0:t.column)===x)){if(r.length>1)if(r[c+1]){a.current.setAttribute("data-selection-id",r[c+1].matcher);const h=r[c+1],{lowestColumnIndex:i,lowestRowIndex:b}=Ie(h);o({coords:d,updatedValue:{column:i,row:b},optOutOfSelectionAreaUpdate:!0});return}else{a.current.setAttribute("data-selection-id",r[0].matcher);const h=r[0],{lowestColumnIndex:i,lowestRowIndex:b}=Ie(h);o({coords:d,updatedValue:{column:i,row:b},optOutOfSelectionAreaUpdate:!0})}if(r.length===1)return o({coords:d,updatedValue:{column:u,row:m},optOutOfSelectionAreaUpdate:!0})}},Xt=({activeCellInsideSelectionArea:e,activeCellCoordinates:t,activeCellRef:a,selectionAreas:r,updateActiveCellCoordinates:o})=>{if(!e)return;const f=a.current.getAttribute("data-selection-id"),c=r.findIndex(d=>d.matcher===f),l=r[c],{lowestColumnIndex:u,lowestRowIndex:m,greatestColumnIndex:x,greatestRowIndex:A}=Ie(l);if((t==null?void 0:t.column)<x&&o({updatedValue:{column:(t==null?void 0:t.column)+1},optOutOfSelectionAreaUpdate:!0}),(t==null?void 0:t.column)===x&&((t==null?void 0:t.row)<A&&o({updatedValue:{column:u,row:(t==null?void 0:t.row)+1},optOutOfSelectionAreaUpdate:!0}),(t==null?void 0:t.row)===A)){if(r.length>1)if(r[c+1]){a.current.setAttribute("data-selection-id",r[c+1].matcher);const d=r[c+1],{lowestColumnIndex:h,lowestRowIndex:i}=Ie(d);o({updatedValue:{column:h,row:i},optOutOfSelectionAreaUpdate:!0});return}else{a.current.setAttribute("data-selection-id",r[0].matcher);const d=r[0],{lowestColumnIndex:h,lowestRowIndex:i}=Ie(d);o({updatedValue:{column:h,row:i},optOutOfSelectionAreaUpdate:!0})}if(r.length===1)return o({updatedValue:{column:u,row:m},optOutOfSelectionAreaUpdate:!0})}},ut=(e,t,a)=>{for(let r=e;r<=t;r++)a(r)},Rt=({activeCellCoordinates:e,selectionAreas:t,currentMatcher:a,rows:r,setActiveCellContent:o,updateData:f})=>{var h,i,b,_,M,H,P,I;if((e==null?void 0:e.column)==="header"||(e==null?void 0:e.row)==="header")return;const c=me(t),l=c.findIndex(B=>B.matcher===a),u=c[l],m=Math.min((h=u==null?void 0:u.point1)==null?void 0:h.column,(i=u==null?void 0:u.point2)==null?void 0:i.column),x=Math.max((b=u==null?void 0:u.point1)==null?void 0:b.column,(_=u==null?void 0:u.point2)==null?void 0:_.column),A=Math.min((M=u==null?void 0:u.point1)==null?void 0:M.row,(H=u==null?void 0:u.point2)==null?void 0:H.row),d=Math.max((P=u==null?void 0:u.point1)==null?void 0:P.row,(I=u==null?void 0:u.point2)==null?void 0:I.row);ut(m,x,B=>{ut(A,d,y=>{const $=r[y].cells[B];f(y,$==null?void 0:$.column.id,"")})}),o(null)},Le=`${fe.prefix}--data-spreadsheet`,Jt=(e,t,a,...r)=>{const[o,f,c,l,u,m,x,A,d,h,i,b,_]=r;a.preventDefault();const H=a.target.closest(`.${Le}__body--td`).classList.contains(`${Le}__body--td`);_(H);const P=De(a,"cmd"),I=De(a,"shiftKey");m(!0);const B={row:e.row.index,column:t},y=Me();if(x(!0),P)d.current.querySelector(`.${Le}__active-cell--highlight`).setAttribute("data-selection-id",y),i(!0),l(B),A(y),u(L=>[...L,{point1:B,matcher:y}]);else if(I){m(!0);const $=me(c),L=$.findIndex(O=>O.matcher===o);if(L===-1)return;$[L].point1=f,$[L].point2=B,$[L].areaCreated=!1,$[L].matcher=o,u($)}else b.current.style.display="none",i(!1),l(B),be({spreadsheetRef:d}),u([{point1:B,matcher:y}]),A(y),h([])},Qt=(e,t,...a)=>{const[r,o,f]=a;if(r){const c={row:e.row.index,column:t};f(l=>{var x,A;const u=me(l),m=u.findIndex(d=>d.matcher===o);return m===-1||((x=u[m].point2)==null?void 0:x.row)===c.row&&((A=u[m].point2)==null?void 0:A.column)===c.column?l:(u[m].point2=c,u[m].areaCreated=!1,u)})}},Yt=(e,t,...a)=>{const[r,o,f,c,l,u,m,x]=a,A=De(t,"cmd");Ne({type:"row",activeCellCoordinates:u,rows:m,columns:r,setActiveCellCoordinates:l,setCurrentMatcher:c,setSelectionAreas:f,spreadsheetRef:o,index:e,setSelectionAreaData:x,isHoldingCommandKey:A})},Zt=(e,...t)=>{const[a,r,o,f,c,l,u,m,x,A,d,h,i,b,_,M,H,P,I,B,y,$,L]=t,{key:O}=e;if(!_(O)&&(["ArrowLeft","ArrowUp","ArrowRight","ArrowDown"].indexOf(O)>-1&&A!=null&&A.length&&h.length<2&&!ot(h)&&(H([]),P([]),be({spreadsheetRef:u})),(h==null?void 0:h.length)>1&&$t({activeCellCoordinates:o,event:e,keysPressedList:h,selectionAreas:A,currentMatcher:m,rows:l,setSelectionAreas:H,columns:c,updateActiveCellCoordinates:r,spreadsheetRef:u,removeCellSelections:be,blockClass:Le,setCurrentMatcher:I,usingMac:i}),h.length<2&&!ot(h)||o.row==="header"||o.column==="header"))switch(O){case"Backspace":case"Delete":{Rt({selectionAreas:A,currentMatcher:m,rows:l,setActiveCellContent:L,updateData:b,activeCellCoordinates:o});break}case"Enter":{Ft({activeCellInsideSelectionArea:a,activeCellCoordinates:o,activeCellRef:B,selectionAreas:A,updateActiveCellCoordinates:r});break}case"Home":case"End":{if(e.preventDefault(),It(h,i))return;d({type:O});break}case"Tab":{if(a)return e.preventDefault(),Xt({activeCellInsideSelectionArea:a,activeCellCoordinates:o,activeCellRef:B,selectionAreas:A,updateActiveCellCoordinates:r});H([]),f(),x(),$(!1),y(null);break}case"ArrowLeft":case"ArrowUp":case"ArrowRight":case"ArrowDown":M(O)}},R=`${fe.prefix}--data-spreadsheet`,Ue=g.forwardRef(({activeCellRef:e,columns:t,activeCellCoordinates:a,defaultColumn:r,defaultEmptyRowCount:o,getTableBodyProps:f,headerGroups:c,setCurrentColumns:l,id:u,onDataUpdate:m,renderRowHeader:x,renderRowHeaderDirection:A,hasCustomRowHeader:d,prepareRow:h,rows:i,selectionAreaData:b,setSelectionAreaData:_,setActiveCellCoordinates:M,selectedHeaderReorderActive:H,setSelectedHeaderReorderActive:P,selectionAreas:I,setContainerHasFocus:B,setSelectionAreas:y,scrollBarSize:$,totalColumnsWidth:L,clickAndHoldActive:O,setClickAndHoldActive:W,currentMatcher:J,setCurrentMatcher:z,onSelectionAreaChange:v,setActiveCellInsideSelectionArea:n,totalVisibleColumns:q,setHeaderCellHoldActive:X,setColumnOrder:V,visibleColumns:E},k)=>{const[ue,le]=g.useState(!1),K=g.useRef(void 0),D=Be({selectionAreaData:b,clickAndHoldActive:O,rowHeight:r==null?void 0:r.rowHeight})||{};g.useEffect(()=>{k==null||k.current.style.setProperty(`--${R}--total-width`,re((L||0)+($||0)))},[k,$,L]),g.useEffect(()=>{var S,j,N,Y;if(b!=null&&b.length){let T=!1;(((S=D==null?void 0:D.selectionAreaData)==null?void 0:S.length)!==(b==null?void 0:b.length)||((j=b==null?void 0:b[0])==null?void 0:j.cells.length)!==((Y=(N=D==null?void 0:D.selectionAreaData)==null?void 0:N[0])==null?void 0:Y.cells.length))&&(T=!0),(!O&&(D!=null&&D.clickAndHoldActive)||T)&&(v==null||v(b))}},[D==null?void 0:D.selectionAreaData,b,v,O,D==null?void 0:D.clickAndHoldActive]),g.useEffect(()=>{I&&I.length&&I.map(S=>{if(S.areaCreated){const j=Math.min(S.point1.row,S.point2.row),N=Math.max(S.point1.row,S.point2.row),Y=Math.min(S.point1.column,S.point2.column),T=Math.max(S.point1.column,S.point2.column),Z={rows:{start:j,end:N},columns:{start:Y,end:T},cells:Q({rowStart:j,rowEnd:N,columnStart:Y,columnEnd:T}),selectionId:S.matcher};_==null||_(F=>[...me(F).filter(he=>he.selectionId!==S.matcher),Z])}!S.areaCreated&&S.point1&&S.point2&&S.matcher&&ct({ref:k,area:S,blockClass:R,defaultColumn:r,selectionAreas:I,setSelectionAreas:y,setActiveCellInsideSelectionArea:n,visibleColumns:E})})},[I,y,r,v,_,k,a,n,E,d]);const Q=({rowStart:S,rowEnd:j,columnStart:N,columnEnd:Y})=>{const T=[];for(let Z=S;Z<=j;Z++)for(let F=N;F<=Y;F++)T.push([Z,F,`${R}__cell--${Z}--${F}`]);return T};Wt({currentMatcher:J,setClickAndHoldActive:W,setSelectionAreas:y,setValidStartingPoint:le,selectedHeaderReorderActive:H,setSelectedHeaderReorderActive:P,validStartingPoint:ue,ref:k,setHeaderCellHoldActive:X,setColumnOrder:V,visibleColumns:E,setActiveCellCoordinates:M,rows:i,activeCellCoordinates:a,defaultColumn:r,selectionAreas:I}),g.useEffect(()=>{let S,j;if(ce!=null&&ce.current&&(S=ce==null?void 0:ce.current,j=S==null?void 0:S.querySelector(`.${R}__active-cell--highlight`)),j&&(r==null?void 0:r.rowHeight)!==D.rowHeight&&(j.style.height=`${r==null?void 0:r.rowHeight}px`,a)){const N=k==null?void 0:k.current.querySelector(`[data-row-index="${a.row}"][data-column-index="${a.column}"]`),Y=k==null?void 0:k.current.querySelector(`.${R}__list--container`);let T;N&&Y&&(T=(N==null?void 0:N.getBoundingClientRect().top)-Y.getBoundingClientRect().top),j.style.top=re(T),be({matcher:void 0,spreadsheetRef:k}),I==null||I.map(Z=>{if(!Z.areaCreated&&Z.point1&&Z.point2&&Z.matcher)return ct({ref:k,area:Z,blockClass:R,defaultColumn:r,selectionAreas:I,setSelectionAreas:y,setActiveCellInsideSelectionArea:n,visibleColumns:E})})}},[r,k,a,D==null?void 0:D.rowHeight,I,n,y,E,d]);const C=g.useCallback(()=>{const S=[],j=[];k==null||k.current.querySelectorAll(`.${R}__selection-area--element`).forEach(N=>{const{top:Y,left:T,height:Z,width:F}=N.style,pe=`${Y}${T}${Z}${F}`;S.indexOf(pe)==-1?S.push(pe):(N.remove(),j.push(N.getAttribute("data-matcher-id")))}),j.length&&(y==null||y(N=>me(N).filter(T=>!j.includes(T.matcher))),_==null||_(N=>me(N).filter(T=>!j.includes(T.selectionId))))},[k,y,_]);g.useEffect(()=>{C()},[I,C]);const ae=g.useCallback((S,j)=>N=>{Jt(S,j,N,J,a,I,M,y,B,W,z,k,_,n,e,le)},[J,a,I,M,y,B,W,z,k,_,n,e]),de=()=>{const S=k.current.querySelector(`
        .${R}__header--container .${R}__tr`)||new HTMLDivElement;S.scrollLeft=K==null?void 0:K.current.scrollLeft};g.useEffect(()=>{K.current.addEventListener("scroll",()=>de());const S=K.current||new HTMLElement;return()=>{S.removeEventListener("scroll",de)}});const ye=g.useCallback((S,j)=>()=>{Qt(S,j,O,J,y)},[O,J,y]),ge=g.useCallback(S=>j=>{Yt(S,j,t,k,y,z,M,a,i,_)},[t,k,y,z,M,a,i,_]);g.useEffect(()=>{if(i!=null&&i.length||(()=>{const j=[];[...Array(o)].map(()=>{var Y;const N={};(Y=c==null?void 0:c[0])==null||Y.headers.map(T=>{N[T.id]=null}),j.push(N)}),m==null||m(j)})(),c!=null&&c[0]&&typeof l=="function"){const S=c[0].headers;l(S)}},[i,c,o,m,l]);const Se=()=>ee.createElement("div",null),_e=g.useCallback(({index:S,style:j})=>{const N=i==null?void 0:i[S];if(i&&i.length){h==null||h(N);const Y=Ve(N.getRowProps({style:j}),"key");return ee.createElement("div",{key:{...N.getRowProps().key},...Y,className:we(`${R}__tr`),"data-row-index":S,"aria-rowindex":S+1,"aria-owns":`${R}__cell-editor-text-area`},ee.createElement("div",{role:"rowheader",className:`${R}__td-th--cell-container`},ee.createElement("button",{id:`${R}__cell--${S}--header`,tabIndex:-1,"data-row-index":S,"data-column-index":"header",type:"button",onClick:ge(S),className:we(`${R}__td`,`${R}__td-th`,`${R}--interactive-cell-element`,{[`${R}__td_custom`]:!!d,[`${R}__td-th--active-header`]:!d&&((a==null?void 0:a.row)===S||Ke(S,I,"row")),[`${R}__td-th--selected-header`]:!d&&lt(S,I,"row",t)}),style:{width:r==null?void 0:r.rowHeaderWidth,flexDirection:d?A==="Left"?"row-reverse":N:void 0}},S+1,d&&typeof x=="function"&&x(S))),N.cells.map((T,Z)=>{var pe;const F=Ve(T.getCellProps(),"key");return ee.createElement("div",{key:`cell_${Z}`,"aria-colindex":Z+1,...F,role:"gridcell",style:{...T.getCellProps().style,display:"grid",minWidth:((pe=T==null?void 0:T.column)==null?void 0:pe.width)||(r==null?void 0:r.width)}},ee.createElement("button",{id:`${R}__cell--${T.row.index}--${Z}`,tabIndex:-1,"data-row-index":T.row.index,"data-column-index":Z,className:we(`${R}__td`,`${R}__body--td`,`${R}--interactive-cell-element`),onMouseDown:ae(T,Z),onMouseOver:ye(T,Z),onFocus:()=>{},type:"button"},T.render("Cell")))}))}},[h,x,i,d,a==null?void 0:a.row,I,ge,ae,ye,t,r,A]),ce=g.useRef(void 0);return ee.createElement("div",{ref:ce,className:we(`${R}__body--container`),...f==null?void 0:f()},ee.createElement(qt,{className:we(`${R}__list--container`,`${R}__list--container--${u}`),height:400,itemCount:(i==null?void 0:i.length)||o,itemSize:r==null?void 0:r.rowHeight,width:mt({headerGroup:void 0,type:void 0,scrollBarSizeValue:$,totalVisibleColumns:q,defaultColumn:r,totalColumnsWidth:L,visibleColumns:E}),outerRef:K},i!=null&&i.length?_e:Se))});Ue.propTypes={activeCellCoordinates:s.shape({row:s.oneOfType([s.string,s.number]),column:s.oneOfType([s.string,s.number])}),activeCellRef:s.object,clickAndHoldActive:s.bool,columns:s.array,currentMatcher:s.string,defaultColumn:s.shape({rowHeight:s.number,rowHeaderWidth:s.number,width:s.number}),defaultEmptyRowCount:s.number,getTableBodyProps:s.func,hasCustomRowHeader:s.bool,headerGroups:s.arrayOf(s.object),id:s.oneOfType([s.number,s.string]),onActiveCellChange:s.func,onDataUpdate:s.func,onSelectionAreaChange:s.func,prepareRow:s.func,renderRowHeader:s.func,renderRowHeaderDirection:s.string,rows:s.arrayOf(s.object),scrollBarSize:s.number,selectedHeaderReorderActive:s.bool,selectionAreaData:s.array,selectionAreas:s.array,setActiveCellCoordinates:s.func,setActiveCellInsideSelectionArea:s.func,setClickAndHoldActive:s.func,setColumnOrder:s.func,setContainerHasFocus:s.func,setCurrentColumns:s.func,setCurrentMatcher:s.func,setHeaderCellHoldActive:s.func,setSelectedHeaderReorderActive:s.func,setSelectionAreaData:s.func,setSelectionAreas:s.func,totalColumnsWidth:s.number,totalVisibleColumns:s.number,visibleColumns:s.array};Ue.__docgenInfo={description:"",methods:[],displayName:"DataSpreadsheetBody",props:{activeCellCoordinates:{required:!1,tsType:{name:"union",raw:"ActiveCellCoordinates | null",elements:[{name:"ActiveCellCoordinates"},{name:"null"}]},description:"Object containing the active cell coordinates",type:{name:"shape",value:{row:{name:"union",value:[{name:"string"},{name:"number"}],required:!1},column:{name:"union",value:[{name:"string"},{name:"number"}],required:!1}}}},activeCellRef:{required:!1,tsType:{name:"MutableRefObject",elements:[{name:"union",raw:"HTMLElement | undefined",elements:[{name:"HTMLElement"},{name:"undefined"}]}],raw:"MutableRefObject<HTMLElement | undefined>"},description:"This is the ref of the button input, which is the active cell element",type:{name:"object"}},clickAndHoldActive:{required:!1,tsType:{name:"boolean"},description:"Is the user clicking and holding in the data spreadsheet body",type:{name:"bool"}},columns:{required:!1,tsType:{name:"unknown"},description:"All of the spreadsheet columns",type:{name:"array"}},currentMatcher:{required:!1,tsType:{name:"string"},description:"This represents the id of the current cell selection area",type:{name:"string"}},defaultColumn:{required:!1,tsType:{name:"SpreadsheetColumn"},description:"Default spreadsheet sizing values",type:{name:"shape",value:{rowHeight:{name:"number",required:!1},rowHeaderWidth:{name:"number",required:!1},width:{name:"number",required:!1}}}},defaultEmptyRowCount:{required:!1,tsType:{name:"number"},description:"Sets the number of empty rows to be created when there is no data provided",type:{name:"number"}},getTableBodyProps:{required:!1,tsType:{name:"signature",type:"function",raw:"(propGetter?: TableBodyPropGetter<any>) => TableBodyProps",signature:{arguments:[{type:{name:"TableBodyPropGetter",elements:[{name:"any"}],raw:"TableBodyPropGetter<any>"},name:"propGetter"}],return:{name:"TableBodyProps"}}},description:"Function to set table body prop values",type:{name:"func"}},headerGroups:{required:!1,tsType:{name:"Array",elements:[{name:"any"}],raw:"any[]"},description:"Headers provided from useTable hook",type:{name:"arrayOf",value:{name:"object"}}},id:{required:!1,tsType:{name:"union",raw:"number | string",elements:[{name:"number"},{name:"string"}]},description:"The spreadsheet id",type:{name:"union",value:[{name:"number"},{name:"string"}]}},setCurrentColumns:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"Array",elements:[{name:"object"}],raw:"object[]"}],raw:"SetStateAction<object[]>"}],raw:"Dispatch<SetStateAction<object[]>>"},description:"Set current columns after drag drop",type:{name:"func"}},onActiveCellChange:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"The event handler that is called when the active cell changes",type:{name:"func"}},hasCustomRowHeader:{required:!1,tsType:{name:"boolean"},description:"Check if user is using custom component",type:{name:"bool"}},renderRowHeader:{required:!1,tsType:{name:"signature",type:"function",raw:"(index: number) => any[]",signature:{arguments:[{type:{name:"number"},name:"index"}],return:{name:"Array",elements:[{name:"any"}],raw:"any[]"}}},description:"Component next to numbering rows",type:{name:"func"}},renderRowHeaderDirection:{required:!1,tsType:{name:"string"},description:"Component next to numbering rows",type:{name:"string"}},onDataUpdate:{required:!1,tsType:{name:"signature",type:"function",raw:"({ ...args }) => void",signature:{arguments:[{name:""}],return:{name:"void"}}},description:"The event handler that is called to set the rows for the empty spreadsheet",type:{name:"func"}},onSelectionAreaChange:{required:!1,tsType:{name:"signature",type:"function",raw:"({ ...args }) => void",signature:{arguments:[{name:""}],return:{name:"void"}}},description:"The event handler that is called when the selection areas change",type:{name:"func"}},prepareRow:{required:!1,tsType:{name:"signature",type:"function",raw:"(...args) => void",signature:{arguments:[{name:"args",rest:!0}],return:{name:"void"}}},description:"Prepare row function from react-table",type:{name:"func"}},rows:{required:!1,tsType:{name:"Array",elements:[{name:"any"}],raw:"any[]"},description:"All of the spreadsheet row data",type:{name:"arrayOf",value:{name:"object"}}},scrollBarSize:{required:!1,tsType:{name:"number"},description:"The scrollbar width",type:{name:"number"}},selectionAreaData:{required:!1,tsType:{name:"Array",elements:[{name:"any"}],raw:"any[]"},description:"Array of selection area data",type:{name:"array"}},selectedHeaderReorderActive:{required:!1,tsType:{name:"boolean"},description:"Header reordering is active",type:{name:"bool"}},setSelectedHeaderReorderActive:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"boolean"}],raw:"SetStateAction<boolean>"}],raw:"Dispatch<SetStateAction<boolean>>"},description:"Set header reordering active or not",type:{name:"func"}},selectionAreas:{required:!1,tsType:{name:"Array",elements:[{name:"any"}],raw:"any[]"},description:"Array of selection areas",type:{name:"array"}},setActiveCellCoordinates:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"union",raw:"ActiveCellCoordinates | null",elements:[{name:"ActiveCellCoordinates"},{name:"null"}]}],raw:"SetStateAction<ActiveCellCoordinates | null>"}],raw:`Dispatch<
  SetStateAction<ActiveCellCoordinates | null>
>`},description:"Setter fn for activeCellCoordinates state value",type:{name:"func"}},setActiveCellInsideSelectionArea:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"boolean"}],raw:"SetStateAction<boolean>"}],raw:"Dispatch<SetStateAction<boolean>>"},description:"Setter fn for active cell inside of selection area",type:{name:"func"}},setClickAndHoldActive:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"boolean"}],raw:"SetStateAction<boolean>"}],raw:"Dispatch<SetStateAction<boolean>>"},description:"Setter fn for clickAndHold state value",type:{name:"func"}},setColumnOrder:{required:!1,tsType:{name:"signature",type:"function",raw:`(
  updater:
    | ((columnOrder: Array<IdType<any>>) => Array<IdType<any>>)
    | Array<IdType<any>>
) => void`,signature:{arguments:[{type:{name:"union",raw:`| ((columnOrder: Array<IdType<any>>) => Array<IdType<any>>)
| Array<IdType<any>>`,elements:[{name:"unknown"},{name:"Array",elements:[{name:"IdType",elements:[{name:"any"}],raw:"IdType<any>"}],raw:"Array<IdType<any>>"}]},name:"updater"}],return:{name:"void"}}},description:"Setter fn for column ordering, provided from react-table",type:{name:"func"}},setContainerHasFocus:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"boolean"}],raw:"SetStateAction<boolean>"}],raw:"Dispatch<SetStateAction<boolean>>"},description:"Setter fn for containerHasFocus state value",type:{name:"func"}},setCurrentMatcher:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"string"}],raw:"SetStateAction<string>"}],raw:"Dispatch<SetStateAction<string>>"},description:"Setter fn for currentMatcher state value",type:{name:"func"}},setHeaderCellHoldActive:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"boolean"}],raw:"SetStateAction<boolean>"}],raw:"Dispatch<SetStateAction<boolean>>"},description:"Setter fn for header cell hold active value",type:{name:"func"}},setSelectionAreaData:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"Array",elements:[{name:"object"}],raw:"object[]"}],raw:"SetStateAction<object[]>"}],raw:"Dispatch<SetStateAction<object[]>>"},description:"Setter fn for selectionAreaData state value",type:{name:"func"}},setSelectionAreas:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"Array",elements:[{name:"object"}],raw:"object[]"}],raw:"SetStateAction<object[]>"}],raw:"Dispatch<SetStateAction<object[]>>"},description:"Setter fn for selectionAreas state value",type:{name:"func"}},totalColumnsWidth:{required:!1,tsType:{name:"number"},description:"The total columns width",type:{name:"number"}},totalVisibleColumns:{required:!1,tsType:{name:"number"},description:`The total number of columns to be initially visible, additional columns will be rendered and
visible via horizontal scrollbar`,type:{name:"number"}},visibleColumns:{required:!1,tsType:{name:"Array",elements:[{name:"Column",elements:[{name:"object"}],raw:"Column<object>"}],raw:"Column<object>[]"},description:"Prop from react-table used to reorder columns",type:{name:"array"}}}};const ne=`${fe.prefix}--data-spreadsheet`,Fe=g.forwardRef(({activeCellCoordinates:e,cellSize:t,columns:a,currentMatcher:r,defaultColumn:o,headerGroups:f,scrollBarSize:c,selectionAreas:l,selectedHeaderReorderActive:u,setSelectedHeaderReorderActive:m,setActiveCellCoordinates:x,setCurrentMatcher:A,setSelectionAreas:d,readOnlyTable:h,disableColumnSwapping:i,setSelectionAreaData:b,rows:_,totalVisibleColumns:M,updateActiveCellCoordinates:H,setHeaderCellHoldActive:P,headerCellHoldActive:I,selectAllAriaLabel:B,visibleColumns:y},$)=>{const[L,O]=g.useState(0),W=Be({cellSize:t})||{};g.useEffect(()=>{var n;if((W==null?void 0:W.cellSize)!==t){const q=(n=$==null?void 0:$.current)==null?void 0:n.querySelector(`.${ne}__list--container`),V=(q==null?void 0:q.scrollHeight)&&(q==null?void 0:q.clientHeight)&&(q==null?void 0:q.scrollHeight)>(q==null?void 0:q.clientHeight)?0:c;q!=null&&q.getAttribute("tabIndex")||q==null||q.setAttribute("tabIndex","0"),O(V)}},[t,$,c,W==null?void 0:W.cellSize]);const J=n=>q=>{const X=De(q,"cmd"),V=De(q,"shiftKey");Ne({type:"column",activeCellCoordinates:e,rows:_,columns:a,currentMatcher:r,setActiveCellCoordinates:x,setCurrentMatcher:A,setSelectionAreas:d,spreadsheetRef:$,index:n,isKeyboard:void 0,setSelectionAreaData:b,isHoldingCommandKey:X,isHoldingShiftKey:V})},z=()=>{it({ref:$,setCurrentMatcher:A,setSelectionAreas:d,rows:_,columns:a,activeCellCoordinates:e,updateActiveCellCoordinates:H})},v=n=>q=>{var ye,ge,Se,_e,ce,S;if(q.shiftKey)return;const X=l==null?void 0:l.filter(j=>(j==null?void 0:j.matcher)===r),V=$.current.querySelector(`[data-matcher-id="${(ye=X==null?void 0:X[0])==null?void 0:ye.matcher}"]`);V&&V.classList.add(`${ne}__selection-area--element`),typeof m=="function"&&m(!0);const E=q.clientX,k=q.target.getBoundingClientRect(),ue=q.target.getAttribute("data-column-index"),le=E-k.left,K=Math.min(((Se=(ge=X==null?void 0:X[0])==null?void 0:ge.point1)==null?void 0:Se.column)||0,((ce=(_e=X==null?void 0:X[0])==null?void 0:_e.point2)==null?void 0:ce.column)||0),D=(V==null?void 0:V.getBoundingClientRect())||new DOMRect,Q=K<parseInt(ue)?le+(k.left-(D==null?void 0:D.left)):le,C=(S=document==null?void 0:document.querySelector(`.${ne}__list--container`))==null?void 0:S.firstElementChild,ae=V==null?void 0:V.cloneNode(),de=V==null?void 0:V.cloneNode();de&&(de.className=`${ne}__reorder-indicator-line`,de.style.width=re(2)),ae.classList.add(`${ne}__selection-area--element-cloned`),ae.setAttribute("data-clone-offset-x",`${Q}`),ae.setAttribute("data-column-index-original",n),C==null||C.appendChild(ae),C==null||C.appendChild(de),P==null||P(!0)};return Kt({ref:$,headerCellHoldActive:I,defaultColumn:o}),ee.createElement("div",{className:we(`${ne}__header--container`),role:"rowgroup"},f==null?void 0:f.map((n,q)=>{const X=Ve(n.getHeaderGroupProps(),"key");return ee.createElement("div",{key:`header_${q}`,...X,style:{...n.getHeaderGroupProps().style,width:mt({type:"header",headerGroup:n,scrollBarSizeValue:L,totalVisibleColumns:M,defaultColumn:o,totalColumnsWidth:void 0,visibleColumns:y}),overflow:"hidden"},className:`${ne}__tr`},ee.createElement("div",{role:"columnheader",className:`${ne}__select-all-cell-container`,style:{width:o==null?void 0:o.rowHeaderWidth,height:o==null?void 0:o.rowHeight}},ee.createElement("button",{id:`${ne}__cell--header--header`,"data-row-index":"header","data-column-index":"header",type:"button",style:{width:o==null?void 0:o.rowHeaderWidth},tabIndex:-1,"aria-label":B,onClick:z,className:we(`${ne}__th`,`${ne}--interactive-cell-element`,`${ne}__th--select-all`,{[`${ne}__th--active-header`]:(e==null?void 0:e.column)==="header"&&(e==null?void 0:e.row)==="header"})},"Â ")),n.headers.map((V,E)=>{const k=Ve(V.getHeaderProps(),"key"),ue=lt(E,l,"column",_);return ee.createElement("div",{key:`column_${E}`,role:"columnheader",className:`${ne}__columnheader`,...k},ee.createElement("button",{id:`${ne}__cell--header--${E}`,"data-row-index":"header","data-column-index":E,tabIndex:-1,onMouseDown:ue&&!h&&!i?v(E):void 0,onMouseUp:ue&&!h&&!i&&typeof m=="function"?()=>m(!1):void 0,onClick:ue?void 0:J(E),style:{height:o==null?void 0:o.rowHeight,width:(V==null?void 0:V.width)||(o==null?void 0:o.width)},className:we(`${ne}__th`,`${ne}--interactive-cell-element`,{[`${ne}__th--active-header`]:(e==null?void 0:e.column)===E||Ke(E,l,"column"),[`${ne}__th--active-header-disabledSwapping`]:i||h,[`${ne}__th--selected-header`]:ue,[`${ne}__th--selected-header-reorder-active`]:u}),type:"button"},V.render("Header")))}))}))});Fe.propTypes={activeCellCoordinates:s.shape({row:s.oneOfType([s.number,s.string]),column:s.oneOfType([s.number,s.string])}),cellSize:s.oneOf(["xs","sm","md","lg"]),columns:s.array,currentMatcher:s.string,defaultColumn:s.shape({rowHeight:s.number,rowHeaderWidth:s.number,width:s.number}),disableColumnSwapping:s.bool,headerCellHoldActive:s.bool,headerGroups:s.arrayOf(s.object),readOnlyTable:s.bool,rows:s.arrayOf(s.object),scrollBarSize:s.number,selectAllAriaLabel:s.string.isRequired,selectedHeaderReorderActive:s.bool,selectionAreas:s.arrayOf(s.object),setActiveCellCoordinates:s.func,setCurrentMatcher:s.func,setHeaderCellHoldActive:s.func,setSelectedHeaderReorderActive:s.func,setSelectionAreaData:s.func,setSelectionAreas:s.func,totalVisibleColumns:s.number,updateActiveCellCoordinates:s.func,visibleColumns:s.array};Fe.__docgenInfo={description:"",methods:[],displayName:"DataSpreadsheetHeader",props:{activeCellCoordinates:{required:!1,tsType:{name:"union",raw:"ActiveCellCoordinates | null",elements:[{name:"ActiveCellCoordinates"},{name:"null"}]},description:"Object containing the active cell coordinates",type:{name:"shape",value:{row:{name:"union",value:[{name:"number"},{name:"string"}],required:!1},column:{name:"union",value:[{name:"number"},{name:"string"}],required:!1}}}},cellSize:{required:!1,tsType:{name:"union",raw:"'xs' | 'sm' | 'md' | 'lg'",elements:[{name:"literal",value:"'xs'"},{name:"literal",value:"'sm'"},{name:"literal",value:"'md'"},{name:"literal",value:"'lg'"}]},description:"Specifies the cell height",type:{name:"enum",value:[{value:"'xs'",computed:!1},{value:"'sm'",computed:!1},{value:"'md'",computed:!1},{value:"'lg'",computed:!1}]}},disableColumnSwapping:{required:!1,tsType:{name:"boolean"},description:"Disable column swapping, default false",type:{name:"bool"}},columns:{required:!1,tsType:{name:"unknown"},description:"All of the spreadsheet columns",type:{name:"array"}},currentMatcher:{required:!1,tsType:{name:"string"},description:"uuid that corresponds to the current selection area",type:{name:"string"}},defaultColumn:{required:!1,tsType:{name:"SpreadsheetColumn"},description:"Default spreadsheet sizing values",type:{name:"shape",value:{rowHeight:{name:"number",required:!1},rowHeaderWidth:{name:"number",required:!1},width:{name:"number",required:!1}}}},headerCellHoldActive:{required:!1,tsType:{name:"boolean"},description:"Whether or not a click/hold is active on a header cell",type:{name:"bool"}},headerGroups:{required:!1,tsType:{name:"Array",elements:[{name:"any"}],raw:"any[]"},description:"Headers provided from useTable hook",type:{name:"arrayOf",value:{name:"object"}}},readOnlyTable:{required:!1,tsType:{name:"boolean"},description:"Read-only table",type:{name:"bool"}},rows:{required:!1,tsType:{name:"Array",elements:[{name:"object"}],raw:"object[]"},description:"All of the spreadsheet row data",type:{name:"arrayOf",value:{name:"object"}}},scrollBarSize:{required:!1,tsType:{name:"number"},description:"The scrollbar width",type:{name:"number"}},selectAllAriaLabel:{required:!0,tsType:{name:"string"},description:"The aria label applied to the Select all button",type:{name:"string"}},selectionAreas:{required:!1,tsType:{name:"Array",elements:[{name:"ItemType"}],raw:"ItemType[]"},description:"All of the cell selection area items",type:{name:"arrayOf",value:{name:"object"}}},setActiveCellCoordinates:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"union",raw:"ActiveCellCoordinates | null",elements:[{name:"ActiveCellCoordinates"},{name:"null"}]}],raw:"SetStateAction<ActiveCellCoordinates | null>"}],raw:`Dispatch<
  SetStateAction<ActiveCellCoordinates | null>
>`},description:"Setter fn for activeCellCoordinates value",type:{name:"func"}},selectedHeaderReorderActive:{required:!1,tsType:{name:"boolean"},description:"Header reordering is active",type:{name:"bool"}},setSelectedHeaderReorderActive:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"boolean"}],raw:"SetStateAction<boolean>"}],raw:"Dispatch<SetStateAction<boolean>>"},description:"Set header reordering active or not",type:{name:"func"}},setCurrentMatcher:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"string"}],raw:"SetStateAction<string>"}],raw:"Dispatch<SetStateAction<string>>"},description:"Setter fn for currentMatcher value",type:{name:"func"}},setHeaderCellHoldActive:{required:!1,tsType:{name:"signature",type:"function",raw:"(arg: boolean) => void",signature:{arguments:[{type:{name:"boolean"},name:"arg"}],return:{name:"void"}}},description:"Setter fn for header cell hold active value",type:{name:"func"}},setSelectionAreaData:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"Array",elements:[{name:"object"}],raw:"object[]"}],raw:"SetStateAction<object[]>"}],raw:"Dispatch<SetStateAction<object[]>>"},description:"Setter fn for selectionAreaData state value",type:{name:"func"}},setSelectionAreas:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"Array",elements:[{name:"object"}],raw:"object[]"}],raw:"SetStateAction<object[]>"}],raw:"Dispatch<SetStateAction<object[]>>"},description:"Setter fn for selectionAreas value",type:{name:"func"}},totalVisibleColumns:{required:!1,tsType:{name:"number"},description:`The total number of columns to be initially visible, additional columns will be rendered and
visible via horizontal scrollbar`,type:{name:"number"}},updateActiveCellCoordinates:{required:!1,tsType:{name:"signature",type:"function",raw:"(arg) => void",signature:{arguments:[{name:"arg"}],return:{name:"void"}}},description:"Function used to update the active cell coordinates",type:{name:"func"}},visibleColumns:{required:!1,tsType:{name:"Array",elements:[{name:"Column",elements:[{name:"object"}],raw:"Column<object>"}],raw:"Column<object>[]"},description:"Array of visible columns provided by react-table useTable hook",type:{name:"array"}}}};const Gt=({placementElement:e,coords:t,addToHeader:a=!1,contextRef:r,blockClass:o=`${fe.prefix}--data-spreadsheet`,onActiveCellChange:f,activeCellValue:c,activeCellRef:l,cellEditorRef:u,defaultColumn:m})=>{if(!t)return;const x=document.querySelector(`[data-row-index="${t.row}"][data-column-index="${t.column}"]`)||document.querySelector(`.${o}__body--td`),A=x.offsetWidth,d=x.offsetHeight,h=a?r==null?void 0:r.current.querySelector(`.${o}__header--container`):r==null?void 0:r.current.querySelector(`.${o}__list--container`).firstElementChild,i={top:e?e.getBoundingClientRect().top-h.getBoundingClientRect().top:t.row===0?0:d*t.row,left:e?e.getBoundingClientRect().left-h.getBoundingClientRect().left:t.column===0?0+(m.rowHeaderWidth-4):A*t.column+(m.rowHeaderWidth-4)},b=l==null?void 0:l.current;b.style.width=re(e?e==null?void 0:e.offsetWidth:A),b.style.height=re(e?e==null?void 0:e.offsetHeight:d),b.style.left=re(i.left),b.style.top=re(i.top),b.style.display="block",b.setAttribute("data-active-row-index",typeof(t==null?void 0:t.row)=="number"?t.row:"header"),b.setAttribute("data-active-column-index",typeof(t==null?void 0:t.column)=="number"?t.column:"header"),h.appendChild(b),b.focus(),a||h.appendChild(u.current),typeof(t==null?void 0:t.column)=="number"&&typeof(t==null?void 0:t.row)=="number"&&(f==null||f(c))},ke=e=>Number(e.replace("rem","")*Ot),vt=e=>{switch(e){case"xs":return ke(Dt);case"sm":return ke(st);case"md":return ke(Mt);case"lg":return ke(kt);default:return ke(st)}},Ct=()=>{const e=document.createElement("div");e.setAttribute("style","width: 100px; height: 100px; overflow: scroll; position:absolute; top:-9999px;"),document.body.appendChild(e);const t=e.offsetWidth-e.clientWidth;return document.body.removeChild(e),t},en=({activeCellCoordinates:e,cellEditorRulerRef:t,columns:a,previousState:r,removeCellEditor:o,rows:f,setActiveCellCoordinates:c,setCurrentMatcher:l,setSelectionAreas:u,spreadsheetRef:m,updateData:x})=>A=>{const{key:d}=A,h=({type:i})=>{const b=()=>{const H=r==null?void 0:r.activeCellCoordinates,P=f[H==null?void 0:H.row].cells[H==null?void 0:H.column];o(),x(H==null?void 0:H.row,P.column.id)};be({spreadsheetRef:m}),b();const _=Me(),M={row:i==="Enter"?e.row===f.length-1?e.row:e.row+1:e.row,column:i==="Tab"?e.column===a.length-1?e.column:e.column+1:e.column};u([{point1:M,point2:M,matcher:_,areaCreated:!1}]),l(_),t.current.textContent=""};d==="Enter"&&(h({type:"Enter"}),c(i=>({...i,row:i.row===f.length-1?i.row:i.row+1}))),d==="Tab"&&(A.preventDefault(),h({type:"Tab"}),c(i=>({...i,column:i.column===a.length-1?i.column:i.column+1})))},ie=`${fe.prefix}--data-spreadsheet`,Xe="DataSpreadsheet",$e={columns:Object.freeze([]),data:Object.freeze([]),defaultEmptyRowCount:16,onDataUpdate:Object.freeze(()=>{}),onColDrag:Object.freeze(()=>{}),onActiveCellChange:Object.freeze(()=>{}),onSelectionAreaChange:Object.freeze(()=>{})};let je=ee.forwardRef(({cellSize:e="sm",className:t,columns:a=$e.columns,data:r=$e.data,defaultEmptyRowCount:o=$e.defaultEmptyRowCount,onDataUpdate:f=$e.onDataUpdate,onColDrag:c=$e.onColDrag,id:l,onActiveCellChange:u=$e.onActiveCellChange,onSelectionAreaChange:m=$e.onSelectionAreaChange,renderRowHeader:x,renderRowHeaderDirection:A,disableColumnSwapping:d=!1,readOnlyTable:h=!1,selectAllAriaLabel:i,spreadsheetAriaLabel:b,theme:_,totalVisibleColumns:M,...H},P)=>{const I=g.useRef(null),B=g.useRef(void 0),y=P||B,$=Lt(),[L,O]=g.useState(a),[W,J]=g.useState([]),[z,v]=g.useState(!1),[n,q]=g.useState(null),[X,V]=g.useState([]),[E,k]=g.useState([]),[ue,le]=g.useState(!1),[K,D]=g.useState(""),[Q,C]=g.useState(!1),[ae,de]=g.useState(""),[ye,ge]=g.useState(!1),[Se,_e]=g.useState(!1),ce=g.useRef(!1),[S,j]=g.useState(!1),[N,Y]=g.useState(!1),T=Be({activeCellCoordinates:n,isEditing:Q,cellEditorValue:ae,selectedHeaderReorderActive:Se})||{},Z=vt(e),F=g.useRef(void 0),[pe,qe]=g.useState(),he=g.useRef(void 0),te=g.useRef(void 0),Ee=typeof x=="function",Re=r.length.toString().length,He=g.useMemo(()=>({width:150,rowHeaderWidth:Ee?40+Re*8.56:64,rowHeight:Z}),[Z,Ee,Re]),{keysPressedList:Je,usingMac:Qe}=Ht({ref:I,containerHasFocus:z,isEditing:Q}),Ye=g.useMemo(()=>Ct(),[]),{getTableProps:dt,getTableBodyProps:ht,headerGroups:Ze,rows:oe,totalColumnsWidth:pt,prepareRow:ft,setColumnOrder:yt,visibleColumns:We}=ze.useTable({columns:a,data:r,defaultColumn:He},ze.useBlockLayout,ze.useColumnOrder),Oe=g.useCallback((p,w,U)=>{f(G=>G.map((se,xe)=>xe===p?{...G[p],[w]:ae||U}:se))},[ae,f]);g.useEffect(()=>{const p=[];Object.keys(L).length>0&&Object.keys(L).forEach(w=>{typeof L[w].Header=="object"?L[w].column_name?p.push(L[w].column_name):p.push(Pt(L[w].Header)):L[w].Header&&p.push(L[w].Header)}),T.selectedHeaderReorderActive&&J(p),!T.selectedHeaderReorderActive&&W.length>0&&!ye&&JSON.stringify(p)!==JSON.stringify(W)&&(c({headers:p,data:pe.props.data}),p.length===0&&J([]))},[T==null?void 0:T.selectedHeaderReorderActive,L,ye,a,pe,c,W]);const Pe=g.useCallback(()=>{var w;const p=(w=y==null?void 0:y.current)==null?void 0:w.querySelector(`.${ie}__active-cell--highlight`);p&&(p.style.display="none")},[y]),Te=g.useCallback(()=>{de(""),C(!1),F!=null&&F.current&&(F.current.style.display="none")},[]);g.useEffect(()=>{const p=T==null?void 0:T.activeCellCoordinates;if(((p==null?void 0:p.row)!==(n==null?void 0:n.row)||(p==null?void 0:p.column)!==(n==null?void 0:n.column))&&Q){const w=oe[Number(p==null?void 0:p.row)].cells[Number(p==null?void 0:p.column)];Te(),Oe(p==null?void 0:p.row,w.column.id,void 0),te!=null&&te.current&&(te.current.textContent="")}if((p==null?void 0:p.row)!==(n==null?void 0:n.row)||(p==null?void 0:p.column)!==(n==null?void 0:n.column)){if(n&&(n==null?void 0:n.row)!=="header"&&(n==null?void 0:n.column)!=="header"){const w=typeof(n==null?void 0:n.column)=="number"&&typeof(n==null?void 0:n.row)=="number"?oe[n==null?void 0:n.row].cells[n==null?void 0:n.column]:null;qe(w?w.render("Cell"):null)}(n&&(n==null?void 0:n.row)==="header"||(n==null?void 0:n.column)==="header")&&(qe(null),j(w=>!w))}Q&&T.activeCellCoordinates&&ce.current&&(qe(T.cellEditorValue),ce.current=!1,Te())},[ce,n,T==null?void 0:T.activeCellCoordinates,T==null?void 0:T.cellEditorValue,Oe,oe,Q,Te,pe]);const wt=g.useCallback(({placementElement:p,coords:w,addToHeader:U=!1})=>{const G=typeof(w==null?void 0:w.column)=="number"&&typeof(w==null?void 0:w.row)=="number"?oe[w==null?void 0:w.row].cells[w==null?void 0:w.column]:null,se=G?Object.values(G.row.values)[w==null?void 0:w.column]:null;Gt({placementElement:p,coords:w,addToHeader:U,contextRef:y,blockClass:ie,onActiveCellChange:u,activeCellValue:se,activeCellRef:he,cellEditorRef:F,defaultColumn:He})},[y,oe,u,He]);Nt({focusedElement:$,removeActiveCell:Pe,setContainerHasFocus:v}),Bt({isBlurSpreadsheet:ce,spreadsheetRef:y,setActiveCellCoordinates:q,setSelectionAreas:V,removeActiveCell:Pe,setContainerHasFocus:v,removeCellEditor:Te}),Vt({spreadsheetRef:y,activeCellCoordinates:n,containerHasFocus:z,createActiveCell:wt,activeCellContent:pe,isActiveHeaderCellChanged:S});const Ge=g.useCallback(()=>{Y(!1),n||q({column:"header",row:"header"})},[n]),Ae=g.useCallback(({coords:p={...n},updatedValue:w,optOutOfSelectionAreaUpdate:U=!1})=>{const G={...p,...w};if(q(G),G.row!=="header"&&G.column!=="header"&&!U){const se=Me();V([{point1:G,matcher:se}]),D(se)}},[n]),ve=g.useCallback(({type:p})=>{const w={...n};Ae({coords:w,updatedValue:{column:p==="Home"?0:a.length-1}}),be({matcher:void 0,spreadsheetRef:y})},[n,Ae,y,a.length]),Ce=g.useCallback(p=>Q||p==="Meta"||p==="Control",[Q]),et=g.useCallback(p=>{event==null||event.preventDefault(),Ge();const w={...n};let U;switch(p){case"ArrowLeft":{if(w.column==="header")return;typeof w.column=="number"&&(w.column===0?U={column:"header"}:U={column:w.column-1});break}case"ArrowUp":{if(w.row==="header")return;typeof w.row=="number"&&(w.row===0?U={row:"header"}:U={row:w.row-1});break}case"ArrowRight":{if(w.column==="header"&&(U={column:0}),typeof w.column=="number"){if(a.length-1===w.column)return;U={column:w.column+1}}break}case"ArrowDown":{if(w.row==="header"&&(U={row:0}),typeof w.row=="number"){if(oe.length-1===w.row)return;U={row:w.row+1}}break}}U&&Ae({coords:w,updatedValue:U})},[Ge,Ae,n,a,oe]),gt=g.useCallback(p=>{Zt(p,N,Ae,n,Pe,a,oe,y,K,Te,X,ve,Je,Qe,Oe,Ce,et,V,k,D,he,q,v,qe,h)},[N,Ae,n,Pe,a,oe,y,K,Te,X,ve,Je,Qe,Oe,Ce,et,h]),tt=()=>{var U,G,se,xe,at;C(!0),le(!1);const p=typeof(n==null?void 0:n.column)=="number"&&typeof(n==null?void 0:n.row)=="number"?oe[n==null?void 0:n.row].cells[n==null?void 0:n.column]:null,w=(se=(G=(U=p==null?void 0:p.row)==null?void 0:U.cells)==null?void 0:G[Number(n==null?void 0:n.column)])==null?void 0:se.value;de(w||""),te!=null&&te.current&&(te.current.textContent=w),F!=null&&F.current&&(he!=null&&he.current)&&(F.current.style.width=(at=(xe=he==null?void 0:he.current)==null?void 0:xe.style)==null?void 0:at.width)};g.useEffect(()=>{var p,w,U,G,se,xe;Q&&!(T!=null&&T.isEditing)&&((se=F==null?void 0:F.current)==null||se.setSelectionRange(Number((w=(p=te==null?void 0:te.current)==null?void 0:p.textContent)==null?void 0:w.length),Number((G=(U=te==null?void 0:te.current)==null?void 0:U.textContent)==null?void 0:G.length)),(xe=F==null?void 0:F.current)==null||xe.focus())},[Q,T==null?void 0:T.isEditing]);const bt=()=>{if((n==null?void 0:n.row)==="header"||(n==null?void 0:n.column)==="header"){const p=(n==null?void 0:n.row)==="header"?n==null?void 0:n.column:n==null?void 0:n.row;if((n==null?void 0:n.row)==="header"&&(n==null?void 0:n.column)==="header")return;nt({isKeyboard:!1,index:Number(p)})}},St=()=>{le(!1)},xt=()=>{if((n==null?void 0:n.row)!=="header"||(n==null?void 0:n.column)!=="header"){const p=Me();le(!0),be({matcher:null,spreadsheetRef:y}),V([{point1:n,matcher:p}]),D(p),k([]),Y(!1)}},_t=p=>{const{key:w}=p;w==="Enter"&&!N&&!h&&((n==null?void 0:n.column)!=="header"&&(n==null?void 0:n.row)!=="header"&&tt(),((n==null?void 0:n.row)==="header"||(n==null?void 0:n.column)==="header")&&nt({isKeyboard:!0}))},nt=({isKeyboard:p,index:w=-1})=>{const U={activeCellCoordinates:n,rows:oe,columns:a,currentMatcher:K,setActiveCellCoordinates:q,setCurrentMatcher:D,setSelectionAreas:V,spreadsheetRef:y,index:w,isKeyboard:p,setSelectionAreaData:k,isHoldingCommandKey:null,isHoldingShiftKey:null};(n==null?void 0:n.row)==="header"&&(n==null?void 0:n.column)!=="header"&&Ne({type:"column",...U}),(n==null?void 0:n.column)==="header"&&(n==null?void 0:n.row)!=="header"&&Ne({type:"row",...U}),(n==null?void 0:n.column)==="header"&&(n==null?void 0:n.row)==="header"&&it({ref:y,setCurrentMatcher:D,setSelectionAreas:V,rows:oe,columns:a,activeCellCoordinates:n,updateActiveCellCoordinates:Ae})},At=p=>{p||tt()};Et({isEditing:Q,rows:oe,activeCellCoordinates:n,activeCellRef:he,cellEditorRef:F,cellEditorRulerRef:te,visibleColumns:We,defaultColumn:He,cellEditorValue:ae});const rt=g.useCallback((p,w)=>{K&&p&&p.length&&w&&K&&V(U=>{const G=me(U),se=G.findIndex(xe=>xe.matcher===K);return se===-1?U:typeof G[se].point2=="object"&&G[se].areaCreated?(G[se].point2=G[se].point1,G[se].areaCreated=!1,Y(!1),be({matcher:K,spreadsheetRef:y}),G):U})},[y,K]),Tt=g.useCallback(()=>{rt(X,ue)},[ue,X,rt]);return ee.createElement("div",{...H,...dt(),...jt(Xe),className:we(ie,t,`${ie}--interactive-cell-element`,{[`${ie}__container-has-focus`]:z,[`${ie}__${_}`]:_==="dark"}),ref:y,role:"grid",tabIndex:0,"aria-rowcount":(oe==null?void 0:oe.length)||0,"aria-colcount":(a==null?void 0:a.length)||0,"aria-label":b,onKeyDown:gt,onFocus:()=>v(!0)},ee.createElement("div",{ref:I},ee.createElement(Fe,{ref:y,activeCellCoordinates:n,cellSize:e,columns:a,currentMatcher:K,defaultColumn:He,selectedHeaderReorderActive:Se,setSelectedHeaderReorderActive:_e,headerGroups:Ze,rows:oe,scrollBarSize:Ye,selectionAreas:X,setActiveCellCoordinates:q,setSelectionAreas:V,setCurrentMatcher:D,setSelectionAreaData:k,disableColumnSwapping:d,readOnlyTable:h,totalVisibleColumns:M,updateActiveCellCoordinates:Ae,setHeaderCellHoldActive:ge,headerCellHoldActive:ye,visibleColumns:We,selectAllAriaLabel:i}),ee.createElement(Ue,{activeCellRef:he,activeCellCoordinates:n,setCurrentColumns:O,ref:y,clickAndHoldActive:ue,setClickAndHoldActive:le,currentMatcher:K,setCurrentMatcher:D,setContainerHasFocus:v,selectedHeaderReorderActive:Se,setSelectedHeaderReorderActive:_e,selectionAreas:X,setSelectionAreas:V,headerGroups:Ze,defaultColumn:He,getTableBodyProps:ht,hasCustomRowHeader:Ee,onDataUpdate:f,renderRowHeaderDirection:A,renderRowHeader:x,onActiveCellChange:u,onSelectionAreaChange:m,prepareRow:ft,rows:oe,selectionAreaData:E,setSelectionAreaData:k,setActiveCellCoordinates:q,scrollBarSize:Ye,totalColumnsWidth:pt,id:l,columns:a,defaultEmptyRowCount:o,setActiveCellInsideSelectionArea:Y,totalVisibleColumns:M,setHeaderCellHoldActive:ge,setColumnOrder:yt,visibleColumns:We}),ee.createElement("button",{onMouseDown:xt,onMouseUp:St,onClick:bt,onKeyDown:_t,onDoubleClick:()=>At(h),onMouseEnter:Tt,ref:he,className:we(`${ie}--interactive-cell-element`,`${ie}__active-cell--highlight`,{[`${ie}__active-cell--with-selection`]:N}),type:"button"},pe),ee.createElement("textarea",{id:`${ie}__cell-editor-text-area`,value:ae,onKeyDown:en({activeCellCoordinates:n,cellEditorRulerRef:te,columns:a,previousState:T,removeCellEditor:Te,rows:oe,setActiveCellCoordinates:q,setCurrentMatcher:D,setSelectionAreas:V,spreadsheetRef:y,updateData:Oe}),onChange:p=>{T.isEditing&&(de(p.target.value),te!=null&&te.current&&(te.current.textContent=p.target.value))},ref:F,"aria-labelledby":n?`${ie}__cell--${n==null?void 0:n.row}--${n==null?void 0:n.column}`:"",className:we(`${ie}__cell-editor`,`${ie}--interactive-cell-element`,`${ie}__cell-editor--${e}`,{[`${ie}__cell-editor--active`]:Q})}),ee.createElement("pre",{"aria-hidden":!0,ref:te,className:`${ie}__cell-editor-ruler`})))});je=fe.checkComponentEnabled(je,Xe);je.displayName=Xe;je.propTypes={cellSize:s.oneOf(["xs","sm","md","lg"]),className:s.string,columns:s.arrayOf(s.shape({Header:s.string,accessor:s.oneOfType([s.string,s.func]),Cell:s.func})),data:s.arrayOf(s.shape),defaultEmptyRowCount:s.number,disableColumnSwapping:s.bool,hasCustomRowHeader:s.bool,id:s.oneOfType([s.number,s.string]),onActiveCellChange:s.func,onColDrag:s.func,onDataUpdate:s.func,onSelectionAreaChange:s.func,readOnlyTable:s.bool,renderRowHeader:s.func,renderRowHeaderDirection:s.oneOf(["left","right"]),selectAllAriaLabel:s.string.isRequired,spreadsheetAriaLabel:s.string.isRequired,theme:s.oneOf(["light","dark"]),totalVisibleColumns:s.number};je.__docgenInfo={description:"DataSpreadsheet: used to organize and display large amounts of structured data, separated by columns and rows in a grid-like format.",methods:[],displayName:"DataSpreadsheet",props:{cellSize:{required:!1,tsType:{name:"union",raw:"'xs' | 'sm' | 'md' | 'lg'",elements:[{name:"literal",value:"'xs'"},{name:"literal",value:"'sm'"},{name:"literal",value:"'md'"},{name:"literal",value:"'lg'"}]},description:"Specifies the cell height",defaultValue:{value:"'sm'",computed:!1},type:{name:"enum",value:[{value:"'xs'",computed:!1},{value:"'sm'",computed:!1},{value:"'md'",computed:!1},{value:"'lg'",computed:!1}]}},className:{required:!1,tsType:{name:"string"},description:"Provide an optional class to be applied to the containing node.",type:{name:"string"}},columns:{required:!1,tsType:{name:"unknown"},description:"The data that will build the column headers",defaultValue:{value:"Object.freeze([])",computed:!0},type:{name:"arrayOf",value:{name:"shape",value:{Header:{name:"string",required:!1},accessor:{name:"union",value:[{name:"string"},{name:"func"}],required:!1},Cell:{name:"func",required:!1}}}}},disableColumnSwapping:{required:!1,tsType:{name:"boolean"},description:"Disable column swapping, default false",defaultValue:{value:"false",computed:!1},type:{name:"bool"}},data:{required:!1,tsType:{name:"unknown"},description:"The spreadsheet data that will be rendered in the body of the spreadsheet component",defaultValue:{value:"Object.freeze([])",computed:!0},type:{name:"arrayOf",value:{name:"shape",value:"",computed:!0}}},defaultEmptyRowCount:{required:!1,tsType:{name:"number"},description:"Sets the number of empty rows to be created when there is no data provided",defaultValue:{value:"16",computed:!1},type:{name:"number"}},hasCustomRowHeader:{required:!1,tsType:{name:"boolean"},description:"Check if has custom row header component attached",type:{name:"bool"}},id:{required:!1,tsType:{name:"union",raw:"number | string",elements:[{name:"number"},{name:"string"}]},description:"The spreadsheet id",type:{name:"union",value:[{name:"number"},{name:"string"}]}},onActiveCellChange:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"The event handler that is called when the active cell changes",defaultValue:{value:"Object.freeze(() => {})",computed:!0},type:{name:"func"}},onColDrag:{required:!1,tsType:{name:"signature",type:"function",raw:"({ ...args }) => void",signature:{arguments:[{name:""}],return:{name:"void"}}},description:"Callback for columns after being dragged",defaultValue:{value:"Object.freeze(() => {})",computed:!0},type:{name:"func"}},onDataUpdate:{required:!1,tsType:{name:"signature",type:"function",raw:"({ ...args }) => void",signature:{arguments:[{name:""}],return:{name:"void"}}},description:"The setter fn for the data prop",defaultValue:{value:"Object.freeze(() => {})",computed:!0},type:{name:"func"}},onSelectionAreaChange:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"The event handler that is called when the selection area values change",defaultValue:{value:"Object.freeze(() => {})",computed:!0},type:{name:"func"}},readOnlyTable:{required:!1,tsType:{name:"boolean"},description:"Read-only table",defaultValue:{value:"false",computed:!1},type:{name:"bool"}},renderRowHeaderDirection:{required:!1,tsType:{name:"union",raw:"'left' | 'right'",elements:[{name:"literal",value:"'left'"},{name:"literal",value:"'right'"}]},description:"Position of the custom row numbering component",type:{name:"enum",value:[{value:"'left'",computed:!1},{value:"'right'",computed:!1}]}},renderRowHeader:{required:!1,tsType:{name:"signature",type:"function",raw:"(index: number) => any[]",signature:{arguments:[{type:{name:"number"},name:"index"}],return:{name:"Array",elements:[{name:"any"}],raw:"any[]"}}},description:"Component next to numbering rows",type:{name:"func"}},selectAllAriaLabel:{required:!0,tsType:{name:"string"},description:"The aria label applied to the Select all button",type:{name:"string"}},spreadsheetAriaLabel:{required:!0,tsType:{name:"string"},description:"The aria label applied to the Data spreadsheet component",type:{name:"string"}},theme:{required:!1,tsType:{name:"union",raw:"'light' | 'dark'",elements:[{name:"literal",value:"'light'"},{name:"literal",value:"'dark'"}]},description:"The theme the DataSpreadsheet should use (only used to render active cell/selection area colors on dark theme)",type:{name:"enum",value:[{value:"'light'",computed:!1},{value:"'dark'",computed:!1}]}},totalVisibleColumns:{required:!1,tsType:{name:"number"},description:`The total number of columns to be initially visible, additional columns will be rendered and
visible via horizontal scrollbar`,type:{name:"number"}}}};export{je as D};
