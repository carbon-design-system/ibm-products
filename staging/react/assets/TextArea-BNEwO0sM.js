import{b as be,c as _e,i as we,v as $e,d as _,_ as Te,P as t,g as G}from"./index-4poXP75K.js";import{r as m,e as r}from"./index-DtHxqM--.js";import{F as ve}from"./FormContext-C4Nuixum.js";import{g as ye}from"./TextInput-CBue0XF4.js";import{n as A}from"./events-CdfZZS3f.js";import{A as Ce}from"./index-CVEmjZFv.js";import{i as Ee}from"./utils--12iVJsW.js";import{T as $}from"./Text-Cjos7Soh.js";import{W as H,a as J}from"./bucket-19-D8xKEiK4.js";const Ne=m.forwardRef,Q=Ne((U,X)=>{const{className:Y,decorator:y,disabled:u=!1,id:C,labelText:I,hideLabel:Z,onChange:L=A,onClick:W=A,onKeyDown:D=A,invalid:o=!1,invalidText:ee="",helperText:T="",light:te,placeholder:ae="",enableCounter:w=!1,maxCount:n,counterMode:s="character",warn:f=!1,warnText:re="",rows:ne=4,slug:E,...p}=U,e=be(),{isFluid:i}=m.useContext(ve),{defaultValue:F,value:O}=p,le=_e(),c=m.useRef(null),oe=we([X,c]);function R(){var x,b;const l=(F||O||((x=c.current)==null?void 0:x.value)||"").toString();return s==="character"?l.length:((b=l.match(new RegExp("\\p{L}+","gu")))==null?void 0:b.length)||0}const[v,h]=m.useState(R());m.useEffect(()=>{h(R())},[O,F,s]),$e(()=>{p.cols&&c.current?(c.current.style.width="",c.current.style.resize="none"):c.current&&(c.current.style.width="100%")},[p.cols]);const P={id:C,onKeyDown:a=>{if(!u&&w&&s==="word"){const l=a.which;(n&&v>=n&&l===32||n&&v>=n&&l===13)&&a.preventDefault()}!u&&D&&D(a)},onPaste:a=>{if(!u&&s==="word"&&w&&typeof n<"u"&&c.current!==null){const l=c.current.value.match(new RegExp("\\p{L}+","gu"))||[],x=a.clipboardData.getData("Text").match(new RegExp("\\p{L}+","gu"))||[];if(l.length+x.length>n){a.preventDefault();const d=l.concat(x).slice(0,n);setTimeout(()=>{h(n)},0),c.current.value=d.join(" ")}}},onChange:a=>{var l,x,b;if(!u){if(s=="character")(l=a==null?void 0:a.persist)==null||l.call(a),setTimeout(()=>{var d,B;h((B=(d=a.target)==null?void 0:d.value)==null?void 0:B.length)},0);else if(s=="word"){if(!a.target.value){setTimeout(()=>{h(0)},0);return}if(w&&typeof n<"u"&&c.current!==null){const d=(b=(x=a.target)==null?void 0:x.value)==null?void 0:b.match(new RegExp("\\p{L}+","gu"));d&&d.length<=n?(c.current.removeAttribute("maxLength"),setTimeout(()=>{h(d.length)},0)):d&&d.length>n&&setTimeout(()=>{h(d.length)},0)}}L&&L(a)}},onClick:a=>{!u&&W&&W(a)}},se=_(`${e}--form-item`,Y),ie=_(`${e}--text-area__wrapper`,{[`${e}--text-area__wrapper--cols`]:p.cols,[`${e}--text-area__wrapper--readonly`]:p.readOnly,[`${e}--text-area__wrapper--warn`]:f,[`${e}--text-area__wrapper--slug`]:E,[`${e}--text-area__wrapper--decorator`]:y}),ce=_(`${e}--label`,{[`${e}--visually-hidden`]:Z&&!i,[`${e}--label--disabled`]:u}),de=_(`${e}--text-area`,{[`${e}--text-area--light`]:te,[`${e}--text-area--invalid`]:o,[`${e}--text-area--warn`]:f}),ue=_(`${e}--label`,{[`${e}--label--disabled`]:u,[`${e}--text-area__label-counter`]:!0}),me=_(`${e}--form__helper-text`,{[`${e}--form__helper-text--disabled`]:u}),fe=I?r.createElement($,{as:"label",htmlFor:C,className:ce},I):null,pe=w&&n&&(s==="character"||s==="word")?r.createElement($,{as:"div",className:ue},`${v}/${n}`):null,V=T?`text-area-helper-text-${le}`:void 0,xe=T?r.createElement($,{as:"div",id:V,className:me},T):null,k=C+"-error-msg",q=o?r.createElement($,{as:"div",role:"alert",className:`${e}--form-requirement`,id:k},ee,i&&r.createElement(H,{className:`${e}--text-area__invalid-icon`})):null,z=f?r.createElement($,{as:"div",role:"alert",className:`${e}--form-requirement`},re,i&&r.createElement(J,{className:`${e}--text-area__invalid-icon ${e}--text-area__invalid-icon--warning`})):null;let N;o?N=k:!o&&!f&&!i&&T&&(N=V),w&&s=="character"&&(P.maxLength=n);const K=m.useRef(null),[M,he]=m.useState(""),g=ye(v,n,s==="word"?"word":void 0,s==="word"?"words":void 0);m.useEffect(()=>{if(g&&g!==M){const a=K.current;if(a){a.textContent="";const l=setTimeout(()=>{a&&(a.textContent=g,he(g))},s==="word"?2e3:1e3);return()=>{l&&clearTimeout(l)}}}},[g,M,s]);const ge=r.createElement("textarea",Te({},p,P,{placeholder:ae,"aria-readonly":!!p.readOnly,className:de,"aria-invalid":o,"aria-describedby":N,disabled:u,rows:ne,readOnly:p.readOnly,ref:oe})),S=E??y,j=Ee(S,Ce)?m.cloneElement(S,{size:"mini"}):null;return r.createElement("div",{className:se},r.createElement("div",{className:`${e}--text-area__label-wrapper`},fe,pe),r.createElement("div",{className:ie,"data-invalid":o||null},o&&!i&&r.createElement(H,{className:`${e}--text-area__invalid-icon`}),f&&!o&&!i&&r.createElement(J,{className:`${e}--text-area__invalid-icon ${e}--text-area__invalid-icon--warning`}),ge,E?j:y?r.createElement("div",{className:`${e}--text-area__inner-wrapper--decorator`},j):"",r.createElement("span",{className:`${e}--text-area__counter-alert`,role:"alert","aria-live":"assertive","aria-atomic":"true",ref:K},g),i&&r.createElement("hr",{className:`${e}--text-area__divider`}),i&&o?q:null,i&&f&&!o?z:null),!o&&!f&&!i?xe:null,o&&!i?q:null,f&&!o&&!i?z:null)});Q.displayName="TextArea";Q.propTypes={className:t.string,cols:t.number,counterMode:t.oneOf(["character","word"]),decorator:t.node,defaultValue:t.oneOfType([t.string,t.number]),disabled:t.bool,enableCounter:t.bool,helperText:t.node,hideLabel:t.bool,id:t.string,invalid:t.bool,invalidText:t.node,labelText:t.node.isRequired,light:G(t.bool),maxCount:t.number,onChange:t.func,onClick:t.func,onKeyDown:t.func,placeholder:t.string,readOnly:t.bool,rows:t.number,slug:G(t.node),value:t.oneOfType([t.string,t.number]),warn:t.bool,warnText:t.node};export{Q as T};
