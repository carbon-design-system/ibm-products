import{b as R,v as H,_ as T,j as G,P as t,d as q,q as O,E as P,S as W,g as A}from"./index-Ccw_5OKp.js";import{e as a,r as $}from"./index-DtHxqM--.js";import{n as L,bk as j,T as J}from"./settings-JuRwpTYJ.js";import{c as M}from"./events-OVwOsPzJ.js";import{L as Q}from"./InlineLoading-B1G6aSdW.js";import{W as X}from"./bucket-18-CKSgrqVQ.js";import{T as D}from"./Text-CPocCdE2.js";var S;function z(y){let{iconDescription:r="Uploading file",status:l="uploading",invalid:p,name:c,tabIndex:b=0,["aria-describedby"]:s,...m}=y;const d=R();switch(l){case"uploading":return a.createElement(Q,{description:r,small:!0,withOverlay:!1,className:`${d}--file-loading`});case"edit":return a.createElement(a.Fragment,null,p&&a.createElement(X,{className:`${d}--file-invalid`}),a.createElement("button",T({"aria-label":`${r} - ${c}`,className:`${d}--file-close`,type:"button",tabIndex:b},m,{"aria-describedby":p?s:void 0}),S||(S=a.createElement(G,null))));case"complete":return a.createElement(H,T({"aria-label":r,className:`${d}--file-complete`},m,{tabIndex:-1}),r&&a.createElement("title",null,r));default:return null}}z.propTypes={"aria-describedby":t.string,iconDescription:t.string,invalid:t.bool,name:t.string,status:t.oneOf(["edit","complete","uploading"]),tabIndex:t.number};function Y(y){let{accept:r=[],className:l,id:p,disabled:c,labelText:b="Add file",multiple:s=!1,name:m,onAddFiles:d=L,onClick:_,pattern:C=".[0-9a-z]+$",innerRef:F,...v}=y;const f=R(),N=$.useRef(null),{current:i}=$.useRef(p||j()),[h,x]=$.useState(!1),k=q(`${f}--file__drop-container`,`${f}--file-browse-btn`,{[`${f}--file__drop-container--drag-over`]:h,[`${f}--file-browse-btn--disabled`]:c},l);function g(e){if(!r.length)return e;const o=new Set(r);return e.reduce((E,u)=>{const{name:U,type:K=""}=u,V=new RegExp(C,"i"),[I]=U.match(V)??[];return I===void 0?E:o.has(K)||o.has(I.toLowerCase())?E.concat([u]):(u.invalidFileType=!0,E.concat([u]))},[])}function w(e){const o=[...e.target.files??[]],E=s?o:[o[0]],u=g(E);return d(e,{addedFiles:u})}function n(e){const o=[...e.dataTransfer.files],E=s?o:[o[0]],u=g(E);return d(e,{addedFiles:u})}const B=()=>{var e;c||(e=N.current)==null||e.click()};return a.createElement("div",{className:`${f}--file`,onDragOver:e=>{e.stopPropagation(),e.preventDefault(),!c&&(x(!0),e.dataTransfer.dropEffect="copy")},onDragLeave:e=>{e.stopPropagation(),e.preventDefault(),!c&&(x(!1),e.dataTransfer.dropEffect="move")},onDrop:e=>{e.stopPropagation(),e.preventDefault(),!c&&(x(!1),n(e))}},a.createElement("button",T({type:"button",className:k,ref:F,onKeyDown:e=>{var o;O(e,[P,W])&&(e.preventDefault(),(o=N.current)==null||o.click())},onClick:M([_,B])},v),b),a.createElement("label",{htmlFor:i,className:`${f}--visually-hidden`},b),a.createElement("input",{type:"file",id:i,className:`${f}--file-input`,ref:N,tabIndex:-1,disabled:c,accept:r.join(","),name:m,multiple:s,onChange:w,onClick:e=>{e.target.value=""}}))}Y.propTypes={accept:t.arrayOf(t.string),className:t.string,disabled:t.bool,id:t.string,labelText:t.string.isRequired,multiple:t.bool,name:t.string,onAddFiles:t.func,onClick:t.func,pattern:t.string,role:A(t.number),tabIndex:A(t.number)};function Z(y){let{uuid:r,name:l,status:p="uploading",iconDescription:c,onDelete:b=L,invalid:s,errorSubject:m,errorBody:d,size:_,className:C,...F}=y;const v=$.useRef(null),[f,N]=$.useState(!1),i=R(),{current:h}=$.useRef(r||j()),x=q(`${i}--file__selected-file`,C,{[`${i}--file__selected-file--invalid`]:s,[`${i}--file__selected-file--md`]:_==="md",[`${i}--file__selected-file--sm`]:_==="sm"}),k=s?`${i}--file-filename-container-wrap-invalid`:`${i}--file-filename-container-wrap`,g=n=>n==null?void 0:n.replace(/\s+/g,""),w=n=>(N(n.offsetWidth<n.scrollWidth),n.offsetWidth<n.scrollWidth);return $.useLayoutEffect(()=>{w(v.current)},[i,l]),a.createElement("span",T({className:x},F),f?a.createElement("div",{className:k},a.createElement(J,{label:l,align:"bottom",className:`${i}--file-filename-tooltip`},a.createElement("button",{className:`${i}--file-filename-button`,type:"button"},a.createElement(D,{ref:v,as:"p",title:l,className:`${i}--file-filename-button`,id:g(l)},l)))):a.createElement(D,{ref:v,as:"p",title:l,className:`${i}--file-filename`,id:g(l)},l),a.createElement("div",{className:`${i}--file-container-item`},a.createElement("span",{className:`${i}--file__state-container`},a.createElement(z,{name:l,iconDescription:c,status:p,invalid:s,"aria-describedby":s&&m?`${g(l)}-id-error`:void 0,onKeyDown:n=>{O(n,[P,W])&&p==="edit"&&(n.preventDefault(),b(n,{uuid:h}))},onClick:n=>{p==="edit"&&b(n,{uuid:h})}}))),s&&m&&a.createElement("div",{className:`${i}--form-requirement`,role:"alert",id:`${g(l)}-id-error`},a.createElement(D,{as:"div",className:`${i}--form-requirement__title`},m),d&&a.createElement(D,{as:"p",className:`${i}--form-requirement__supplement`},d)))}Z.propTypes={errorBody:t.string,errorSubject:t.string,iconDescription:t.string,invalid:t.bool,name:t.string,onDelete:t.func,size:t.oneOf(["sm","md","lg"]),status:t.oneOf(["uploading","edit","complete"]),uuid:t.string};export{Y as F,Z as a,z as b};
