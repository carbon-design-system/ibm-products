import{u as ve,a as Ve,e as We,f as je,c as He,b as Xe,d as V,_ as ee,P as t,bO as Oe,r as Ye,k as Ke,T as Ge,bR as Ue,q as de,J as Je,D as Qe,H as Ze,U as et,l as tt,g as me}from"./index-CMVdkQrl.js";import{e as h,r as n}from"./index-DtHxqM--.js";import{I as Ee,n as ne}from"./settings-C3kz8lqM.js";import{b as nt,a as ot}from"./useAttachedMenu-C8bta719.js";import{m as re}from"./mergeRefs-CTUecegF.js";import{d as Re}from"./index-BLvAv8yb.js";import{am as ye}from"./bucket-12-sLjQv6-z.js";import{g as Ce,c as Q}from"./_commonjsHelpers-Cpj98o6Y.js";import{h as rt}from"./index-DgLvjnYm.js";import{s as st,b as it,w as at,a as lt}from"./wrapFocus-4QzkQnOM.js";import{u as ct}from"./useOutsideClick-ChWAVyF5.js";const ge="md",ft=r=>({"top-left":"top-start","top-right":"top-end","bottom-left":"bottom-start","bottom-right":"bottom-end","left-bottom":"left-end","left-top":"left-start","right-bottom":"right-end","right-top":"right-start"})[r],Te=h.forwardRef(function(s,l){let{autoAlign:f=!1,children:d,className:i,label:v="Options",renderIcon:u=ye,size:R=ge,menuAlignment:b="bottom-start",tooltipAlignment:m,menuTarget:y,...C}=s;const O=ve("enable-v12-dynamic-floating-styles")||f,{refs:a,floatingStyles:P,placement:g,middlewareData:I}=Ve(O?{placement:b,strategy:"fixed",middleware:[f&&je({fallbackPlacements:b.includes("bottom")?["bottom-start","bottom-end","top-start","top-end"]:["top-start","top-end","bottom-start","bottom-end"]})],whileElementsMounted:We}:{}),w=He("overflowmenu"),E=Xe(),p=n.useRef(null),{open:F,x:W,y:N,handleClick:q,handleMousedown:j,handleClose:c}=nt(p);n.useEffect(()=>{O&&Object.keys(P).forEach(k=>{a.floating.current&&(a.floating.current.style[k]=P[k])})},[P,O,a.floating,F,g,I]);function e(){p.current&&q()}const T=V(i,`${E}--overflow-menu__container`,{[`${E}--autoalign`]:O}),M=V(`${E}--overflow-menu__${b}`),$=V(`${E}--overflow-menu`,{[`${E}--overflow-menu--open`]:F},R!==ge&&`${E}--overflow-menu--${R}`),z=re(p,a.setReference);return h.createElement("div",ee({},C,{className:T,"aria-owns":F?w:void 0,ref:l}),h.createElement(Ee,{"aria-controls":F?w:void 0,"aria-haspopup":!0,"aria-expanded":F,className:$,onClick:e,onMouseDown:j,ref:z,label:v,align:m,kind:"ghost"},h.createElement(u,{className:`${E}--overflow-menu__icon`})),h.createElement(ot,{containerRef:p,ref:a.setFloating,menuAlignment:b,className:M,id:w,size:R,legacyAutoalign:!O,open:F,onClose:c,x:W,y:N,label:v,target:y},d))});Te.propTypes={autoAlign:t.bool,children:t.node,className:t.string,label:t.string,menuAlignment:t.oneOf(["top-start","top-end","bottom-start","bottom-end"]),renderIcon:t.oneOfType([t.func,t.object]),size:t.oneOf(["sm","md","lg"]),tooltipAlignment:Re(t.oneOf(["top","top-left","top-right","bottom","bottom-left","bottom-right","left","left-bottom","left-top","right","right-bottom","right-top","top-start","top-end","bottom-start","bottom-end","left-end","left-start","right-end","right-start"]),["top","top-start","top-end","bottom","bottom-start","bottom-end","left","left-start","left-end","right","right-start","right-end"],ft),menuTarget:t.instanceOf(typeof Element<"u"?Element:Object)};var oe,he;function ut(){if(he)return oe;he=1;var r=function(s,l,f,d,i,v,u,R){if(!s){var b;if(l===void 0)b=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var m=[f,d,i,v,u,R],y=0;b=new Error(l.replace(/%s/g,function(){return m[y++]})),b.name="Invariant Violation"}throw b.framesToPop=1,b}};return oe=r,oe}var pt=ut();const At=Ce(pt);var Z,be;function dt(){return be||(be=1,Z=typeof self=="object"&&self.self===self&&self||typeof Q=="object"&&Q.global===Q&&Q||Z),Z}var mt=dt();const _=Ce(mt),gt=(()=>{const r=[];let s=!1;const l=()=>{r.forEach(i=>{i()}),s=!1},f=()=>{s||(s=!0,_.requestAnimationFrame(l))},d=i=>{r.indexOf(i)<0&&r.push(i)};return{add:i=>(r.length||_.addEventListener("resize",f),d(i),{remove:()=>{const v=r.indexOf(i);v>=0&&r.splice(v,1)}})}})(),ht="left",se="top",bt="right",G="bottom",wt=r=>{let{menuSize:s,refPosition:l,offset:f,direction:d,scrollX:i,scrollY:v,container:u}=r;const{left:R=0,top:b=0,right:m=0,bottom:y=0}=l,C=u.position!=="static"?0:i,O=u.position!=="static"?0:v,a={top:u.position!=="static"?u.rect.top:0,left:u.position!=="static"?u.rect.left:0},{width:P,height:g}=s,{top:I=0,left:w=0}=f,E=(R+m)/2,p=(b+y)/2;return{[ht]:()=>({left:R-P+C-w-a.left,top:p-g/2+O+I-9-a.top}),[se]:()=>({left:E-P/2+C+w-a.left,top:b-g+O-I-a.top}),[bt]:()=>({left:m+C+w-a.left,top:p-g/2+O+I+3-a.top}),[G]:()=>({left:E-P/2+C+w-a.left,top:y+O+I-a.top})}[d]()},vt=r=>{let{children:s,flipped:l,focusTrap:f,menuDirection:d=G,menuOffset:i={top:0,left:0},menuRef:v,onPlace:u,selectorPrimaryFocus:R,styles:b,target:m=()=>document.body,triggerRef:y,updateOrientation:C}=r;const O=n.useContext(Oe),[a,P]=n.useState(void 0),g=n.useRef(null),I=n.useRef(null),w=n.useRef(null),E=n.useRef(!1),p=n.useCallback(e=>{const T=g.current;if(!T)return;const M=y.current,$=T.getBoundingClientRect(),z=M?M.getBoundingClientRect():void 0,k=typeof i=="function"?i(T,d,M,l):i;if(C&&C({menuSize:$,refPosition:z,direction:d,offset:k,scrollX:_.pageXOffset,scrollY:_.pageYOffset,container:{rect:m().getBoundingClientRect(),position:getComputedStyle(m()).position}}),$.width>0&&$.height>0||!k){const S=wt({menuSize:$,refPosition:z??{left:0,top:0,right:0,bottom:0},offset:k,direction:d,scrollX:_.pageXOffset,scrollY:_.pageYOffset,container:{rect:m().getBoundingClientRect(),position:getComputedStyle(m()).position}});if((!a||a.left!==S.left||a.top!==S.top)&&P(S),!e){const U=T.getBoundingClientRect();(U.width!==$.width||U.height!==$.height)&&p(!0)}}},[y,i,d,l,m,C,a]),F=e=>{const T=R?e.querySelector(R):null,M=e.querySelector(st),$=e.querySelector(it);(T||M||$||e).focus()},W=e=>{g.current=e,E.current=!!e,v&&v(e),e&&p()};n.useEffect(()=>{E.current&&a&&g.current&&(g.current.contains(document.activeElement)||F(g.current),typeof u=="function"&&u(g.current),E.current=!1)},[a,u]),n.useEffect(()=>{const e=gt.add(()=>{p()});return()=>{e.remove()}},[y,i,d,l,m,C]),n.useEffect(()=>{p()},[i,d,l,y,m,C]);const N=()=>{const e=a,T=e?{left:`${e.left}px`,top:`${e.top}px`,right:"auto"}:{visibility:"hidden",top:"0px"},M=s;return n.cloneElement(M,{ref:W,style:{...b,...T,position:"absolute",opacity:1}})},q=e=>{g.current&&I.current&&w.current&&lt({bodyNode:g.current,startTrapNode:I.current,endTrapNode:w.current,currentActiveNode:e.relatedTarget,oldActiveNode:e.target})},j=e=>{Ke(e,Ge)&&g.current&&at({containerNode:g.current,currentActiveNode:e.target,event:e})},c=Ye("enable-experimental-focus-wrap-without-sentinels");if(typeof document<"u"){const e=m?m():document.body;return rt.createPortal(h.createElement("div",{onBlur:f&&!c?q:void 0,onKeyDown:c?j:void 0},!c&&h.createElement("span",{ref:I,tabIndex:0,role:"link",className:`${O}--visually-hidden`},"Focus sentinel"),N(),!c&&h.createElement("span",{ref:w,tabIndex:0,role:"link",className:`${O}--visually-hidden`},"Focus sentinel")),e)}return null},Ot=Ue(),Et=function(r){for(var s=arguments.length,l=new Array(s>1?s-1:0),f=1;f<s;f++)l[f-1]=arguments[f];return r.addEventListener(...l),{release(){return r.removeEventListener(...l),null}}},Rt={[se]:"bottom",[G]:"top"},we=(r,s,l,f)=>{const d=Rt[s],{offsetWidth:i,offsetHeight:v}=r;switch(d){case"top":case"bottom":{const u=l?l.offsetWidth:0;return{left:(f?-1:1)*(i/2-u/2),top:0}}default:return{left:0,top:0}}},yt=r=>({"top-left":"top-start","top-right":"top-end","bottom-left":"bottom-start","bottom-right":"bottom-end","left-bottom":"left-end","left-top":"left-start","right-bottom":"right-end","right-top":"right-start"})[r],ie=n.forwardRef((r,s)=>{let{align:l,["aria-label"]:f=null,ariaLabel:d,children:i,className:v,direction:u=G,flipped:R=!1,focusTrap:b=!0,iconClass:m,iconDescription:y="Options",id:C,light:O,menuOffset:a=we,menuOffsetFlip:P=we,menuOptionsClass:g,onClick:I=ne,onClose:w=ne,onOpen:E=ne,open:p,renderIcon:F=ye,selectorPrimaryFocus:W="[data-floating-menu-primary-focus]",size:N="md",innerRef:q,...j}=r;const c=n.useContext(Oe),[e,T]=n.useState(p??!1),[M,$]=n.useState(!1),[z,k]=n.useState(!1),S=n.useRef(null),U=n.useRef(Ot()),B=n.useRef(null),ae=n.useRef({}),le=n.useRef(p),ce=n.useRef(e),A=n.useRef(null),fe=n.useRef(null);n.useEffect(()=>{le.current!==p&&(T(!!p),le.current=p)},[p]),n.useEffect(()=>{A.current&&k(!0)},[]),n.useEffect(()=>{!e&&ce.current&&w(),ce.current=e},[e,w]),ct(fe,o=>{let{target:x}=o;e&&(!B.current||x instanceof Node&&!B.current.contains(x))&&H()});const J=n.useCallback(()=>{A.current&&A.current.focus()},[]),H=n.useCallback(o=>{T(!1),o&&o(),w()},[w]),ue=n.useCallback(()=>{const o=M,x=e;H(()=>{x&&!o&&J()})},[M,e,H,J]),Ie=n.useCallback(()=>{const o=e;H(()=>{o&&J()})},[e,H,J]),Me=o=>{$(!0),(!B.current||!B.current.contains(o.target))&&(T(x=>!x),I(o))},$e=o=>{e&&de(o,[Je,Qe,Ze,et])&&o.preventDefault(),de(o,[tt])&&(Ie(),o.stopPropagation())},Pe=o=>{let{currentIndex:x=0,direction:L}=o;const D=n.Children.toArray(i).reduce((K,pe,_e)=>(h.isValidElement(pe)&&!pe.props.disabled&&K.push(_e),K),[]),X=(()=>{const K=D.indexOf(x)+L;switch(K){case-1:return D.length-1;case D.length:return 0;default:return K}})(),Y=ae.current[D[X]];Y==null||Y.focus()},Fe=o=>{o||(B.current=o),!o&&S.current&&(S.current=S.current.release())},Ne=o=>{if(!o)return;B.current=o;const x="onfocusin"in window,L=x?"focusin":"focus";S.current=Et(o.ownerDocument,L,D=>{const X=D.target,Y=A.current;typeof X.matches=="function"&&!o.contains(X)&&Y&&!X.matches(`.${c}--overflow-menu:first-child, .${c}--overflow-menu-options:first-child`)&&ue()},!x),E()},ke=()=>{const o=A.current;return o instanceof Element&&o.closest("[data-floating-menu-container]")||document.body},te=`overflow-menu-${U.current}__menu-body`,Se=V(v,`${c}--overflow-menu`,{[`${c}--overflow-menu--open`]:e,[`${c}--overflow-menu--light`]:O,[`${c}--overflow-menu--${N}`]:N}),Ae=V(g,`${c}--overflow-menu-options`,{[`${c}--overflow-menu--flip`]:R,[`${c}--overflow-menu-options--open`]:e,[`${c}--overflow-menu-options--light`]:O,[`${c}--overflow-menu-options--${N}`]:N}),De=V(`${c}--overflow-menu__icon`,m),ze=n.Children.toArray(i).map((o,x)=>{if(n.isValidElement(o)){const L=o;return n.cloneElement(L,{closeMenu:L.props.closeMenu||ue,handleOverflowMenuItemFocus:Pe,ref:D=>{ae.current[x]=D},index:x})}return null}),qe=h.createElement("ul",{className:Ae,tabIndex:-1,role:"menu","aria-label":f||d,onKeyDown:$e,id:te},ze),Be=h.createElement(vt,{focusTrap:b,triggerRef:A,menuDirection:u,menuOffset:R?P:a,menuRef:Fe,flipped:R,target:ke,onPlace:Ne,selectorPrimaryFocus:W},n.cloneElement(qe,{"data-floating-menu-direction":u})),Le=q?re(A,q,s):re(A,s);return h.createElement(h.Fragment,null,h.createElement("span",{className:`${c}--overflow-menu__wrapper`,"aria-owns":e?te:void 0,ref:fe},h.createElement(Ee,ee({},j,{align:l,type:"button","aria-haspopup":!0,"aria-expanded":e,"aria-controls":e?te:void 0,className:Se,onClick:Me,id:C,ref:Le,size:N,label:y,kind:"ghost"}),h.createElement(F,{className:De,"aria-label":y})),e&&z&&Be))});ie.propTypes={align:Re(t.oneOf(["top","top-left","top-right","bottom","bottom-left","bottom-right","left","left-bottom","left-top","right","right-bottom","right-top","top-start","top-end","bottom-start","bottom-end","left-end","left-start","right-end","right-start"]),["top","top-start","top-end","bottom","bottom-start","bottom-end","left","left-start","left-end","right","right-start","right-end"],yt),"aria-label":t.string,ariaLabel:me(t.string),children:t.node,className:t.string,direction:t.oneOf([se,G]),flipped:t.bool,focusTrap:t.bool,iconClass:t.string,iconDescription:t.string,id:t.string,light:me(t.bool),menuOffset:t.oneOfType([t.shape({top:t.number.isRequired,left:t.number.isRequired}),t.func]),menuOffsetFlip:t.oneOfType([t.shape({top:t.number.isRequired,left:t.number.isRequired}),t.func]),menuOptionsClass:t.string,onClick:t.func,onClose:t.func,onFocus:t.func,onKeyDown:t.func,onOpen:t.func,open:t.bool,renderIcon:t.oneOfType([t.func,t.object]),selectorPrimaryFocus:t.string,size:t.oneOf(["sm","md","lg"])};const xe=n.forwardRef((r,s)=>ve("enable-v12-overflowmenu")?h.createElement(Te,ee({},r,{ref:s})):h.createElement(ie,ee({},r,{ref:s})));xe.displayName="OverflowMenu";xe.propTypes=ie.propTypes;export{xe as O,At as i};
