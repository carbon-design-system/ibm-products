import{r as c,q as C,u as ve,d as $e,k as Te,v as ye,c as h,e as n,_ as Ce,P as t,i as H}from"./iframe-arkle79Y.js";import{F as Ee}from"./FormContext-CgeFsgSy.js";import{g as Ne}from"./TextInput-CfvZmzil.js";import{A as Ie}from"./index-Chb2kpTH.js";import{i as Re}from"./utils-ChakNn1e.js";import{T as w}from"./Text-pEBQpjZl.js";import{W as J,a as Q}from"./bucket-19-ClJk_Iwe.js";const Ae=c.forwardRef,U=Ae((X,Y)=>{const{className:Z,decorator:$,disabled:d=!1,id:b,labelText:E,hideLabel:ee,onChange:N=C,onClick:I=C,onKeyDown:R=C,invalid:o=!1,invalidText:te="",helperText:_="",light:ae,placeholder:re="",enableCounter:g=!1,maxCount:l,counterMode:s="character",warn:m=!1,warnText:ne="",rows:le=4,slug:T,...f}=X,e=ve(),{isFluid:i}=c.useContext(Ee),{defaultValue:A,value:W}=f,oe=$e(),L=c.useRef(null),u=c.useRef(null),D=c.useRef(null),F=c.useRef(null),O=c.useRef(null),se=Te([Y,u]);function k(){const r=(A||W||u.current?.value||"").toString();return s==="character"?r.length:r.match(new RegExp("\\p{L}+","gu"))?.length||0}const[v,p]=c.useState(k());c.useEffect(()=>{p(k())},[W,A,s]),ye(()=>{const a=L.current?.scrollWidth;f.cols&&u.current?(u.current.style.width="",u.current.style.resize="none"):u.current&&(u.current.style.width="100%"),[D,F,O].forEach(r=>{r.current&&(r.current.style.maxWidth=`${a}px`,r.current.style.overflowWrap="break-word")})},[f.cols,o,m]);const P={id:b,onKeyDown:a=>{if(!d&&g&&s==="word"){const r=a.which;(l&&v>=l&&r===32||l&&v>=l&&r===13)&&a.preventDefault()}!d&&R&&R(a)},onPaste:a=>{if(!d&&s==="word"&&g&&typeof l<"u"&&u.current!==null){const r=u.current.value.match(new RegExp("\\p{L}+","gu"))||[],G=a.clipboardData.getData("Text").match(new RegExp("\\p{L}+","gu"))||[];if(r.length+G.length>l){a.preventDefault();const _e=r.concat(G).slice(0,l);setTimeout(()=>{p(l)},0),u.current.value=_e.join(" ")}}},onChange:a=>{if(!d){if(s=="character")a?.persist?.(),setTimeout(()=>{p(a.target?.value?.length)},0);else if(s=="word"){if(!a.target.value){setTimeout(()=>{p(0)},0);return}if(g&&typeof l<"u"&&u.current!==null){const r=a.target?.value?.match(new RegExp("\\p{L}+","gu"));r&&r.length<=l?(u.current.removeAttribute("maxLength"),setTimeout(()=>{p(r.length)},0)):r&&r.length>l&&setTimeout(()=>{p(r.length)},0)}}N&&N(a)}},onClick:a=>{!d&&I&&I(a)}},ce=h(`${e}--form-item`,Z),ie=h(`${e}--text-area__wrapper`,{[`${e}--text-area__wrapper--cols`]:f.cols,[`${e}--text-area__wrapper--readonly`]:f.readOnly,[`${e}--text-area__wrapper--warn`]:m,[`${e}--text-area__wrapper--slug`]:T,[`${e}--text-area__wrapper--decorator`]:$}),ue=h(`${e}--label`,{[`${e}--visually-hidden`]:ee&&!i,[`${e}--label--disabled`]:d}),de=h(`${e}--text-area`,{[`${e}--text-area--light`]:ae,[`${e}--text-area--invalid`]:o,[`${e}--text-area--warn`]:m}),me=h(`${e}--label`,{[`${e}--label--disabled`]:d,[`${e}--text-area__label-counter`]:!0}),fe=h(`${e}--form__helper-text`,{[`${e}--form__helper-text--disabled`]:d}),pe=E?n.createElement(w,{as:"label",htmlFor:b,className:ue},E):null,xe=g&&l&&(s==="character"||s==="word")?n.createElement(w,{as:"div",className:me},`${v}/${l}`):null,V=_?`text-area-helper-text-${oe}`:void 0,he=_?n.createElement(w,{as:"div",id:V,className:fe,ref:D},_):null,q=b+"-error-msg",z=o?n.createElement(w,{as:"div",role:"alert",className:`${e}--form-requirement`,id:q,ref:F},te,i&&n.createElement(J,{className:`${e}--text-area__invalid-icon`})):null,ge=b+"-warn-msg",K=m?n.createElement(w,{as:"div",role:"alert",className:`${e}--form-requirement`,id:ge,ref:O},ne,i&&n.createElement(Q,{className:`${e}--text-area__invalid-icon ${e}--text-area__invalid-icon--warning`})):null;let y;o?y=q:!o&&!m&&!i&&_&&(y=V),g&&s=="character"&&(P.maxLength=l);const M=c.useRef(null),[S,we]=c.useState(""),x=Ne(v,l,s==="word"?"word":void 0,s==="word"?"words":void 0);c.useEffect(()=>{if(x&&x!==S){const a=M.current;if(a){a.textContent="";const r=setTimeout(()=>{a&&(a.textContent=x,we(x))},s==="word"?2e3:1e3);return()=>{r&&clearTimeout(r)}}}},[x,S,s]);const be=n.createElement("textarea",Ce({},f,P,{placeholder:re,"aria-readonly":!!f.readOnly,className:de,"aria-invalid":o,"aria-describedby":y,disabled:d,rows:le,readOnly:f.readOnly,ref:se})),j=T??$,B=Re(j,Ie)?c.cloneElement(j,{size:"mini"}):null;return n.createElement("div",{className:ce},n.createElement("div",{className:`${e}--text-area__label-wrapper`},pe,xe),n.createElement("div",{ref:L,className:ie,"data-invalid":o||null},o&&!i&&n.createElement(J,{className:`${e}--text-area__invalid-icon`}),m&&!o&&!i&&n.createElement(Q,{className:`${e}--text-area__invalid-icon ${e}--text-area__invalid-icon--warning`}),be,T?B:$?n.createElement("div",{className:`${e}--text-area__inner-wrapper--decorator`},B):"",n.createElement("span",{className:`${e}--text-area__counter-alert`,role:"alert","aria-live":"assertive","aria-atomic":"true",ref:M},x),i&&n.createElement("hr",{className:`${e}--text-area__divider`}),i&&o?z:null,i&&m&&!o?K:null),!o&&!m&&!i?he:null,o&&!i?z:null,m&&!o&&!i?K:null)});U.displayName="TextArea";U.propTypes={className:t.string,cols:t.number,counterMode:t.oneOf(["character","word"]),decorator:t.node,defaultValue:t.oneOfType([t.string,t.number]),disabled:t.bool,enableCounter:t.bool,helperText:t.node,hideLabel:t.bool,id:t.string,invalid:t.bool,invalidText:t.node,labelText:t.node.isRequired,light:H(t.bool),maxCount:t.number,onChange:t.func,onClick:t.func,onKeyDown:t.func,placeholder:t.string,readOnly:t.bool,rows:t.number,slug:H(t.node),value:t.oneOfType([t.string,t.number]),warn:t.bool,warnText:t.node};export{U as T};
