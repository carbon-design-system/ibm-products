{"version":3,"file":"CoachmarkFixed.stories-bEJRO_rv.js","sources":["../../src/patterns/CoachmarkFixed/CoachmarkFixed.mdx","../../src/patterns/CoachmarkFixed/CoachmarkFixed.stories.jsx"],"sourcesContent":["import { Story, Controls, Source, Canvas } from '@storybook/addon-docs/blocks';\nimport { CodesandboxLink } from '../../global/js/utils/story-helper';\nimport * as CoachmarkFixedStories from './CoachmarkFixed.stories';\nimport { stackblitzPrefillConfig } from '../../../previewer/codePreviewer';\n\n# CoachmarkFixed\n\n## Table of Contents\n\n- [Overview](#overview)\n- [Example usage](#example-usage)\n\n## Overview\n\nThe CoachmarkFixed pattern acts as a container element for onboarding and should\nonly be used within the scope of a Coachmark.\n\nTo build this pattern, we recommend including the following components:\n\n- [Coachmark](https://carbon-for-ibm-products.netlify.app/?path=/docs/preview-onboarding-coachmark--overview)\n- [Button](https://react.carbondesignsystem.com/?path=/docs/components-button)\n- [Carousel utility](https://github.com/carbon-design-system/carbon/blob/main/packages/utilities/src/carousel/README.md)\n\n## Example usage\n\n{/* TODO: One example per designed use case. */}\n\n<Canvas className=\"coachmarkExample\" withSource=\"none\">\n  <div className=\"CoachmarkBaseExampleUsage\">\n    <Story of={CoachmarkFixedStories.CoachmarkFixed} />\n  </div>\n</Canvas>\n","/**\n * Copyright IBM Corp. 2025\n *\n * This source code is licensed under the Apache-2.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React, {\n  useCallback,\n  useEffect,\n  useLayoutEffect,\n  useRef,\n  useState,\n} from 'react';\nimport { Button, Theme, Link as CarbonLink } from '@carbon/react';\nimport styles from './_storybook-styles.scss?inline';\nimport DocsPage from './CoachmarkFixed.mdx';\nimport { Coachmark } from '../../components/Coachmark/next/Coachmark';\nimport {\n  initCarousel,\n  InitCarousel,\n} from '../../global/js/utils/carousel/carousel';\nimport { CoachmarkTagline } from '../../components/Coachmark/next/Coachmark/CoachmarkTagline/CoachmarkTagline';\n\nexport default {\n  title: 'Patterns/Coachmark Fixed',\n  component: () => {},\n  tags: ['autodocs'],\n  parameters: {\n    styles,\n    docs: {\n      page: DocsPage,\n    },\n  },\n};\n\n//fetching theme\nfunction useCarbonTheme() {\n  const [themeValue, setThemeValue] = useState(() =>\n    document.documentElement.getAttribute('data-carbon-theme')\n  );\n\n  useEffect(() => {\n    const target = document.documentElement;\n\n    // function to read the current theme\n    const readTheme = () => {\n      const newTheme = target.getAttribute('data-carbon-theme');\n      setThemeValue((prev) => (prev !== newTheme ? newTheme : prev));\n    };\n\n    const observer = new MutationObserver((mutationsList) => {\n      for (const mutation of mutationsList) {\n        if (\n          mutation.type === 'attributes' &&\n          mutation.attributeName === 'data-carbon-theme'\n        ) {\n          readTheme();\n        }\n      }\n    });\n\n    observer.observe(target, {\n      attributes: true,\n      attributeFilter: ['data-carbon-theme'],\n    });\n\n    //fallback - check readTheme in every 200ms\n    const interval = setInterval(readTheme, 200);\n\n    return () => {\n      observer.disconnect();\n      clearInterval(interval);\n    };\n  }, []);\n\n  return themeValue;\n}\n\nconst CoachmarkFixedPattern = (args) => {\n  const carbonTheme = useCarbonTheme();\n  const [isOpen, setIsOpen] = useState(true);\n\n  const [currentViewIndex, setCurrentViewIndex] = useState(-1);\n  const [lastViewIndex, setLastViewIndex] = useState(-1);\n  const [fixedIsVisible, setFixedIsVisible] = useState(false);\n\n  //prettier-ignore\n  const carouselContainerRef = useRef < HTMLDivElement > (null);\n  //prettier-ignore\n  const carouselInit = useRef < InitCarousel > (null);\n  //prettier-ignore\n  const nextRef = useRef<HTMLButtonElement>(null);\n\n  const items = [\n    {\n      id: 1,\n      title: 'Hello World',\n      text: 'Link opens in new tab.',\n      button: (\n        <CarbonLink href=\"https://www.ibm.com\" target=\"_blank\">\n          {' '}\n          Learn more\n        </CarbonLink>\n      ),\n    },\n    {\n      id: 2,\n      title: 'Hello World 2',\n      text: 'Link opens on this page.',\n      button: <CarbonLink href=\"https://www.ibm.com\">Learn more</CarbonLink>,\n    },\n  ];\n\n  useEffect(() => {\n    setFixedIsVisible(isOpen);\n  }, [isOpen]);\n\n  const handleClose = () => {\n    setIsOpen(false);\n    setFixedIsVisible(false);\n    carouselInit.current.reset();\n  };\n\n  useLayoutEffect(() => {\n    setTimeout(() => nextRef.current?.focus(), 0);\n  }, [isOpen]);\n\n  const handleTaglineClick = () => {\n    setIsOpen((isOpen) => !isOpen);\n  };\n\n  useEffect(() => {\n    if (carouselContainerRef && carouselContainerRef.current) {\n      carouselInit.current = initCarousel(carouselContainerRef.current, {\n        onViewChangeStart: onViewChangeStart,\n        onViewChangeEnd: onViewChangeEnd,\n      });\n    }\n  }, [carouselInit, isOpen]);\n\n  const onViewChangeStart = () => {};\n  const onViewChangeEnd = (options) => {\n    handleViewStackUpdate(options);\n  };\n\n  const handleViewStackUpdate = useCallback(({ currentIndex, lastIndex }) => {\n    console.log(currentIndex, lastIndex);\n\n    setCurrentViewIndex(currentIndex);\n    setLastViewIndex(lastIndex);\n  }, []);\n\n  const onNext = () => {\n    carouselInit.current.next();\n  };\n  const onPrev = () => {\n    carouselInit.current.prev();\n  };\n\n  return (\n    <Theme theme={carbonTheme}>\n      <Coachmark open={isOpen} onClose={handleClose} align=\"top\" {...args}>\n        <CoachmarkTagline\n          title=\"Why are there two types of severity scores?\"\n          closeIconDescription=\"Close\"\n          isOpen={isOpen}\n          buttonProps={{ onClick: handleTaglineClick, id: 'CoachmarkTagline' }}\n        ></CoachmarkTagline>\n        <Coachmark.Content\n          className={fixedIsVisible && `is-visible`}\n          highContrast={true}\n        >\n          <Coachmark.Content.Header closeIconDescription=\"Close\"></Coachmark.Content.Header>\n          <Coachmark.Content.Body>\n            <div ref={carouselContainerRef} className=\"exampleCarouselWrapper\">\n              {items.map((item) => (\n                <div key={item.id}>\n                  <h2>{item.title}</h2>\n                  <p>{item.text}</p>\n                  <br></br>\n                  <p>{item.button}</p>\n                </div>\n              ))}\n            </div>\n\n            <div className={'carouselControlWrapper__footer'}>\n              <div className={'carouselControlWrapper--controls-progress'}>\n                {items.map((item, index) => {\n                  if (carouselInit.current?.getActiveItem?.()?.index === index)\n                    return (\n                      <span key={item.id}>\n                        {`${carouselInit.current?.getActiveItem?.()?.index + 1} / ${items.length}`}\n                      </span>\n                    );\n                })}\n              </div>\n              <div className={'carouselControlWrapper--buttons'}>\n                {currentViewIndex !== 0 && (\n                  <Button\n                    size=\"sm\"\n                    iconDescription=\"Previous\"\n                    kind=\"ghost\"\n                    onClick={onPrev}\n                  >\n                    Back\n                  </Button>\n                )}\n\n                {lastViewIndex !== currentViewIndex ? (\n                  <Button\n                    ref={nextRef}\n                    size=\"sm\"\n                    iconDescription=\"Next\"\n                    onClick={onNext}\n                  >\n                    Next\n                  </Button>\n                ) : (\n                  <Button size=\"sm\" onClick={handleClose}>\n                    Done\n                  </Button>\n                )}\n              </div>\n            </div>\n          </Coachmark.Content.Body>\n        </Coachmark.Content>\n      </Coachmark>\n    </Theme>\n  );\n};\n\nexport const CoachmarkFixed = CoachmarkFixedPattern.bind({});\nCoachmarkFixed.args = {};\n"],"names":["_createMdxContent","props","_components","_provideComponents","_jsxs","_Fragment","_jsx","Canvas","Story","CoachmarkFixedStories.CoachmarkFixed","MDXContent","MDXLayout","CoachmarkFixed_stories","title","component","tags","parameters","styles","docs","page","DocsPage","useCarbonTheme","themeValue","setThemeValue","useState","document","documentElement","getAttribute","useEffect","target","readTheme","newTheme","prev","observer","MutationObserver","mutationsList","mutation","type","attributeName","observe","attributes","attributeFilter","interval","setInterval","disconnect","clearInterval","CoachmarkFixedPattern","args","carbonTheme","isOpen","setIsOpen","currentViewIndex","setCurrentViewIndex","lastViewIndex","setLastViewIndex","fixedIsVisible","setFixedIsVisible","carouselContainerRef","useRef","carouselInit","nextRef","items","id","text","button","CarbonLink","React","handleClose","current","reset","useLayoutEffect","setTimeout","focus","handleTaglineClick","initCarousel","onViewChangeStart","onViewChangeEnd","options","handleViewStackUpdate","useCallback","currentIndex","lastIndex","console","log","onNext","next","onPrev","Theme","Coachmark","CoachmarkTagline","onClick","map","item","index","getActiveItem","length","Button","CoachmarkFixed","bind","source","originalSource"],"mappings":"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"}