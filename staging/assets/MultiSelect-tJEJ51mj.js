import{P as s,a3 as D,b as ft,d as pt,u as mt,a as ht,i as $,c as z,_ as G,e as gt,f as It,s as yt,h as xt,$ as _e,E as Ee,S as St,y as $e,v as Te,g as Ae}from"./index-Cd8snwnz.js";import{u as Me,L as H,b as bt}from"./index-CNhKwCqX.js";import{g as wt}from"./_commonjsHelpers-BosuxZz1.js";import{r as m,e as f}from"./index-BOZkNhcz.js";import{m as vt}from"./mergeRefs-CTUecegF.js";import{F as Ct}from"./FormContext-qEw5DNxz.js";import{C as _t}from"./Checkbox-DURplLdT.js";import{n as Et}from"./settings-DqneCnpo.js";import{W as $t,a as Tt}from"./bucket-18-D95sPjw6.js";var le,Oe;function At(){if(Oe)return le;Oe=1;var c=typeof Element<"u",p=typeof Map=="function",o=typeof Set=="function",d=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function u(t,n){if(t===n)return!0;if(t&&n&&typeof t=="object"&&typeof n=="object"){if(t.constructor!==n.constructor)return!1;var a,l,g;if(Array.isArray(t)){if(a=t.length,a!=n.length)return!1;for(l=a;l--!==0;)if(!u(t[l],n[l]))return!1;return!0}var S;if(p&&t instanceof Map&&n instanceof Map){if(t.size!==n.size)return!1;for(S=t.entries();!(l=S.next()).done;)if(!n.has(l.value[0]))return!1;for(S=t.entries();!(l=S.next()).done;)if(!u(l.value[1],n.get(l.value[0])))return!1;return!0}if(o&&t instanceof Set&&n instanceof Set){if(t.size!==n.size)return!1;for(S=t.entries();!(l=S.next()).done;)if(!n.has(l.value[0]))return!1;return!0}if(d&&ArrayBuffer.isView(t)&&ArrayBuffer.isView(n)){if(a=t.length,a!=n.length)return!1;for(l=a;l--!==0;)if(t[l]!==n[l])return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf&&typeof t.valueOf=="function"&&typeof n.valueOf=="function")return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString&&typeof t.toString=="function"&&typeof n.toString=="function")return t.toString()===n.toString();if(g=Object.keys(t),a=g.length,a!==Object.keys(n).length)return!1;for(l=a;l--!==0;)if(!Object.prototype.hasOwnProperty.call(n,g[l]))return!1;if(c&&t instanceof Element)return!1;for(l=a;l--!==0;)if(!((g[l]==="_owner"||g[l]==="__v"||g[l]==="__o")&&t.$$typeof)&&!u(t[g[l]],n[g[l]]))return!1;return!0}return t!==t&&n!==n}return le=function(n,a){try{return u(n,a)}catch(l){if((l.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw l}},le}var Ot=At();const re=wt(Ot),Ft={compareItems:s.func,sortItems:s.func},Mt=(c,p,o)=>{let{locale:d}=o;return c.localeCompare(p,d,{numeric:!0})},Pt=(c,p)=>{let{selectedItems:o=[],itemToString:d,compareItems:u,locale:t="en"}=p;return c.sort((n,a)=>{if(n.isSelectAll)return-1;if(a.isSelectAll)return 1;const l=o.includes(n),g=o.includes(a);return l&&!g?-1:g&&!l?1:u(d(n),d(a),{locale:t})})};function Fe(c){let{isControlled:p,isMounted:o,onChangeHandlerControlled:d,onChangeHandlerUncontrolled:u,selectedItems:t}=c;p?o&&d&&d({selectedItems:t}):u(t)}function Dt(c){let{disabled:p,onChange:o,initialSelectedItems:d=[],selectedItems:u,selectAll:t=!1,filteredItems:n=[]}=c;const a=m.useRef(!1),l=m.useRef(o),[g,S]=m.useState(d),x=!!u,b=x?u:g,L=m.useCallback(h=>{if(p)return;const K=n.filter(_=>!_.disabled),Q=n.filter(_=>_.disabled).length;let w;if(h&&h.isSelectAll&&b.length>0)w=[];else if(h&&h.isSelectAll&&b.length==0)w=K;else{let _;b.forEach((B,X)=>{re(B,h)&&(_=X)}),_===void 0?(w=b.concat(h),t&&n.length-1===w.length+Q&&(w=K)):(w=Pe(b,_),w=w.filter(B=>!B.isSelectAll))}Fe({isControlled:x,isMounted:a.current,onChangeHandlerControlled:l.current,onChangeHandlerUncontrolled:S,selectedItems:w})},[p,b,n,t,x]),J=m.useCallback(()=>{p||Fe({isControlled:x,isMounted:a.current,onChangeHandlerControlled:l.current,onChangeHandlerUncontrolled:S,selectedItems:[]})},[p,x]);return m.useEffect(()=>{l.current=o},[o]),m.useEffect(()=>{a.current&&l.current&&!x&&l.current({selectedItems:b})},[x,b]),m.useEffect(()=>(a.current=!0,()=>{a.current=!1}),[]),{selectedItems:b,onItemChange:L,clearSelection:J}}class Bt extends f.Component{constructor(p){super(p),D(this,"internalSetState",(o,d)=>this.setState(o,()=>{d&&d(),this.props.onChange&&this.props.onChange(this.state)})),D(this,"handleClearSelection",()=>{this.props.disabled||this.internalSetState({selectedItems:[]})}),D(this,"handleSelectItem",o=>{this.internalSetState(d=>({selectedItems:d.selectedItems.concat(o)}))}),D(this,"handleRemoveItem",o=>{this.internalSetState(d=>({selectedItems:Pe(d.selectedItems,o)}))}),D(this,"handleOnItemChange",o=>{if(this.props.disabled)return;const{selectedItems:d}=this.state;let u;if(d.forEach((t,n)=>{re(t,o)&&(u=n)}),u===void 0){this.handleSelectItem(o);return}this.handleRemoveItem(u)}),this.state={selectedItems:p.initialSelectedItems}}render(){const{children:p,render:o}=this.props,{selectedItems:d}=this.state,u={selectedItems:d,onItemChange:this.handleOnItemChange,clearSelection:this.handleClearSelection};return o!==void 0?o(u):p!==void 0?p(u):null}}D(Bt,"propTypes",{children:s.func,disabled:s.bool,initialSelectedItems:s.array.isRequired,onChange:s.func,render:s.func});const Pe=(c,p)=>{const o=c.slice();return o.splice(p,1),o},{ItemClick:Nt,ToggleButtonBlur:Rt,ToggleButtonKeyDownArrowDown:kt,ToggleButtonKeyDownArrowUp:jt,ToggleButtonKeyDownEnter:zt,ToggleButtonKeyDownEscape:Ht,ToggleButtonKeyDownSpaceButton:Lt,ItemMouseMove:Kt,MenuMouseLeave:qt,ToggleButtonClick:Wt,ToggleButtonKeyDownPageDown:Ut,ToggleButtonKeyDownPageUp:Vt,FunctionSetHighlightedIndex:Gt}=Me.stateChangeTypes,Jt=c=>typeof c=="string"?c:typeof c=="number"?`${c}`:c!==null&&typeof c=="object"&&"label"in c&&typeof c.label=="string"?c.label:"",De=f.forwardRef((c,p)=>{var Ce;let{autoAlign:o=!1,className:d,decorator:u,id:t,items:n,itemToElement:a,itemToString:l=Jt,titleText:g=!1,hideLabel:S,helperText:x,label:b,type:L="default",size:J,disabled:h=!1,initialSelectedItems:K=[],sortItems:Q=Pt,compareItems:w=Mt,clearSelectionText:_="To clear selection, press Delete or Backspace",clearAnnouncement:B="all items have been cleared",clearSelectionDescription:X="Total items selected: ",light:Be,invalid:C,invalidText:Ne,warn:q,warnText:Re,useTitleInItem:ke,translateWithId:oe,downshiftProps:je,open:F=!1,selectionFeedback:ie="top-after-reopen",onChange:ze,onMenuChange:ae,direction:ce="bottom",selectedItems:de,readOnly:N,locale:He="en",slug:W}=c;const R=m.useMemo(()=>n.filter(e=>{if(typeof e=="object"&&e!==null){for(const I in e)if(Object.hasOwn(e,I)&&e[I]===void 0)return!1}return!0}),[n]);let k=R.some(e=>e.isSelectAll);(de??[]).length>0&&k&&(console.warn("Warning: `selectAll` should not be used when `selectedItems` is provided. Please pass either `selectAll` or `selectedItems`, not both."),k=!1);const r=ft(),{isFluid:Y}=m.useContext(Ct),ue=pt(),[Qt,Z]=m.useState(!1),[fe,j]=m.useState(!1),[v,Le]=m.useState(F||!1),[Ke,qe]=m.useState(F),[We,Ue]=m.useState([]),[Ve,pe]=m.useState(!1),T=mt("enable-v12-dynamic-floating-styles")||o,{refs:M,floatingStyles:me,middlewareData:he}=ht(T?{placement:ce,strategy:"fixed",middleware:[o&&It({crossAxis:!1}),yt({apply(e){let{rects:I,elements:i}=e;Object.assign(i.floating.style,{width:`${I.reference.width}px`})}}),o&&xt()],whileElementsMounted:gt}:{});m.useLayoutEffect(()=>{var e;if(T){const I={...me,visibility:(e=he.hide)!=null&&e.referenceHidden?"hidden":"visible"};Object.keys(I).forEach(i=>{M.floating.current&&(M.floating.current.style[i]=I[i])})}},[T,me,M.floating,he,F]);const{selectedItems:U,onItemChange:ge,clearSelection:Ie}=Dt({disabled:h,initialSelectedItems:K,onChange:ze,selectedItems:de,selectAll:k,filteredItems:R}),ee={selectedItems:U,itemToString:l,compareItems:w,locale:He},Ge={stateReducer:ot,isOpen:v,itemToString:e=>Array.isArray(e)&&e.map(function(I){return l(I)}).join(", ")||"",selectedItem:U,items:R,isItemDisabled(e,I){return e==null?void 0:e.disabled},...je},{getToggleButtonProps:Je,getLabelProps:Qe,getMenuProps:ye,getItemProps:Xe,selectedItem:Ye,highlightedIndex:Ze,setHighlightedIndex:xe}=Me(Ge),Se=Je({onFocus:()=>{j(!0)},onBlur:()=>{j(!1)},onKeyDown:e=>{h||(($(e,_e)||$(e,Ee))&&!v&&(Ie(),e.stopPropagation()),!v&&$(e,_e)&&y.length>0&&pe(!0),($(e,St)||$(e,$e)||$(e,Te))&&!v&&(xe(0),pe(!1),V(!0)),$(e,$e)&&y.length===0&&(j(!1),Z(!1)),$(e,Ee)&&v&&j(!0),$(e,Te)&&v&&j(!0))}}),te=vt(Se.ref,p),y=Ye,V=e=>{Le(e),ae&&ae(e)};Ke!==F&&(V(F),qe(F));const A=L==="inline",be=!C&&q,et=z(`${r}--multi-select__wrapper`,`${r}--list-box__wrapper`,d,{[`${r}--multi-select__wrapper--inline`]:A,[`${r}--list-box__wrapper--inline`]:A,[`${r}--multi-select__wrapper--inline--invalid`]:A&&C,[`${r}--list-box__wrapper--inline--invalid`]:A&&C,[`${r}--list-box__wrapper--fluid--invalid`]:Y&&C,[`${r}--list-box__wrapper--slug`]:W,[`${r}--list-box__wrapper--decorator`]:u}),tt=z(`${r}--label`,{[`${r}--label--disabled`]:h,[`${r}--visually-hidden`]:S}),we=x?`multiselect-helper-text-${ue}`:void 0,nt=`multiselect-field-label-${ue}`,st=z(`${r}--form__helper-text`,{[`${r}--form__helper-text--disabled`]:h}),lt=z(`${r}--multi-select`,{[`${r}--multi-select--invalid`]:C,[`${r}--multi-select--invalid--focused`]:C&&fe,[`${r}--multi-select--warning`]:be,[`${r}--multi-select--inline`]:A,[`${r}--multi-select--selected`]:y&&y.length>0,[`${r}--list-box--up`]:ce==="top",[`${r}--multi-select--readonly`]:N,[`${r}--autoalign`]:T,[`${r}--multi-select--selectall`]:k}),rt=a;ie==="fixed"?ee.selectedItems=[]:ie==="top-after-reopen"&&(ee.selectedItems=We);function ot(e,I){const{changes:i,props:ne,type:O}=I,{highlightedIndex:E}=i;switch(i.isOpen&&!v&&Ue(U),O){case Lt:case zt:if(i.selectedItem===void 0||Array.isArray(i.selectedItem))break;return ge(i.selectedItem),{...i,highlightedIndex:e.highlightedIndex};case Rt:case Ht:V(!1);break;case Wt:return V(i.isOpen||!1),{...i,highlightedIndex:U.length>0?0:void 0};case Nt:return xe(i.selectedItem),ge(i.selectedItem),{...i,highlightedIndex:e.highlightedIndex};case qt:return{...i,highlightedIndex:e.highlightedIndex};case Gt:return v?{...i,highlightedIndex:R.indexOf(E)}:{...i,highlightedIndex:0};case kt:case jt:case Ut:case Vt:if(E>-1){const se=document.querySelectorAll(`li.${r}--list-box__menu-item[role="option"]`);ne.scrollIntoView(se[E])}return E===-1?{...i,highlightedIndex:0}:i;case Kt:return{...i,highlightedIndex:e.highlightedIndex}}return i}const it=z(`${r}--list-box__field--wrapper`,{[`${r}--list-box__field--wrapper--input-focused`]:fe}),ve=e=>{e.target.classList.contains(`${r}--tag__close-icon`)?Z(!1):Z(e.type==="focus")},at=N?{onClick:e=>{e.preventDefault(),te.current!==void 0&&te.current.focus()},onKeyDown:e=>{["ArrowDown","ArrowUp"," ","Enter"].includes(e.key)&&e.preventDefault()}}:{};let P=f.isValidElement(W??u)?W??u:null;P&&((Ce=P.type)==null?void 0:Ce.displayName)==="AILabel"&&(P=f.cloneElement(P,{size:"mini"}));const ct=y.length>0&&y.map(e=>e==null?void 0:e.text),dt=k?y.filter(e=>!e.isSelectAll).length:y.length,ut=m.useMemo(()=>ye({ref:T?M.setFloating:null}),[T,ye,M.setFloating]);return f.createElement("div",{className:et},f.createElement("label",G({className:tt},Qe()),g&&g,y.length>0&&f.createElement("span",{className:`${r}--visually-hidden`},X," ",y.length," ",ct,",",_)),f.createElement(H,{onFocus:Y?ve:void 0,onBlur:Y?ve:void 0,type:L,size:J,className:lt,disabled:h,light:Be,invalid:C,invalidText:Ne,warn:q,warnText:Re,isOpen:v,id:t},C&&f.createElement($t,{className:`${r}--list-box__invalid-icon`}),be&&f.createElement(Tt,{className:`${r}--list-box__invalid-icon ${r}--list-box__invalid-icon--warning`}),f.createElement("div",{className:it,ref:T?M.setReference:null},y.length>0&&f.createElement(H.Selection,{readOnly:N,clearSelection:!h&&!N?Ie:Et,selectionCount:dt,translateWithId:oe,disabled:h}),f.createElement("button",G({type:"button",className:`${r}--list-box__field`,disabled:h,"aria-disabled":h||N,"aria-describedby":!A&&!C&&!q&&x?we:void 0},Se,{ref:te},at),f.createElement("span",{id:nt,className:`${r}--list-box__label`},b),f.createElement(H.MenuIcon,{isOpen:v,translateWithId:oe})),W?P:u?f.createElement("div",{className:`${r}--list-box__inner-wrapper--decorator`},P):""),f.createElement(H.Menu,ut,v&&Q(R,ee).map((e,I)=>{const i=y.filter(se=>re(se,e)).length>0,ne=y.length!==0&&e.isSelectAll&&!i,O=Xe({item:e,"aria-selected":i}),E=l(e);return f.createElement(H.MenuItem,G({key:O.id,isActive:i&&!e.isSelectAll,"aria-label":E,isHighlighted:Ze===I,title:E,disabled:O["aria-disabled"]},O),f.createElement("div",{className:`${r}--checkbox-wrapper`},f.createElement(_t,{id:`${O.id}__checkbox`,labelText:a?f.createElement(rt,G({key:O.id},e)):E,checked:i,title:ke?E:void 0,indeterminate:ne,disabled:h})))})),Ve&&f.createElement("span",{"aria-live":"assertive","aria-label":B})),!A&&!C&&!q&&x&&f.createElement("div",{id:we,className:st},x))});De.displayName="MultiSelect";De.propTypes={...Ft,autoAlign:s.bool,className:s.string,clearSelectionDescription:s.string,clearSelectionText:s.string,compareItems:s.func,decorator:s.node,direction:s.oneOf(["top","bottom"]),disabled:s.bool,downshiftProps:s.object,helperText:s.node,hideLabel:s.bool,id:s.string.isRequired,initialSelectedItems:s.array,invalid:s.bool,invalidText:s.node,itemToElement:s.func,itemToString:s.func,items:s.array.isRequired,label:s.node.isRequired,light:Ae(s.bool),locale:s.string,onChange:s.func,onMenuChange:s.func,open:s.bool,readOnly:s.bool,selectedItems:s.array,selectionFeedback:s.oneOf(["top","fixed","top-after-reopen"]),size:bt,slug:Ae(s.node),sortItems:s.func,titleText:s.node,translateWithId:s.func,type:s.oneOf(["default","inline"]),useTitleInItem:s.bool,warn:s.bool,warnText:s.node};export{De as M,re as i};
