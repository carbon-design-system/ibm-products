import{e as r,c as j,p as V,P as t,aa as O,r as o,B as ne,bP as ie}from"./iframe-BCQS5_Al.js";import{C as ee}from"./Checkbox-Cfr6AEd4.js";import{u as ae}from"./useId-DiFn3R-L.js";import{u as oe,C as le,a as Z,P as ce,K as de,b as ue,D as me,r as pe,e as ge,c as be,S as fe,v as ye}from"./modifiers.esm-CFR9zWYJ.js";import{j as Ce}from"./bucket-11-BKStVx8j.js";import{m as he}from"./bucket-6-BnWBUhiK.js";import{g as w}from"./getNodeTextContent-C8IeKkUQ.js";import{u as Te}from"./uuidv4-BN2rGLQG.js";import{S as qe}from"./Search-CBYfLWWC.js";import{T as _e}from"./TearsheetNarrow-DH8CF6dX.js";import{l as ve}from"./useDatagrid-cAsz3Two.js";import{r as xe}from"./index.esm-nggaN46X.js";const W=s=>typeof s.isVisible=="boolean"?s.isVisible:!0,D=`${V.prefix}--datagrid`,K=({id:s,elementId:i,children:l,classList:m,disabled:a,ariaLabel:g,isSticky:f,selected:T})=>{const{attributes:b,isDragging:x,listeners:d,setNodeRef:h,transform:L,transition:E}=oe({disabled:a,id:s}),{"aria-pressed":R,"aria-describedby":S}=b,k=f?r.createElement("div",{className:j({disabled:a},`${D}__draggable-handleStyle`)},r.createElement(Ce,{size:16})," "):r.createElement("button",{className:`${D}__draggable-handleStyle`,type:"button","aria-label":g,"aria-describedby":S,"aria-pressed":R,...d},r.createElement(he,{size:16})),z=r.createElement(r.Fragment,null,k,l),e={transform:a?void 0:le.Transform.toString(L),transition:E};return r.createElement("li",{className:j(m,`${D}__draggable-handleHolder`,{[`${D}__draggable-handleHolder--selected`]:T,[`${D}__draggable-handleHolder--sticky`]:f,[`${D}__draggable-handleHolder--dragging`]:x}),id:i||s,ref:h,style:e},r.createElement("div",{className:j([`${D}__draggable-handleHolder-droppable`])},z))};K.propTypes={ariaLabel:t.string.isRequired,children:t.element.isRequired,classList:t.string,disabled:t.bool,elementId:t.string,id:t.string.isRequired,isSticky:t.bool,selected:t.bool};K.__docgenInfo={description:"Single row in the DraggableItemsList used by CustomizeColumnsTearsheet.",methods:[],displayName:"DraggableElement",props:{ariaLabel:{required:!0,tsType:{name:"string"},description:"",type:{name:"string"}},children:{required:!0,tsType:{name:"ReactNode"},description:"",type:{name:"element"}},classList:{required:!1,tsType:{name:"string"},description:"",type:{name:"string"}},disabled:{required:!1,tsType:{name:"boolean"},description:"",type:{name:"bool"}},id:{required:!0,tsType:{name:"string"},description:"",type:{name:"string"}},elementId:{required:!1,tsType:{name:"string"},description:"",type:{name:"string"}},isSticky:{required:!1,tsType:{name:"boolean"},description:"",type:{name:"bool"}},selected:{required:!1,tsType:{name:"boolean"},description:"",type:{name:"bool"}}},composes:["PropsWithChildren"]};const A=`${V.prefix}--datagrid`,P=(s,i)=>s&&i&&s.id===i.id,U=({columns:s,filterString:i,id:l,moveElement:m,onSelectColumn:a,setAriaRegionText:g})=>{const f=`${A}__draggable-item`,T=ae(),b=s.filter(e=>w(e.Header).trim().length!==0).filter(Boolean).filter(e=>!e.isAction).filter(e=>e.id!=="spacer").filter(e=>i.length===0||w(e.Header).toLowerCase().includes(i)),d=(()=>{const e=[...b];return e.forEach(c=>{c.sticky&&(c.disabled=!0)}),e})(),h=e=>{const{active:c,over:u}=e,n=d.filter(_=>_.id===u.id);if(n?.length&&n[0]?.disabled)return;const y=d.findIndex(_=>P(_,c)),I=d.findIndex(_=>P(_,u)),q=w(d[y].Header);g(`${q} dropped. New position ${I+1} of ${d.length}.`);const B=s.findIndex(_=>P(_,c)),F=s.findIndex(_=>P(_,u));m(B,F)},L=e=>{const{active:c}=e,u=d.findIndex(y=>P(y,c)),n=w(d[u].Header);g(`${n} grabbed. Current position ${u+1} of ${d.length}.`)},E=e=>{const{active:c,over:u}=e,n=d.findIndex(q=>P(q,c)),y=d.findIndex(q=>P(q,u)),I=w(d[n].Header);g(`${I} grabbed. Original position ${n+1}, new position ${y+1} of ${d.length}.`)},R=Z(ce,{activationConstraint:{distance:4}}),S=Z(de,{coordinateGetter:(e,c)=>{const{currentCoordinates:u}=c;let n=e.target;for(;n&&!n.classList.contains(f);)n=n.parentNode;const y=n.offsetHeight;switch(e.code){case"ArrowRight":case"ArrowLeft":return u;case"ArrowUp":return{...u,y:u.y-y};case"ArrowDown":return{...u,y:u.y+y}}}}),k=ue(R,S),z=(e,c)=>{if(e.code==="Space")return a(c,!W(c)),e.preventDefault(),e.stopPropagation(),!1};return r.createElement(me,{collisionDetection:be,onDragEnd:h,onDragStart:L,onDragMove:E,sensors:k,modifiers:[pe,ge]},r.createElement(r.Fragment,null,r.createElement("div",{className:`${A}__draggable-underlay`,"aria-hidden":"true",key:`draggable-underlay-${l}`},b.map(e=>r.createElement("div",{className:`${A}__draggable-underlay-item`,key:e.id}))),r.createElement(fe,{items:d,strategy:ye},b.map(e=>{const c=w(e.Header),u=!!e.sticky,n=e.disabled,y=r.createElement(ee,{checked:W(e),disabled:n||u,onChange:(I,{checked:q})=>a(e,q),id:`${A}__customization-column-${e.id}`,labelText:c,className:`${A}__customize-columns-checkbox`,onKeyDown:I=>z(I,e)});return r.createElement(K,{classList:f,key:e.id,id:e.id,elementId:`${e.id}-${T}`,disabled:i.length>0||u,ariaLabel:c,isSticky:u,selected:W(e)},y)}))))};U.propTypes={columns:O.PropTypes.array.isRequired,filterString:O.PropTypes.string.isRequired,id:O.PropTypes.string.isRequired,moveElement:O.PropTypes.func.isRequired,onSelectColumn:O.PropTypes.func.isRequired,setAriaRegionText:O.PropTypes.func.isRequired};U.__docgenInfo={description:"",methods:[],displayName:"DraggableItemsList",props:{columns:{description:"",type:{name:"array"},required:!0},filterString:{description:"",type:{name:"string"},required:!0},id:{description:"",type:{name:"string"},required:!0},moveElement:{description:"",type:{name:"func"},required:!0},onSelectColumn:{description:"",type:{name:"func"},required:!0},setAriaRegionText:{description:"",type:{name:"func"},required:!0}}};const v=`${V.prefix}--datagrid`,G=({getVisibleColumnsCount:s,filterString:i,columns:l,setColumnsObject:m,onSelectColumn:a,assistiveTextInstructionsLabel:g,assistiveTextDisabledInstructionsLabel:f,selectAllLabel:T,customizeTearsheetHeadingLabel:b})=>{const x=o.useRef(Te()),d=o.useRef(null),[h,L]=r.useState(""),E=r.useCallback((S,k)=>{m(z=>{const e=[...z],c=e[S];return e.splice(S,1),e.splice(k,0,c),e})},[m]),R=l?.filter(S=>!S.sticky);return r.createElement("div",{className:`${v}__customize-columns-column-list`,ref:d},r.createElement("ol",{className:`${v}__customize-columns-column-list--focus`,"aria-label":b,"aria-describedby":`${v}__customize-columns--instructions`},r.createElement("span",{"aria-live":"assertive",className:`${v}__shared-ui--assistive-text`},h),r.createElement("span",{id:`${v}__customize-columns--instructions`,className:`${v}__shared-ui--assistive-text`},i.length===0?g:f),r.createElement("div",{id:`${v}__customize-columns-select-all`,className:j(`${v}__customize-columns-select-all`,{[`${v}__customize-columns-select-all--selected`]:s()>0}),selected:s()>0},r.createElement(ee,{className:`${v}__customize-columns-checkbox-wrapper`,checked:s()===l.length,indeterminate:s()<l.length&&s()>0,onChange:()=>{a(R,s()!==l.length)},id:`${v}__customization-column-select-all`,labelText:T})),r.createElement(U,{id:x.current,columns:l,filterString:i,moveElement:E,setAriaRegionText:L,onSelectColumn:a})))};G.propTypes={assistiveTextDisabledInstructionsLabel:t.string,assistiveTextInstructionsLabel:t.string,columns:t.array.isRequired,customizeTearsheetHeadingLabel:t.string,disabledInstructionsLabel:t.string,filterString:t.string.isRequired,getVisibleColumnsCount:t.func.isRequired,instructionsLabel:t.string,onSelectColumn:t.func.isRequired,selectAllLabel:t.string,setColumnStatus:t.func,setColumnsObject:t.func.isRequired};G.__docgenInfo={description:"",methods:[],displayName:"Columns",props:{assistiveTextDisabledInstructionsLabel:{description:"",type:{name:"string"},required:!1},assistiveTextInstructionsLabel:{description:"",type:{name:"string"},required:!1},columns:{description:"",type:{name:"array"},required:!0},customizeTearsheetHeadingLabel:{description:"",type:{name:"string"},required:!1},disabledInstructionsLabel:{description:"",type:{name:"string"},required:!1},filterString:{description:"",type:{name:"string"},required:!0},getVisibleColumnsCount:{description:"",type:{name:"func"},required:!0},instructionsLabel:{description:"",type:{name:"string"},required:!1},onSelectColumn:{description:"",type:{name:"func"},required:!0},selectAllLabel:{description:"",type:{name:"string"},required:!1},setColumnStatus:{description:"",type:{name:"func"},required:!1},setColumnsObject:{description:"",type:{name:"func"},required:!0}}};const Se=`${V.prefix}--datagrid`,M=({searchText:s,setSearchText:i,findColumnPlaceholderLabel:l})=>o.createElement("div",{className:`${Se}__customize-columns-tearsheet--actions`},o.createElement(qe,{placeholder:l,value:s,size:"lg",labelText:l,onChange:m=>{i(m.target.value)}}));M.propTypes={columns:t.array.isRequired,findColumnPlaceholderLabel:t.string,originalColumnDefinitions:t.array.isRequired,resetToDefaultLabel:t.string,searchText:t.string.isRequired,setColumnsObject:t.func.isRequired,setSearchText:t.func.isRequired};M.__docgenInfo={description:"",methods:[],displayName:"Actions",props:{columns:{description:"",type:{name:"array"},required:!0},findColumnPlaceholderLabel:{description:"",type:{name:"string"},required:!1},originalColumnDefinitions:{description:"",type:{name:"array"},required:!0},resetToDefaultLabel:{description:"",type:{name:"string"},required:!1},searchText:{description:"",type:{name:"string"},required:!0},setColumnsObject:{description:"",type:{name:"func"},required:!0},setSearchText:{description:"",type:{name:"func"},required:!0}}};const $e=`${V.prefix}--datagrid`,J=({isOpen:s,setIsTearsheetOpen:i,launcherButtonRef:l,onSaveColumnPrefs:m,columnDefinitions:a,originalColumnDefinitions:g,customizeTearsheetHeadingLabel:f="Customize columns",primaryButtonTextLabel:T="Save",secondaryButtonTextLabel:b="Cancel",instructionsLabel:x="Select columns to display them. Click and drag the box to reorder the columns. These specifications will be saved and persist if you leave and return to the data table.",findColumnPlaceholderLabel:d="Find column",resetToDefaultLabel:h="Reset to default",assistiveTextInstructionsLabel:L="Press space bar to toggle drag drop mode, use arrow keys to move selected elements.",assistiveTextDisabledInstructionsLabel:E="Reordering columns are disabled because they are filtered currently.",selectAllLabel:R="Column name"})=>{const[S,k]=o.useState(""),[z,e]=o.useState(""),[c,u]=o.useState(""),[n,y]=o.useState(a),[I,q]=o.useState(!1),B=o.useRef(void 0),F=()=>{y(a),i(!1)},_=()=>{i(!1);const C=n.map($=>({id:$.id,isVisible:$.isVisible}));m(C)},te=(C,$)=>{const N=n.map(p=>Array.isArray(C)?C.includes(p)&&p.canFilter&&!p.disabled?{...p,isVisible:$}:p:C.id===p.id?{...p,isVisible:$}:p),Y=N.filter(p=>p.isVisible&&!["datagridSelection","actions"].includes(p.id)).length,re=N.map(p=>Y>0?["datagridSelection","actions"].includes(p.id)?{...p,isVisible:!0}:p:["datagridSelection","actions"].includes(p.id)?{...p,isVisible:!1}:p);y(re),q(Y!==0)},H=o.useCallback(()=>n.filter(C=>C.isVisible).length,[n]),se=c.trim().toLowerCase();return o.useEffect(()=>{B.current!==a&&y(a);const C=n.filter(N=>N.id==="actions").length,$=n.filter(N=>N.id==="datagridSelection").length;k(H()-C-$<0?0:H()-C-$),e(n.length-C-$),B.current=a},[H,n,a]),r.createElement(_e,{className:`${$e}__customize-columns-tearsheet`,open:s,title:`${f} (${S}/${z})`,description:x,launcherButtonRef:l,actions:[{kind:"secondary",label:b,onClick:F},{kind:"primary",label:T,onClick:_,disabled:!I}]},r.createElement(M,{columns:n,originalColumnDefinitions:g,searchText:c,setColumnsObject:C=>{y(C),q(!0)},setSearchText:u,findColumnPlaceholderLabel:d,resetToDefaultLabel:h}),s&&r.createElement(G,{assistiveTextInstructionsLabel:L,assistiveTextDisabledInstructionsLabel:E,getVisibleColumnsCount:H,columns:n,filterString:se,onSelectColumn:te,setColumnsObject:C=>{y(C),q(H()!==0)},selectAllLabel:R,customizeTearsheetHeadingLabel:f}))};J.propTypes={assistiveTextDisabledInstructionsLabel:t.string,assistiveTextInstructionsLabel:t.string,columnDefinitions:t.array.isRequired,customizeTearsheetHeadingLabel:t.string,findColumnPlaceholderLabel:t.string,instructionsLabel:t.string,isOpen:t.bool.isRequired,onSaveColumnPrefs:t.func.isRequired,originalColumnDefinitions:t.array.isRequired,primaryButtonTextLabel:t.string,resetToDefaultLabel:t.string,secondaryButtonTextLabel:t.string,selectAllLabel:t.string,setIsTearsheetOpen:t.func.isRequired};J.__docgenInfo={description:"",methods:[],displayName:"CustomizeColumnsTearsheet",props:{customizeTearsheetHeadingLabel:{defaultValue:{value:"'Customize columns'",computed:!1},description:"",type:{name:"string"},required:!1},primaryButtonTextLabel:{defaultValue:{value:"'Save'",computed:!1},description:"",type:{name:"string"},required:!1},secondaryButtonTextLabel:{defaultValue:{value:"'Cancel'",computed:!1},description:"",type:{name:"string"},required:!1},instructionsLabel:{defaultValue:{value:"'Select columns to display them. Click and drag the box to reorder the columns. These specifications will be saved and persist if you leave and return to the data table.'",computed:!1},description:"",type:{name:"string"},required:!1},findColumnPlaceholderLabel:{defaultValue:{value:"'Find column'",computed:!1},description:"",type:{name:"string"},required:!1},resetToDefaultLabel:{defaultValue:{value:"'Reset to default'",computed:!1},description:"",type:{name:"string"},required:!1},assistiveTextInstructionsLabel:{defaultValue:{value:"'Press space bar to toggle drag drop mode, use arrow keys to move selected elements.'",computed:!1},description:"",type:{name:"string"},required:!1},assistiveTextDisabledInstructionsLabel:{defaultValue:{value:"'Reordering columns are disabled because they are filtered currently.'",computed:!1},description:"",type:{name:"string"},required:!1},selectAllLabel:{defaultValue:{value:"'Column name'",computed:!1},description:"",type:{name:"string"},required:!1},columnDefinitions:{description:"",type:{name:"array"},required:!0},isOpen:{description:"",type:{name:"bool"},required:!0},onSaveColumnPrefs:{description:"",type:{name:"func"},required:!0},originalColumnDefinitions:{description:"",type:{name:"array"},required:!0},setIsTearsheetOpen:{description:"",type:{name:"func"},required:!0}}};const Q=({instance:s,launcherButtonRef:i})=>{const{onSaveColumnPrefs:l,isTearsheetOpen:m,setIsTearsheetOpen:a,labels:g,...f}=s.customizeColumnsProps,{state:T}=o.useContext(ve),{featureFlags:b}=T||{};return o.useEffect(()=>{b&&!b?.["enable-datagrid-useCustomizeColumns"]&&console.error("Datagrid useCustomizeColumns extension has not been enabled via feature flag.")},[b]),r.createElement(J,{...f,...g,isOpen:m,setIsTearsheetOpen:a,launcherButtonRef:i,columnDefinitions:s.allColumns,originalColumnDefinitions:s.columns,onSaveColumnPrefs:x=>{setTimeout(()=>{const d=x.filter(h=>!h.isVisible).map(h=>h.id);s.setHiddenColumns(d),typeof s.setColumnOrder=="function"?s.setColumnOrder(x.map(h=>h.id)):console.warn("Column order can not be updated. Did you forget to add 'useColumnOrder' in 'useDatagrid'")},0),typeof l=="function"&&l(x)}})};Q.propTypes={instance:t.object.isRequired};Q.__docgenInfo={description:"",methods:[],displayName:"TearsheetWrapper",props:{instance:{description:"",type:{name:"object"},required:!0}}};const Ie=`${V.prefix}--datagrid`,X=o.forwardRef(({onClick:s,setIsTearsheetOpen:i,isTearsheetOpen:l,iconTooltipLabel:m="Customize columns",...a},g)=>o.createElement(ne,{...a,renderIcon:f=>o.createElement(ie,{size:16,...f}),iconDescription:m,tooltipPosition:"bottom",kind:"ghost",hasIconOnly:!0,"test-id":`${Ie}__customize-columns-trigger`,ref:g,onClick:()=>{i(!l),typeof s=="function"&&s()}}));X.propTypes={iconTooltipLabel:t.string,isTearsheetOpen:t.bool.isRequired,onClick:t.func.isRequired,setIsTearsheetOpen:t.func.isRequired};X.__docgenInfo={description:"",methods:[],displayName:"ButtonWrapper",props:{isTearsheetOpen:{required:!0,tsType:{name:"boolean"},description:"",type:{name:"bool"}},iconTooltipLabel:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:"'Customize columns'",computed:!1},type:{name:"string"}},onClick:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"",type:{name:"func"}},setIsTearsheetOpen:{required:!0,tsType:{name:"signature",type:"function",raw:"(open: boolean) => void",signature:{arguments:[{type:{name:"boolean"},name:"open"}],return:{name:"void"}}},description:"",type:{name:"func"}}},composes:["ComponentProps"]};const Le=s=>{const{customizeColumnsProps:i}=s,{labels:l}=i||{},[m,a]=o.useState(!1),g=o.useRef(null),f=o.useCallback(b=>o.createElement(X,{...b,iconTooltipLabel:l?.iconTooltipLabel,isTearsheetOpen:m,setIsTearsheetOpen:a,ref:g}),[m,l?.iconTooltipLabel]),T=o.useCallback(b=>o.createElement(Q,{...b,launcherButtonRef:g}),[g]);Object.assign(s,{customizeColumnsProps:{...i,isTearsheetOpen:m,setIsTearsheetOpen:a},CustomizeColumnsButton:f,CustomizeColumnsTearsheet:T})},Be=s=>{s.useInstance.push(Le)},je=xe.useColumnOrder;export{Be as a,je as u};
