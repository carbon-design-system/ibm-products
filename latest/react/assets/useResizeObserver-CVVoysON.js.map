{"version":3,"file":"useResizeObserver-CVVoysON.js","sources":["../../src/global/js/hooks/useResizeObserver.ts"],"sourcesContent":["/**\n * Copyright IBM Corp. 2023, 2025\n *\n * This source code is licensed under the Apache-2.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport { useRef, useState, useEffect, RefObject } from 'react';\nimport { useIsomorphicEffect } from './useIsomorphicEffect';\n\nexport const useResizeObserver = (\n  ref: RefObject<HTMLElement | null>,\n  onResize?: (rect: DOMRectReadOnly) => void\n) => {\n  const [width, setWidth] = useState(-1);\n  const [height, setHeight] = useState(-1);\n  const entriesToHandle = useRef<ResizeObserverEntry[] | null>(null);\n  const cb = useRef(onResize);\n\n  useEffect(() => {\n    // ref for onResize removes it as dependency from useIsomorphicEffect\n    // This significantly reduces repeated calls if a function is redefined on every\n    // render\n    cb.current = onResize;\n  }, [onResize]);\n\n  useEffect(() => {\n    const getInitialSize = () => {\n      if (ref.current) {\n        const refComputedStyle = window.getComputedStyle(ref.current);\n\n        const initialWidth =\n          (ref.current?.offsetWidth ?? 0) -\n          (typeof refComputedStyle?.paddingLeft === 'string' &&\n          refComputedStyle?.paddingLeft.length\n            ? parseFloat(refComputedStyle?.paddingLeft)\n            : 0) -\n          (typeof refComputedStyle?.paddingRight === 'string' &&\n          refComputedStyle?.paddingRight.length\n            ? parseFloat(refComputedStyle?.paddingRight)\n            : 0);\n\n        const initialHeight =\n          (ref.current?.offsetHeight ?? 0) -\n          (typeof refComputedStyle?.paddingTop === 'string' &&\n          refComputedStyle?.paddingTop.length\n            ? parseFloat(refComputedStyle?.paddingTop)\n            : 0) -\n          (typeof refComputedStyle?.paddingBottom === 'string' &&\n          refComputedStyle?.paddingBottom.length\n            ? parseFloat(refComputedStyle?.paddingBottom)\n            : 0);\n\n        setWidth(initialWidth);\n        setHeight(initialHeight);\n      }\n    };\n    if (!ref?.current || (width >= 0 && height >= 0)) {\n      return;\n    }\n    getInitialSize();\n    // Ignoring exhaustive-deps as we do NOT want to include the ref in dep array\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [width, height]);\n\n  useIsomorphicEffect(() => {\n    if (!ref?.current) {\n      return;\n    }\n\n    const doCallbacks = () => {\n      if (!ref?.current || !Array.isArray(entriesToHandle?.current)) {\n        return;\n      }\n\n      const entry = entriesToHandle.current[0];\n\n      setWidth(entry.contentRect.width);\n      setHeight(entry.contentRect.height);\n\n      cb.current && cb.current(entry.contentRect);\n    };\n\n    const observer = new ResizeObserver((entries) => {\n      // always update entriesToHandle\n      entriesToHandle.current = entries;\n\n      window.requestAnimationFrame(() => {\n        // do callbacks\n        doCallbacks();\n      });\n    });\n\n    // observe all refs passed\n    observer.observe(ref.current);\n\n    return () => {\n      observer.disconnect();\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [ref.current]);\n  return { width, height };\n};\n"],"names":["useResizeObserver","ref","onResize","width","setWidth","useState","height","setHeight","entriesToHandle","useRef","cb","useEffect","getInitialSize","refComputedStyle","initialWidth","initialHeight","useIsomorphicEffect","doCallbacks","entry","observer","entries"],"mappings":"0FASO,MAAMA,EAAoB,CAC/BC,EACAC,IACG,CACH,KAAM,CAACC,EAAOC,CAAQ,EAAIC,EAAAA,SAAS,EAAE,EAC/B,CAACC,EAAQC,CAAS,EAAIF,EAAAA,SAAS,EAAE,EACjCG,EAAkBC,EAAAA,OAAqC,IAAI,EAC3DC,EAAKD,EAAAA,OAAOP,CAAQ,EAE1BS,OAAAA,EAAAA,UAAU,IAAM,CAIdD,EAAG,QAAUR,CACf,EAAG,CAACA,CAAQ,CAAC,EAEbS,EAAAA,UAAU,IAAM,CACd,MAAMC,EAAiB,IAAM,CAC3B,GAAIX,EAAI,QAAS,CACf,MAAMY,EAAmB,OAAO,iBAAiBZ,EAAI,OAAO,EAEtDa,GACHb,EAAI,SAAS,aAAe,IAC5B,OAAOY,GAAkB,aAAgB,UAC1CA,GAAkB,YAAY,OAC1B,WAAWA,GAAkB,WAAW,EACxC,IACH,OAAOA,GAAkB,cAAiB,UAC3CA,GAAkB,aAAa,OAC3B,WAAWA,GAAkB,YAAY,EACzC,GAEAE,GACHd,EAAI,SAAS,cAAgB,IAC7B,OAAOY,GAAkB,YAAe,UACzCA,GAAkB,WAAW,OACzB,WAAWA,GAAkB,UAAU,EACvC,IACH,OAAOA,GAAkB,eAAkB,UAC5CA,GAAkB,cAAc,OAC5B,WAAWA,GAAkB,aAAa,EAC1C,GAENT,EAASU,CAAY,EACrBP,EAAUQ,CAAa,CACzB,CACF,EACI,CAACd,GAAK,SAAYE,GAAS,GAAKG,GAAU,GAG9CM,EAAA,CAGF,EAAG,CAACT,EAAOG,CAAM,CAAC,EAElBU,EAAoB,IAAM,CACxB,GAAI,CAACf,GAAK,QACR,OAGF,MAAMgB,EAAc,IAAM,CACxB,GAAI,CAAChB,GAAK,SAAW,CAAC,MAAM,QAAQO,GAAiB,OAAO,EAC1D,OAGF,MAAMU,EAAQV,EAAgB,QAAQ,CAAC,EAEvCJ,EAASc,EAAM,YAAY,KAAK,EAChCX,EAAUW,EAAM,YAAY,MAAM,EAElCR,EAAG,SAAWA,EAAG,QAAQQ,EAAM,WAAW,CAC5C,EAEMC,EAAW,IAAI,eAAgBC,GAAY,CAE/CZ,EAAgB,QAAUY,EAE1B,OAAO,sBAAsB,IAAM,CAEjCH,EAAA,CACF,CAAC,CACH,CAAC,EAGD,OAAAE,EAAS,QAAQlB,EAAI,OAAO,EAErB,IAAM,CACXkB,EAAS,WAAA,CACX,CAEF,EAAG,CAAClB,EAAI,OAAO,CAAC,EACT,CAAE,MAAAE,EAAO,OAAAG,CAAA,CAClB"}